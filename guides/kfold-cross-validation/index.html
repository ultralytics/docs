<!doctypehtml><html class=no-js lang=en><meta charset=utf-8><meta content=width=device-width,initial-scale=1 name=viewport><meta content="Learn to implement K-Fold Cross Validation for object detection datasets using Ultralytics YOLO. Improve your model's reliability and robustness."name=description><meta content=Ultralytics name=author><link href=https://docs.ultralytics.com/guides/kfold-cross-validation/ rel=canonical><link href=../model-deployment-options/ rel=prev><link href=../hyperparameter-tuning/ rel=next><link href=../../assets/favicon.ico rel=icon><meta content="mkdocs-1.6.1, mkdocs-material-9.5.44"name=generator><title>K-Fold Cross Validation - Ultralytics YOLO Docs</title><link href=../../assets/stylesheets/main.0253249f.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href=https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href=../../assets/_mkdocstrings.css rel=stylesheet><link href=../../stylesheets/style.css rel=stylesheet><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2M5EHKC0BH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2M5EHKC0BH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2M5EHKC0BH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><meta content="K-Fold Cross Validation"name=title><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css rel=stylesheet><meta content="Ultralytics, YOLO, K-Fold Cross Validation, object detection, sklearn, pandas, PyYaml, machine learning, dataset split"name=keywords><meta content=website property=og:type><meta content=https://docs.ultralytics.com/guides/kfold-cross-validation property=og:url><meta content="K-Fold Cross Validation"property=og:title><meta content="Learn to implement K-Fold Cross Validation for object detection datasets using Ultralytics YOLO. Improve your model's reliability and robustness."property=og:description><meta content=https://github.com/ultralytics/docs/releases/download/0/k-fold-cross-validation-overview.avif property=og:image><meta content=summary_large_image property=twitter:card><meta content=https://docs.ultralytics.com/guides/kfold-cross-validation property=twitter:url><meta content="K-Fold Cross Validation"property=twitter:title><meta content="Learn to implement K-Fold Cross Validation for object detection datasets using Ultralytics YOLO. Improve your model's reliability and robustness."property=twitter:description><meta content=https://github.com/ultralytics/docs/releases/download/0/k-fold-cross-validation-overview.avif property=twitter:image><script type=application/ld+json>{"@context": "https://schema.org", "@type": ["Article", "FAQPage"], "headline": "K-Fold Cross Validation", "image": ["https://github.com/ultralytics/docs/releases/download/0/k-fold-cross-validation-overview.avif"], "datePublished": "2023-11-12 02:49:37 +0100", "dateModified": "2024-11-07 02:33:15 +0330", "author": [{"@type": "Organization", "name": "Ultralytics", "url": "https://ultralytics.com/"}], "abstract": "Learn to implement K-Fold Cross Validation for object detection datasets using Ultralytics YOLO. Improve your model's reliability and robustness.", "mainEntity": [{"@type": "Question", "name": "What is K-Fold Cross Validation and why is it useful in object detection?", "acceptedAnswer": {"@type": "Answer", "text": "K-Fold Cross Validation is a technique where the dataset is divided into 'k' subsets (folds) to evaluate model performance more reliably. Each fold serves as both training and validation data. In the context of object detection, using K-Fold Cross Validation helps to ensure your Ultralytics YOLO model's performance is robust and generalizable across different data splits, enhancing its reliability. For detailed instructions on setting up K-Fold Cross Validation with Ultralytics YOLO, refer to K-Fold Cross Validation with Ultralytics."}}, {"@type": "Question", "name": "How do I implement K-Fold Cross Validation using Ultralytics YOLO?", "acceptedAnswer": {"@type": "Answer", "text": "To implement K-Fold Cross Validation with Ultralytics YOLO, you need to follow these steps: For a comprehensive guide, see the K-Fold Dataset Split section in our documentation."}}, {"@type": "Question", "name": "Why should I use Ultralytics YOLO for object detection?", "acceptedAnswer": {"@type": "Answer", "text": "Ultralytics YOLO offers state-of-the-art, real-time object detection with high accuracy and efficiency. It's versatile, supporting multiple computer vision tasks such as detection, segmentation, and classification. Additionally, it integrates seamlessly with tools like Ultralytics HUB for no-code model training and deployment. For more details, explore the benefits and features on our Ultralytics YOLO page."}}, {"@type": "Question", "name": "How can I ensure my annotations are in the correct format for Ultralytics YOLO?", "acceptedAnswer": {"@type": "Answer", "text": "Your annotations should follow the YOLO detection format. Each annotation file must list the object class, alongside its bounding box coordinates in the image. The YOLO format ensures streamlined and standardized data processing for training object detection models. For more information on proper annotation formatting, visit the YOLO detection format guide."}}, {"@type": "Question", "name": "Can I use K-Fold Cross Validation with custom datasets other than Fruit Detection?", "acceptedAnswer": {"@type": "Answer", "text": "Yes, you can use K-Fold Cross Validation with any custom dataset as long as the annotations are in the YOLO detection format. Replace the dataset paths and class labels with those specific to your custom dataset. This flexibility ensures that any object detection project can benefit from robust model evaluation using K-Fold Cross Validation. For a practical example, review our Generating Feature Vectors section."}}]}</script><body data-md-color-accent=indigo data-md-color-primary=indigo data-md-color-scheme=default dir=ltr><input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox><input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox><label class=md-overlay for=__drawer></label><div data-md-component=skip><a class=md-skip href=#k-fold-cross-validation-with-ultralytics> Skip to content </a></div><div data-md-component=announce><aside class=md-banner><div class="md-banner__inner md-grid md-typeset"><div class=banner-wrapper><div class=banner-content-wrapper><p>YOLO Vision 2024 is here!<div class=banner-info-wrapper><img alt="YOLO Vision 24"height=20 loading=lazy src=https://assets-global.website-files.com/646dd1f1a3703e451ba81ecc/66e9a87cfc78245ffa51d6f0_w_yv24.svg width=20><p>September 27, 2024</div><div class=banner-info-wrapper><img alt="YOLO Vision 24"height=20 loading=lazy src=https://assets-global.website-files.com/646dd1f1a3703e451ba81ecc/66e9a87cdfbd25e409560ed8_l_yv24.svg width=20><p>Free hybrid event</div></div><div class=banner-button-wrapper><div class="banner-button-wrapper large"><button onclick="window.open('https://www.ultralytics.com/events/yolovision', '_blank')">Register now</button></div></div></div></div></aside></div><header class="md-header md-header--shadow md-header--lifted"data-md-component=header><nav class="md-header__inner md-grid"aria-label=Header><a aria-label="Ultralytics YOLO Docs"class="md-header__button md-logo"title="Ultralytics YOLO Docs"data-md-component=logo href=../..> <img alt=logo src=https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg> </a><label class="md-header__button md-icon"for=__drawer><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> Ultralytics YOLO Docs </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> K-Fold Cross Validation </span></div></div></div><form class=md-header__option data-md-component=palette><input aria-label="Switch to light mode"class=md-option data-md-color-accent=indigo data-md-color-media=(prefers-color-scheme) data-md-color-primary=indigo data-md-color-scheme=default id=__palette_0 name=__palette type=radio><label class="md-header__button md-icon"title="Switch to light mode"for=__palette_1 hidden><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg></label><input aria-label="Switch to system preference"data-md-color-media="(prefers-color-scheme: dark)"class=md-option data-md-color-accent=indigo data-md-color-primary=black data-md-color-scheme=slate id=__palette_1 name=__palette type=radio><label class="md-header__button md-icon"title="Switch to system preference"for=__palette_2 hidden><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label><input aria-label="Switch to dark mode"data-md-color-media="(prefers-color-scheme: light)"class=md-option data-md-color-accent=indigo data-md-color-primary=indigo data-md-color-scheme=default id=__palette_2 name=__palette type=radio><label class="md-header__button md-icon"title="Switch to dark mode"for=__palette_0 hidden><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label></form><script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon"for=__search><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false><label class="md-search__icon md-icon"for=__search><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg></label><nav aria-label=Search class=md-search__options><a class="md-search__icon md-icon"aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share href=javascript:void(0) tabindex=-1 title=Share> <svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg> </a><button class="md-search__icon md-icon"aria-label=Clear tabindex=-1 title=Clear type=reset><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix tabindex=0><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>Initializing search</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a title="Go to repository"class=md-source data-md-component=source href=https://github.com/ultralytics/ultralytics> <div class="md-source__icon md-icon"><svg viewbox="0 0 496 512"xmlns=http://www.w3.org/2000/svg><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg></div> <div class=md-source__repository>ultralytics/ultralytics</div> </a></div></nav><nav aria-label=Tabs class=md-tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a class=md-tabs__link href=../..> Home </a><li class=md-tabs__item><a class=md-tabs__link href=../../quickstart/> Quickstart </a><li class=md-tabs__item><a class=md-tabs__link href=../../modes/> Modes </a><li class=md-tabs__item><a class=md-tabs__link href=../../tasks/> Tasks </a><li class=md-tabs__item><a class=md-tabs__link href=../../models/> Models </a><li class=md-tabs__item><a class=md-tabs__link href=../../datasets/> Datasets </a><li class=md-tabs__item><a class=md-tabs__link href=../../solutions/> Solutions 🚀 NEW </a><li class="md-tabs__item md-tabs__item--active"><a class=md-tabs__link href=../> Guides </a><li class=md-tabs__item><a class=md-tabs__link href=../../integrations/> Integrations </a><li class=md-tabs__item><a class=md-tabs__link href=../../hub/> HUB </a><li class=md-tabs__item><a class=md-tabs__link href=../../reference/cfg/__init__/> Reference </a><li class=md-tabs__item><a class=md-tabs__link href=../../help/> Help </a></ul></div></nav></header><div class=md-container data-md-component=container><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary"data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted"aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a aria-label="Ultralytics YOLO Docs"class="md-nav__button md-logo"title="Ultralytics YOLO Docs"data-md-component=logo href=../..> <img alt=logo src=https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg> </a> Ultralytics YOLO Docs</label><div class=md-nav__source><a title="Go to repository"class=md-source data-md-component=source href=https://github.com/ultralytics/ultralytics> <div class="md-source__icon md-icon"><svg viewbox="0 0 496 512"xmlns=http://www.w3.org/2000/svg><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg></div> <div class=md-source__repository>ultralytics/ultralytics</div> </a></div><ul class=md-nav__list data-md-scrollfix><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../..> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../quickstart/> <span class=md-ellipsis> Quickstart </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../modes/> <span class=md-ellipsis> Modes </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../tasks/> <span class=md-ellipsis> Tasks </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../models/> <span class=md-ellipsis> Models </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../datasets/> <span class=md-ellipsis> Datasets </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../solutions/> <span class=md-ellipsis> Solutions 🚀 NEW </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle"checked id=__nav_8 type=checkbox> <div class="md-nav__link md-nav__container"><a class=md-nav__link href=../> <span class=md-ellipsis> Guides </span> </a><label class=md-nav__link for=__nav_8 id=__nav_8_label><span class="md-nav__icon md-icon"></span></label></div> <nav aria-expanded=true aria-labelledby=__nav_8_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_8><span class="md-nav__icon md-icon"></span> Guides</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../yolo-common-issues/> <span class=md-ellipsis> YOLO Common Issues </span> </a><li class=md-nav__item><a class=md-nav__link href=../yolo-performance-metrics/> <span class=md-ellipsis> YOLO Performance Metrics </span> </a><li class=md-nav__item><a class=md-nav__link href=../yolo-thread-safe-inference/> <span class=md-ellipsis> YOLO Thread-Safe Inference </span> </a><li class=md-nav__item><a class=md-nav__link href=../model-deployment-options/> <span class=md-ellipsis> Model Deployment Options </span> </a><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle"id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active"for=__toc><span class=md-ellipsis> K-Fold Cross Validation </span> <span class="md-nav__icon md-icon"></span></label> <a class="md-nav__link md-nav__link--active"href=./> <span class=md-ellipsis> K-Fold Cross Validation </span> </a> <nav aria-label="Table of contents"class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#introduction> <span class=md-ellipsis> Introduction </span> </a><li class=md-nav__item><a class=md-nav__link href=#setup> <span class=md-ellipsis> Setup </span> </a><li class=md-nav__item><a class=md-nav__link href=#generating-feature-vectors-for-object-detection-dataset> <span class=md-ellipsis> Generating Feature Vectors for Object Detection Dataset </span> </a><li class=md-nav__item><a class=md-nav__link href=#k-fold-dataset-split> <span class=md-ellipsis> K-Fold Dataset Split </span> </a><li class=md-nav__item><a class=md-nav__link href=#save-records-optional> <span class=md-ellipsis> Save Records (Optional) </span> </a><li class=md-nav__item><a class=md-nav__link href=#train-yolo-using-k-fold-data-splits> <span class=md-ellipsis> Train YOLO using K-Fold Data Splits </span> </a><li class=md-nav__item><a class=md-nav__link href=#conclusion> <span class=md-ellipsis> Conclusion </span> </a><li class=md-nav__item><a class=md-nav__link href=#faq> <span class=md-ellipsis> FAQ </span> </a> <nav aria-label=FAQ class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#what-is-k-fold-cross-validation-and-why-is-it-useful-in-object-detection> <span class=md-ellipsis> What is K-Fold Cross Validation and why is it useful in object detection? </span> </a><li class=md-nav__item><a class=md-nav__link href=#how-do-i-implement-k-fold-cross-validation-using-ultralytics-yolo> <span class=md-ellipsis> How do I implement K-Fold Cross Validation using Ultralytics YOLO? </span> </a><li class=md-nav__item><a class=md-nav__link href=#why-should-i-use-ultralytics-yolo-for-object-detection> <span class=md-ellipsis> Why should I use Ultralytics YOLO for object detection? </span> </a><li class=md-nav__item><a class=md-nav__link href=#how-can-i-ensure-my-annotations-are-in-the-correct-format-for-ultralytics-yolo> <span class=md-ellipsis> How can I ensure my annotations are in the correct format for Ultralytics YOLO? </span> </a><li class=md-nav__item><a class=md-nav__link href=#can-i-use-k-fold-cross-validation-with-custom-datasets-other-than-fruit-detection> <span class=md-ellipsis> Can I use K-Fold Cross Validation with custom datasets other than Fruit Detection? </span> </a></ul></nav></ul></nav><li class=md-nav__item><a class=md-nav__link href=../hyperparameter-tuning/> <span class=md-ellipsis> Hyperparameter Tuning </span> </a><li class=md-nav__item><a class=md-nav__link href=../sahi-tiled-inference/> <span class=md-ellipsis> SAHI Tiled Inference </span> </a><li class=md-nav__item><a class=md-nav__link href=../azureml-quickstart/> <span class=md-ellipsis> AzureML Quickstart </span> </a><li class=md-nav__item><a class=md-nav__link href=../conda-quickstart/> <span class=md-ellipsis> Conda Quickstart </span> </a><li class=md-nav__item><a class=md-nav__link href=../docker-quickstart/> <span class=md-ellipsis> Docker Quickstart </span> </a><li class=md-nav__item><a class=md-nav__link href=../raspberry-pi/> <span class=md-ellipsis> Raspberry Pi </span> </a><li class=md-nav__item><a class=md-nav__link href=../nvidia-jetson/> <span class=md-ellipsis> NVIDIA Jetson </span> </a><li class=md-nav__item><a class=md-nav__link href=../deepstream-nvidia-jetson/> <span class=md-ellipsis> DeepStream on NVIDIA Jetson </span> </a><li class=md-nav__item><a class=md-nav__link href=../triton-inference-server/> <span class=md-ellipsis> Triton Inference Server </span> </a><li class=md-nav__item><a class=md-nav__link href=../isolating-segmentation-objects/> <span class=md-ellipsis> Isolating Segmentation Objects </span> </a><li class=md-nav__item><a class=md-nav__link href=../coral-edge-tpu-on-raspberry-pi/> <span class=md-ellipsis> Edge TPU on Raspberry Pi </span> </a><li class=md-nav__item><a class=md-nav__link href=../view-results-in-terminal/> <span class=md-ellipsis> Viewing Inference Images in a Terminal </span> </a><li class=md-nav__item><a class=md-nav__link href=../optimizing-openvino-latency-vs-throughput-modes/> <span class=md-ellipsis> OpenVINO Latency vs Throughput modes </span> </a><li class=md-nav__item><a class=md-nav__link href=../ros-quickstart/> <span class=md-ellipsis> ROS Quickstart </span> </a><li class=md-nav__item><a class=md-nav__link href=../steps-of-a-cv-project/> <span class=md-ellipsis> Steps of a Computer Vision Project </span> </a><li class=md-nav__item><a class=md-nav__link href=../defining-project-goals/> <span class=md-ellipsis> Defining A Computer Vision Project's Goals </span> </a><li class=md-nav__item><a class=md-nav__link href=../data-collection-and-annotation/> <span class=md-ellipsis> Data Collection and Annotation </span> </a><li class=md-nav__item><a class=md-nav__link href=../preprocessing_annotated_data/> <span class=md-ellipsis> Preprocessing Annotated Data </span> </a><li class=md-nav__item><a class=md-nav__link href=../model-training-tips/> <span class=md-ellipsis> Tips for Model Training </span> </a><li class=md-nav__item><a class=md-nav__link href=../model-evaluation-insights/> <span class=md-ellipsis> Insights on Model Evaluation and Fine-Tuning </span> </a><li class=md-nav__item><a class=md-nav__link href=../model-testing/> <span class=md-ellipsis> A Guide on Model Testing </span> </a><li class=md-nav__item><a class=md-nav__link href=../model-deployment-practices/> <span class=md-ellipsis> Best Practices for Model Deployment </span> </a><li class=md-nav__item><a class=md-nav__link href=../model-monitoring-and-maintenance/> <span class=md-ellipsis> Maintaining Your Computer Vision Model </span> </a><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_8_30 type=checkbox> <div class="md-nav__link md-nav__container"><a class=md-nav__link href=../../datasets/explorer/> <span class=md-ellipsis> Explorer </span> </a><label class=md-nav__link for=__nav_8_30 id=__nav_8_30_label><span class="md-nav__icon md-icon"></span></label></div> <nav aria-expanded=false aria-labelledby=__nav_8_30_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_8_30><span class="md-nav__icon md-icon"></span> Explorer</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../datasets/explorer/api/> <span class=md-ellipsis> Explorer API </span> </a><li class=md-nav__item><a class=md-nav__link href=../../datasets/explorer/dashboard/> <span class=md-ellipsis> Explorer Dashboard Demo </span> </a><li class=md-nav__item><a class=md-nav__link href=../../datasets/explorer/explorer/> <span class=md-ellipsis> VOC Exploration Example </span> </a></ul></nav><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_8_31 type=checkbox> <div class="md-nav__link md-nav__container"><a class=md-nav__link href=../../yolov5/> <span class=md-ellipsis> YOLOv5 </span> </a><label class=md-nav__link for=__nav_8_31 id=__nav_8_31_label><span class="md-nav__icon md-icon"></span></label></div> <nav aria-expanded=false aria-labelledby=__nav_8_31_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_8_31><span class="md-nav__icon md-icon"></span> YOLOv5</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../yolov5/quickstart_tutorial/> <span class=md-ellipsis> Quickstart </span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../yolov5/environments/aws_quickstart_tutorial/> <span class=md-ellipsis> Environments </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../yolov5/tutorials/train_custom_data/> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </a></ul></nav></ul></nav><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../integrations/> <span class=md-ellipsis> Integrations </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../hub/> <span class=md-ellipsis> HUB </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../reference/cfg/__init__/> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../help/> <span class=md-ellipsis> Help </span> <span class="md-nav__icon md-icon"></span> </a></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary"data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav aria-label="Table of contents"class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#introduction> <span class=md-ellipsis> Introduction </span> </a><li class=md-nav__item><a class=md-nav__link href=#setup> <span class=md-ellipsis> Setup </span> </a><li class=md-nav__item><a class=md-nav__link href=#generating-feature-vectors-for-object-detection-dataset> <span class=md-ellipsis> Generating Feature Vectors for Object Detection Dataset </span> </a><li class=md-nav__item><a class=md-nav__link href=#k-fold-dataset-split> <span class=md-ellipsis> K-Fold Dataset Split </span> </a><li class=md-nav__item><a class=md-nav__link href=#save-records-optional> <span class=md-ellipsis> Save Records (Optional) </span> </a><li class=md-nav__item><a class=md-nav__link href=#train-yolo-using-k-fold-data-splits> <span class=md-ellipsis> Train YOLO using K-Fold Data Splits </span> </a><li class=md-nav__item><a class=md-nav__link href=#conclusion> <span class=md-ellipsis> Conclusion </span> </a><li class=md-nav__item><a class=md-nav__link href=#faq> <span class=md-ellipsis> FAQ </span> </a> <nav aria-label=FAQ class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#what-is-k-fold-cross-validation-and-why-is-it-useful-in-object-detection> <span class=md-ellipsis> What is K-Fold Cross Validation and why is it useful in object detection? </span> </a><li class=md-nav__item><a class=md-nav__link href=#how-do-i-implement-k-fold-cross-validation-using-ultralytics-yolo> <span class=md-ellipsis> How do I implement K-Fold Cross Validation using Ultralytics YOLO? </span> </a><li class=md-nav__item><a class=md-nav__link href=#why-should-i-use-ultralytics-yolo-for-object-detection> <span class=md-ellipsis> Why should I use Ultralytics YOLO for object detection? </span> </a><li class=md-nav__item><a class=md-nav__link href=#how-can-i-ensure-my-annotations-are-in-the-correct-format-for-ultralytics-yolo> <span class=md-ellipsis> How can I ensure my annotations are in the correct format for Ultralytics YOLO? </span> </a><li class=md-nav__item><a class=md-nav__link href=#can-i-use-k-fold-cross-validation-with-custom-datasets-other-than-fruit-detection> <span class=md-ellipsis> Can I use K-Fold Cross Validation with custom datasets other than Fruit Detection? </span> </a></ul></nav></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><a class="md-content__button md-icon"title="Edit this page"href=https://github.com/ultralytics/ultralytics/tree/main/docs/en/guides/kfold-cross-validation.md> <svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg> </a><h1 id=k-fold-cross-validation-with-ultralytics>K-Fold Cross Validation with Ultralytics</h1><h2 id=introduction>Introduction</h2><p>This comprehensive guide illustrates the implementation of K-Fold Cross Validation for <a href=https://www.ultralytics.com/glossary/object-detection>object detection</a> datasets within the Ultralytics ecosystem. We'll leverage the YOLO detection format and key Python libraries such as sklearn, pandas, and PyYaml to guide you through the necessary setup, the process of generating feature vectors, and the execution of a K-Fold dataset split.<p align=center><img alt="K-Fold Cross Validation Overview"src=https://github.com/ultralytics/docs/releases/download/0/k-fold-cross-validation-overview.avif width=800><p>Whether your project involves the Fruit Detection dataset or a custom data source, this tutorial aims to help you comprehend and apply K-Fold Cross Validation to bolster the reliability and robustness of your <a href=https://www.ultralytics.com/glossary/machine-learning-ml>machine learning</a> models. While we're applying <code>k=5</code> folds for this tutorial, keep in mind that the optimal number of folds can vary depending on your dataset and the specifics of your project.<p>Without further ado, let's dive in!<h2 id=setup>Setup</h2><ul><li><p>Your annotations should be in the <a href=../../datasets/detect/>YOLO detection format</a>.</p><li><p>This guide assumes that annotation files are locally available.</p><li><p>For our demonstration, we use the <a href=https://www.kaggle.com/datasets/lakshaytyagi01/fruit-detection/code>Fruit Detection</a> dataset.</p> <ul><li>This dataset contains a total of 8479 images.<li>It includes 6 class labels, each with its total instance counts listed below.</ul></ul><table><thead><tr><th style="text-align: left;">Class Label<th style="text-align: center;">Instance Count<tbody><tr><td style="text-align: left;">Apple<td style="text-align: center;">7049<tr><td style="text-align: left;">Grapes<td style="text-align: center;">7202<tr><td style="text-align: left;">Pineapple<td style="text-align: center;">1613<tr><td style="text-align: left;">Orange<td style="text-align: center;">15549<tr><td style="text-align: left;">Banana<td style="text-align: center;">3536<tr><td style="text-align: left;">Watermelon<td style="text-align: center;">1976</table><ul><li><p>Necessary Python packages include:</p> <ul><li><code>ultralytics</code><li><code>sklearn</code><li><code>pandas</code><li><code>pyyaml</code></ul><li><p>This tutorial operates with <code>k=5</code> folds. However, you should determine the best number of folds for your specific dataset.</p><li><p>Initiate a new Python virtual environment (<code>venv</code>) for your project and activate it. Use <code>pip</code> (or your preferred package manager) to install:</p> <ul><li>The Ultralytics library: <code>pip install -U ultralytics</code>. Alternatively, you can clone the official <a href=https://github.com/ultralytics/ultralytics>repo</a>.<li>Scikit-learn, pandas, and PyYAML: <code>pip install -U scikit-learn pandas pyyaml</code>.</ul><li><p>Verify that your annotations are in the <a href=../../datasets/detect/>YOLO detection format</a>.</p> <ul><li>For this tutorial, all annotation files are found in the <code>Fruit-Detection/labels</code> directory.</ul></ul><h2 id=generating-feature-vectors-for-object-detection-dataset>Generating Feature Vectors for Object Detection Dataset</h2><ol><li><p>Start by creating a new <code>example.py</code> Python file for the steps below.</p><li><p>Proceed to retrieve all label files for your dataset.</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=kn>from</span> <span class=nn>pathlib</span> <span class=kn>import</span> <span class=n>Path</span>
<a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>
<a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=n>dataset_path</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=s2>"./Fruit-detection"</span><span class=p>)</span>  <span class=c1># replace with 'path/to/dataset' for your custom data</span>
<a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=n>labels</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>dataset_path</span><span class=o>.</span><span class=n>rglob</span><span class=p>(</span><span class=s2>"*labels/*.txt"</span><span class=p>))</span>  <span class=c1># all data in 'labels'</span>
</code></pre></div><li><p>Now, read the contents of the dataset YAML file and extract the indices of the class labels.</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-1-1 id=__codelineno-1-1 name=__codelineno-1-1></a><span class=n>yaml_file</span> <span class=o>=</span> <span class=s2>"path/to/data.yaml"</span>  <span class=c1># your data YAML with data directories and names dictionary</span>
<a href=#__codelineno-1-2 id=__codelineno-1-2 name=__codelineno-1-2></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>yaml_file</span><span class=p>,</span> <span class=s2>"r"</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>"utf8"</span><span class=p>)</span> <span class=k>as</span> <span class=n>y</span><span class=p>:</span>
<a href=#__codelineno-1-3 id=__codelineno-1-3 name=__codelineno-1-3></a>    <span class=n>classes</span> <span class=o>=</span> <span class=n>yaml</span><span class=o>.</span><span class=n>safe_load</span><span class=p>(</span><span class=n>y</span><span class=p>)[</span><span class=s2>"names"</span><span class=p>]</span>
<a href=#__codelineno-1-4 id=__codelineno-1-4 name=__codelineno-1-4></a><span class=n>cls_idx</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>classes</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</code></pre></div><li><p>Initialize an empty <code>pandas</code> DataFrame.</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-2-1 id=__codelineno-2-1 name=__codelineno-2-1></a><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
<a href=#__codelineno-2-2 id=__codelineno-2-2 name=__codelineno-2-2></a>
<a href=#__codelineno-2-3 id=__codelineno-2-3 name=__codelineno-2-3></a><span class=n>indx</span> <span class=o>=</span> <span class=p>[</span><span class=n>label</span><span class=o>.</span><span class=n>stem</span> <span class=k>for</span> <span class=n>label</span> <span class=ow>in</span> <span class=n>labels</span><span class=p>]</span>  <span class=c1># uses base filename as ID (no extension)</span>
<a href=#__codelineno-2-4 id=__codelineno-2-4 name=__codelineno-2-4></a><span class=n>labels_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([],</span> <span class=n>columns</span><span class=o>=</span><span class=n>cls_idx</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=n>indx</span><span class=p>)</span>
</code></pre></div><li><p>Count the instances of each class-label present in the annotation files.</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-3-1 id=__codelineno-3-1 name=__codelineno-3-1></a><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>Counter</span>
<a href=#__codelineno-3-2 id=__codelineno-3-2 name=__codelineno-3-2></a>
<a href=#__codelineno-3-3 id=__codelineno-3-3 name=__codelineno-3-3></a><span class=k>for</span> <span class=n>label</span> <span class=ow>in</span> <span class=n>labels</span><span class=p>:</span>
<a href=#__codelineno-3-4 id=__codelineno-3-4 name=__codelineno-3-4></a>    <span class=n>lbl_counter</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>()</span>
<a href=#__codelineno-3-5 id=__codelineno-3-5 name=__codelineno-3-5></a>
<a href=#__codelineno-3-6 id=__codelineno-3-6 name=__codelineno-3-6></a>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=s2>"r"</span><span class=p>)</span> <span class=k>as</span> <span class=n>lf</span><span class=p>:</span>
<a href=#__codelineno-3-7 id=__codelineno-3-7 name=__codelineno-3-7></a>        <span class=n>lines</span> <span class=o>=</span> <span class=n>lf</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
<a href=#__codelineno-3-8 id=__codelineno-3-8 name=__codelineno-3-8></a>
<a href=#__codelineno-3-9 id=__codelineno-3-9 name=__codelineno-3-9></a>    <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>lines</span><span class=p>:</span>
<a href=#__codelineno-3-10 id=__codelineno-3-10 name=__codelineno-3-10></a>        <span class=c1># classes for YOLO label uses integer at first position of each line</span>
<a href=#__codelineno-3-11 id=__codelineno-3-11 name=__codelineno-3-11></a>        <span class=n>lbl_counter</span><span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>line</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>" "</span><span class=p>)[</span><span class=mi>0</span><span class=p>])]</span> <span class=o>+=</span> <span class=mi>1</span>
<a href=#__codelineno-3-12 id=__codelineno-3-12 name=__codelineno-3-12></a>
<a href=#__codelineno-3-13 id=__codelineno-3-13 name=__codelineno-3-13></a>    <span class=n>labels_df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>label</span><span class=o>.</span><span class=n>stem</span><span class=p>]</span> <span class=o>=</span> <span class=n>lbl_counter</span>
<a href=#__codelineno-3-14 id=__codelineno-3-14 name=__codelineno-3-14></a>
<a href=#__codelineno-3-15 id=__codelineno-3-15 name=__codelineno-3-15></a><span class=n>labels_df</span> <span class=o>=</span> <span class=n>labels_df</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=mf>0.0</span><span class=p>)</span>  <span class=c1># replace `nan` values with `0.0`</span>
</code></pre></div><li><p>The following is a sample view of the populated DataFrame:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-4-1 id=__codelineno-4-1 name=__codelineno-4-1></a>                                                       0    1    2    3    4    5
<a href=#__codelineno-4-2 id=__codelineno-4-2 name=__codelineno-4-2></a>'0000a16e4b057580_jpg.rf.00ab48988370f64f5ca8ea4...'  0.0  0.0  0.0  0.0  0.0  7.0
<a href=#__codelineno-4-3 id=__codelineno-4-3 name=__codelineno-4-3></a>'0000a16e4b057580_jpg.rf.7e6dce029fb67f01eb19aa7...'  0.0  0.0  0.0  0.0  0.0  7.0
<a href=#__codelineno-4-4 id=__codelineno-4-4 name=__codelineno-4-4></a>'0000a16e4b057580_jpg.rf.bc4d31cdcbe229dd022957a...'  0.0  0.0  0.0  0.0  0.0  7.0
<a href=#__codelineno-4-5 id=__codelineno-4-5 name=__codelineno-4-5></a>'00020ebf74c4881c_jpg.rf.508192a0a97aa6c4a3b6882...'  0.0  0.0  0.0  1.0  0.0  0.0
<a href=#__codelineno-4-6 id=__codelineno-4-6 name=__codelineno-4-6></a>'00020ebf74c4881c_jpg.rf.5af192a2254c8ecc4188a25...'  0.0  0.0  0.0  1.0  0.0  0.0
<a href=#__codelineno-4-7 id=__codelineno-4-7 name=__codelineno-4-7></a> ...                                                  ...  ...  ...  ...  ...  ...
<a href=#__codelineno-4-8 id=__codelineno-4-8 name=__codelineno-4-8></a>'ff4cd45896de38be_jpg.rf.c4b5e967ca10c7ced3b9e97...'  0.0  0.0  0.0  0.0  0.0  2.0
<a href=#__codelineno-4-9 id=__codelineno-4-9 name=__codelineno-4-9></a>'ff4cd45896de38be_jpg.rf.ea4c1d37d2884b3e3cbce08...'  0.0  0.0  0.0  0.0  0.0  2.0
<a href=#__codelineno-4-10 id=__codelineno-4-10 name=__codelineno-4-10></a>'ff5fd9c3c624b7dc_jpg.rf.bb519feaa36fc4bf630a033...'  1.0  0.0  0.0  0.0  0.0  0.0
<a href=#__codelineno-4-11 id=__codelineno-4-11 name=__codelineno-4-11></a>'ff5fd9c3c624b7dc_jpg.rf.f0751c9c3aa4519ea3c9d6a...'  1.0  0.0  0.0  0.0  0.0  0.0
<a href=#__codelineno-4-12 id=__codelineno-4-12 name=__codelineno-4-12></a>'fffe28b31f2a70d4_jpg.rf.7ea16bd637ba0711c53b540...'  0.0  6.0  0.0  0.0  0.0  0.0
</code></pre></div></ol><p>The rows index the label files, each corresponding to an image in your dataset, and the columns correspond to your class-label indices. Each row represents a pseudo feature-vector, with the count of each class-label present in your dataset. This data structure enables the application of K-Fold Cross Validation to an object detection dataset.<h2 id=k-fold-dataset-split>K-Fold Dataset Split</h2><ol><li><p>Now we will use the <code>KFold</code> class from <code>sklearn.model_selection</code> to generate <code>k</code> splits of the dataset.</p> <ul><li>Important:<ul><li>Setting <code>shuffle=True</code> ensures a randomized distribution of classes in your splits.<li>By setting <code>random_state=M</code> where <code>M</code> is a chosen integer, you can obtain repeatable results.</ul></ul> <div class=highlight><pre><span></span><code><a href=#__codelineno-5-1 id=__codelineno-5-1 name=__codelineno-5-1></a><span class=kn>from</span> <span class=nn>sklearn.model_selection</span> <span class=kn>import</span> <span class=n>KFold</span>
<a href=#__codelineno-5-2 id=__codelineno-5-2 name=__codelineno-5-2></a>
<a href=#__codelineno-5-3 id=__codelineno-5-3 name=__codelineno-5-3></a><span class=n>ksplit</span> <span class=o>=</span> <span class=mi>5</span>
<a href=#__codelineno-5-4 id=__codelineno-5-4 name=__codelineno-5-4></a><span class=n>kf</span> <span class=o>=</span> <span class=n>KFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=n>ksplit</span><span class=p>,</span> <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>  <span class=c1># setting random_state for repeatable results</span>
<a href=#__codelineno-5-5 id=__codelineno-5-5 name=__codelineno-5-5></a>
<a href=#__codelineno-5-6 id=__codelineno-5-6 name=__codelineno-5-6></a><span class=n>kfolds</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>kf</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>labels_df</span><span class=p>))</span>
</code></pre></div><li><p>The dataset has now been split into <code>k</code> folds, each having a list of <code>train</code> and <code>val</code> indices. We will construct a DataFrame to display these results more clearly.</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-6-1 id=__codelineno-6-1 name=__codelineno-6-1></a><span class=n>folds</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>"split_</span><span class=si>{</span><span class=n>n</span><span class=si>}</span><span class=s2>"</span> <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>ksplit</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)]</span>
<a href=#__codelineno-6-2 id=__codelineno-6-2 name=__codelineno-6-2></a><span class=n>folds_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=n>indx</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=n>folds</span><span class=p>)</span>
<a href=#__codelineno-6-3 id=__codelineno-6-3 name=__codelineno-6-3></a>
<a href=#__codelineno-6-4 id=__codelineno-6-4 name=__codelineno-6-4></a><span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=p>(</span><span class=n>train</span><span class=p>,</span> <span class=n>val</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>kfolds</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>):</span>
<a href=#__codelineno-6-5 id=__codelineno-6-5 name=__codelineno-6-5></a>    <span class=n>folds_df</span><span class=p>[</span><span class=sa>f</span><span class=s2>"split_</span><span class=si>{</span><span class=n>idx</span><span class=si>}</span><span class=s2>"</span><span class=p>]</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>labels_df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>train</span><span class=p>]</span><span class=o>.</span><span class=n>index</span><span class=p>]</span> <span class=o>=</span> <span class=s2>"train"</span>
<a href=#__codelineno-6-6 id=__codelineno-6-6 name=__codelineno-6-6></a>    <span class=n>folds_df</span><span class=p>[</span><span class=sa>f</span><span class=s2>"split_</span><span class=si>{</span><span class=n>idx</span><span class=si>}</span><span class=s2>"</span><span class=p>]</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>labels_df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>val</span><span class=p>]</span><span class=o>.</span><span class=n>index</span><span class=p>]</span> <span class=o>=</span> <span class=s2>"val"</span>
</code></pre></div><li><p>Now we will calculate the distribution of class labels for each fold as a ratio of the classes present in <code>val</code> to those present in <code>train</code>.</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-7-1 id=__codelineno-7-1 name=__codelineno-7-1></a><span class=n>fold_lbl_distrb</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=n>folds</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=n>cls_idx</span><span class=p>)</span>
<a href=#__codelineno-7-2 id=__codelineno-7-2 name=__codelineno-7-2></a>
<a href=#__codelineno-7-3 id=__codelineno-7-3 name=__codelineno-7-3></a><span class=k>for</span> <span class=n>n</span><span class=p>,</span> <span class=p>(</span><span class=n>train_indices</span><span class=p>,</span> <span class=n>val_indices</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>kfolds</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=mi>1</span><span class=p>):</span>
<a href=#__codelineno-7-4 id=__codelineno-7-4 name=__codelineno-7-4></a>    <span class=n>train_totals</span> <span class=o>=</span> <span class=n>labels_df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>train_indices</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<a href=#__codelineno-7-5 id=__codelineno-7-5 name=__codelineno-7-5></a>    <span class=n>val_totals</span> <span class=o>=</span> <span class=n>labels_df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>val_indices</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<a href=#__codelineno-7-6 id=__codelineno-7-6 name=__codelineno-7-6></a>
<a href=#__codelineno-7-7 id=__codelineno-7-7 name=__codelineno-7-7></a>    <span class=c1># To avoid division by zero, we add a small value (1E-7) to the denominator</span>
<a href=#__codelineno-7-8 id=__codelineno-7-8 name=__codelineno-7-8></a>    <span class=n>ratio</span> <span class=o>=</span> <span class=n>val_totals</span> <span class=o>/</span> <span class=p>(</span><span class=n>train_totals</span> <span class=o>+</span> <span class=mf>1e-7</span><span class=p>)</span>
<a href=#__codelineno-7-9 id=__codelineno-7-9 name=__codelineno-7-9></a>    <span class=n>fold_lbl_distrb</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=sa>f</span><span class=s2>"split_</span><span class=si>{</span><span class=n>n</span><span class=si>}</span><span class=s2>"</span><span class=p>]</span> <span class=o>=</span> <span class=n>ratio</span>
</code></pre></div> <p>The ideal scenario is for all class ratios to be reasonably similar for each split and across classes. This, however, will be subject to the specifics of your dataset.</p><li><p>Next, we create the directories and dataset YAML files for each split.</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-8-1 id=__codelineno-8-1 name=__codelineno-8-1></a><span class=kn>import</span> <span class=nn>datetime</span>
<a href=#__codelineno-8-2 id=__codelineno-8-2 name=__codelineno-8-2></a>
<a href=#__codelineno-8-3 id=__codelineno-8-3 name=__codelineno-8-3></a><span class=n>supported_extensions</span> <span class=o>=</span> <span class=p>[</span><span class=s2>".jpg"</span><span class=p>,</span> <span class=s2>".jpeg"</span><span class=p>,</span> <span class=s2>".png"</span><span class=p>]</span>
<a href=#__codelineno-8-4 id=__codelineno-8-4 name=__codelineno-8-4></a>
<a href=#__codelineno-8-5 id=__codelineno-8-5 name=__codelineno-8-5></a><span class=c1># Initialize an empty list to store image file paths</span>
<a href=#__codelineno-8-6 id=__codelineno-8-6 name=__codelineno-8-6></a><span class=n>images</span> <span class=o>=</span> <span class=p>[]</span>
<a href=#__codelineno-8-7 id=__codelineno-8-7 name=__codelineno-8-7></a>
<a href=#__codelineno-8-8 id=__codelineno-8-8 name=__codelineno-8-8></a><span class=c1># Loop through supported extensions and gather image files</span>
<a href=#__codelineno-8-9 id=__codelineno-8-9 name=__codelineno-8-9></a><span class=k>for</span> <span class=n>ext</span> <span class=ow>in</span> <span class=n>supported_extensions</span><span class=p>:</span>
<a href=#__codelineno-8-10 id=__codelineno-8-10 name=__codelineno-8-10></a>    <span class=n>images</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=nb>sorted</span><span class=p>((</span><span class=n>dataset_path</span> <span class=o>/</span> <span class=s2>"images"</span><span class=p>)</span><span class=o>.</span><span class=n>rglob</span><span class=p>(</span><span class=sa>f</span><span class=s2>"*</span><span class=si>{</span><span class=n>ext</span><span class=si>}</span><span class=s2>"</span><span class=p>)))</span>
<a href=#__codelineno-8-11 id=__codelineno-8-11 name=__codelineno-8-11></a>
<a href=#__codelineno-8-12 id=__codelineno-8-12 name=__codelineno-8-12></a><span class=c1># Create the necessary directories and dataset YAML files (unchanged)</span>
<a href=#__codelineno-8-13 id=__codelineno-8-13 name=__codelineno-8-13></a><span class=n>save_path</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>dataset_path</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>datetime</span><span class=o>.</span><span class=n>date</span><span class=o>.</span><span class=n>today</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>ksplit</span><span class=si>}</span><span class=s2>-Fold_Cross-val"</span><span class=p>)</span>
<a href=#__codelineno-8-14 id=__codelineno-8-14 name=__codelineno-8-14></a><span class=n>save_path</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>parents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a href=#__codelineno-8-15 id=__codelineno-8-15 name=__codelineno-8-15></a><span class=n>ds_yamls</span> <span class=o>=</span> <span class=p>[]</span>
<a href=#__codelineno-8-16 id=__codelineno-8-16 name=__codelineno-8-16></a>
<a href=#__codelineno-8-17 id=__codelineno-8-17 name=__codelineno-8-17></a><span class=k>for</span> <span class=n>split</span> <span class=ow>in</span> <span class=n>folds_df</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
<a href=#__codelineno-8-18 id=__codelineno-8-18 name=__codelineno-8-18></a>    <span class=c1># Create directories</span>
<a href=#__codelineno-8-19 id=__codelineno-8-19 name=__codelineno-8-19></a>    <span class=n>split_dir</span> <span class=o>=</span> <span class=n>save_path</span> <span class=o>/</span> <span class=n>split</span>
<a href=#__codelineno-8-20 id=__codelineno-8-20 name=__codelineno-8-20></a>    <span class=n>split_dir</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>parents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a href=#__codelineno-8-21 id=__codelineno-8-21 name=__codelineno-8-21></a>    <span class=p>(</span><span class=n>split_dir</span> <span class=o>/</span> <span class=s2>"train"</span> <span class=o>/</span> <span class=s2>"images"</span><span class=p>)</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>parents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a href=#__codelineno-8-22 id=__codelineno-8-22 name=__codelineno-8-22></a>    <span class=p>(</span><span class=n>split_dir</span> <span class=o>/</span> <span class=s2>"train"</span> <span class=o>/</span> <span class=s2>"labels"</span><span class=p>)</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>parents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a href=#__codelineno-8-23 id=__codelineno-8-23 name=__codelineno-8-23></a>    <span class=p>(</span><span class=n>split_dir</span> <span class=o>/</span> <span class=s2>"val"</span> <span class=o>/</span> <span class=s2>"images"</span><span class=p>)</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>parents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a href=#__codelineno-8-24 id=__codelineno-8-24 name=__codelineno-8-24></a>    <span class=p>(</span><span class=n>split_dir</span> <span class=o>/</span> <span class=s2>"val"</span> <span class=o>/</span> <span class=s2>"labels"</span><span class=p>)</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>parents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a href=#__codelineno-8-25 id=__codelineno-8-25 name=__codelineno-8-25></a>
<a href=#__codelineno-8-26 id=__codelineno-8-26 name=__codelineno-8-26></a>    <span class=c1># Create dataset YAML files</span>
<a href=#__codelineno-8-27 id=__codelineno-8-27 name=__codelineno-8-27></a>    <span class=n>dataset_yaml</span> <span class=o>=</span> <span class=n>split_dir</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>split</span><span class=si>}</span><span class=s2>_dataset.yaml"</span>
<a href=#__codelineno-8-28 id=__codelineno-8-28 name=__codelineno-8-28></a>    <span class=n>ds_yamls</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>dataset_yaml</span><span class=p>)</span>
<a href=#__codelineno-8-29 id=__codelineno-8-29 name=__codelineno-8-29></a>
<a href=#__codelineno-8-30 id=__codelineno-8-30 name=__codelineno-8-30></a>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>dataset_yaml</span><span class=p>,</span> <span class=s2>"w"</span><span class=p>)</span> <span class=k>as</span> <span class=n>ds_y</span><span class=p>:</span>
<a href=#__codelineno-8-31 id=__codelineno-8-31 name=__codelineno-8-31></a>        <span class=n>yaml</span><span class=o>.</span><span class=n>safe_dump</span><span class=p>(</span>
<a href=#__codelineno-8-32 id=__codelineno-8-32 name=__codelineno-8-32></a>            <span class=p>{</span>
<a href=#__codelineno-8-33 id=__codelineno-8-33 name=__codelineno-8-33></a>                <span class=s2>"path"</span><span class=p>:</span> <span class=n>split_dir</span><span class=o>.</span><span class=n>as_posix</span><span class=p>(),</span>
<a href=#__codelineno-8-34 id=__codelineno-8-34 name=__codelineno-8-34></a>                <span class=s2>"train"</span><span class=p>:</span> <span class=s2>"train"</span><span class=p>,</span>
<a href=#__codelineno-8-35 id=__codelineno-8-35 name=__codelineno-8-35></a>                <span class=s2>"val"</span><span class=p>:</span> <span class=s2>"val"</span><span class=p>,</span>
<a href=#__codelineno-8-36 id=__codelineno-8-36 name=__codelineno-8-36></a>                <span class=s2>"names"</span><span class=p>:</span> <span class=n>classes</span><span class=p>,</span>
<a href=#__codelineno-8-37 id=__codelineno-8-37 name=__codelineno-8-37></a>            <span class=p>},</span>
<a href=#__codelineno-8-38 id=__codelineno-8-38 name=__codelineno-8-38></a>            <span class=n>ds_y</span><span class=p>,</span>
<a href=#__codelineno-8-39 id=__codelineno-8-39 name=__codelineno-8-39></a>        <span class=p>)</span>
</code></pre></div><li><p>Lastly, copy images and labels into the respective directory ('train' or 'val') for each split.</p> <ul><li><strong>NOTE:</strong> The time required for this portion of the code will vary based on the size of your dataset and your system hardware.</ul> <div class=highlight><pre><span></span><code><a href=#__codelineno-9-1 id=__codelineno-9-1 name=__codelineno-9-1></a><span class=kn>import</span> <span class=nn>shutil</span>
<a href=#__codelineno-9-2 id=__codelineno-9-2 name=__codelineno-9-2></a>
<a href=#__codelineno-9-3 id=__codelineno-9-3 name=__codelineno-9-3></a><span class=k>for</span> <span class=n>image</span><span class=p>,</span> <span class=n>label</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>images</span><span class=p>,</span> <span class=n>labels</span><span class=p>):</span>
<a href=#__codelineno-9-4 id=__codelineno-9-4 name=__codelineno-9-4></a>    <span class=k>for</span> <span class=n>split</span><span class=p>,</span> <span class=n>k_split</span> <span class=ow>in</span> <span class=n>folds_df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>image</span><span class=o>.</span><span class=n>stem</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a href=#__codelineno-9-5 id=__codelineno-9-5 name=__codelineno-9-5></a>        <span class=c1># Destination directory</span>
<a href=#__codelineno-9-6 id=__codelineno-9-6 name=__codelineno-9-6></a>        <span class=n>img_to_path</span> <span class=o>=</span> <span class=n>save_path</span> <span class=o>/</span> <span class=n>split</span> <span class=o>/</span> <span class=n>k_split</span> <span class=o>/</span> <span class=s2>"images"</span>
<a href=#__codelineno-9-7 id=__codelineno-9-7 name=__codelineno-9-7></a>        <span class=n>lbl_to_path</span> <span class=o>=</span> <span class=n>save_path</span> <span class=o>/</span> <span class=n>split</span> <span class=o>/</span> <span class=n>k_split</span> <span class=o>/</span> <span class=s2>"labels"</span>
<a href=#__codelineno-9-8 id=__codelineno-9-8 name=__codelineno-9-8></a>
<a href=#__codelineno-9-9 id=__codelineno-9-9 name=__codelineno-9-9></a>        <span class=c1># Copy image and label files to new directory (SamefileError if file already exists)</span>
<a href=#__codelineno-9-10 id=__codelineno-9-10 name=__codelineno-9-10></a>        <span class=n>shutil</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>img_to_path</span> <span class=o>/</span> <span class=n>image</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
<a href=#__codelineno-9-11 id=__codelineno-9-11 name=__codelineno-9-11></a>        <span class=n>shutil</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=n>lbl_to_path</span> <span class=o>/</span> <span class=n>label</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</code></pre></div></ol><h2 id=save-records-optional>Save Records (Optional)</h2><p>Optionally, you can save the records of the K-Fold split and label distribution DataFrames as CSV files for future reference.<div class=highlight><pre><span></span><code><a href=#__codelineno-10-1 id=__codelineno-10-1 name=__codelineno-10-1></a><span class=n>folds_df</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=n>save_path</span> <span class=o>/</span> <span class=s2>"kfold_datasplit.csv"</span><span class=p>)</span>
<a href=#__codelineno-10-2 id=__codelineno-10-2 name=__codelineno-10-2></a><span class=n>fold_lbl_distrb</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=n>save_path</span> <span class=o>/</span> <span class=s2>"kfold_label_distribution.csv"</span><span class=p>)</span>
</code></pre></div><h2 id=train-yolo-using-k-fold-data-splits>Train YOLO using K-Fold Data Splits</h2><ol><li><p>First, load the YOLO model.</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-11-1 id=__codelineno-11-1 name=__codelineno-11-1></a><span class=kn>from</span> <span class=nn>ultralytics</span> <span class=kn>import</span> <span class=n>YOLO</span>
<a href=#__codelineno-11-2 id=__codelineno-11-2 name=__codelineno-11-2></a>
<a href=#__codelineno-11-3 id=__codelineno-11-3 name=__codelineno-11-3></a><span class=n>weights_path</span> <span class=o>=</span> <span class=s2>"path/to/weights.pt"</span>
<a href=#__codelineno-11-4 id=__codelineno-11-4 name=__codelineno-11-4></a><span class=n>model</span> <span class=o>=</span> <span class=n>YOLO</span><span class=p>(</span><span class=n>weights_path</span><span class=p>,</span> <span class=n>task</span><span class=o>=</span><span class=s2>"detect"</span><span class=p>)</span>
</code></pre></div><li><p>Next, iterate over the dataset YAML files to run training. The results will be saved to a directory specified by the <code>project</code> and <code>name</code> arguments. By default, this directory is 'exp/runs#' where # is an integer index.</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-12-1 id=__codelineno-12-1 name=__codelineno-12-1></a><span class=n>results</span> <span class=o>=</span> <span class=p>{}</span>
<a href=#__codelineno-12-2 id=__codelineno-12-2 name=__codelineno-12-2></a>
<a href=#__codelineno-12-3 id=__codelineno-12-3 name=__codelineno-12-3></a><span class=c1># Define your additional arguments here</span>
<a href=#__codelineno-12-4 id=__codelineno-12-4 name=__codelineno-12-4></a><span class=n>batch</span> <span class=o>=</span> <span class=mi>16</span>
<a href=#__codelineno-12-5 id=__codelineno-12-5 name=__codelineno-12-5></a><span class=n>project</span> <span class=o>=</span> <span class=s2>"kfold_demo"</span>
<a href=#__codelineno-12-6 id=__codelineno-12-6 name=__codelineno-12-6></a><span class=n>epochs</span> <span class=o>=</span> <span class=mi>100</span>
<a href=#__codelineno-12-7 id=__codelineno-12-7 name=__codelineno-12-7></a>
<a href=#__codelineno-12-8 id=__codelineno-12-8 name=__codelineno-12-8></a><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>ksplit</span><span class=p>):</span>
<a href=#__codelineno-12-9 id=__codelineno-12-9 name=__codelineno-12-9></a>    <span class=n>dataset_yaml</span> <span class=o>=</span> <span class=n>ds_yamls</span><span class=p>[</span><span class=n>k</span><span class=p>]</span>
<a href=#__codelineno-12-10 id=__codelineno-12-10 name=__codelineno-12-10></a>    <span class=n>model</span> <span class=o>=</span> <span class=n>YOLO</span><span class=p>(</span><span class=n>weights_path</span><span class=p>,</span> <span class=n>task</span><span class=o>=</span><span class=s2>"detect"</span><span class=p>)</span>
<a href=#__codelineno-12-11 id=__codelineno-12-11 name=__codelineno-12-11></a>    <span class=n>model</span><span class=o>.</span><span class=n>train</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=n>dataset_yaml</span><span class=p>,</span> <span class=n>epochs</span><span class=o>=</span><span class=n>epochs</span><span class=p>,</span> <span class=n>batch</span><span class=o>=</span><span class=n>batch</span><span class=p>,</span> <span class=n>project</span><span class=o>=</span><span class=n>project</span><span class=p>)</span>  <span class=c1># include any train arguments</span>
<a href=#__codelineno-12-12 id=__codelineno-12-12 name=__codelineno-12-12></a>    <span class=n>results</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>metrics</span>  <span class=c1># save output metrics for further analysis</span>
</code></pre></div></ol><h2 id=conclusion>Conclusion</h2><p>In this guide, we have explored the process of using K-Fold cross-validation for training the YOLO object detection model. We learned how to split our dataset into K partitions, ensuring a balanced class distribution across the different folds.<p>We also explored the procedure for creating report DataFrames to visualize the data splits and label distributions across these splits, providing us a clear insight into the structure of our training and validation sets.<p>Optionally, we saved our records for future reference, which could be particularly useful in large-scale projects or when troubleshooting model performance.<p>Finally, we implemented the actual model training using each split in a loop, saving our training results for further analysis and comparison.<p>This technique of K-Fold cross-validation is a robust way of making the most out of your available data, and it helps to ensure that your model performance is reliable and consistent across different data subsets. This results in a more generalizable and reliable model that is less likely to overfit to specific data patterns.<p>Remember that although we used YOLO in this guide, these steps are mostly transferable to other machine learning models. Understanding these steps allows you to apply cross-validation effectively in your own machine learning projects. Happy coding!<h2 id=faq>FAQ</h2><h3 id=what-is-k-fold-cross-validation-and-why-is-it-useful-in-object-detection>What is K-Fold Cross Validation and why is it useful in object detection?</h3><p>K-Fold Cross Validation is a technique where the dataset is divided into 'k' subsets (folds) to evaluate model performance more reliably. Each fold serves as both training and <a href=https://www.ultralytics.com/glossary/validation-data>validation data</a>. In the context of object detection, using K-Fold Cross Validation helps to ensure your Ultralytics YOLO model's performance is robust and generalizable across different data splits, enhancing its reliability. For detailed instructions on setting up K-Fold Cross Validation with Ultralytics YOLO, refer to <a href=#introduction>K-Fold Cross Validation with Ultralytics</a>.<h3 id=how-do-i-implement-k-fold-cross-validation-using-ultralytics-yolo>How do I implement K-Fold Cross Validation using Ultralytics YOLO?</h3><p>To implement K-Fold Cross Validation with Ultralytics YOLO, you need to follow these steps:<ol><li>Verify annotations are in the <a href=../../datasets/detect/>YOLO detection format</a>.<li>Use Python libraries like <code>sklearn</code>, <code>pandas</code>, and <code>pyyaml</code>.<li>Create feature vectors from your dataset.<li>Split your dataset using <code>KFold</code> from <code>sklearn.model_selection</code>.<li>Train the YOLO model on each split.</ol><p>For a comprehensive guide, see the <a href=#k-fold-dataset-split>K-Fold Dataset Split</a> section in our documentation.<h3 id=why-should-i-use-ultralytics-yolo-for-object-detection>Why should I use Ultralytics YOLO for object detection?</h3><p>Ultralytics YOLO offers state-of-the-art, real-time object detection with high <a href=https://www.ultralytics.com/glossary/accuracy>accuracy</a> and efficiency. It's versatile, supporting multiple <a href=https://www.ultralytics.com/glossary/computer-vision-cv>computer vision</a> tasks such as detection, segmentation, and classification. Additionally, it integrates seamlessly with tools like Ultralytics HUB for no-code model training and deployment. For more details, explore the benefits and features on our <a href=https://www.ultralytics.com/yolo>Ultralytics YOLO page</a>.<h3 id=how-can-i-ensure-my-annotations-are-in-the-correct-format-for-ultralytics-yolo>How can I ensure my annotations are in the correct format for Ultralytics YOLO?</h3><p>Your annotations should follow the YOLO detection format. Each annotation file must list the object class, alongside its <a href=https://www.ultralytics.com/glossary/bounding-box>bounding box</a> coordinates in the image. The YOLO format ensures streamlined and standardized data processing for training object detection models. For more information on proper annotation formatting, visit the <a href=../../datasets/detect/>YOLO detection format guide</a>.<h3 id=can-i-use-k-fold-cross-validation-with-custom-datasets-other-than-fruit-detection>Can I use K-Fold Cross Validation with custom datasets other than Fruit Detection?</h3><p>Yes, you can use K-Fold Cross Validation with any custom dataset as long as the annotations are in the YOLO detection format. Replace the dataset paths and class labels with those specific to your custom dataset. This flexibility ensures that any object detection project can benefit from robust model evaluation using K-Fold Cross Validation. For a practical example, review our <a href=#generating-feature-vectors-for-object-detection-dataset>Generating Feature Vectors</a> section.<div class=git-info><div class=dates-container><span title="This page was first created on November 12, 2023"class=date-item> <span class=hover-item>📅</span> Created 1 year ago </span><span title="This page was last updated on November 07, 2024"class=date-item> <span class=hover-item>✏️</span> Updated 12 days ago </span></div><div class=authors-container><a title="M-Amrollahi (1 change)"class=author-link href=https://github.com/M-Amrollahi> <img alt=M-Amrollahi class=hover-item loading=lazy src=https://avatars.githubusercontent.com/u/44016758?v=4&s=96> </a><a title="glenn-jocher (12 changes)"class=author-link href=https://github.com/glenn-jocher> <img alt=glenn-jocher class=hover-item loading=lazy src=https://avatars.githubusercontent.com/u/26833433?v=4&s=96> </a><a title="RizwanMunawar (1 change)"class=author-link href=https://github.com/RizwanMunawar> <img alt=RizwanMunawar class=hover-item loading=lazy src=https://avatars.githubusercontent.com/u/62513924?v=4&s=96> </a><a title="IvorZhu331 (1 change)"class=author-link href=https://github.com/IvorZhu331> <img alt=IvorZhu331 class=hover-item loading=lazy src=https://avatars.githubusercontent.com/u/130829914?v=4&s=96> </a><a title="Burhan-Q (1 change)"class=author-link href=https://github.com/Burhan-Q> <img alt=Burhan-Q class=hover-item loading=lazy src=https://avatars.githubusercontent.com/u/62214284?v=4&s=96> </a></div></div><div class=share-buttons><button class="share-button hover-item"onclick="window.open('https://twitter.com/intent/tweet?url=https://docs.ultralytics.com/guides/kfold-cross-validation', 'TwitterShare', 'width=550,height=680,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-x-twitter"></i> Tweet</button><button class="share-button hover-item linkedin"onclick="window.open('https://www.linkedin.com/shareArticle?url=https://docs.ultralytics.com/guides/kfold-cross-validation', 'LinkedinShare', 'width=550,height=730,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-linkedin-in"></i> Share</button></div><h2 id=__comments>Comments</h2><div id=giscus-container></div></article></div><script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div><button class="md-top md-icon"data-md-component=top hidden type=button><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top</button></main><footer class=md-footer><nav class="md-footer__inner md-grid"aria-label=Footer><a aria-label="Previous: Model Deployment Options"class="md-footer__link md-footer__link--prev"href=../model-deployment-options/> <div class="md-footer__button md-icon"><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg></div> <div class=md-footer__title><span class=md-footer__direction> Previous </span><div class=md-ellipsis>Model Deployment Options</div></div> </a><a aria-label="Next: Hyperparameter Tuning"class="md-footer__link md-footer__link--next"href=../hyperparameter-tuning/> <div class=md-footer__title><span class=md-footer__direction> Next </span><div class=md-ellipsis>Hyperparameter Tuning</div></div> <div class="md-footer__button md-icon"><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg></div> </a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright><div class=md-copyright__highlight><a href=https://ultralytics.com target=_blank>© 2024 Ultralytics Inc.</a> All rights reserved.</div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a></div><div class=md-social><a class=md-social__link href=https://github.com/ultralytics rel=noopener target=_blank title=github.com> <svg viewbox="0 0 496 512"xmlns=http://www.w3.org/2000/svg><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </a><a class=md-social__link href=https://www.linkedin.com/company/ultralytics/ rel=noopener target=_blank title=www.linkedin.com> <svg viewbox="0 0 448 512"xmlns=http://www.w3.org/2000/svg><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"></path></svg> </a><a class=md-social__link href=https://twitter.com/ultralytics rel=noopener target=_blank title=twitter.com> <svg viewbox="0 0 512 512"xmlns=http://www.w3.org/2000/svg><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"></path></svg> </a><a class=md-social__link href=https://youtube.com/ultralytics?sub_confirmation=1 rel=noopener target=_blank title=youtube.com> <svg viewbox="0 0 576 512"xmlns=http://www.w3.org/2000/svg><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"></path></svg> </a><a class=md-social__link href=https://hub.docker.com/r/ultralytics/ultralytics/ rel=noopener target=_blank title=hub.docker.com> <svg viewbox="0 0 640 512"xmlns=http://www.w3.org/2000/svg><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"></path></svg> </a><a class=md-social__link href=https://pypi.org/project/ultralytics/ rel=noopener target=_blank title=pypi.org> <svg viewbox="0 0 448 512"xmlns=http://www.w3.org/2000/svg><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"></path></svg> </a><a class=md-social__link href=https://ultralytics.com/discord rel=noopener target=_blank title=ultralytics.com> <svg viewbox="0 0 640 512"xmlns=http://www.w3.org/2000/svg><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"></path></svg> </a><a class=md-social__link href=https://reddit.com/r/ultralytics rel=noopener target=_blank title=reddit.com> <svg viewbox="0 0 512 512"xmlns=http://www.w3.org/2000/svg><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5"></path></svg> </a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><div class=md-progress data-md-component=progress role=progressbar></div><script id=__config type=application/json>{"base": "../..", "features": ["content.action.edit", "content.code.annotate", "content.code.copy", "content.tooltips", "search.highlight", "search.share", "search.suggest", "toc.follow", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.prune", "navigation.footer", "navigation.tracking", "navigation.instant", "navigation.instant.progress", "navigation.indexes", "navigation.sections", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script><script src=../../assets/javascripts/bundle.83f73b43.min.js></script><script src=../../javascript/extra.js></script><script src=../../javascript/giscus.js></script>