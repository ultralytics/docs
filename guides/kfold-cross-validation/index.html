 <!DOCTYPE html><html class="no-js" lang="en"><head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Learn to implement K-Fold Cross Validation for object detection datasets using Ultralytics YOLO. Improve your model's reliability and robustness." name="description"/><meta content="Ultralytics" name="author"/><link href="https://docs.ultralytics.com/guides/kfold-cross-validation/" rel="canonical"/><link href="../isolating-segmentation-objects/" rel="prev"/><link href="../model-monitoring-and-maintenance/" rel="next"/><link href="/" hreflang="en" rel="alternate"/><link href="/zh/" hreflang="zh" rel="alternate"/><link href="/ko/" hreflang="ko" rel="alternate"/><link href="/ja/" hreflang="ja" rel="alternate"/><link href="/ru/" hreflang="ru" rel="alternate"/><link href="/de/" hreflang="de" rel="alternate"/><link href="/fr/" hreflang="fr" rel="alternate"/><link href="/es/" hreflang="es" rel="alternate"/><link href="/pt/" hreflang="pt" rel="alternate"/><link href="/it/" hreflang="it" rel="alternate"/><link href="/tr/" hreflang="tr" rel="alternate"/><link href="/vi/" hreflang="vi" rel="alternate"/><link href="/ar/" hreflang="ar" rel="alternate"/><link href="https://raw.githubusercontent.com/ultralytics/assets/refs/heads/main/logo/favicon-yolo.png" rel="icon"/><meta content="zensical-0.0.15" name="generator"/><title>K-Fold Cross Validation with Ultralytics - Ultralytics YOLO Docs</title><link href="../../assets/stylesheets/modern/main.f1b6466b.min.css" rel="stylesheet"/><link href="../../assets/stylesheets/modern/palette.dfe2e883.min.css" rel="stylesheet"/><style>:root{}</style><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,500,500i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link href="../../stylesheets/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)),0),__md_get=(e,t=localStorage,a=__md_scope)=>JSON.parse(t.getItem(a.pathname+"."+e)),__md_set=(e,t,a=localStorage,_=__md_scope)=>{try{a.setItem(_.pathname+"."+e,JSON.stringify(t))}catch(e){}},document.documentElement.setAttribute("data-platform",navigator.platform)</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2M5EHKC0BH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2M5EHKC0BH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2M5EHKC0BH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
<style data-doc-kind="true">.doc-kind{display:inline-flex;align-items:center;gap:0.25em;padding:0.21em 0.59em;border-radius:999px;font-weight:700;font-size:0.81em;letter-spacing:0.06em;text-transform:uppercase;line-height:1;color:var(--doc-kind-color,#f8fafc);background:var(--doc-kind-bg,rgba(255,255,255,0.12));}.doc-kind-class{--doc-kind-color:#039dfc;--doc-kind-bg:rgba(3,157,252,0.22);}.doc-kind-function{--doc-kind-color:#fc9803;--doc-kind-bg:rgba(252,152,3,0.22);}.doc-kind-method{--doc-kind-color:#ef5eff;--doc-kind-bg:rgba(239,94,255,0.22);}.doc-kind-property{--doc-kind-color:#02e835;--doc-kind-bg:rgba(2,232,53,0.22);}</style><meta content="K-Fold Cross Validation with Ultralytics" name="title"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"/><meta content="website" property="og:type"/><meta content="https://docs.ultralytics.com/guides/kfold-cross-validation/" property="og:url"/><meta content="K-Fold Cross Validation with Ultralytics" property="og:title"/><meta content="" property="og:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="og:image"/><meta content="summary_large_image" property="twitter:card"/><meta content="https://docs.ultralytics.com/guides/kfold-cross-validation/" property="twitter:url"/><meta content="K-Fold Cross Validation with Ultralytics" property="twitter:title"/><meta content="" property="twitter:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="twitter:image"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": ["Article", "FAQPage"], "headline": "K-Fold Cross Validation with Ultralytics", "image": ["https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png"], "datePublished": "2023-11-12 02:49:37 +0100", "dateModified": "2025-12-12 18:18:41 +0100", "author": [{"@type": "Organization", "name": "Ultralytics", "url": "https://ultralytics.com/"}], "abstract": "", "mainEntity": [{"@type": "Question", "name": "What is K-Fold Cross Validation and why is it useful in object detection?", "acceptedAnswer": {"@type": "Answer", "text": "K-Fold Cross Validation is a technique where the dataset is divided into 'k' subsets (folds) to evaluate model performance more reliably. Each fold serves as both training and validation data. In the context of object detection, using K-Fold Cross Validation helps to ensure your Ultralytics YOLO model's performance is robust and generalizable across different data splits, enhancing its reliability. For detailed instructions on setting up K-Fold Cross Validation with Ultralytics YOLO, refer to K-Fold Cross Validation with Ultralytics."}}, {"@type": "Question", "name": "How do I implement K-Fold Cross Validation using Ultralytics YOLO?", "acceptedAnswer": {"@type": "Answer", "text": "To implement K-Fold Cross Validation with Ultralytics YOLO, you need to follow these steps: For a comprehensive guide, see the K-Fold Dataset Split section in our documentation."}}, {"@type": "Question", "name": "Why should I use Ultralytics YOLO for object detection?", "acceptedAnswer": {"@type": "Answer", "text": "Ultralytics YOLO offers state-of-the-art, real-time object detection with high accuracy and efficiency. It's versatile, supporting multiple computer vision tasks such as detection, segmentation, and classification. Additionally, it integrates seamlessly with tools like Ultralytics HUB for no-code model training and deployment. For more details, explore the benefits and features on our Ultralytics YOLO page."}}, {"@type": "Question", "name": "How can I ensure my annotations are in the correct format for Ultralytics YOLO?", "acceptedAnswer": {"@type": "Answer", "text": "Your annotations should follow the YOLO detection format. Each annotation file must list the object class, alongside its bounding box coordinates in the image. The YOLO format ensures streamlined and standardized data processing for training object detection models. For more information on proper annotation formatting, visit the YOLO detection format guide."}}, {"@type": "Question", "name": "Can I use K-Fold Cross Validation with custom datasets other than Fruit Detection?", "acceptedAnswer": {"@type": "Answer", "text": "Yes, you can use K-Fold Cross Validation with any custom dataset as long as the annotations are in the YOLO detection format. Replace the dataset paths and class labels with those specific to your custom dataset. This flexibility ensures that any object detection project can benefit from robust model evaluation using K-Fold Cross Validation. For a practical example, review our Generating Feature Vectors section."}}]}</script></head><body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr"><input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/><input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/><label class="md-overlay" for="__drawer"></label><div data-md-component="skip"><a class="md-skip" href="#k-fold-cross-validation-with-ultralytics"> Skip to content </a></div><div data-md-component="announce"><aside class="md-banner"><div class="md-banner__inner md-grid md-typeset"><a class="banner-wrapper" href="https://www.ultralytics.com/news/ultralytics-raises-30m-series-a" target="_blank"><div class="banner-content-wrapper"><img alt="Ultralytics raises $30M Series A" height="40" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac336b5de2ae8b398bca_writting.svg"/><div class="vc-wrapper"><img alt="Elephant" height="28" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac33c95408144846afc7_image%201.png"/><img alt="SquareOne" height="28" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac3333068d9632cc6df8_image%202.png"/></div></div></a></div></aside></div><header class="md-header md-header--shadow md-header--lifted" data-md-component="header"><nav aria-label="Header" class="md-header__inner md-grid"><a aria-label="Ultralytics YOLO Docs" class="md-header__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs"><img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/></a><label class="md-header__button md-icon" for="__drawer"><svg class="lucide lucide-menu" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 5h16M4 12h16M4 19h16"></path></svg></label><div class="md-header__title" data-md-component="header-title"><div class="md-header__ellipsis"><div class="md-header__topic"><span class="md-ellipsis"> Ultralytics YOLO Docs </span></div><div class="md-header__topic" data-md-component="header-topic"><span class="md-ellipsis"> K-Fold Cross Validation with Ultralytics </span></div></div></div><form class="md-header__option" data-md-component="palette"><input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg></label><input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to system preference"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label><input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label></form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<div class="md-header__option"><div class="md-select"><button aria-label="Select language" class="md-header__button md-icon"><svg class="lucide lucide-languages" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m5 8 6 6M4 14l6-6 2-3M2 5h12M7 2h1M22 22l-5-10-5 10M14 18h6"></path></svg></button><div class="md-select__inner"><ul class="md-select__list"><li class="md-select__item"><a class="md-select__link" href="/" hreflang="en"> üá¨üáß English </a></li><li class="md-select__item"><a class="md-select__link" href="/zh/" hreflang="zh"> üá®üá≥ ÁÆÄ‰Ωì‰∏≠Êñá </a></li><li class="md-select__item"><a class="md-select__link" href="/ko/" hreflang="ko"> üá∞üá∑ ÌïúÍµ≠Ïñ¥ </a></li><li class="md-select__item"><a class="md-select__link" href="/ja/" hreflang="ja"> üáØüáµ Êó•Êú¨Ë™û </a></li><li class="md-select__item"><a class="md-select__link" href="/ru/" hreflang="ru"> üá∑üá∫ –†—É—Å—Å–∫–∏–π </a></li><li class="md-select__item"><a class="md-select__link" href="/de/" hreflang="de"> üá©üá™ Deutsch </a></li><li class="md-select__item"><a class="md-select__link" href="/fr/" hreflang="fr"> üá´üá∑ Fran√ßais </a></li><li class="md-select__item"><a class="md-select__link" href="/es/" hreflang="es"> üá™üá∏ Espa√±ol </a></li><li class="md-select__item"><a class="md-select__link" href="/pt/" hreflang="pt"> üáµüáπ Portugu√™s </a></li><li class="md-select__item"><a class="md-select__link" href="/it/" hreflang="it"> üáÆüáπ Italiano </a></li><li class="md-select__item"><a class="md-select__link" href="/tr/" hreflang="tr"> üáπüá∑ T√ºrk√ße </a></li><li class="md-select__item"><a class="md-select__link" href="/vi/" hreflang="vi"> üáªüá≥ Ti·∫øng Vi·ªát </a></li><li class="md-select__item"><a class="md-select__link" href="/ar/" hreflang="ar"> üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ© </a></li></ul></div></div></div><div class="md-header__source"><a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository"><div class="md-source__icon md-icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></div><div class="md-source__repository"> ultralytics/ultralytics </div></a></div></nav><nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"><div class="md-grid"><ul class="md-tabs__list"><li class="md-tabs__item"><a class="md-tabs__link" href="../.."> Home </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../quickstart/"> Quickstart </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../modes/"> Modes </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../tasks/"> Tasks </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../models/"> Models </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../datasets/"> Datasets </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../solutions/"> Solutions </a></li><li class="md-tabs__item md-tabs__item--active"><a class="md-tabs__link" href="../"> Guides </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../integrations/"> Integrations </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../hub/"> HUB </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../reference/__init__/"> Reference </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../help/"> Help </a></li></ul></div></nav></header><div class="md-container" data-md-component="container"><main class="md-main" data-md-component="main"><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0"><label class="md-nav__title" for="__drawer"><a aria-label="Ultralytics YOLO Docs" class="md-nav__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs"><img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/></a> Ultralytics YOLO Docs </label><div class="md-nav__source"><a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository"><div class="md-source__icon md-icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></div><div class="md-source__repository"> ultralytics/ultralytics </div></a></div><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../.."><span class="md-ellipsis"> Home </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../quickstart/"><span class="md-ellipsis"> Quickstart </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../modes/"><span class="md-ellipsis"> Modes </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../tasks/"><span class="md-ellipsis"> Tasks </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/"><span class="md-ellipsis"> Models </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../datasets/"><span class="md-ellipsis"> Datasets </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../solutions/"><span class="md-ellipsis"> Solutions </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input checked="" class="md-nav__toggle md-toggle" id="__nav_8" type="checkbox"/><div class="md-nav__link md-nav__container"><a class="md-nav__link" href="../"><span class="md-ellipsis"> Guides </span></a><label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex=""><span class="md-nav__icon md-icon"></span></label></div><nav aria-expanded="true" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1"><label class="md-nav__title" for="__nav_8"><span class="md-nav__icon md-icon"></span> Guides </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../model-testing/"><span class="md-ellipsis"> A Guide on Model Testing </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../azureml-quickstart/"><span class="md-ellipsis"> AzureML Quickstart </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../model-deployment-practices/"><span class="md-ellipsis"> Best Practices for Model Deployment </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../conda-quickstart/"><span class="md-ellipsis"> Conda Quickstart </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../data-collection-and-annotation/"><span class="md-ellipsis"> Data Collection and Annotation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../deepstream-nvidia-jetson/"><span class="md-ellipsis"> DeepStream on NVIDIA Jetson </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../defining-project-goals/"><span class="md-ellipsis"> Defining A Computer Vision Project's Goals </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../vertex-ai-deployment-with-docker/"><span class="md-ellipsis"> Deploying YOLO on Vertex AI in Docker container </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../docker-quickstart/"><span class="md-ellipsis"> Docker Quickstart </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../coral-edge-tpu-on-raspberry-pi/"><span class="md-ellipsis"> Edge TPU on Raspberry Pi </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../hyperparameter-tuning/"><span class="md-ellipsis"> Hyperparameter Tuning </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../model-evaluation-insights/"><span class="md-ellipsis"> Insights on Model Evaluation and Fine-Tuning </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../isolating-segmentation-objects/"><span class="md-ellipsis"> Isolating Segmentation Objects </span></a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/><label class="md-nav__link md-nav__link--active" for="__toc"><span class="md-ellipsis"> K-Fold Cross Validation </span><span class="md-nav__icon md-icon"></span></label><a class="md-nav__link md-nav__link--active" href="./"><span class="md-ellipsis"> K-Fold Cross Validation </span></a><nav aria-label="On this page" class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc"><span class="md-nav__icon md-icon"></span> On this page </label><ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#introduction"><span class="md-ellipsis"> Introduction </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#setup"><span class="md-ellipsis"> Setup </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#generating-feature-vectors-for-object-detection-dataset"><span class="md-ellipsis"> Generating Feature Vectors for Object Detection Dataset </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#k-fold-dataset-split"><span class="md-ellipsis"> K-Fold Dataset Split </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#save-records-optional"><span class="md-ellipsis"> Save Records (Optional) </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#train-yolo-using-k-fold-data-splits"><span class="md-ellipsis"> Train YOLO using K-Fold Data Splits </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#conclusion"><span class="md-ellipsis"> Conclusion </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#faq"><span class="md-ellipsis"> FAQ </span></a><nav aria-label="FAQ" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#what-is-k-fold-cross-validation-and-why-is-it-useful-in-object-detection"><span class="md-ellipsis"> What is K-Fold Cross Validation and why is it useful in object detection? </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#how-do-i-implement-k-fold-cross-validation-using-ultralytics-yolo"><span class="md-ellipsis"> How do I implement K-Fold Cross Validation using Ultralytics YOLO? </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#why-should-i-use-ultralytics-yolo-for-object-detection"><span class="md-ellipsis"> Why should I use Ultralytics YOLO for object detection? </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#how-can-i-ensure-my-annotations-are-in-the-correct-format-for-ultralytics-yolo"><span class="md-ellipsis"> How can I ensure my annotations are in the correct format for Ultralytics YOLO? </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#can-i-use-k-fold-cross-validation-with-custom-datasets-other-than-fruit-detection"><span class="md-ellipsis"> Can I use K-Fold Cross Validation with custom datasets other than Fruit Detection? </span></a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="../model-monitoring-and-maintenance/"><span class="md-ellipsis"> Maintaining Your Computer Vision Model </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../model-deployment-options/"><span class="md-ellipsis"> Model Deployment Options </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../model-yaml-config/"><span class="md-ellipsis"> Model YAML Configuration Guide </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../nvidia-jetson/"><span class="md-ellipsis"> NVIDIA Jetson </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../optimizing-openvino-latency-vs-throughput-modes/"><span class="md-ellipsis"> OpenVINO Latency vs Throughput modes </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../preprocessing_annotated_data/"><span class="md-ellipsis"> Preprocessing Annotated Data </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../raspberry-pi/"><span class="md-ellipsis"> Raspberry Pi </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../ros-quickstart/"><span class="md-ellipsis"> ROS Quickstart </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../sahi-tiled-inference/"><span class="md-ellipsis"> SAHI Tiled Inference </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../steps-of-a-cv-project/"><span class="md-ellipsis"> Steps of a Computer Vision Project </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../model-training-tips/"><span class="md-ellipsis"> Tips for Model Training </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../triton-inference-server/"><span class="md-ellipsis"> Triton Inference Server </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../view-results-in-terminal/"><span class="md-ellipsis"> Viewing Inference Images in a Terminal </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../yolo-common-issues/"><span class="md-ellipsis"> YOLO Common Issues </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../yolo-data-augmentation/"><span class="md-ellipsis"> YOLO Data Augmentation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../yolo-performance-metrics/"><span class="md-ellipsis"> YOLO Performance Metrics </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../yolo-thread-safe-inference/"><span class="md-ellipsis"> YOLO Thread-Safe Inference </span></a></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_8_33" type="checkbox"/><div class="md-nav__link md-nav__container"><a class="md-nav__link" href="../../datasets/explorer/"><span class="md-ellipsis"> Explorer </span></a><label class="md-nav__link" for="__nav_8_33" id="__nav_8_33_label" tabindex=""><span class="md-nav__icon md-icon"></span></label></div><nav aria-expanded="false" aria-labelledby="__nav_8_33_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_8_33"><span class="md-nav__icon md-icon"></span> Explorer </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../datasets/explorer/api/"><span class="md-ellipsis"> Explorer API </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../datasets/explorer/dashboard/"><span class="md-ellipsis"> Explorer Dashboard Demo </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../datasets/explorer/explorer/"><span class="md-ellipsis"> VOC Exploration Example </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_8_34" type="checkbox"/><div class="md-nav__link md-nav__container"><a class="md-nav__link" href="../../yolov5/"><span class="md-ellipsis"> YOLOv5 </span></a><label class="md-nav__link" for="__nav_8_34" id="__nav_8_34_label" tabindex=""><span class="md-nav__icon md-icon"></span></label></div><nav aria-expanded="false" aria-labelledby="__nav_8_34_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_8_34"><span class="md-nav__icon md-icon"></span> YOLOv5 </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../yolov5/quickstart_tutorial/"><span class="md-ellipsis"> Quickstart </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../yolov5/environments/aws_quickstart_tutorial/"><span class="md-ellipsis"> Environments </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../yolov5/tutorials/train_custom_data/"><span class="md-ellipsis"> Tutorials </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../integrations/"><span class="md-ellipsis"> Integrations </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../hub/"><span class="md-ellipsis"> HUB </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../reference/__init__/"><span class="md-ellipsis"> Reference </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../help/"><span class="md-ellipsis"> Help </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav aria-label="On this page" class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc"><span class="md-nav__icon md-icon"></span> On this page </label><ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#introduction"><span class="md-ellipsis"> Introduction </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#setup"><span class="md-ellipsis"> Setup </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#generating-feature-vectors-for-object-detection-dataset"><span class="md-ellipsis"> Generating Feature Vectors for Object Detection Dataset </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#k-fold-dataset-split"><span class="md-ellipsis"> K-Fold Dataset Split </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#save-records-optional"><span class="md-ellipsis"> Save Records (Optional) </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#train-yolo-using-k-fold-data-splits"><span class="md-ellipsis"> Train YOLO using K-Fold Data Splits </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#conclusion"><span class="md-ellipsis"> Conclusion </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#faq"><span class="md-ellipsis"> FAQ </span></a><nav aria-label="FAQ" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#what-is-k-fold-cross-validation-and-why-is-it-useful-in-object-detection"><span class="md-ellipsis"> What is K-Fold Cross Validation and why is it useful in object detection? </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#how-do-i-implement-k-fold-cross-validation-using-ultralytics-yolo"><span class="md-ellipsis"> How do I implement K-Fold Cross Validation using Ultralytics YOLO? </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#why-should-i-use-ultralytics-yolo-for-object-detection"><span class="md-ellipsis"> Why should I use Ultralytics YOLO for object detection? </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#how-can-i-ensure-my-annotations-are-in-the-correct-format-for-ultralytics-yolo"><span class="md-ellipsis"> How can I ensure my annotations are in the correct format for Ultralytics YOLO? </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#can-i-use-k-fold-cross-validation-with-custom-datasets-other-than-fruit-detection"><span class="md-ellipsis"> Can I use K-Fold Cross Validation with custom datasets other than Fruit Detection? </span></a></li></ul></nav></li></ul></nav></div></div></div><div class="md-content" data-md-component="content"><article class="md-content__inner md-typeset"><a class="md-content__button md-icon" href="https://github.com/ultralytics/ultralytics/tree/main/docs/en/guides/kfold-cross-validation.md" rel="edit" title="Edit this page"><svg class="lucide lucide-file-pen" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v9.34"></path><path d="M14 2v5a1 1 0 0 0 1 1h5M10.378 12.622a1 1 0 0 1 3 3.003L8.36 20.637a2 2 0 0 1-.854.506l-2.867.837a.5.5 0 0 1-.62-.62l.836-2.869a2 2 0 0 1 .506-.853z"></path></svg></a><a class="md-content__button md-icon" href="javascript:void(0)" onclick="copyMarkdownForLLM(this); return false;" title="Copy page in Markdown format"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg></a><h1 id="k-fold-cross-validation-with-ultralytics">K-Fold Cross Validation with Ultralytics</h1><h2 id="introduction">Introduction</h2><p>This comprehensive guide illustrates the implementation of K-Fold Cross Validation for <a href="https://www.ultralytics.com/glossary/object-detection">object detection</a> datasets within the Ultralytics ecosystem. We'll leverage the YOLO detection format and key Python libraries such as sklearn, pandas, and PyYAML to guide you through the necessary setup, the process of generating feature vectors, and the execution of a K-Fold dataset split.</p><p align="center"><img alt="K-Fold Cross Validation Overview" src="https://github.com/ultralytics/docs/releases/download/0/k-fold-cross-validation-overview.avif" width="800"/></p><p>Whether your project involves the Fruit Detection dataset or a custom data source, this tutorial aims to help you comprehend and apply K-Fold Cross Validation to bolster the reliability and robustness of your <a href="https://www.ultralytics.com/glossary/machine-learning-ml">machine learning</a> models. While we're applying <code>k=5</code> folds for this tutorial, keep in mind that the optimal number of folds can vary depending on your dataset and the specifics of your project.</p><p>Let's get started.</p><h2 id="setup">Setup</h2><ul><li><p>Your annotations should be in the <a href="../../datasets/detect/">YOLO detection format</a>.</p></li><li><p>This guide assumes that annotation files are locally available.</p></li><li><p>For our demonstration, we use the <a href="https://www.kaggle.com/datasets/lakshaytyagi01/fruit-detection/code">Fruit Detection</a> dataset.</p><ul><li>This dataset contains a total of 8479 images.</li><li>It includes 6 class labels, each with its total instance counts listed below.</li></ul></li></ul><table><thead><tr><th style="text-align: left;">Class Label</th><th style="text-align: center;">Instance Count</th></tr></thead><tbody><tr><td style="text-align: left;">Apple</td><td style="text-align: center;">7049</td></tr><tr><td style="text-align: left;">Grapes</td><td style="text-align: center;">7202</td></tr><tr><td style="text-align: left;">Pineapple</td><td style="text-align: center;">1613</td></tr><tr><td style="text-align: left;">Orange</td><td style="text-align: center;">15549</td></tr><tr><td style="text-align: left;">Banana</td><td style="text-align: center;">3536</td></tr><tr><td style="text-align: left;">Watermelon</td><td style="text-align: center;">1976</td></tr></tbody></table><ul><li><p>Necessary Python packages include:</p><ul><li><code>ultralytics</code></li><li><code>sklearn</code></li><li><code>pandas</code></li><li><code>pyyaml</code></li></ul></li><li><p>This tutorial operates with <code>k=5</code> folds. However, you should determine the best number of folds for your specific dataset.</p></li><li><p>Initiate a new Python virtual environment (<code>venv</code>) for your project and activate it. Use <code>pip</code> (or your preferred package manager) to install:</p><ul><li>The Ultralytics library: <code>pip install -U ultralytics</code>. Alternatively, you can clone the official <a href="https://github.com/ultralytics/ultralytics">repo</a>.</li><li>Scikit-learn, pandas, and PyYAML: <code>pip install -U scikit-learn pandas pyyaml</code>.</li></ul></li><li><p>Verify that your annotations are in the <a href="../../datasets/detect/">YOLO detection format</a>.</p><ul><li>For this tutorial, all annotation files are found in the <code>Fruit-Detection/labels</code> directory.</li></ul></li></ul><h2 id="generating-feature-vectors-for-object-detection-dataset">Generating Feature Vectors for Object Detection Dataset</h2><ol><li><p>Start by creating a new <code>example.py</code> Python file for the steps below.</p></li><li><p>Proceed to retrieve all label files for your dataset.</p><div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span></span>
<span></span><span class="n">dataset_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"./Fruit-detection"</span><span class="p">)</span>  <span class="c1"># replace with 'path/to/dataset' for your custom data</span>
<span></span><span class="n">labels</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dataset_path</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">"*labels/*.txt"</span><span class="p">))</span>  <span class="c1"># all data in 'labels'</span>
</code></pre></div></li><li><p>Now, read the contents of the dataset YAML file and extract the indices of the class labels.</p><div class="highlight"><pre><span></span><code><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
<span></span>
<span></span><span class="n">yaml_file</span> <span class="o">=</span> <span class="s2">"path/to/data.yaml"</span>  <span class="c1"># your data YAML with data directories and names dictionary</span>
<span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">yaml_file</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">y</span><span class="p">:</span>
<span></span>    <span class="n">classes</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">y</span><span class="p">)[</span><span class="s2">"names"</span><span class="p">]</span>
<span></span><span class="n">cls_idx</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">classes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</code></pre></div></li><li><p>Initialize an empty <code>pandas</code> DataFrame.</p><div class="highlight"><pre><span></span><code><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span></span>
<span></span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span><span class="o">.</span><span class="n">stem</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>  <span class="c1"># uses base filename as ID (no extension)</span>
<span></span><span class="n">labels_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([],</span> <span class="n">columns</span><span class="o">=</span><span class="n">cls_idx</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></li><li><p>Count the instances of each class-label present in the annotation files.</p><div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
<span></span>
<span></span><span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
<span></span>    <span class="n">lbl_counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
<span></span>
<span></span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="k">as</span> <span class="n">lf</span><span class="p">:</span>
<span></span>        <span class="n">lines</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span></span>
<span></span>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
<span></span>        <span class="c1"># classes for YOLO label uses integer at first position of each line</span>
<span></span>        <span class="n">lbl_counter</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">+=</span> <span class="mi">1</span>
<span></span>
<span></span>    <span class="n">labels_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">label</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span> <span class="o">=</span> <span class="n">lbl_counter</span>
<span></span>
<span></span><span class="n">labels_df</span> <span class="o">=</span> <span class="n">labels_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>  <span class="c1"># replace `nan` values with `0.0`</span>
</code></pre></div></li><li><p>The following is a sample view of the populated DataFrame:</p><div class="highlight"><pre><span></span><code><span></span>                                                       0    1    2    3    4    5
<span></span>'0000a16e4b057580_jpg.rf.00ab48988370f64f5ca8ea4...'  0.0  0.0  0.0  0.0  0.0  7.0
<span></span>'0000a16e4b057580_jpg.rf.7e6dce029fb67f01eb19aa7...'  0.0  0.0  0.0  0.0  0.0  7.0
<span></span>'0000a16e4b057580_jpg.rf.bc4d31cdcbe229dd022957a...'  0.0  0.0  0.0  0.0  0.0  7.0
<span></span>'00020ebf74c4881c_jpg.rf.508192a0a97aa6c4a3b6882...'  0.0  0.0  0.0  1.0  0.0  0.0
<span></span>'00020ebf74c4881c_jpg.rf.5af192a2254c8ecc4188a25...'  0.0  0.0  0.0  1.0  0.0  0.0
<span></span> ...                                                  ...  ...  ...  ...  ...  ...
<span></span>'ff4cd45896de38be_jpg.rf.c4b5e967ca10c7ced3b9e97...'  0.0  0.0  0.0  0.0  0.0  2.0
<span></span>'ff4cd45896de38be_jpg.rf.ea4c1d37d2884b3e3cbce08...'  0.0  0.0  0.0  0.0  0.0  2.0
<span></span>'ff5fd9c3c624b7dc_jpg.rf.bb519feaa36fc4bf630a033...'  1.0  0.0  0.0  0.0  0.0  0.0
<span></span>'ff5fd9c3c624b7dc_jpg.rf.f0751c9c3aa4519ea3c9d6a...'  1.0  0.0  0.0  0.0  0.0  0.0
<span></span>'fffe28b31f2a70d4_jpg.rf.7ea16bd637ba0711c53b540...'  0.0  6.0  0.0  0.0  0.0  0.0
</code></pre></div></li></ol><p>The rows index the label files, each corresponding to an image in your dataset, and the columns correspond to your class-label indices. Each row represents a pseudo feature-vector, with the count of each class-label present in your dataset. This data structure enables the application of <a href="https://www.ultralytics.com/glossary/cross-validation">K-Fold Cross Validation</a> to an object detection dataset.</p><h2 id="k-fold-dataset-split">K-Fold Dataset Split</h2><ol><li><p>Now we will use the <code>KFold</code> class from <code>sklearn.model_selection</code> to generate <code>k</code> splits of the dataset.</p><ul><li>Important:<ul><li>Setting <code>shuffle=True</code> ensures a randomized distribution of classes in your splits.</li><li>By setting <code>random_state=M</code> where <code>M</code> is a chosen integer, you can obtain repeatable results.</li></ul></li></ul><div class="highlight"><pre><span></span><code><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span></span>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">KFold</span>
<span></span>
<span></span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># for reproducibility</span>
<span></span><span class="n">ksplit</span> <span class="o">=</span> <span class="mi">5</span>
<span></span><span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">ksplit</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># setting random_state for repeatable results</span>
<span></span>
<span></span><span class="n">kfolds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">labels_df</span><span class="p">))</span>
</code></pre></div></li><li><p>The dataset has now been split into <code>k</code> folds, each having a list of <code>train</code> and <code>val</code> indices. We will construct a DataFrame to display these results more clearly.</p><div class="highlight"><pre><span></span><code><span></span><span class="n">folds</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">"split_</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">"</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ksplit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
<span></span><span class="n">folds_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">folds</span><span class="p">)</span>
<span></span>
<span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kfolds</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span></span>    <span class="n">folds_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">"split_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">labels_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"train"</span>
<span></span>    <span class="n">folds_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">"split_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">labels_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">val</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"val"</span>
</code></pre></div></li><li><p>Now we will calculate the distribution of class labels for each fold as a ratio of the classes present in <code>val</code> to those present in <code>train</code>.</p><div class="highlight"><pre><span></span><code><span></span><span class="n">fold_lbl_distrb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cls_idx</span><span class="p">)</span>
<span></span>
<span></span><span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">train_indices</span><span class="p">,</span> <span class="n">val_indices</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kfolds</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span></span>    <span class="n">train_totals</span> <span class="o">=</span> <span class="n">labels_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span></span>    <span class="n">val_totals</span> <span class="o">=</span> <span class="n">labels_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">val_indices</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span></span>
<span></span>    <span class="c1"># To avoid division by zero, we add a small value (1E-7) to the denominator</span>
<span></span>    <span class="n">ratio</span> <span class="o">=</span> <span class="n">val_totals</span> <span class="o">/</span> <span class="p">(</span><span class="n">train_totals</span> <span class="o">+</span> <span class="mf">1e-7</span><span class="p">)</span>
<span></span>    <span class="n">fold_lbl_distrb</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="sa">f</span><span class="s2">"split_</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratio</span>
</code></pre></div><p>The ideal scenario is for all class ratios to be reasonably similar for each split and across classes. This, however, will be subject to the specifics of your dataset.</p></li><li><p>Next, we create the directories and dataset YAML files for each split.</p><div class="highlight"><pre><span></span><code><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span></span>
<span></span><span class="n">supported_extensions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">".jpg"</span><span class="p">,</span> <span class="s2">".jpeg"</span><span class="p">,</span> <span class="s2">".png"</span><span class="p">]</span>
<span></span>
<span></span><span class="c1"># Initialize an empty list to store image file paths</span>
<span></span><span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>
<span></span><span class="c1"># Loop through supported extensions and gather image files</span>
<span></span><span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">supported_extensions</span><span class="p">:</span>
<span></span>    <span class="n">images</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">((</span><span class="n">dataset_path</span> <span class="o">/</span> <span class="s2">"images"</span><span class="p">)</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="sa">f</span><span class="s2">"*</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">"</span><span class="p">)))</span>
<span></span>
<span></span><span class="c1"># Create the necessary directories and dataset YAML files</span>
<span></span><span class="n">save_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">dataset_path</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">ksplit</span><span class="si">}</span><span class="s2">-Fold_Cross-val"</span><span class="p">)</span>
<span></span><span class="n">save_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span><span class="n">ds_yamls</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>
<span></span><span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">folds_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<span></span>    <span class="c1"># Create directories</span>
<span></span>    <span class="n">split_dir</span> <span class="o">=</span> <span class="n">save_path</span> <span class="o">/</span> <span class="n">split</span>
<span></span>    <span class="n">split_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>    <span class="p">(</span><span class="n">split_dir</span> <span class="o">/</span> <span class="s2">"train"</span> <span class="o">/</span> <span class="s2">"images"</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>    <span class="p">(</span><span class="n">split_dir</span> <span class="o">/</span> <span class="s2">"train"</span> <span class="o">/</span> <span class="s2">"labels"</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>    <span class="p">(</span><span class="n">split_dir</span> <span class="o">/</span> <span class="s2">"val"</span> <span class="o">/</span> <span class="s2">"images"</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>    <span class="p">(</span><span class="n">split_dir</span> <span class="o">/</span> <span class="s2">"val"</span> <span class="o">/</span> <span class="s2">"labels"</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Create dataset YAML files</span>
<span></span>    <span class="n">dataset_yaml</span> <span class="o">=</span> <span class="n">split_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">split</span><span class="si">}</span><span class="s2">_dataset.yaml"</span>
<span></span>    <span class="n">ds_yamls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset_yaml</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dataset_yaml</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">ds_y</span><span class="p">:</span>
<span></span>        <span class="n">yaml</span><span class="o">.</span><span class="n">safe_dump</span><span class="p">(</span>
<span></span>            <span class="p">{</span>
<span></span>                <span class="s2">"path"</span><span class="p">:</span> <span class="n">split_dir</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span>
<span></span>                <span class="s2">"train"</span><span class="p">:</span> <span class="s2">"train"</span><span class="p">,</span>
<span></span>                <span class="s2">"val"</span><span class="p">:</span> <span class="s2">"val"</span><span class="p">,</span>
<span></span>                <span class="s2">"names"</span><span class="p">:</span> <span class="n">classes</span><span class="p">,</span>
<span></span>            <span class="p">},</span>
<span></span>            <span class="n">ds_y</span><span class="p">,</span>
<span></span>        <span class="p">)</span>
</code></pre></div></li><li><p>Lastly, copy images and labels into the respective directory ('train' or 'val') for each split.</p><ul><li><strong>NOTE:</strong> The time required for this portion of the code will vary based on the size of your dataset and your system hardware.</li></ul><div class="highlight"><pre><span></span><code><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span></span>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<span></span>
<span></span><span class="k">for</span> <span class="n">image</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">labels</span><span class="p">),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">"Copying files"</span><span class="p">):</span>
<span></span>    <span class="k">for</span> <span class="n">split</span><span class="p">,</span> <span class="n">k_split</span> <span class="ow">in</span> <span class="n">folds_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">image</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span></span>        <span class="c1"># Destination directory</span>
<span></span>        <span class="n">img_to_path</span> <span class="o">=</span> <span class="n">save_path</span> <span class="o">/</span> <span class="n">split</span> <span class="o">/</span> <span class="n">k_split</span> <span class="o">/</span> <span class="s2">"images"</span>
<span></span>        <span class="n">lbl_to_path</span> <span class="o">=</span> <span class="n">save_path</span> <span class="o">/</span> <span class="n">split</span> <span class="o">/</span> <span class="n">k_split</span> <span class="o">/</span> <span class="s2">"labels"</span>
<span></span>
<span></span>        <span class="c1"># Copy image and label files to new directory (SamefileError if file already exists)</span>
<span></span>        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">img_to_path</span> <span class="o">/</span> <span class="n">image</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span></span>        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">lbl_to_path</span> <span class="o">/</span> <span class="n">label</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></li></ol><h2 id="save-records-optional">Save Records (Optional)</h2><p>Optionally, you can save the records of the K-Fold split and label distribution DataFrames as CSV files for future reference.</p><div class="highlight"><pre><span></span><code><span></span><span class="n">folds_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">save_path</span> <span class="o">/</span> <span class="s2">"kfold_datasplit.csv"</span><span class="p">)</span>
<span></span><span class="n">fold_lbl_distrb</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">save_path</span> <span class="o">/</span> <span class="s2">"kfold_label_distribution.csv"</span><span class="p">)</span>
</code></pre></div><h2 id="train-yolo-using-k-fold-data-splits">Train YOLO using K-Fold Data Splits</h2><ol><li><p>First, load the YOLO model.</p><div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">YOLO</span>
<span></span>
<span></span><span class="n">weights_path</span> <span class="o">=</span> <span class="s2">"path/to/weights.pt"</span>  <span class="c1"># use yolo11n.pt for a small model</span>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="n">weights_path</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">"detect"</span><span class="p">)</span>
</code></pre></div></li><li><p>Next, iterate over the dataset YAML files to run training. The results will be saved to a directory specified by the <code>project</code> and <code>name</code> arguments. By default, this directory is 'runs/detect/train#' where # is an integer index.</p><div class="highlight"><pre><span></span><code><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
<span></span>
<span></span><span class="c1"># Define your additional arguments here</span>
<span></span><span class="n">batch</span> <span class="o">=</span> <span class="mi">16</span>
<span></span><span class="n">project</span> <span class="o">=</span> <span class="s2">"kfold_demo"</span>
<span></span><span class="n">epochs</span> <span class="o">=</span> <span class="mi">100</span>
<span></span>
<span></span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">dataset_yaml</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ds_yamls</span><span class="p">):</span>
<span></span>    <span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="n">weights_path</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">"detect"</span><span class="p">)</span>
<span></span>    <span class="n">results</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
<span></span>        <span class="n">data</span><span class="o">=</span><span class="n">dataset_yaml</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="n">batch</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">"fold_</span><span class="si">{</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">"</span>
<span></span>    <span class="p">)</span>  <span class="c1"># include any additional train arguments</span>
</code></pre></div></li><li><p>You can also use <a href="https://docs.ultralytics.com/reference/data/utils/">Ultralytics data.utils.autosplit</a> function for automatic dataset splitting:</p><div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">autosplit</span>
<span></span>
<span></span><span class="c1"># Automatically split dataset into train/val/test</span>
<span></span><span class="n">autosplit</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">"path/to/images"</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">annotated_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></li></ol><h2 id="conclusion">Conclusion</h2><p>In this guide, we have explored the process of using K-Fold cross-validation for training the YOLO object detection model. We learned how to split our dataset into K partitions, ensuring a balanced class distribution across the different folds.</p><p>We also explored the procedure for creating report DataFrames to visualize the data splits and label distributions across these splits, providing us a clear insight into the structure of our training and validation sets.</p><p>Optionally, we saved our records for future reference, which could be particularly useful in large-scale projects or when troubleshooting model performance.</p><p>Finally, we implemented the actual model training using each split in a loop, saving our training results for further analysis and comparison.</p><p>This technique of K-Fold cross-validation is a robust way of making the most out of your available data, and it helps to ensure that your model performance is reliable and consistent across different data subsets. This results in a more generalizable and reliable model that is less likely to <a href="https://www.ultralytics.com/glossary/overfitting">overfit</a> to specific data patterns.</p><p>Remember that although we used YOLO in this guide, these steps are mostly transferable to other machine learning models. Understanding these steps allows you to apply cross-validation effectively in your own machine learning projects.</p><h2 id="faq">FAQ</h2><h3 id="what-is-k-fold-cross-validation-and-why-is-it-useful-in-object-detection">What is K-Fold Cross Validation and why is it useful in object detection?</h3><p>K-Fold Cross Validation is a technique where the dataset is divided into 'k' subsets (folds) to evaluate model performance more reliably. Each fold serves as both training and <a href="https://www.ultralytics.com/glossary/validation-data">validation data</a>. In the context of object detection, using K-Fold Cross Validation helps to ensure your Ultralytics YOLO model's performance is robust and generalizable across different data splits, enhancing its reliability. For detailed instructions on setting up K-Fold Cross Validation with Ultralytics YOLO, refer to <a href="#introduction">K-Fold Cross Validation with Ultralytics</a>.</p><h3 id="how-do-i-implement-k-fold-cross-validation-using-ultralytics-yolo">How do I implement K-Fold Cross Validation using Ultralytics YOLO?</h3><p>To implement K-Fold Cross Validation with Ultralytics YOLO, you need to follow these steps:</p><ol><li>Verify annotations are in the <a href="../../datasets/detect/">YOLO detection format</a>.</li><li>Use Python libraries like <code>sklearn</code>, <code>pandas</code>, and <code>pyyaml</code>.</li><li>Create feature vectors from your dataset.</li><li>Split your dataset using <code>KFold</code> from <code>sklearn.model_selection</code>.</li><li>Train the YOLO model on each split.</li></ol><p>For a comprehensive guide, see the <a href="#k-fold-dataset-split">K-Fold Dataset Split</a> section in our documentation.</p><h3 id="why-should-i-use-ultralytics-yolo-for-object-detection">Why should I use Ultralytics YOLO for object detection?</h3><p>Ultralytics YOLO offers state-of-the-art, real-time object detection with high <a href="https://www.ultralytics.com/glossary/accuracy">accuracy</a> and efficiency. It's versatile, supporting multiple <a href="https://www.ultralytics.com/glossary/computer-vision-cv">computer vision</a> tasks such as detection, segmentation, and classification. Additionally, it integrates seamlessly with tools like <a href="https://docs.ultralytics.com/hub/">Ultralytics HUB</a> for no-code model training and deployment. For more details, explore the benefits and features on our <a href="https://www.ultralytics.com/yolo">Ultralytics YOLO page</a>.</p><h3 id="how-can-i-ensure-my-annotations-are-in-the-correct-format-for-ultralytics-yolo">How can I ensure my annotations are in the correct format for Ultralytics YOLO?</h3><p>Your annotations should follow the YOLO detection format. Each annotation file must list the object class, alongside its <a href="https://www.ultralytics.com/glossary/bounding-box">bounding box</a> coordinates in the image. The YOLO format ensures streamlined and standardized data processing for training object detection models. For more information on proper annotation formatting, visit the <a href="../../datasets/detect/">YOLO detection format guide</a>.</p><h3 id="can-i-use-k-fold-cross-validation-with-custom-datasets-other-than-fruit-detection">Can I use K-Fold Cross Validation with custom datasets other than Fruit Detection?</h3><p>Yes, you can use K-Fold Cross Validation with any custom dataset as long as the annotations are in the YOLO detection format. Replace the dataset paths and class labels with those specific to your custom dataset. This flexibility ensures that any object detection project can benefit from robust model evaluation using K-Fold Cross Validation. For a practical example, review our <a href="#generating-feature-vectors-for-object-detection-dataset">Generating Feature Vectors</a> section.</p><br/><br/><div class="git-info"><div class="dates-container"><span class="date-item" title="This page was first created on November 12, 2023"><span class="hover-item">üìÖ</span> Created 2 years ago </span><span class="date-item" title="This page was last updated on December 12, 2025"><span class="hover-item">‚úèÔ∏è</span> Updated 13 days ago </span></div><div class="authors-container"><a class="author-link" href="https://github.com/glenn-jocher" title="glenn-jocher (15 changes)"><img alt="glenn-jocher" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/26833433?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/RizwanMunawar" title="RizwanMunawar (2 changes)"><img alt="RizwanMunawar" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62513924?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/pderrenger" title="pderrenger (1 change)"><img alt="pderrenger" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/107626595?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/ambitious-octopus" title="ambitious-octopus (1 change)"><img alt="ambitious-octopus" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/3855193?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/Y-T-G" title="Y-T-G (1 change)"><img alt="Y-T-G" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/32206511?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/ultralytics/ultralytics" title="willie.maddox@gmail.com (1 change)"><img alt="willie.maddox@gmail.com" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/9919?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/Burhan-Q" title="Burhan-Q (1 change)"><img alt="Burhan-Q" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62214284?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/M-Amrollahi" title="M-Amrollahi (1 change)"><img alt="M-Amrollahi" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/44016758?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/IvorZhu331" title="IvorZhu331 (1 change)"><img alt="IvorZhu331" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/130829914?v=4&amp;s=96"/></a></div></div><div class="share-buttons"><button class="share-button hover-item" onclick="window.open('https://twitter.com/intent/tweet?url=https%3A%2F%2Fdocs.ultralytics.com%2Fguides%2Fkfold-cross-validation%2F', 'TwitterShare', 'width=550,height=680,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-x-twitter"></i> Tweet </button><button class="share-button hover-item linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fdocs.ultralytics.com%2Fguides%2Fkfold-cross-validation%2F', 'LinkedinShare', 'width=550,height=730,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-linkedin-in"></i> Share </button></div><br/><h2 id="__comments">Comments</h2><div id="giscus-container"></div></article></div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div><button class="md-top md-icon" data-md-component="top" hidden="" type="button"><svg class="lucide lucide-circle-arrow-up" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10"></circle><path d="m16 12-4-4-4 4M12 16V8"></path></svg> Back to top
</button></main><footer class="md-footer"><nav aria-label="Footer" class="md-footer__inner md-grid"><a aria-label="Previous: Isolating Segmentation Objects" class="md-footer__link md-footer__link--prev" href="../isolating-segmentation-objects/"><div class="md-footer__button md-icon"><svg class="lucide lucide-arrow-left" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12 19-7-7 7-7M19 12H5"></path></svg></div><div class="md-footer__title"><span class="md-footer__direction"> Previous </span><div class="md-ellipsis"> Isolating Segmentation Objects </div></div></a><a aria-label="Next: Maintaining Your Computer Vision Model" class="md-footer__link md-footer__link--next" href="../model-monitoring-and-maintenance/"><div class="md-footer__title"><span class="md-footer__direction"> Next </span><div class="md-ellipsis"> Maintaining Your Computer Vision Model </div></div><div class="md-footer__button md-icon"><svg class="lucide lucide-arrow-right" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 12h14M12 5l7 7-7 7"></path></svg></div></a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-copyright"><div class="md-copyright__highlight"><a href="https://www.ultralytics.com/" target="_blank">¬© 2025 Ultralytics Inc.</a> All rights reserved. </div> Made with <a href="https://zensical.org/" rel="noopener" target="_blank"> Zensical </a></div><div class="md-social"><a class="md-social__link" href="https://github.com/ultralytics" rel="noopener" target="_blank" title="github.com"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://www.linkedin.com/company/ultralytics/" rel="noopener" target="_blank" title="www.linkedin.com"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://x.com/ultralytics" rel="noopener" target="_blank" title="x.com"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://youtube.com/ultralytics?sub_confirmation=1" rel="noopener" target="_blank" title="youtube.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://hub.docker.com/r/ultralytics/ultralytics/" rel="noopener" target="_blank" title="hub.docker.com"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://pypi.org/project/ultralytics/" rel="noopener" target="_blank" title="pypi.org"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://discord.com/invite/ultralytics" rel="noopener" target="_blank" title="discord.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://reddit.com/r/ultralytics" rel="noopener" target="_blank" title="reddit.com"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://weixin.qq.com/r/mp/LxckPDfEgWr_rXNf90I9" rel="noopener" target="_blank" title="weixin.qq.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6" fill="currentColor"></path></svg></a></div></div></div></footer></div><div class="md-dialog" data-md-component="dialog"><div class="md-dialog__inner md-typeset"></div></div><div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"annotate":null,"base":"../..","features":["content.action.edit","content.code.annotate","content.code.copy","content.tooltips","toc.follow","navigation.top","navigation.tabs","navigation.tabs.sticky","navigation.prune","navigation.footer","navigation.tracking","navigation.instant","navigation.instant.progress","navigation.indexes","navigation.sections","content.tabs.link"],"search":"../../assets/javascripts/workers/search.e2d2d235.min.js","tags":null,"translations":{"clipboard.copied":"Copied to clipboard","clipboard.copy":"Copy to clipboard","search.result.more.one":"1 more on this page","search.result.more.other":"# more on this page","search.result.none":"No matching documents","search.result.one":"1 matching document","search.result.other":"# matching documents","search.result.placeholder":"Type to start searching","search.result.term.missing":"Missing","select.version":"Select version"},"version":null}</script>
<script src="../../assets/javascripts/bundle.00c35305.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/ultralytics/llm@v0.1.8/js/chat.min.js"></script>
<script src="https://unpkg.com/tablesort@5.6.0/dist/tablesort.min.js"></script>
<script src="../../javascript/extra.js"></script>
<script src="../../javascript/giscus.js"></script>
<script src="../../javascript/tablesort.js"></script>
<script>
            async function copyMarkdownForLLM(button) {
                const editBtn = document.querySelector('a[title="Edit this page"]');
                if (!editBtn) return;

                const originalHTML = button.innerHTML;
                const checkIcon = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19L21 7l-1.41-1.41L9 16.17z"></path></svg>';

                let rawUrl = editBtn.href.replace('github.com', 'raw.githubusercontent.com');
                rawUrl = rawUrl.replace('/blob/', '/').replace('/tree/', '/');

                try {
                    const response = await fetch(rawUrl);
                    let markdown = await response.text();

                    if (markdown.startsWith('---')) {
                        const frontMatterEnd = markdown.indexOf('\n---\n', 3);
                        if (frontMatterEnd !== -1) {
                            markdown = markdown.substring(frontMatterEnd + 5).trim();
                        }
                    }

                    const title = document.querySelector('h1')?.textContent || document.title;
                    const content = `# ${title}\n\nSource: ${window.location.href}\n\n---\n\n${markdown}`;

                    await navigator.clipboard.writeText(content);
                    button.innerHTML = checkIcon + ' Copied!';
                    setTimeout(() => { button.innerHTML = originalHTML; }, 2000);
                } catch (err) {
                    button.innerHTML = '‚ùå Failed';
                    setTimeout(() => { button.innerHTML = originalHTML; }, 2000);
                }
            }
            </script></body></html>