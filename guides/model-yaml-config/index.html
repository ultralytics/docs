<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Learn how to structure and customize model architectures using Ultralytics YAML configuration files. Master module definitions, connections, and scaling parameters." name="description"/>
<meta content="Ultralytics" name="author"/>
<link href="https://docs.ultralytics.com/guides/model-yaml-config/" rel="canonical"/>
<link href="../model-deployment-options/" rel="prev"/>
<link href="../kfold-cross-validation/" rel="next"/>
<link href="https://raw.githubusercontent.com/ultralytics/assets/refs/heads/main/logo/favicon-yolo.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.22" name="generator"/>
<title>Model YAML Configuration Guide - Ultralytics YOLO Docs</title>
<link href="../../assets/stylesheets/main.84d31ad4.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../assets/_mkdocstrings.css" rel="stylesheet"/>
<link href="../../stylesheets/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2M5EHKC0BH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2M5EHKC0BH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2M5EHKC0BH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
<meta content="Model YAML Configuration Guide" name="title"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"/><meta content="Ultralytics, YOLO, model architecture, YAML configuration, neural networks, deep learning, backbone, head, modules, custom models" name="keywords"/><meta content="website" property="og:type"/><meta content="https://docs.ultralytics.com/guides/model-yaml-config" property="og:url"/><meta content="Model YAML Configuration Guide" property="og:title"/><meta content="Learn how to structure and customize model architectures using Ultralytics YAML configuration files. Master module definitions, connections, and scaling parameters." property="og:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="og:image"/><meta content="summary_large_image" property="twitter:card"/><meta content="https://docs.ultralytics.com/guides/model-yaml-config" property="twitter:url"/><meta content="Model YAML Configuration Guide" property="twitter:title"/><meta content="Learn how to structure and customize model architectures using Ultralytics YAML configuration files. Master module definitions, connections, and scaling parameters." property="twitter:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="twitter:image"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": ["Article", "FAQPage"], "headline": "Model YAML Configuration Guide", "image": ["https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png"], "datePublished": "2025-09-17 06:35:38 +0800", "dateModified": "2025-09-30 15:28:52 +0100", "author": [{"@type": "Organization", "name": "Ultralytics", "url": "https://ultralytics.com/"}], "abstract": "Learn how to structure and customize model architectures using Ultralytics YAML configuration files. Master module definitions, connections, and scaling parameters.", "mainEntity": [{"@type": "Question", "name": "How do I change the number of classes in my model?", "acceptedAnswer": {"@type": "Answer", "text": "Set the nc parameter at the top of your YAML file to match your dataset's number of classes."}}, {"@type": "Question", "name": "Can I use a custom backbone in my model YAML?", "acceptedAnswer": {"@type": "Answer", "text": "Yes. You can use any supported module, including TorchVision backbones, or define your own custom module and import it as described in Custom Module Integration."}}, {"@type": "Question", "name": "How do I scale my model for different sizes (nano, small, medium, etc.)?", "acceptedAnswer": {"@type": "Answer", "text": "Use the scales section in your YAML to define scaling factors for depth, width, and max channels. The model will automatically apply these when you load the base YAML file with the scale appended to the filename (e.g., yolo11n.yaml)."}}, {"@type": "Question", "name": "What does the [from, repeats, module, args] format mean?", "acceptedAnswer": {"@type": "Answer", "text": "This format specifies how each layer is constructed:"}}, {"@type": "Question", "name": "How do I troubleshoot channel mismatch errors?", "acceptedAnswer": {"@type": "Answer", "text": "Check that the output channels of one layer match the expected input channels of the next. Use print(model.model.model) to inspect your model's architecture."}}, {"@type": "Question", "name": "Where can I find a list of available modules and their arguments?", "acceptedAnswer": {"@type": "Answer", "text": "Check the source code in the ultralytics/nn/modules directory for all available modules and their arguments."}}, {"@type": "Question", "name": "How do I add a custom module to my YAML configuration?", "acceptedAnswer": {"@type": "Answer", "text": "Define your module in the source code, import it as shown in Source Code Modification, and reference it by name in your YAML file."}}, {"@type": "Question", "name": "Can I use pretrained weights with a custom YAML?", "acceptedAnswer": {"@type": "Answer", "text": "Yes, you can use model.load(\"path/to/weights\") to load weights from a pretrained checkpoint. However, only weights for layers that match would load successfully."}}, {"@type": "Question", "name": "How do I validate my model configuration?", "acceptedAnswer": {"@type": "Answer", "text": "Use model.info() to check whether FLOPs count is non-zero. A valid model should show non-zero FLOPs count. If it's zero, follow the suggestions in Debugging Tips to find the issue."}}]}</script></head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#model-yaml-configuration-guide">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
<aside class="md-banner">
<div class="md-banner__inner md-grid md-typeset">
<a class="banner-wrapper" href="https://www.ultralytics.com/events/yolovision" target="_blank">
<div class="banner-content-wrapper">
<p>Register now for</p>
<img alt="Ultralytics YOLO Vision" height="40" loading="lazy" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/6895ca9b3ece7244d9981ab9_yv25-logo.avif"/>
<p class="shenzhen-text">Shenzhen</p>
</div>
</a>
</div>
</aside>
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Ultralytics YOLO Docs" class="md-header__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs">
<img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Ultralytics YOLO Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
              Model YAML Configuration Guide
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<div class="md-header__option">
<div class="md-select">
<button aria-label="Select language" class="md-header__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"></path></svg>
</button>
<div class="md-select__inner">
<ul class="md-select__list">
<li class="md-select__item">
<a class="md-select__link" href="/" hreflang="en">
              🇬🇧 English
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/zh/" hreflang="zh">
              🇨🇳 简体中文
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/ko/" hreflang="ko">
              🇰🇷 한국어
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/ja/" hreflang="ja">
              🇯🇵 日本語
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/ru/" hreflang="ru">
              🇷🇺 Русский
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/de/" hreflang="de">
              🇩🇪 Deutsch
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/fr/" hreflang="fr">
              🇫🇷 Français
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/es/" hreflang="es">
              🇪🇸 Español
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/pt/" hreflang="pt">
              🇵🇹 Português
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/it/" hreflang="it">
              🇮🇹 Italiano
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/tr/" hreflang="tr">
              🇹🇷 Türkçe
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/vi/" hreflang="vi">
              🇻🇳 Tiếng Việt
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/ar/" hreflang="ar">
              🇸🇦 العربية
            </a>
</li>
</ul>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    ultralytics/ultralytics
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
  Home
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../quickstart/">
  Quickstart
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../modes/">
  Modes
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../tasks/">
  Tasks
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../models/">
  Models
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../datasets/">
  Datasets
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../solutions/">
  Solutions 🚀
        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../">
  Guides
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../integrations/">
  Integrations
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../hub/">
  HUB
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../reference/__init__/">
  Reference
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../help/">
  Help
        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Ultralytics YOLO Docs" class="md-nav__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs">
<img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/>
</a>
    Ultralytics YOLO Docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    ultralytics/ultralytics
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../quickstart/">
<span class="md-ellipsis">
    Quickstart
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../modes/">
<span class="md-ellipsis">
    Modes
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../tasks/">
<span class="md-ellipsis">
    Tasks
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../models/">
<span class="md-ellipsis">
    Models
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../datasets/">
<span class="md-ellipsis">
    Datasets
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../solutions/">
<span class="md-ellipsis">
    Solutions 🚀
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_8" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Guides
  </span>
</a>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            Guides
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../yolo-common-issues/">
<span class="md-ellipsis">
    YOLO Common Issues
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yolo-performance-metrics/">
<span class="md-ellipsis">
    YOLO Performance Metrics
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yolo-thread-safe-inference/">
<span class="md-ellipsis">
    YOLO Thread-Safe Inference
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yolo-data-augmentation/">
<span class="md-ellipsis">
    YOLO Data Augmentation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../model-deployment-options/">
<span class="md-ellipsis">
    Model Deployment Options
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Model YAML Configuration Guide
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Model YAML Configuration Guide
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#configuration-structure">
<span class="md-ellipsis">
      Configuration Structure
    </span>
</a>
<nav aria-label="Configuration Structure" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#parameters-section">
<span class="md-ellipsis">
      Parameters Section
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#backbone-and-head-architecture">
<span class="md-ellipsis">
      Backbone and Head Architecture
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#layer-specification-format">
<span class="md-ellipsis">
      Layer Specification Format
    </span>
</a>
<nav aria-label="Layer Specification Format" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#connection-patterns">
<span class="md-ellipsis">
      Connection Patterns
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#module-repetition">
<span class="md-ellipsis">
      Module Repetition
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#available-modules">
<span class="md-ellipsis">
      Available Modules
    </span>
</a>
<nav aria-label="Available Modules" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-operations">
<span class="md-ellipsis">
      Basic Operations
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#composite-blocks">
<span class="md-ellipsis">
      Composite Blocks
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#specialized-modules">
<span class="md-ellipsis">
      Specialized Modules
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#advanced-features">
<span class="md-ellipsis">
      Advanced Features
    </span>
</a>
<nav aria-label="Advanced Features" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#torchvision-integration">
<span class="md-ellipsis">
      TorchVision Integration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#index-module-for-feature-selection">
<span class="md-ellipsis">
      Index Module for Feature Selection
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#module-resolution-system">
<span class="md-ellipsis">
      Module Resolution System
    </span>
</a>
<nav aria-label="Module Resolution System" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#module-lookup-process">
<span class="md-ellipsis">
      Module Lookup Process
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#module-import-chain">
<span class="md-ellipsis">
      Module Import Chain
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-module-integration">
<span class="md-ellipsis">
      Custom Module Integration
    </span>
</a>
<nav aria-label="Custom Module Integration" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#source-code-modification">
<span class="md-ellipsis">
      Source Code Modification
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example-configurations">
<span class="md-ellipsis">
      Example Configurations
    </span>
</a>
<nav aria-label="Example Configurations" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-detection-model">
<span class="md-ellipsis">
      Basic Detection Model
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#torchvision-backbone-model">
<span class="md-ellipsis">
      TorchVision Backbone Model
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#classification-model">
<span class="md-ellipsis">
      Classification Model
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#best-practices">
<span class="md-ellipsis">
      Best Practices
    </span>
</a>
<nav aria-label="Best Practices" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#architecture-design-tips">
<span class="md-ellipsis">
      Architecture Design Tips
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-considerations">
<span class="md-ellipsis">
      Performance Considerations
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#troubleshooting">
<span class="md-ellipsis">
      Troubleshooting
    </span>
</a>
<nav aria-label="Troubleshooting" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#common-issues">
<span class="md-ellipsis">
      Common Issues
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#debugging-tips">
<span class="md-ellipsis">
      Debugging Tips
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#faq">
<span class="md-ellipsis">
      FAQ
    </span>
</a>
<nav aria-label="FAQ" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#how-do-i-change-the-number-of-classes-in-my-model">
<span class="md-ellipsis">
      How do I change the number of classes in my model?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#can-i-use-a-custom-backbone-in-my-model-yaml">
<span class="md-ellipsis">
      Can I use a custom backbone in my model YAML?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-do-i-scale-my-model-for-different-sizes-nano-small-medium-etc">
<span class="md-ellipsis">
      How do I scale my model for different sizes (nano, small, medium, etc.)?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-does-the-from-repeats-module-args-format-mean">
<span class="md-ellipsis">
      What does the [from, repeats, module, args] format mean?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-do-i-troubleshoot-channel-mismatch-errors">
<span class="md-ellipsis">
      How do I troubleshoot channel mismatch errors?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#where-can-i-find-a-list-of-available-modules-and-their-arguments">
<span class="md-ellipsis">
      Where can I find a list of available modules and their arguments?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-do-i-add-a-custom-module-to-my-yaml-configuration">
<span class="md-ellipsis">
      How do I add a custom module to my YAML configuration?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#can-i-use-pretrained-weights-with-a-custom-yaml">
<span class="md-ellipsis">
      Can I use pretrained weights with a custom YAML?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-do-i-validate-my-model-configuration">
<span class="md-ellipsis">
      How do I validate my model configuration?
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../kfold-cross-validation/">
<span class="md-ellipsis">
    K-Fold Cross Validation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hyperparameter-tuning/">
<span class="md-ellipsis">
    Hyperparameter Tuning
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sahi-tiled-inference/">
<span class="md-ellipsis">
    SAHI Tiled Inference
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../azureml-quickstart/">
<span class="md-ellipsis">
    AzureML Quickstart
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../conda-quickstart/">
<span class="md-ellipsis">
    Conda Quickstart
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../docker-quickstart/">
<span class="md-ellipsis">
    Docker Quickstart
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../raspberry-pi/">
<span class="md-ellipsis">
    Raspberry Pi
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../nvidia-jetson/">
<span class="md-ellipsis">
    NVIDIA Jetson
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../deepstream-nvidia-jetson/">
<span class="md-ellipsis">
    DeepStream on NVIDIA Jetson
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../triton-inference-server/">
<span class="md-ellipsis">
    Triton Inference Server
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../isolating-segmentation-objects/">
<span class="md-ellipsis">
    Isolating Segmentation Objects
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../coral-edge-tpu-on-raspberry-pi/">
<span class="md-ellipsis">
    Edge TPU on Raspberry Pi
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../view-results-in-terminal/">
<span class="md-ellipsis">
    Viewing Inference Images in a Terminal
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../optimizing-openvino-latency-vs-throughput-modes/">
<span class="md-ellipsis">
    OpenVINO Latency vs Throughput modes
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ros-quickstart/">
<span class="md-ellipsis">
    ROS Quickstart
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../steps-of-a-cv-project/">
<span class="md-ellipsis">
    Steps of a Computer Vision Project
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../defining-project-goals/">
<span class="md-ellipsis">
    Defining A Computer Vision Project's Goals
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../data-collection-and-annotation/">
<span class="md-ellipsis">
    Data Collection and Annotation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../preprocessing_annotated_data/">
<span class="md-ellipsis">
    Preprocessing Annotated Data
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../model-training-tips/">
<span class="md-ellipsis">
    Tips for Model Training
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../model-evaluation-insights/">
<span class="md-ellipsis">
    Insights on Model Evaluation and Fine-Tuning
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../model-testing/">
<span class="md-ellipsis">
    A Guide on Model Testing
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../model-deployment-practices/">
<span class="md-ellipsis">
    Best Practices for Model Deployment
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../model-monitoring-and-maintenance/">
<span class="md-ellipsis">
    Maintaining Your Computer Vision Model
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../vertex-ai-deployment-with-docker/">
<span class="md-ellipsis">
    Deploying YOLO on Vertex AI in Docker container
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_8_33" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../datasets/explorer/">
<span class="md-ellipsis">
    Explorer
  </span>
</a>
<label class="md-nav__link" for="__nav_8_33" id="__nav_8_33_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_33_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_8_33">
<span class="md-nav__icon md-icon"></span>
            Explorer
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../datasets/explorer/api/">
<span class="md-ellipsis">
    Explorer API
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../datasets/explorer/dashboard/">
<span class="md-ellipsis">
    Explorer Dashboard Demo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../datasets/explorer/explorer/">
<span class="md-ellipsis">
    VOC Exploration Example
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_8_34" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../yolov5/">
<span class="md-ellipsis">
    YOLOv5
  </span>
</a>
<label class="md-nav__link" for="__nav_8_34" id="__nav_8_34_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_34_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_8_34">
<span class="md-nav__icon md-icon"></span>
            YOLOv5
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../yolov5/quickstart_tutorial/">
<span class="md-ellipsis">
    Quickstart
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../yolov5/environments/aws_quickstart_tutorial/">
<span class="md-ellipsis">
    Environments
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../yolov5/tutorials/train_custom_data/">
<span class="md-ellipsis">
    Tutorials
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../integrations/">
<span class="md-ellipsis">
    Integrations
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../hub/">
<span class="md-ellipsis">
    HUB
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../reference/__init__/">
<span class="md-ellipsis">
    Reference
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../help/">
<span class="md-ellipsis">
    Help
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#configuration-structure">
<span class="md-ellipsis">
      Configuration Structure
    </span>
</a>
<nav aria-label="Configuration Structure" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#parameters-section">
<span class="md-ellipsis">
      Parameters Section
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#backbone-and-head-architecture">
<span class="md-ellipsis">
      Backbone and Head Architecture
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#layer-specification-format">
<span class="md-ellipsis">
      Layer Specification Format
    </span>
</a>
<nav aria-label="Layer Specification Format" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#connection-patterns">
<span class="md-ellipsis">
      Connection Patterns
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#module-repetition">
<span class="md-ellipsis">
      Module Repetition
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#available-modules">
<span class="md-ellipsis">
      Available Modules
    </span>
</a>
<nav aria-label="Available Modules" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-operations">
<span class="md-ellipsis">
      Basic Operations
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#composite-blocks">
<span class="md-ellipsis">
      Composite Blocks
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#specialized-modules">
<span class="md-ellipsis">
      Specialized Modules
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#advanced-features">
<span class="md-ellipsis">
      Advanced Features
    </span>
</a>
<nav aria-label="Advanced Features" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#torchvision-integration">
<span class="md-ellipsis">
      TorchVision Integration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#index-module-for-feature-selection">
<span class="md-ellipsis">
      Index Module for Feature Selection
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#module-resolution-system">
<span class="md-ellipsis">
      Module Resolution System
    </span>
</a>
<nav aria-label="Module Resolution System" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#module-lookup-process">
<span class="md-ellipsis">
      Module Lookup Process
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#module-import-chain">
<span class="md-ellipsis">
      Module Import Chain
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-module-integration">
<span class="md-ellipsis">
      Custom Module Integration
    </span>
</a>
<nav aria-label="Custom Module Integration" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#source-code-modification">
<span class="md-ellipsis">
      Source Code Modification
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example-configurations">
<span class="md-ellipsis">
      Example Configurations
    </span>
</a>
<nav aria-label="Example Configurations" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-detection-model">
<span class="md-ellipsis">
      Basic Detection Model
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#torchvision-backbone-model">
<span class="md-ellipsis">
      TorchVision Backbone Model
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#classification-model">
<span class="md-ellipsis">
      Classification Model
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#best-practices">
<span class="md-ellipsis">
      Best Practices
    </span>
</a>
<nav aria-label="Best Practices" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#architecture-design-tips">
<span class="md-ellipsis">
      Architecture Design Tips
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-considerations">
<span class="md-ellipsis">
      Performance Considerations
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#troubleshooting">
<span class="md-ellipsis">
      Troubleshooting
    </span>
</a>
<nav aria-label="Troubleshooting" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#common-issues">
<span class="md-ellipsis">
      Common Issues
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#debugging-tips">
<span class="md-ellipsis">
      Debugging Tips
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#faq">
<span class="md-ellipsis">
      FAQ
    </span>
</a>
<nav aria-label="FAQ" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#how-do-i-change-the-number-of-classes-in-my-model">
<span class="md-ellipsis">
      How do I change the number of classes in my model?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#can-i-use-a-custom-backbone-in-my-model-yaml">
<span class="md-ellipsis">
      Can I use a custom backbone in my model YAML?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-do-i-scale-my-model-for-different-sizes-nano-small-medium-etc">
<span class="md-ellipsis">
      How do I scale my model for different sizes (nano, small, medium, etc.)?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-does-the-from-repeats-module-args-format-mean">
<span class="md-ellipsis">
      What does the [from, repeats, module, args] format mean?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-do-i-troubleshoot-channel-mismatch-errors">
<span class="md-ellipsis">
      How do I troubleshoot channel mismatch errors?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#where-can-i-find-a-list-of-available-modules-and-their-arguments">
<span class="md-ellipsis">
      Where can I find a list of available modules and their arguments?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-do-i-add-a-custom-module-to-my-yaml-configuration">
<span class="md-ellipsis">
      How do I add a custom module to my YAML configuration?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#can-i-use-pretrained-weights-with-a-custom-yaml">
<span class="md-ellipsis">
      Can I use pretrained weights with a custom YAML?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-do-i-validate-my-model-configuration">
<span class="md-ellipsis">
      How do I validate my model configuration?
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/ultralytics/ultralytics/tree/main/docs/en/guides/model-yaml-config.md" rel="edit" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
</a><a class="md-content__button md-icon" href="javascript:void(0)" onclick="copyMarkdownForLLM(this); return false;" title="Copy page in Markdown format"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg></a>
<h1 id="model-yaml-configuration-guide">Model YAML Configuration Guide</h1>
<p>The model YAML configuration file serves as the architectural blueprint for Ultralytics neural networks. It defines how layers connect, what parameters each module uses, and how the entire network scales across different model sizes.</p>
<h2 id="configuration-structure">Configuration Structure</h2>
<p>Model YAML files are organized into three main sections that work together to define the architecture.</p>
<h3 id="parameters-section">Parameters Section</h3>
<p>The <strong>parameters</strong> section specifies the model's global characteristics and scaling behavior:</p>
<div class="highlight"><pre><span></span><code><span></span><span class="c1"># Parameters</span>
<span></span><span class="nt">nc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span><span class="w"> </span><span class="c1"># number of classes</span>
<span></span><span class="nt">scales</span><span class="p">:</span><span class="w"> </span><span class="c1"># compound scaling constants [depth, width, max_channels]</span>
<span></span><span class="w">    </span><span class="nt">n</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.50</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.25</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1024</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># nano: shallow layers, narrow channels</span>
<span></span><span class="w">    </span><span class="nt">s</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.50</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.50</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1024</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># small: shallow depth, standard width</span>
<span></span><span class="w">    </span><span class="nt">m</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.50</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1.00</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">512</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># medium: moderate depth, full width</span>
<span></span><span class="w">    </span><span class="nt">l</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1.00</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1.00</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">512</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># large: full depth and width</span>
<span></span><span class="w">    </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1.00</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1.50</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">512</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># extra-large: maximum performance</span>
<span></span><span class="nt">kpt_shape</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">17</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># pose models only</span>
</code></pre></div>
<ul>
<li><code>nc</code> sets the number of classes the model predicts.</li>
<li><code>scales</code> define compound scaling factors that adjust model depth, width, and maximum channels to produce different size variants (nano through extra-large).</li>
<li><code>kpt_shape</code> applies to pose models. It can be <code>[N, 2]</code> for <code>(x, y)</code> keypoints or <code>[N, 3]</code> for <code>(x, y, visibility)</code>.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Reduce redundancy with <code>scales</code></p>
<p>The <code>scales</code> parameter lets you generate multiple model sizes from a single base YAML. For instance, when you load <code>yolo11n.yaml</code>, Ultralytics reads the base <code>yolo11.yaml</code> and applies the <code>n</code> scaling factors (<code>depth=0.50</code>, <code>width=0.25</code>) to build the nano variant.</p>
</div>
<div class="admonition note">
<p class="admonition-title"><code>nc</code> and <code>kpt_shape</code> are dataset-dependent</p>
<p>If your dataset specifies a different <code>nc</code> or <code>kpt_shape</code>, Ultralytics will automatically override the model config at runtime to match the dataset YAML.</p>
</div>
<h3 id="backbone-and-head-architecture">Backbone and Head Architecture</h3>
<p>The model architecture consists of backbone (feature extraction) and head (task-specific) sections:</p>
<div class="highlight"><pre><span></span><code><span></span><span class="nt">backbone</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="c1"># [from, repeats, module, args]</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Conv</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">64</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 0: Initial convolution</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Conv</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">128</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 1: Downsample</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">C2f</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">128</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">True</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 2: Feature processing</span>
<span></span>
<span></span><span class="nt">head</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">nn.Upsample</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">None</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">nearest</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 6: Upsample</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Concat</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 7: Skip connection</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">C2f</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">256</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 8: Process features</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">8</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Detect</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">nc</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 9: Detection layer</span>
</code></pre></div>
<h2 id="layer-specification-format">Layer Specification Format</h2>
<p>Every layer follows the consistent pattern: <strong><code>[from, repeats, module, args]</code></strong></p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Purpose</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>from</strong></td>
<td>Input connections</td>
<td><code>-1</code> (previous), <code>6</code> (layer 6), <code>[4, 6, 8]</code> (multi-input)</td>
</tr>
<tr>
<td><strong>repeats</strong></td>
<td>Number of repetitions</td>
<td><code>1</code> (single), <code>3</code> (repeat 3 times)</td>
</tr>
<tr>
<td><strong>module</strong></td>
<td>Module type</td>
<td><code>Conv</code>, <code>C2f</code>, <code>TorchVision</code>, <code>Detect</code></td>
</tr>
<tr>
<td><strong>args</strong></td>
<td>Module arguments</td>
<td><code>[64, 3, 2]</code> (channels, kernel, stride)</td>
</tr>
</tbody>
</table>
<h3 id="connection-patterns">Connection Patterns</h3>
<p>The <code>from</code> field creates flexible data flow patterns throughout your network:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="sequential-flow" name="__tabbed_1" type="radio"/><input id="skip-connections" name="__tabbed_1" type="radio"/><input id="multi-input-fusion" name="__tabbed_1" type="radio"/><div class="tabbed-labels"><label for="sequential-flow">Sequential Flow</label><label for="skip-connections">Skip Connections</label><label for="multi-input-fusion">Multi-Input Fusion</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Conv</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">64</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">]]</span><span class="w">    </span><span class="c1"># Takes input from previous layer</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Concat</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">]]</span><span class="w">    </span><span class="c1"># Combines current layer with layer 6</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">4</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Detect</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">nc</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># Detection head using 3 feature scales</span>
</code></pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Layer Indexing</p>
<p>Layers are indexed starting from 0. Negative indices reference previous layers (<code>-1</code> = previous layer), while positive indices reference specific layers by their position.</p>
</div>
<h3 id="module-repetition">Module Repetition</h3>
<p>The <code>repeats</code> parameter creates deeper network sections:</p>
<div class="highlight"><pre><span></span><code><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">C2f</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">128</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">True</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># Creates 3 consecutive C2f blocks</span>
<span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Conv</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">64</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># Single convolution layer</span>
</code></pre></div>
<p>The actual repetition count gets multiplied by the depth scaling factor from your model size configuration.</p>
<h2 id="available-modules">Available Modules</h2>
<p>Modules are organized by functionality and defined in the <a href="https://github.com/ultralytics/ultralytics/tree/main/ultralytics/nn/modules">Ultralytics modules directory</a>. The following tables show commonly used modules by category, with many more available in the source code:</p>
<h3 id="basic-operations">Basic Operations</h3>
<table>
<thead>
<tr>
<th>Module</th>
<th>Purpose</th>
<th>Source</th>
<th>Arguments</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Conv</code></td>
<td>Convolution + BatchNorm + Activation</td>
<td><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/nn/modules/conv.py">conv.py</a></td>
<td><code>[out_ch, kernel, stride, pad, groups]</code></td>
</tr>
<tr>
<td><code>nn.Upsample</code></td>
<td>Spatial upsampling</td>
<td><a href="https://pytorch.org/docs/stable/generated/torch.nn.Upsample.html">PyTorch</a></td>
<td><code>[size, scale_factor, mode]</code></td>
</tr>
<tr>
<td><code>nn.Identity</code></td>
<td>Pass-through operation</td>
<td><a href="https://pytorch.org/docs/stable/generated/torch.nn.Identity.html">PyTorch</a></td>
<td><code>[]</code></td>
</tr>
</tbody>
</table>
<h3 id="composite-blocks">Composite Blocks</h3>
<table>
<thead>
<tr>
<th>Module</th>
<th>Purpose</th>
<th>Source</th>
<th>Arguments</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C2f</code></td>
<td>CSP bottleneck with 2 convolutions</td>
<td><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/nn/modules/block.py">block.py</a></td>
<td><code>[out_ch, shortcut, expansion]</code></td>
</tr>
<tr>
<td><code>SPPF</code></td>
<td>Spatial Pyramid Pooling (fast)</td>
<td><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/nn/modules/block.py">block.py</a></td>
<td><code>[out_ch, kernel_size]</code></td>
</tr>
<tr>
<td><code>Concat</code></td>
<td>Channel-wise concatenation</td>
<td><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/nn/modules/conv.py">conv.py</a></td>
<td><code>[dimension]</code></td>
</tr>
</tbody>
</table>
<h3 id="specialized-modules">Specialized Modules</h3>
<table>
<thead>
<tr>
<th>Module</th>
<th>Purpose</th>
<th>Source</th>
<th>Arguments</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>TorchVision</code></td>
<td>Load any torchvision model</td>
<td><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/nn/modules/block.py">block.py</a></td>
<td><code>[out_ch, model_name, weights, unwrap, truncate, split]</code></td>
</tr>
<tr>
<td><code>Index</code></td>
<td>Extract specific tensor from list</td>
<td><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/nn/modules/block.py">block.py</a></td>
<td><code>[out_ch, index]</code></td>
</tr>
<tr>
<td><code>Detect</code></td>
<td>YOLO detection head</td>
<td><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/nn/modules/head.py">head.py</a></td>
<td><code>[nc, anchors, ch]</code></td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Complete Module List</p>
<p>This represents a subset of available modules. For the full list of modules and their parameters, explore the <a href="https://github.com/ultralytics/ultralytics/tree/main/ultralytics/nn/modules">modules directory</a>.</p>
</div>
<h2 id="advanced-features">Advanced Features</h2>
<h3 id="torchvision-integration">TorchVision Integration</h3>
<p>The TorchVision module enables seamless integration of any <a href="https://pytorch.org/vision/stable/models.html">TorchVision model</a> as a backbone:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="python" name="__tabbed_2" type="radio"/><input id="yaml-configuration" name="__tabbed_2" type="radio"/><div class="tabbed-labels"><label for="python">Python</label><label for="yaml-configuration">YAML Configuration</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">YOLO</span>
<span></span>
<span></span><span class="c1"># Model with ConvNeXt backbone</span>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="s2">"convnext_backbone.yaml"</span><span class="p">)</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s2">"coco8.yaml"</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span></span><span class="nt">backbone</span><span class="p">:</span>
<span></span><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">TorchVision</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">768</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">convnext_tiny</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">DEFAULT</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">True</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">False</span><span class="p p-Indicator">]]</span>
<span></span><span class="nt">head</span><span class="p">:</span>
<span></span><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Classify</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">nc</span><span class="p p-Indicator">]]</span>
</code></pre></div>
<p><strong>Parameter Breakdown:</strong></p>
<ul>
<li><code>768</code>: Expected output channels</li>
<li><code>convnext_tiny</code>: Model architecture (<a href="https://pytorch.org/vision/stable/models.html">available models</a>)</li>
<li><code>DEFAULT</code>: Use pretrained weights</li>
<li><code>True</code>: Remove classification head</li>
<li><code>2</code>: Truncate last 2 layers</li>
<li><code>False</code>: Return single tensor (not list)</li>
</ul>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Multi-Scale Features</p>
<p>Set the last parameter to <code>True</code> to get intermediate feature maps for multi-scale detection.</p>
</div>
<h3 id="index-module-for-feature-selection">Index Module for Feature Selection</h3>
<p>When using models that output multiple feature maps, the Index module selects specific outputs:</p>
<div class="highlight"><pre><span></span><code><span></span><span class="nt">backbone</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">TorchVision</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">768</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">convnext_tiny</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">DEFAULT</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">True</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">True</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># Multi-output</span>
<span></span><span class="nt">head</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Index</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">192</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># Select 4th feature map (192 channels)</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Index</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">384</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># Select 6th feature map (384 channels)</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Index</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">768</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># Select 8th feature map (768 channels)</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Detect</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">nc</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># Multi-scale detection</span>
</code></pre></div>
<h2 id="module-resolution-system">Module Resolution System</h2>
<p>Understanding how Ultralytics locates and imports modules is crucial for customization:</p>
<h3 id="module-lookup-process">Module Lookup Process</h3>
<p>Ultralytics uses a three-tier system in <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/nn/tasks.py"><code>parse_model</code></a>:</p>
<div class="highlight"><pre><span></span><code><span></span><span class="c1"># Core resolution logic</span>
<span></span><span class="n">m</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span> <span class="k">if</span> <span class="s2">"nn."</span> <span class="ow">in</span> <span class="n">m</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">torchvision</span><span class="o">.</span><span class="n">ops</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="mi">4</span><span class="p">:])</span> <span class="k">if</span> <span class="s2">"ops."</span> <span class="ow">in</span> <span class="n">m</span> <span class="k">else</span> <span class="nb">globals</span><span class="p">()[</span><span class="n">m</span><span class="p">]</span>
</code></pre></div>
<ol>
<li><strong>PyTorch modules</strong>: Names starting with <code>'nn.'</code> → <code>torch.nn</code> namespace</li>
<li><strong>TorchVision operations</strong>: Names starting with <code>'ops.'</code> → <code>torchvision.ops</code> namespace</li>
<li><strong>Ultralytics modules</strong>: All other names → global namespace via imports</li>
</ol>
<h3 id="module-import-chain">Module Import Chain</h3>
<p>Standard modules become available through imports in <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/nn/tasks.py"><code>tasks.py</code></a>:</p>
<div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.nn.modules</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>  <span class="c1"># noqa: F401, E501</span>
<span></span>    <span class="n">SPPF</span><span class="p">,</span>
<span></span>    <span class="n">C2f</span><span class="p">,</span>
<span></span>    <span class="n">Conv</span><span class="p">,</span>
<span></span>    <span class="n">Detect</span><span class="p">,</span>
<span></span>    <span class="c1"># ... many more modules</span>
<span></span>    <span class="n">Index</span><span class="p">,</span>
<span></span>    <span class="n">TorchVision</span><span class="p">,</span>
<span></span><span class="p">)</span>
</code></pre></div>
<h2 id="custom-module-integration">Custom Module Integration</h2>
<h3 id="source-code-modification">Source Code Modification</h3>
<p>Modifying the source code is the most versatile way to integrate your custom modules, but it can be tricky. To define and use a custom module, follow these steps:</p>
<ol>
<li>
<p><strong>Install Ultralytics in development mode</strong> using the Git clone method from the <a href="https://docs.ultralytics.com/quickstart#git-clone">Quickstart guide</a>.</p>
</li>
<li>
<p><strong>Define your module</strong> in <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/nn/modules/block.py"><code>ultralytics/nn/modules/block.py</code></a>:</p>
<div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CustomBlock</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Custom block with Conv-BatchNorm-ReLU sequence."""</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">):</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize CustomBlock with input and output channels."""</span>
<span></span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">(</span><span class="n">c2</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">())</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span></span><span class="w">        </span><span class="sd">"""Forward pass through the block."""</span>
<span></span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><strong>Expose your module at the package level</strong> in <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/nn/modules/__init__.py"><code>ultralytics/nn/modules/__init__.py</code></a>:</p>
<div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">.block</span><span class="w"> </span><span class="kn">import</span> <span class="n">CustomBlock</span>  <span class="c1"># noqa makes CustomBlock available as ultralytics.nn.modules.CustomBlock</span>
</code></pre></div>
</li>
<li>
<p><strong>Add to imports</strong> in <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/nn/tasks.py"><code>ultralytics/nn/tasks.py</code></a>:</p>
<div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.nn.modules</span><span class="w"> </span><span class="kn">import</span> <span class="n">CustomBlock</span>  <span class="c1"># noqa</span>
</code></pre></div>
</li>
<li>
<p><strong>Handle special arguments</strong> (if needed) inside <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/nn/tasks.py"><code>parse_model()</code></a> in <code>ultralytics/nn/tasks.py</code>:</p>
<div class="highlight"><pre><span></span><code><span></span><span class="c1"># Add this condition in the parse_model() function</span>
<span></span><span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="n">CustomBlock</span><span class="p">:</span>
<span></span>    <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">ch</span><span class="p">[</span><span class="n">f</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># input channels, output channels</span>
<span></span>    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
</code></pre></div>
</li>
<li>
<p><strong>Use the module</strong> in your model YAML:</p>
<div class="highlight"><pre><span></span><code><span></span><span class="c1"># custom_model.yaml</span>
<span></span><span class="nt">nc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span></span><span class="nt">backbone</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">CustomBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">64</span><span class="p p-Indicator">]]</span>
<span></span><span class="nt">head</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Classify</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">nc</span><span class="p p-Indicator">]]</span>
</code></pre></div>
</li>
<li>
<p><strong>Check FLOPs</strong> to ensure the forward pass works:</p>
<div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">YOLO</span>
<span></span>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="s2">"custom_model.yaml"</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">"classify"</span><span class="p">)</span>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>  <span class="c1"># should print non-zero FLOPs if working</span>
</code></pre></div>
</li>
</ol>
<h2 id="example-configurations">Example Configurations</h2>
<h3 id="basic-detection-model">Basic Detection Model</h3>
<div class="highlight"><pre><span></span><code><span></span><span class="c1"># Simple YOLO detection model</span>
<span></span><span class="nt">nc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span></span><span class="nt">scales</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="nt">n</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.33</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.25</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1024</span><span class="p p-Indicator">]</span>
<span></span>
<span></span><span class="nt">backbone</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Conv</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">64</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 0-P1/2</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Conv</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">128</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 1-P2/4</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">C2f</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">128</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">True</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 2</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Conv</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">256</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 3-P3/8</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">C2f</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">256</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">True</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 4</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">SPPF</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">256</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 5</span>
<span></span>
<span></span><span class="nt">head</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Conv</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">256</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 6</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">6</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Detect</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">nc</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># 7</span>
</code></pre></div>
<h3 id="torchvision-backbone-model">TorchVision Backbone Model</h3>
<div class="highlight"><pre><span></span><code><span></span><span class="c1"># ConvNeXt backbone with YOLO head</span>
<span></span><span class="nt">nc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span></span>
<span></span><span class="nt">backbone</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">TorchVision</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">768</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">convnext_tiny</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">DEFAULT</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">True</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">True</span><span class="p p-Indicator">]]</span>
<span></span>
<span></span><span class="nt">head</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Index</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">192</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># P3 features</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Index</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">384</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># P4 features</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Index</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">768</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># P5 features</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Detect</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">nc</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># Multi-scale detection</span>
</code></pre></div>
<h3 id="classification-model">Classification Model</h3>
<div class="highlight"><pre><span></span><code><span></span><span class="c1"># Simple classification model</span>
<span></span><span class="nt">nc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span></span>
<span></span><span class="nt">backbone</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Conv</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">64</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">7</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">]]</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">nn.MaxPool2d</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">]]</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">C2f</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">64</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">True</span><span class="p p-Indicator">]]</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Conv</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">128</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">]]</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">C2f</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">128</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">True</span><span class="p p-Indicator">]]</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">nn.AdaptiveAvgPool2d</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">]]</span>
<span></span>
<span></span><span class="nt">head</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Classify</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">nc</span><span class="p p-Indicator">]]</span>
</code></pre></div>
<h2 id="best-practices">Best Practices</h2>
<h3 id="architecture-design-tips">Architecture Design Tips</h3>
<p><strong>Start Simple</strong>: Begin with proven architectures before customizing. Use existing YOLO configurations as templates and modify incrementally rather than building from scratch.</p>
<p><strong>Test Incrementally</strong>: Validate each modification step-by-step. Add one custom module at a time and verify it works before proceeding to the next change.</p>
<p><strong>Monitor Channels</strong>: Ensure channel dimensions match between connected layers. The output channels (<code>c2</code>) of one layer must match the input channels (<code>c1</code>) of the next layer in the sequence.</p>
<p><strong>Use Skip Connections</strong>: Leverage feature reuse with <code>[[-1, N], 1, Concat, [1]]</code> patterns. These connections help with gradient flow and allow the model to combine features from different scales.</p>
<p><strong>Scale Appropriately</strong>: Choose model scales based on your computational constraints. Use nano (<code>n</code>) for edge devices, small (<code>s</code>) for balanced performance, and larger scales (<code>m</code>, <code>l</code>, <code>x</code>) for maximum accuracy.</p>
<h3 id="performance-considerations">Performance Considerations</h3>
<p><strong>Depth vs Width</strong>: Deep networks capture complex hierarchical features through multiple transformation layers, while wide networks process more information in parallel at each layer. Balance these based on your task complexity.</p>
<p><strong>Skip Connections</strong>: Improve gradient flow during training and enable feature reuse throughout the network. They're particularly important in deeper architectures to prevent vanishing gradients.</p>
<p><strong>Bottleneck Blocks</strong>: Reduce computational cost while maintaining model expressiveness. Modules like <code>C2f</code> use fewer parameters than standard convolutions while preserving feature learning capacity.</p>
<p><strong>Multi-Scale Features</strong>: Essential for detecting objects at different sizes in the same image. Use Feature Pyramid Network (FPN) patterns with multiple detection heads at different scales.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<table>
<thead>
<tr>
<th>Problem</th>
<th>Cause</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>KeyError: 'ModuleName'</code></td>
<td>Module not imported</td>
<td>Add to <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/nn/tasks.py"><code>tasks.py</code></a> imports</td>
</tr>
<tr>
<td>Channel dimension mismatch</td>
<td>Incorrect <code>args</code> specification</td>
<td>Verify input/output channel compatibility</td>
</tr>
<tr>
<td><code>AttributeError: 'int' object has no attribute</code></td>
<td>Wrong argument type</td>
<td>Check module documentation for correct argument types</td>
</tr>
<tr>
<td>Model fails to build</td>
<td>Invalid <code>from</code> reference</td>
<td>Ensure referenced layers exist</td>
</tr>
</tbody>
</table>
<h3 id="debugging-tips">Debugging Tips</h3>
<p>When developing custom architectures, systematic debugging helps identify issues early:</p>
<p><strong>Use Identity Head for Testing</strong></p>
<p>Replace complex heads with <code>nn.Identity</code> to isolate backbone issues:</p>
<div class="highlight"><pre><span></span><code><span></span><span class="nt">nc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span></span><span class="nt">backbone</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">CustomBlock</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">64</span><span class="p p-Indicator">]]</span>
<span></span><span class="nt">head</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">nn.Identity</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">[]]</span><span class="w"> </span><span class="c1"># Pass-through for debugging</span>
</code></pre></div>
<p>This allows direct inspection of backbone outputs:</p>
<div class="highlight"><pre><span></span><code><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span></span>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">YOLO</span>
<span></span>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="s2">"debug_model.yaml"</span><span class="p">)</span>
<span></span><span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">))</span>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Output shape: </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># Should match expected dimensions</span>
</code></pre></div>
<p><strong>Model Architecture Inspection</strong></p>
<p>Checking the FLOPs count and printing out each layer can also help debug issues with your custom model config. FLOPs count should be non-zero for a valid model. If it's zero, then there's likely an issue with the forward pass. Running a simple forward pass should show the exact error being encountered.</p>
<div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">YOLO</span>
<span></span>
<span></span><span class="c1"># Build model with verbose output to see layer details</span>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="s2">"debug_model.yaml"</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>
<span></span><span class="c1"># Check model FLOPs. Failed forward pass causes 0 FLOPs.</span>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span></span>
<span></span><span class="c1"># Inspect individual layers</span>
<span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">):</span>
<span></span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Layer </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">layer</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<p><strong>Step-by-Step Validation</strong></p>
<ol>
<li><strong>Start minimal</strong>: Test with simplest possible architecture first</li>
<li><strong>Add incrementally</strong>: Build complexity layer by layer</li>
<li><strong>Check dimensions</strong>: Verify channel and spatial size compatibility</li>
<li><strong>Validate scaling</strong>: Test with different model scales (<code>n</code>, <code>s</code>, <code>m</code>)</li>
</ol>
<h2 id="faq">FAQ</h2>
<h3 id="how-do-i-change-the-number-of-classes-in-my-model">How do I change the number of classes in my model?</h3>
<p>Set the <code>nc</code> parameter at the top of your YAML file to match your dataset's number of classes.</p>
<div class="highlight"><pre><span></span><code><span></span><span class="nt">nc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span><span class="w"> </span><span class="c1"># 5 classes</span>
</code></pre></div>
<h3 id="can-i-use-a-custom-backbone-in-my-model-yaml">Can I use a custom backbone in my model YAML?</h3>
<p>Yes. You can use any supported module, including TorchVision backbones, or define your own custom module and import it as described in <a href="#custom-module-integration">Custom Module Integration</a>.</p>
<h3 id="how-do-i-scale-my-model-for-different-sizes-nano-small-medium-etc">How do I scale my model for different sizes (nano, small, medium, etc.)?</h3>
<p>Use the <a href="#parameters-section"><code>scales</code> section</a> in your YAML to define scaling factors for depth, width, and max channels. The model will automatically apply these when you load the base YAML file with the scale appended to the filename (e.g., <code>yolo11n.yaml</code>).</p>
<h3 id="what-does-the-from-repeats-module-args-format-mean">What does the <code>[from, repeats, module, args]</code> format mean?</h3>
<p>This format specifies how each layer is constructed:</p>
<ul>
<li><code>from</code>: input source(s)</li>
<li><code>repeats</code>: number of times to repeat the module</li>
<li><code>module</code>: the layer type</li>
<li><code>args</code>: arguments for the module</li>
</ul>
<h3 id="how-do-i-troubleshoot-channel-mismatch-errors">How do I troubleshoot channel mismatch errors?</h3>
<p>Check that the output channels of one layer match the expected input channels of the next. Use <code>print(model.model.model)</code> to inspect your model's architecture.</p>
<h3 id="where-can-i-find-a-list-of-available-modules-and-their-arguments">Where can I find a list of available modules and their arguments?</h3>
<p>Check the source code in the <a href="https://github.com/ultralytics/ultralytics/tree/main/ultralytics/nn/modules"><code>ultralytics/nn/modules</code> directory</a> for all available modules and their arguments.</p>
<h3 id="how-do-i-add-a-custom-module-to-my-yaml-configuration">How do I add a custom module to my YAML configuration?</h3>
<p>Define your module in the source code, import it as shown in <a href="#source-code-modification">Source Code Modification</a>, and reference it by name in your YAML file.</p>
<h3 id="can-i-use-pretrained-weights-with-a-custom-yaml">Can I use pretrained weights with a custom YAML?</h3>
<p>Yes, you can use <code>model.load("path/to/weights")</code> to load weights from a pretrained checkpoint. However, only weights for layers that match would load successfully.</p>
<h3 id="how-do-i-validate-my-model-configuration">How do I validate my model configuration?</h3>
<p>Use <code>model.info()</code> to check whether FLOPs count is non-zero. A valid model should show non-zero FLOPs count. If it's zero, follow the suggestions in <a href="#debugging-tips">Debugging Tips</a> to find the issue.</p>
<br/><br/>
<div class="git-info">
<div class="dates-container">
<span class="date-item" title="This page was first created on September 17, 2025">
<span class="hover-item">📅</span> Created 28 days ago
    </span>
<span class="date-item" title="This page was last updated on September 30, 2025">
<span class="hover-item">✏️</span> Updated 14 days ago
    </span>
</div>
<div class="authors-container">
<a class="author-link" href="https://github.com/Y-T-G" title="Y-T-G (2 changes)">
<img alt="Y-T-G" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/32206511?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/glenn-jocher" title="glenn-jocher (1 change)">
<img alt="glenn-jocher" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/26833433?v=4&amp;s=96"/>
</a>
</div></div><div class="share-buttons">
<button class="share-button hover-item" onclick="window.open('https://twitter.com/intent/tweet?url=https://docs.ultralytics.com/guides/model-yaml-config', 'TwitterShare', 'width=550,height=680,menubar=no,toolbar=no'); return false;">
<i class="fa-brands fa-x-twitter"></i> Tweet
    </button>
<button class="share-button hover-item linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?url=https://docs.ultralytics.com/guides/model-yaml-config', 'LinkedinShare', 'width=550,height=730,menubar=no,toolbar=no'); return false;">
<i class="fa-brands fa-linkedin-in"></i> Share
    </button>
</div>
<br/>
<h2 id="__comments">Comments</h2>
<div id="giscus-container"></div>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Model Deployment Options" class="md-footer__link md-footer__link--prev" href="../model-deployment-options/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                Model Deployment Options
              </div>
</div>
</a>
<a aria-label="Next: K-Fold Cross Validation" class="md-footer__link md-footer__link--next" href="../kfold-cross-validation/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                K-Fold Cross Validation
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
<a href="https://www.ultralytics.com/" target="_blank">© 2025 Ultralytics Inc.</a> All rights reserved.
    </div>
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/ultralytics" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
<a class="md-social__link" href="https://www.linkedin.com/company/ultralytics/" rel="noopener" target="_blank" title="www.linkedin.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"></path></svg>
</a>
<a class="md-social__link" href="https://x.com/ultralytics" rel="noopener" target="_blank" title="x.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"></path></svg>
</a>
<a class="md-social__link" href="https://youtube.com/ultralytics?sub_confirmation=1" rel="noopener" target="_blank" title="youtube.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"></path></svg>
</a>
<a class="md-social__link" href="https://hub.docker.com/r/ultralytics/ultralytics/" rel="noopener" target="_blank" title="hub.docker.com">
<svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"></path></svg>
</a>
<a class="md-social__link" href="https://pypi.org/project/ultralytics/" rel="noopener" target="_blank" title="pypi.org">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"></path></svg>
</a>
<a class="md-social__link" href="https://discord.com/invite/ultralytics" rel="noopener" target="_blank" title="discord.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"></path></svg>
</a>
<a class="md-social__link" href="https://reddit.com/r/ultralytics" rel="noopener" target="_blank" title="reddit.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5"></path></svg>
</a>
<a class="md-social__link" href="https://weixin.qq.com/r/mp/LxckPDfEgWr_rXNf90I9" rel="noopener" target="_blank" title="weixin.qq.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.code.annotate", "content.code.copy", "content.tooltips", "toc.follow", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.prune", "navigation.footer", "navigation.tracking", "navigation.instant", "navigation.instant.progress", "navigation.indexes", "navigation.sections", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
<script src="../../javascript/extra.js"></script>
<script src="../../javascript/giscus.js"></script>
<script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
<script src="../../javascript/tablesort.js"></script>
<script>
                    async function copyMarkdownForLLM(button) {
                        const editBtn = document.querySelector('a[title="Edit this page"]');
                        if (!editBtn) return;
                        const originalHTML = button.innerHTML;
                        const checkIcon = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19L21 7l-1.41-1.41L9 16.17z"></path></svg>';
                        // Handle both /blob/ and /tree/ in GitHub URLs
                        let rawUrl = editBtn.href.replace('github.com', 'raw.githubusercontent.com');
                        // Remove /blob/ or /tree/ from the URL
                        rawUrl = rawUrl.replace('/blob/', '/').replace('/tree/', '/');
                        try {
                            const response = await fetch(rawUrl);
                            let markdown = await response.text();
                            // Remove YAML front matter if present
                            if (markdown.startsWith('---')) {
                                const frontMatterEnd = markdown.indexOf('\n---\n', 3);
                                if (frontMatterEnd !== -1) {
                                    markdown = markdown.substring(frontMatterEnd + 5).trim();
                                }
                            }
                            const title = document.querySelector('h1')?.textContent || document.title;
                            const content = `# ${title}\n\nSource: ${window.location.href}\n\n---\n\n${markdown}`;
                            await navigator.clipboard.writeText(content);
                            button.innerHTML = checkIcon + ' Copied!';
                            setTimeout(() => { button.innerHTML = originalHTML; }, 2000);
                        } catch (err) {
                            button.innerHTML = '❌ Failed';
                            setTimeout(() => { button.innerHTML = originalHTML; }, 2000);
                        }
                    }
                    </script></body>
</html>