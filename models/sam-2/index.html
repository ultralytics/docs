<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Discover SAM 2, the next generation of Meta's Segment Anything Model, supporting real-time promptable segmentation in both images and videos with state-of-the-art performance. Learn about its key features, datasets, and how to use it." name="description"/>
<meta content="Ultralytics" name="author"/>
<link href="https://docs.ultralytics.com/models/sam-2/" rel="canonical"/>
<link href="../sam/" rel="prev"/>
<link href="../mobile-sam/" rel="next"/>
<link href="https://raw.githubusercontent.com/ultralytics/assets/refs/heads/main/logo/favicon-yolo.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.20" name="generator"/>
<title>SAM 2: Segment Anything Model 2 - Ultralytics YOLO Docs</title>
<link href="../../assets/stylesheets/main.e53b48f4.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../assets/_mkdocstrings.css" rel="stylesheet"/>
<link href="../../stylesheets/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2M5EHKC0BH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2M5EHKC0BH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2M5EHKC0BH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
<meta content="SAM 2 (Segment Anything Model 2)" name="title"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"/><meta content="SAM 2, SAM 2.1, Segment Anything, video segmentation, image segmentation, promptable segmentation, zero-shot performance, SA-V dataset, Ultralytics, real-time segmentation, AI, machine learning" name="keywords"/><meta content="website" property="og:type"/><meta content="https://docs.ultralytics.com/models/sam-2" property="og:url"/><meta content="SAM 2 (Segment Anything Model 2)" property="og:title"/><meta content="Discover SAM 2, the next generation of Meta's Segment Anything Model, supporting real-time promptable segmentation in both images and videos with state-of-the-art performance. Learn about its key features, datasets, and how to use it." property="og:description"/><meta content="https://colab.research.google.com/assets/colab-badge.svg" property="og:image"/><meta content="summary_large_image" property="twitter:card"/><meta content="https://docs.ultralytics.com/models/sam-2" property="twitter:url"/><meta content="SAM 2 (Segment Anything Model 2)" property="twitter:title"/><meta content="Discover SAM 2, the next generation of Meta's Segment Anything Model, supporting real-time promptable segmentation in both images and videos with state-of-the-art performance. Learn about its key features, datasets, and how to use it." property="twitter:description"/><meta content="https://colab.research.google.com/assets/colab-badge.svg" property="twitter:image"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": ["Article", "FAQPage"], "headline": "SAM 2 (Segment Anything Model 2)", "image": ["https://colab.research.google.com/assets/colab-badge.svg"], "datePublished": "2024-07-30 11:33:54 +0200", "dateModified": "2025-09-05 16:31:03 +0800", "author": [{"@type": "Organization", "name": "Ultralytics", "url": "https://ultralytics.com/"}], "abstract": "Discover SAM 2, the next generation of Meta's Segment Anything Model, supporting real-time promptable segmentation in both images and videos with state-of-the-art performance. Learn about its key features, datasets, and how to use it.", "mainEntity": [{"@type": "Question", "name": "What is SAM 2 and how does it improve upon the original Segment Anything Model (SAM)?", "acceptedAnswer": {"@type": "Answer", "text": "SAM 2, the successor to Meta's Segment Anything Model (SAM), is a cutting-edge tool designed for comprehensive object segmentation in both images and videos. It excels in handling complex visual data through a unified, promptable model architecture that supports real-time processing and zero-shot generalization. SAM 2 offers several improvements over the original SAM, including: For more details on SAM 2's architecture and capabilities, explore the SAM 2 research paper."}}, {"@type": "Question", "name": "How can I use SAM 2 for real-time video segmentation?", "acceptedAnswer": {"@type": "Answer", "text": "SAM 2 can be utilized for real-time video segmentation by leveraging its promptable interface and real-time inference capabilities. Here's a basic example: For more comprehensive usage, refer to the How to Use SAM 2 section."}}, {"@type": "Question", "name": "What datasets are used to train SAM 2, and how do they enhance its performance?", "acceptedAnswer": {"@type": "Answer", "text": "SAM 2 is trained on the SA-V dataset, one of the largest and most diverse video segmentation datasets available. The SA-V dataset includes: This extensive dataset allows SAM 2 to achieve superior performance across major video segmentation benchmarks and enhances its zero-shot generalization capabilities. For more information, see the SA-V Dataset section."}}, {"@type": "Question", "name": "How does SAM 2 handle occlusions and object reappearances in video segmentation?", "acceptedAnswer": {"@type": "Answer", "text": "SAM 2 includes a sophisticated memory mechanism to manage temporal dependencies and occlusions in video data. The memory mechanism consists of: This mechanism ensures continuity even when objects are temporarily obscured or exit and re-enter the scene. For more details, refer to the Memory Mechanism and Occlusion Handling section."}}, {"@type": "Question", "name": "How does SAM 2 compare to other segmentation models like YOLO11?", "acceptedAnswer": {"@type": "Answer", "text": "SAM 2 models, such as Meta's SAM2-t and SAM2-b, offer powerful zero-shot segmentation capabilities but are significantly larger and slower compared to YOLO11 models. For instance, YOLO11n-seg is approximately 13 times smaller and over 860 times faster than SAM2-b. While SAM 2 excels in versatile, prompt-based, and zero-shot segmentation scenarios, YOLO11 is optimized for speed, efficiency, and real-time applications, making it better suited for deployment in resource-constrained environments."}}]}</script></head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#sam-2-segment-anything-model-2">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
<aside class="md-banner">
<div class="md-banner__inner md-grid md-typeset">
<a class="banner-wrapper" href="https://www.ultralytics.com/events/yolovision" target="_blank">
<div class="banner-content-wrapper">
<p>Register now for</p>
<img alt="Ultralytics YOLO Vision" height="40" loading="lazy" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/6895ca9b3ece7244d9981ab9_yv25-logo.avif"/>
</div>
</a>
</div>
</aside>
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Ultralytics YOLO Docs" class="md-header__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs">
<img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Ultralytics YOLO Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
              SAM 2 (Segment Anything Model 2)
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<div class="md-header__option">
<div class="md-select">
<button aria-label="Select language" class="md-header__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"></path></svg>
</button>
<div class="md-select__inner">
<ul class="md-select__list">
<li class="md-select__item">
<a class="md-select__link" href="/" hreflang="en">
              🇬🇧 English
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/zh/" hreflang="zh">
              🇨🇳 简体中文
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/ko/" hreflang="ko">
              🇰🇷 한국어
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/ja/" hreflang="ja">
              🇯🇵 日本語
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/ru/" hreflang="ru">
              🇷🇺 Русский
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/de/" hreflang="de">
              🇩🇪 Deutsch
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/fr/" hreflang="fr">
              🇫🇷 Français
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/es/" hreflang="es">
              🇪🇸 Español
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/pt/" hreflang="pt">
              🇵🇹 Português
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/it/" hreflang="it">
              🇮🇹 Italiano
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/tr/" hreflang="tr">
              🇹🇷 Türkçe
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/vi/" hreflang="vi">
              🇻🇳 Tiếng Việt
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/ar/" hreflang="ar">
              🇸🇦 العربية
            </a>
</li>
</ul>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    ultralytics/ultralytics
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
  Home
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../quickstart/">
  Quickstart
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../modes/">
  Modes
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../tasks/">
  Tasks
        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../">
  Models
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../datasets/">
  Datasets
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../solutions/">
  Solutions 🚀
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../guides/">
  Guides
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../integrations/">
  Integrations
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../hub/">
  HUB
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../reference/__init__/">
  Reference
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../help/">
  Help
        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Ultralytics YOLO Docs" class="md-nav__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs">
<img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/>
</a>
    Ultralytics YOLO Docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    ultralytics/ultralytics
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../quickstart/">
<span class="md-ellipsis">
    Quickstart
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../modes/">
<span class="md-ellipsis">
    Modes
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../tasks/">
<span class="md-ellipsis">
    Tasks
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Models
  </span>
</a>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Models
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../yolov3/">
<span class="md-ellipsis">
    YOLOv3
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yolov4/">
<span class="md-ellipsis">
    YOLOv4
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yolov5/">
<span class="md-ellipsis">
    YOLOv5
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yolov6/">
<span class="md-ellipsis">
    YOLOv6
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yolov7/">
<span class="md-ellipsis">
    YOLOv7
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yolov8/">
<span class="md-ellipsis">
    YOLOv8
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yolov9/">
<span class="md-ellipsis">
    YOLOv9
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yolov10/">
<span class="md-ellipsis">
    YOLOv10
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yolo11/">
<span class="md-ellipsis">
    YOLO11 🚀 NEW
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yolo12/">
<span class="md-ellipsis">
    YOLO12
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sam/">
<span class="md-ellipsis">
    SAM (Segment Anything Model)
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    SAM 2 (Segment Anything Model 2)
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    SAM 2 (Segment Anything Model 2)
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#key-features">
<span class="md-ellipsis">
      Key Features
    </span>
</a>
<nav aria-label="Key Features" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#unified-model-architecture">
<span class="md-ellipsis">
      Unified Model Architecture
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#real-time-performance">
<span class="md-ellipsis">
      Real-Time Performance
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#zero-shot-generalization">
<span class="md-ellipsis">
      Zero-Shot Generalization
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#interactive-refinement">
<span class="md-ellipsis">
      Interactive Refinement
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#advanced-handling-of-visual-challenges">
<span class="md-ellipsis">
      Advanced Handling of Visual Challenges
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-and-technical-details">
<span class="md-ellipsis">
      Performance and Technical Details
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#model-architecture">
<span class="md-ellipsis">
      Model Architecture
    </span>
</a>
<nav aria-label="Model Architecture" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#core-components">
<span class="md-ellipsis">
      Core Components
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#memory-mechanism-and-occlusion-handling">
<span class="md-ellipsis">
      Memory Mechanism and Occlusion Handling
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multi-mask-ambiguity-resolution">
<span class="md-ellipsis">
      Multi-Mask Ambiguity Resolution
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sa-v-dataset">
<span class="md-ellipsis">
      SA-V Dataset
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#benchmarks">
<span class="md-ellipsis">
      Benchmarks
    </span>
</a>
<nav aria-label="Benchmarks" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#video-object-segmentation">
<span class="md-ellipsis">
      Video Object Segmentation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#interactive-segmentation">
<span class="md-ellipsis">
      Interactive Segmentation
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#installation">
<span class="md-ellipsis">
      Installation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-use-sam-2-versatility-in-image-and-video-segmentation">
<span class="md-ellipsis">
      How to Use SAM 2: Versatility in Image and Video Segmentation
    </span>
</a>
<nav aria-label="How to Use SAM 2: Versatility in Image and Video Segmentation" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#sam-2-prediction-examples">
<span class="md-ellipsis">
      SAM 2 Prediction Examples
    </span>
</a>
<nav aria-label="SAM 2 Prediction Examples" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#segment-with-prompts">
<span class="md-ellipsis">
      Segment with Prompts
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#segment-everything">
<span class="md-ellipsis">
      Segment Everything
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#segment-video-and-track-objects">
<span class="md-ellipsis">
      Segment Video and Track objects
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dynamic-interactive-segment-and-track">
<span class="md-ellipsis">
      Dynamic Interactive Segment and Track
    </span>
</a>
<nav aria-label="Dynamic Interactive Segment and Track" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#key-features_1">
<span class="md-ellipsis">
      Key Features
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#core-capabilities">
<span class="md-ellipsis">
      Core Capabilities
    </span>
</a>
<nav aria-label="Core Capabilities" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#arguments">
<span class="md-ellipsis">
      Arguments
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#use-cases">
<span class="md-ellipsis">
      Use Cases
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sam-2-comparison-vs-yolo">
<span class="md-ellipsis">
      SAM 2 Comparison vs YOLO
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#auto-annotation-efficient-dataset-creation">
<span class="md-ellipsis">
      Auto-Annotation: Efficient Dataset Creation
    </span>
</a>
<nav aria-label="Auto-Annotation: Efficient Dataset Creation" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-auto-annotate-with-sam-2">
<span class="md-ellipsis">
      How to Auto-Annotate with SAM 2
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#limitations">
<span class="md-ellipsis">
      Limitations
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#citations-and-acknowledgements">
<span class="md-ellipsis">
      Citations and Acknowledgements
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#faq">
<span class="md-ellipsis">
      FAQ
    </span>
</a>
<nav aria-label="FAQ" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-is-sam-2-and-how-does-it-improve-upon-the-original-segment-anything-model-sam">
<span class="md-ellipsis">
      What is SAM 2 and how does it improve upon the original Segment Anything Model (SAM)?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-can-i-use-sam-2-for-real-time-video-segmentation">
<span class="md-ellipsis">
      How can I use SAM 2 for real-time video segmentation?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-datasets-are-used-to-train-sam-2-and-how-do-they-enhance-its-performance">
<span class="md-ellipsis">
      What datasets are used to train SAM 2, and how do they enhance its performance?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-does-sam-2-handle-occlusions-and-object-reappearances-in-video-segmentation">
<span class="md-ellipsis">
      How does SAM 2 handle occlusions and object reappearances in video segmentation?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-does-sam-2-compare-to-other-segmentation-models-like-yolo11">
<span class="md-ellipsis">
      How does SAM 2 compare to other segmentation models like YOLO11?
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../mobile-sam/">
<span class="md-ellipsis">
    MobileSAM (Mobile Segment Anything Model)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../fast-sam/">
<span class="md-ellipsis">
    FastSAM (Fast Segment Anything Model)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yolo-nas/">
<span class="md-ellipsis">
    YOLO-NAS (Neural Architecture Search)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../rtdetr/">
<span class="md-ellipsis">
    RT-DETR (Realtime Detection Transformer)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yolo-world/">
<span class="md-ellipsis">
    YOLO-World (Real-Time Open-Vocabulary Object Detection)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yoloe/">
<span class="md-ellipsis">
    YOLOE (Real-Time Seeing Anything)
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../datasets/">
<span class="md-ellipsis">
    Datasets
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../solutions/">
<span class="md-ellipsis">
    Solutions 🚀
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../guides/">
<span class="md-ellipsis">
    Guides
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../integrations/">
<span class="md-ellipsis">
    Integrations
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../hub/">
<span class="md-ellipsis">
    HUB
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../reference/__init__/">
<span class="md-ellipsis">
    Reference
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../help/">
<span class="md-ellipsis">
    Help
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#key-features">
<span class="md-ellipsis">
      Key Features
    </span>
</a>
<nav aria-label="Key Features" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#unified-model-architecture">
<span class="md-ellipsis">
      Unified Model Architecture
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#real-time-performance">
<span class="md-ellipsis">
      Real-Time Performance
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#zero-shot-generalization">
<span class="md-ellipsis">
      Zero-Shot Generalization
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#interactive-refinement">
<span class="md-ellipsis">
      Interactive Refinement
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#advanced-handling-of-visual-challenges">
<span class="md-ellipsis">
      Advanced Handling of Visual Challenges
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-and-technical-details">
<span class="md-ellipsis">
      Performance and Technical Details
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#model-architecture">
<span class="md-ellipsis">
      Model Architecture
    </span>
</a>
<nav aria-label="Model Architecture" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#core-components">
<span class="md-ellipsis">
      Core Components
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#memory-mechanism-and-occlusion-handling">
<span class="md-ellipsis">
      Memory Mechanism and Occlusion Handling
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multi-mask-ambiguity-resolution">
<span class="md-ellipsis">
      Multi-Mask Ambiguity Resolution
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sa-v-dataset">
<span class="md-ellipsis">
      SA-V Dataset
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#benchmarks">
<span class="md-ellipsis">
      Benchmarks
    </span>
</a>
<nav aria-label="Benchmarks" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#video-object-segmentation">
<span class="md-ellipsis">
      Video Object Segmentation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#interactive-segmentation">
<span class="md-ellipsis">
      Interactive Segmentation
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#installation">
<span class="md-ellipsis">
      Installation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-use-sam-2-versatility-in-image-and-video-segmentation">
<span class="md-ellipsis">
      How to Use SAM 2: Versatility in Image and Video Segmentation
    </span>
</a>
<nav aria-label="How to Use SAM 2: Versatility in Image and Video Segmentation" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#sam-2-prediction-examples">
<span class="md-ellipsis">
      SAM 2 Prediction Examples
    </span>
</a>
<nav aria-label="SAM 2 Prediction Examples" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#segment-with-prompts">
<span class="md-ellipsis">
      Segment with Prompts
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#segment-everything">
<span class="md-ellipsis">
      Segment Everything
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#segment-video-and-track-objects">
<span class="md-ellipsis">
      Segment Video and Track objects
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dynamic-interactive-segment-and-track">
<span class="md-ellipsis">
      Dynamic Interactive Segment and Track
    </span>
</a>
<nav aria-label="Dynamic Interactive Segment and Track" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#key-features_1">
<span class="md-ellipsis">
      Key Features
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#core-capabilities">
<span class="md-ellipsis">
      Core Capabilities
    </span>
</a>
<nav aria-label="Core Capabilities" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#arguments">
<span class="md-ellipsis">
      Arguments
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#use-cases">
<span class="md-ellipsis">
      Use Cases
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sam-2-comparison-vs-yolo">
<span class="md-ellipsis">
      SAM 2 Comparison vs YOLO
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#auto-annotation-efficient-dataset-creation">
<span class="md-ellipsis">
      Auto-Annotation: Efficient Dataset Creation
    </span>
</a>
<nav aria-label="Auto-Annotation: Efficient Dataset Creation" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-auto-annotate-with-sam-2">
<span class="md-ellipsis">
      How to Auto-Annotate with SAM 2
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#limitations">
<span class="md-ellipsis">
      Limitations
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#citations-and-acknowledgements">
<span class="md-ellipsis">
      Citations and Acknowledgements
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#faq">
<span class="md-ellipsis">
      FAQ
    </span>
</a>
<nav aria-label="FAQ" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-is-sam-2-and-how-does-it-improve-upon-the-original-segment-anything-model-sam">
<span class="md-ellipsis">
      What is SAM 2 and how does it improve upon the original Segment Anything Model (SAM)?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-can-i-use-sam-2-for-real-time-video-segmentation">
<span class="md-ellipsis">
      How can I use SAM 2 for real-time video segmentation?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-datasets-are-used-to-train-sam-2-and-how-do-they-enhance-its-performance">
<span class="md-ellipsis">
      What datasets are used to train SAM 2, and how do they enhance its performance?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-does-sam-2-handle-occlusions-and-object-reappearances-in-video-segmentation">
<span class="md-ellipsis">
      How does SAM 2 handle occlusions and object reappearances in video segmentation?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-does-sam-2-compare-to-other-segmentation-models-like-yolo11">
<span class="md-ellipsis">
      How does SAM 2 compare to other segmentation models like YOLO11?
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/ultralytics/ultralytics/tree/main/docs/en/models/sam-2.md" rel="edit" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
</a><a class="md-content__button md-icon" href="javascript:void(0)" onclick="copyMarkdownForLLM(this); return false;" title="Copy page in Markdown format"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg></a>
<div class="admonition tip">
<p class="admonition-title">SAM 2.1</p>
<p>We have just added support for the more accurate SAM2.1 model. Please give it a try!</p>
</div>
<h1 id="sam-2-segment-anything-model-2">SAM 2: Segment Anything Model 2</h1>
<p><a href="https://colab.research.google.com/github/ultralytics/notebooks/blob/main/notebooks/inference-with-meta-sam-and-sam2-using-ultralytics-python-package.ipynb"><img alt="Inference with Segment Anything 2 In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a></p>
<p>SAM 2, the successor to Meta's <a href="../sam/">Segment Anything Model (SAM)</a>, is a cutting-edge tool designed for comprehensive object segmentation in both images and videos. It excels in handling complex visual data through a unified, promptable model architecture that supports real-time processing and zero-shot generalization.</p>
<p><img alt="SAM 2 Example Results" src="https://github.com/ultralytics/docs/releases/download/0/sa-v-dataset.avif"/></p>
<h2 id="key-features">Key Features</h2>
<p align="center">
<br/>
<iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" frameborder="0" height="405" loading="lazy" src="https://www.youtube.com/embed/yXQPLMrNX2s" title="YouTube video player" width="720">
</iframe>
<br/>
<strong>Watch:</strong> How to Run Inference with Meta's SAM2 using Ultralytics | Step-by-Step Guide 🎉
</p>
<h3 id="unified-model-architecture">Unified Model Architecture</h3>
<p>SAM 2 combines the capabilities of image and video segmentation in a single model. This unification simplifies deployment and allows for consistent performance across different media types. It leverages a flexible prompt-based interface, enabling users to specify objects of interest through various prompt types, such as points, bounding boxes, or masks.</p>
<h3 id="real-time-performance">Real-Time Performance</h3>
<p>The model achieves real-time inference speeds, processing approximately 44 frames per second. This makes SAM 2 suitable for applications requiring immediate feedback, such as video editing and augmented reality.</p>
<h3 id="zero-shot-generalization">Zero-Shot Generalization</h3>
<p>SAM 2 can segment objects it has never encountered before, demonstrating strong zero-shot generalization. This is particularly useful in diverse or evolving visual domains where pre-defined categories may not cover all possible objects.</p>
<h3 id="interactive-refinement">Interactive Refinement</h3>
<p>Users can iteratively refine the segmentation results by providing additional prompts, allowing for precise control over the output. This interactivity is essential for fine-tuning results in applications like video annotation or medical imaging.</p>
<h3 id="advanced-handling-of-visual-challenges">Advanced Handling of Visual Challenges</h3>
<p>SAM 2 includes mechanisms to manage common video segmentation challenges, such as object occlusion and reappearance. It uses a sophisticated memory mechanism to keep track of objects across frames, ensuring continuity even when objects are temporarily obscured or exit and re-enter the scene.</p>
<p>For a deeper understanding of SAM 2's architecture and capabilities, explore the <a href="https://arxiv.org/abs/2408.00714">SAM 2 research paper</a>.</p>
<h2 id="performance-and-technical-details">Performance and Technical Details</h2>
<p>SAM 2 sets a new benchmark in the field, outperforming previous models on various metrics:</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>SAM 2</th>
<th>Previous SOTA</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Interactive Video Segmentation</strong></td>
<td><strong>Best</strong></td>
<td>-</td>
</tr>
<tr>
<td><strong>Human Interactions Required</strong></td>
<td><strong>3x fewer</strong></td>
<td>Baseline</td>
</tr>
<tr>
<td><strong><a href="https://www.ultralytics.com/glossary/image-segmentation">Image Segmentation</a> Accuracy</strong></td>
<td><strong>Improved</strong></td>
<td>SAM</td>
</tr>
<tr>
<td><strong>Inference Speed</strong></td>
<td><strong>6x faster</strong></td>
<td>SAM</td>
</tr>
</tbody>
</table>
<h2 id="model-architecture">Model Architecture</h2>
<h3 id="core-components">Core Components</h3>
<ul>
<li><strong>Image and Video Encoder</strong>: Utilizes a <a href="https://www.ultralytics.com/glossary/transformer">transformer</a>-based architecture to extract high-level features from both images and video frames. This component is responsible for understanding the visual content at each timestep.</li>
<li><strong>Prompt Encoder</strong>: Processes user-provided prompts (points, boxes, masks) to guide the segmentation task. This allows SAM 2 to adapt to user input and target specific objects within a scene.</li>
<li><strong>Memory Mechanism</strong>: Includes a memory encoder, memory bank, and memory attention module. These components collectively store and utilize information from past frames, enabling the model to maintain consistent <a href="https://www.ultralytics.com/glossary/object-tracking">object tracking</a> over time.</li>
<li><strong>Mask Decoder</strong>: Generates the final segmentation masks based on the encoded image features and prompts. In video, it also uses memory context to ensure accurate tracking across frames.</li>
</ul>
<p><img alt="SAM 2 Architecture Diagram" src="https://raw.githubusercontent.com/facebookresearch/sam2/refs/heads/main/assets/model_diagram.png"/></p>
<h3 id="memory-mechanism-and-occlusion-handling">Memory Mechanism and Occlusion Handling</h3>
<p>The memory mechanism allows SAM 2 to handle temporal dependencies and occlusions in video data. As objects move and interact, SAM 2 records their features in a memory bank. When an object becomes occluded, the model can rely on this memory to predict its position and appearance when it reappears. The occlusion head specifically handles scenarios where objects are not visible, predicting the likelihood of an object being occluded.</p>
<h3 id="multi-mask-ambiguity-resolution">Multi-Mask Ambiguity Resolution</h3>
<p>In situations with ambiguity (e.g., overlapping objects), SAM 2 can generate multiple mask predictions. This feature is crucial for accurately representing complex scenes where a single mask might not sufficiently describe the scene's nuances.</p>
<h2 id="sa-v-dataset">SA-V Dataset</h2>
<p>The SA-V dataset, developed for SAM 2's training, is one of the largest and most diverse video segmentation datasets available. It includes:</p>
<ul>
<li><strong>51,000+ Videos</strong>: Captured across 47 countries, providing a wide range of real-world scenarios.</li>
<li><strong>600,000+ Mask Annotations</strong>: Detailed spatio-temporal mask annotations, referred to as "masklets," covering whole objects and parts.</li>
<li><strong>Dataset Scale</strong>: It features 4.5 times more videos and 53 times more annotations than previous largest datasets, offering unprecedented diversity and complexity.</li>
</ul>
<h2 id="benchmarks">Benchmarks</h2>
<h3 id="video-object-segmentation">Video Object Segmentation</h3>
<p>SAM 2 has demonstrated superior performance across major video segmentation benchmarks:</p>
<table>
<thead>
<tr>
<th>Dataset</th>
<th>J&amp;F</th>
<th>J</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DAVIS 2017</strong></td>
<td>82.5</td>
<td>79.8</td>
<td>85.2</td>
</tr>
<tr>
<td><strong>YouTube-VOS</strong></td>
<td>81.2</td>
<td>78.9</td>
<td>83.5</td>
</tr>
</tbody>
</table>
<h3 id="interactive-segmentation">Interactive Segmentation</h3>
<p>In interactive segmentation tasks, SAM 2 shows significant efficiency and accuracy:</p>
<table>
<thead>
<tr>
<th>Dataset</th>
<th>NoC@90</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DAVIS Interactive</strong></td>
<td>1.54</td>
<td>0.872</td>
</tr>
</tbody>
</table>
<h2 id="installation">Installation</h2>
<p>To install SAM 2, use the following command. All SAM 2 models will automatically download on first use.</p>
<div class="highlight"><pre><span></span><code><span></span>pip<span class="w"> </span>install<span class="w"> </span>ultralytics
</code></pre></div>
<h2 id="how-to-use-sam-2-versatility-in-image-and-video-segmentation">How to Use SAM 2: Versatility in Image and Video Segmentation</h2>
<p>The following table details the available SAM 2 models, their pre-trained weights, supported tasks, and compatibility with different operating modes like <a href="../../modes/predict/">Inference</a>, <a href="../../modes/val/">Validation</a>, <a href="../../modes/train/">Training</a>, and <a href="../../modes/export/">Export</a>.</p>
<table>
<thead>
<tr>
<th>Model Type</th>
<th>Pre-trained Weights</th>
<th>Tasks Supported</th>
<th>Inference</th>
<th>Validation</th>
<th>Training</th>
<th>Export</th>
</tr>
</thead>
<tbody>
<tr>
<td>SAM 2 tiny</td>
<td><a href="https://github.com/ultralytics/assets/releases/download/v8.3.0/sam2_t.pt">sam2_t.pt</a></td>
<td><a href="../../tasks/segment/">Instance Segmentation</a></td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>SAM 2 small</td>
<td><a href="https://github.com/ultralytics/assets/releases/download/v8.3.0/sam2_s.pt">sam2_s.pt</a></td>
<td><a href="../../tasks/segment/">Instance Segmentation</a></td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>SAM 2 base</td>
<td><a href="https://github.com/ultralytics/assets/releases/download/v8.3.0/sam2_b.pt">sam2_b.pt</a></td>
<td><a href="../../tasks/segment/">Instance Segmentation</a></td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>SAM 2 large</td>
<td><a href="https://github.com/ultralytics/assets/releases/download/v8.3.0/sam2_l.pt">sam2_l.pt</a></td>
<td><a href="../../tasks/segment/">Instance Segmentation</a></td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>SAM 2.1 tiny</td>
<td><a href="https://github.com/ultralytics/assets/releases/download/v8.3.0/sam2.1_t.pt">sam2.1_t.pt</a></td>
<td><a href="../../tasks/segment/">Instance Segmentation</a></td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>SAM 2.1 small</td>
<td><a href="https://github.com/ultralytics/assets/releases/download/v8.3.0/sam2.1_s.pt">sam2.1_s.pt</a></td>
<td><a href="../../tasks/segment/">Instance Segmentation</a></td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>SAM 2.1 base</td>
<td><a href="https://github.com/ultralytics/assets/releases/download/v8.3.0/sam2.1_b.pt">sam2.1_b.pt</a></td>
<td><a href="../../tasks/segment/">Instance Segmentation</a></td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>SAM 2.1 large</td>
<td><a href="https://github.com/ultralytics/assets/releases/download/v8.3.0/sam2.1_l.pt">sam2.1_l.pt</a></td>
<td><a href="../../tasks/segment/">Instance Segmentation</a></td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
</tbody>
</table>
<h3 id="sam-2-prediction-examples">SAM 2 Prediction Examples</h3>
<p>SAM 2 can be utilized across a broad spectrum of tasks, including real-time video editing, medical imaging, and autonomous systems. Its ability to segment both static and dynamic visual data makes it a versatile tool for researchers and developers.</p>
<h4 id="segment-with-prompts">Segment with Prompts</h4>
<div class="admonition example">
<p class="admonition-title">Segment with Prompts</p>
<p>Use prompts to segment specific objects in images or videos.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="python" name="__tabbed_1" type="radio"/><div class="tabbed-labels"><label for="python">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">SAM</span>
<span></span>
<span></span><span class="c1"># Load a model</span>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">SAM</span><span class="p">(</span><span class="s2">"sam2.1_b.pt"</span><span class="p">)</span>
<span></span>
<span></span><span class="c1"># Display model information (optional)</span>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span></span>
<span></span><span class="c1"># Run inference with bboxes prompt</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">,</span> <span class="n">bboxes</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>
<span></span>
<span></span><span class="c1"># Run inference with single point</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="p">[</span><span class="mi">900</span><span class="p">,</span> <span class="mi">370</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span></span>
<span></span><span class="c1"># Run inference with multiple points</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="p">[[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">370</span><span class="p">],</span> <span class="p">[</span><span class="mi">900</span><span class="p">,</span> <span class="mi">370</span><span class="p">]],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span></span>
<span></span><span class="c1"># Run inference with multiple points prompt per object</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="p">[[[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">370</span><span class="p">],</span> <span class="p">[</span><span class="mi">900</span><span class="p">,</span> <span class="mi">370</span><span class="p">]]],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span></span>
<span></span><span class="c1"># Run inference with negative points prompt</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="p">[[[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">370</span><span class="p">],</span> <span class="p">[</span><span class="mi">900</span><span class="p">,</span> <span class="mi">370</span><span class="p">]]],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<h4 id="segment-everything">Segment Everything</h4>
<div class="admonition example">
<p class="admonition-title">Segment Everything</p>
<p>Segment the entire image or video content without specific prompts.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="python_1" name="__tabbed_2" type="radio"/><input id="cli" name="__tabbed_2" type="radio"/><div class="tabbed-labels"><label for="python_1">Python</label><label for="cli">CLI</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">SAM</span>
<span></span>
<span></span><span class="c1"># Load a model</span>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">SAM</span><span class="p">(</span><span class="s2">"sam2.1_b.pt"</span><span class="p">)</span>
<span></span>
<span></span><span class="c1"># Display model information (optional)</span>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span></span>
<span></span><span class="c1"># Run inference</span>
<span></span><span class="n">model</span><span class="p">(</span><span class="s2">"path/to/video.mp4"</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span></span><span class="c1"># Run inference with a SAM 2 model</span>
<span></span>yolo<span class="w"> </span>predict<span class="w"> </span><span class="nv">model</span><span class="o">=</span>sam2.1_b.pt<span class="w"> </span><span class="nv">source</span><span class="o">=</span>path/to/video.mp4
</code></pre></div>
</div>
</div>
</div>
</div>
<h4 id="segment-video-and-track-objects">Segment Video and Track objects</h4>
<div class="admonition example">
<p class="admonition-title">Segment Video</p>
<p>Segment the entire video content with specific prompts and track objects.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked="checked" id="python_2" name="__tabbed_3" type="radio"/><div class="tabbed-labels"><label for="python_2">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.models.sam</span><span class="w"> </span><span class="kn">import</span> <span class="n">SAM2VideoPredictor</span>
<span></span>
<span></span><span class="c1"># Create SAM2VideoPredictor</span>
<span></span><span class="n">overrides</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">conf</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">"segment"</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"predict"</span><span class="p">,</span> <span class="n">imgsz</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">"sam2_b.pt"</span><span class="p">)</span>
<span></span><span class="n">predictor</span> <span class="o">=</span> <span class="n">SAM2VideoPredictor</span><span class="p">(</span><span class="n">overrides</span><span class="o">=</span><span class="n">overrides</span><span class="p">)</span>
<span></span>
<span></span><span class="c1"># Run inference with single point</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">"test.mp4"</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="p">[</span><span class="mi">920</span><span class="p">,</span> <span class="mi">470</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span></span>
<span></span><span class="c1"># Run inference with multiple points</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">"test.mp4"</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="p">[[</span><span class="mi">920</span><span class="p">,</span> <span class="mi">470</span><span class="p">],</span> <span class="p">[</span><span class="mi">909</span><span class="p">,</span> <span class="mi">138</span><span class="p">]],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span></span>
<span></span><span class="c1"># Run inference with multiple points prompt per object</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">"test.mp4"</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="p">[[[</span><span class="mi">920</span><span class="p">,</span> <span class="mi">470</span><span class="p">],</span> <span class="p">[</span><span class="mi">909</span><span class="p">,</span> <span class="mi">138</span><span class="p">]]],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span></span>
<span></span><span class="c1"># Run inference with negative points prompt</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">"test.mp4"</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="p">[[[</span><span class="mi">920</span><span class="p">,</span> <span class="mi">470</span><span class="p">],</span> <span class="p">[</span><span class="mi">909</span><span class="p">,</span> <span class="mi">138</span><span class="p">]]],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<ul>
<li>This example demonstrates how SAM 2 can be used to segment the entire content of an image or video if no prompts (bboxes/points/masks) are provided.</li>
</ul>
<h2 id="dynamic-interactive-segment-and-track">Dynamic Interactive Segment and Track</h2>
<p>SAM2DynamicInteractivePredictor is an advanced training free extension of SAM2 that enables dynamic interaction with multiple frames and continual learning capabilities. This predictor supports real-time prompt updates and memory management for improved tracking performance across a sequence of images. Compared to the original SAM2, SAM2DynamicInteractivePredictor re-build the inference flow to make the best use of pre-trained SAM2 models without requiring additional training.</p>
<p><img alt="SAM 2 Example Results" src="https://github.com/ultralytics/assets/releases/download/v0.0.0/sam2-interative-sample.avif"/></p>
<h3 id="key-features_1">Key Features</h3>
<p>It offers three significant enhancements:</p>
<ol>
<li><strong>Dynamic Interactive</strong>: Add new prompts for merging/untracked new instances in following frames anytime during video processing</li>
<li><strong>Continual Learning</strong>: Add new prompts for existing instances to improve the model performance over time</li>
<li><strong>Independent Multi-Image Support</strong>: Process multiple independent images (not necessarily from a video sequence) with memory sharing and cross-image object tracking</li>
</ol>
<h3 id="core-capabilities">Core Capabilities</h3>
<ul>
<li><strong>Prompt Flexibility</strong>: Accepts bounding boxes, points, and masks as prompts</li>
<li><strong>Memory Bank Management</strong>: Maintains a dynamic memory bank to store object states across frames</li>
<li><strong>Multi-Object Tracking</strong>: Supports tracking multiple objects simultaneously with individual object IDs</li>
<li><strong>Real-Time Updates</strong>: Allows adding new prompts during inference without reprocessing previous frames</li>
<li><strong>Independent Image Processing</strong>: Process standalone images with shared memory context for cross-image object consistency</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Dynamic Object Addition</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="python_3" name="__tabbed_4" type="radio"/><div class="tabbed-labels"><label for="python_3">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.models.sam</span><span class="w"> </span><span class="kn">import</span> <span class="n">SAM2DynamicInteractivePredictor</span>
<span></span>
<span></span><span class="c1"># Create SAM2DynamicInteractivePredictor</span>
<span></span><span class="n">overrides</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">conf</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">"segment"</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"predict"</span><span class="p">,</span> <span class="n">imgsz</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">"sam2_t.pt"</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span></span><span class="n">predictor</span> <span class="o">=</span> <span class="n">SAM2DynamicInteractivePredictor</span><span class="p">(</span><span class="n">overrides</span><span class="o">=</span><span class="n">overrides</span><span class="p">,</span> <span class="n">max_obj_num</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span></span>
<span></span><span class="c1"># Define a category by box prompt</span>
<span></span><span class="n">predictor</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">"image1.jpg"</span><span class="p">,</span> <span class="n">bboxes</span><span class="o">=</span><span class="p">[[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">]],</span> <span class="n">obj_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">update_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>
<span></span><span class="c1"># Detect this particular object in a new image</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">"image2.jpg"</span><span class="p">)</span>
<span></span>
<span></span><span class="c1"># Add new category with a new object ID</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="p">(</span>
<span></span>    <span class="n">source</span><span class="o">=</span><span class="s2">"image4.jpg"</span><span class="p">,</span>
<span></span>    <span class="n">bboxes</span><span class="o">=</span><span class="p">[[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">]],</span>  <span class="c1"># New object</span>
<span></span>    <span class="n">obj_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># New object ID</span>
<span></span>    <span class="n">update_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Add to memory</span>
<span></span><span class="p">)</span>
<span></span><span class="c1"># Perform inference</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">"image5.jpg"</span><span class="p">)</span>
<span></span>
<span></span><span class="c1"># Add refinement prompts to the same category to boost performance</span>
<span></span><span class="c1"># This helps when object appearance changes significantly</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="p">(</span>
<span></span>    <span class="n">source</span><span class="o">=</span><span class="s2">"image6.jpg"</span><span class="p">,</span>
<span></span>    <span class="n">points</span><span class="o">=</span><span class="p">[[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">]],</span>  <span class="c1"># Refinement point</span>
<span></span>    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># Positive point</span>
<span></span>    <span class="n">obj_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># Same object ID</span>
<span></span>    <span class="n">update_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Update memory with new information</span>
<span></span><span class="p">)</span>
<span></span><span class="c1"># Perform inference on new image</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">"image7.jpg"</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>SAM2DynamicInteractivePredictor</code> is designed to work with SAM2 models, and support adding/refining categories by all the <a href="#sam-2-prediction-examples">box/point/mask prompts</a> natively that SAM2 supports. It is particularly useful for scenarios where objects appear or change over time, such as in video annotation or interactive editing tasks.</p>
</div>
<h4 id="arguments">Arguments</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Default Value</th>
<th>Data Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>max_obj_num</code></td>
<td><code>3</code></td>
<td><code>str</code></td>
<td>The preset maximum number of categories</td>
</tr>
<tr>
<td><code>update_memory</code></td>
<td><code>False</code></td>
<td><code>bool</code></td>
<td>Whether to update memory with new prompts</td>
</tr>
<tr>
<td><code>obj_ids</code></td>
<td><code>None</code></td>
<td><code>List[int]</code></td>
<td>List of object IDs corresponding to prompts</td>
</tr>
</tbody>
</table>
<h3 id="use-cases">Use Cases</h3>
<p><code>SAM2DynamicInteractivePredictor</code> is ideal for:</p>
<ul>
<li><strong>Video annotation workflows</strong> where new objects appear during the sequence</li>
<li><strong>Interactive video editing</strong> requiring real-time object addition and refinement</li>
<li><strong>Surveillance applications</strong> with dynamic object tracking needs</li>
<li><strong>Medical imaging</strong> for tracking anatomical structures across time series</li>
<li><strong>Autonomous systems</strong> requiring adaptive object detection and tracking</li>
<li><strong>Multi-image datasets</strong> for consistent object segmentation across independent images</li>
<li><strong>Image collection analysis</strong> where objects need to be tracked across different scenes</li>
<li><strong>Cross-domain segmentation</strong> leveraging memory from diverse image contexts</li>
<li><strong>Semi-automatic annotation</strong> for efficient dataset creation with minimal manual intervention</li>
</ul>
<h2 id="sam-2-comparison-vs-yolo">SAM 2 Comparison vs YOLO</h2>
<p>Here we compare Meta's SAM 2 models, including the smallest SAM2-t variant, with Ultralytics smallest segmentation model, <a href="../../tasks/segment/">YOLO11n-seg</a>:</p>
<table>
<thead>
<tr>
<th>Model</th>
<th>Size<br/><sup>(MB)</sup></th>
<th>Parameters<br/><sup>(M)</sup></th>
<th>Speed (CPU)<br/><sup>(ms/im)</sup></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="../sam/">Meta SAM-b</a></td>
<td>375</td>
<td>93.7</td>
<td>49401</td>
</tr>
<tr>
<td>Meta SAM2-b</td>
<td>162</td>
<td>80.8</td>
<td>31901</td>
</tr>
<tr>
<td>Meta SAM2-t</td>
<td>78.1</td>
<td>38.9</td>
<td>25997</td>
</tr>
<tr>
<td><a href="../mobile-sam/">MobileSAM</a></td>
<td>40.7</td>
<td>10.1</td>
<td>25381</td>
</tr>
<tr>
<td><a href="../fast-sam/">FastSAM-s</a> with YOLOv8 <a href="https://www.ultralytics.com/glossary/backbone">backbone</a></td>
<td>23.7</td>
<td>11.8</td>
<td>55.9</td>
</tr>
<tr>
<td>Ultralytics <a href="../yolov8/">YOLOv8n-seg</a></td>
<td><strong>6.7</strong> (11.7x smaller)</td>
<td><strong>3.4</strong> (11.4x less)</td>
<td><strong>24.5</strong> (1061x faster)</td>
</tr>
<tr>
<td>Ultralytics <a href="../yolo11/">YOLO11n-seg</a></td>
<td><strong>5.9</strong> (13.2x smaller)</td>
<td><strong>2.9</strong> (13.4x less)</td>
<td><strong>30.1</strong> (864x faster)</td>
</tr>
</tbody>
</table>
<p>This comparison demonstrates the substantial differences in model sizes and speeds between SAM variants and YOLO segmentation models. While SAM provides unique automatic segmentation capabilities, YOLO models, particularly YOLOv8n-seg and YOLO11n-seg, are significantly smaller, faster, and more computationally efficient.</p>
<p>Tests run on a 2025 Apple M4 Pro with 24GB of RAM using <code>torch==2.6.0</code> and <code>ultralytics==8.3.90</code>. To reproduce this test:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="python_4" name="__tabbed_5" type="radio"/><div class="tabbed-labels"><label for="python_4">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">ASSETS</span><span class="p">,</span> <span class="n">SAM</span><span class="p">,</span> <span class="n">YOLO</span><span class="p">,</span> <span class="n">FastSAM</span>
<span></span>
<span></span><span class="c1"># Profile SAM2-t, SAM2-b, SAM-b, MobileSAM</span>
<span></span><span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"sam_b.pt"</span><span class="p">,</span> <span class="s2">"sam2_b.pt"</span><span class="p">,</span> <span class="s2">"sam2_t.pt"</span><span class="p">,</span> <span class="s2">"mobile_sam.pt"</span><span class="p">]:</span>
<span></span>    <span class="n">model</span> <span class="o">=</span> <span class="n">SAM</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span></span>    <span class="n">model</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span></span>    <span class="n">model</span><span class="p">(</span><span class="n">ASSETS</span><span class="p">)</span>
<span></span>
<span></span><span class="c1"># Profile FastSAM-s</span>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">FastSAM</span><span class="p">(</span><span class="s2">"FastSAM-s.pt"</span><span class="p">)</span>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span></span><span class="n">model</span><span class="p">(</span><span class="n">ASSETS</span><span class="p">)</span>
<span></span>
<span></span><span class="c1"># Profile YOLO models</span>
<span></span><span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"yolov8n-seg.pt"</span><span class="p">,</span> <span class="s2">"yolo11n-seg.pt"</span><span class="p">]:</span>
<span></span>    <span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
<span></span>    <span class="n">model</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span></span>    <span class="n">model</span><span class="p">(</span><span class="n">ASSETS</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<h2 id="auto-annotation-efficient-dataset-creation">Auto-Annotation: Efficient Dataset Creation</h2>
<p>Auto-annotation is a powerful feature of SAM 2, enabling users to generate segmentation datasets quickly and accurately by leveraging pre-trained models. This capability is particularly useful for creating large, high-quality datasets without extensive manual effort.</p>
<h3 id="how-to-auto-annotate-with-sam-2">How to Auto-Annotate with SAM 2</h3>
<p align="center">
<br/>
<iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" frameborder="0" height="405" loading="lazy" src="https://www.youtube.com/embed/M7xWw4Iodhg" title="YouTube video player" width="720">
</iframe>
<br/>
<strong>Watch:</strong> Auto Annotation with Meta's Segment Anything 2 Model using Ultralytics | Data Labeling
</p>
<p>To auto-annotate your dataset using SAM 2, follow this example:</p>
<div class="admonition example">
<p class="admonition-title">Auto-Annotation Example</p>
<div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.annotator</span><span class="w"> </span><span class="kn">import</span> <span class="n">auto_annotate</span>
<span></span>
<span></span><span class="n">auto_annotate</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s2">"path/to/images"</span><span class="p">,</span> <span class="n">det_model</span><span class="o">=</span><span class="s2">"yolo11x.pt"</span><span class="p">,</span> <span class="n">sam_model</span><span class="o">=</span><span class="s2">"sam2_b.pt"</span><span class="p">)</span>
</code></pre></div>
</div>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>data</code></td>
<td><code>str</code></td>
<td>required</td>
<td>Path to directory containing target images for annotation or segmentation.</td>
</tr>
<tr>
<td><code>det_model</code></td>
<td><code>str</code></td>
<td><code>'yolo11x.pt'</code></td>
<td>YOLO detection model path for initial object detection.</td>
</tr>
<tr>
<td><code>sam_model</code></td>
<td><code>str</code></td>
<td><code>'sam_b.pt'</code></td>
<td>SAM model path for segmentation (supports SAM, SAM2 variants and mobile_sam models).</td>
</tr>
<tr>
<td><code>device</code></td>
<td><code>str</code></td>
<td><code>''</code></td>
<td>Computation device (e.g., 'cuda:0', 'cpu', or '' for automatic device detection).</td>
</tr>
<tr>
<td><code>conf</code></td>
<td><code>float</code></td>
<td><code>0.25</code></td>
<td>YOLO detection confidence threshold for filtering weak detections.</td>
</tr>
<tr>
<td><code>iou</code></td>
<td><code>float</code></td>
<td><code>0.45</code></td>
<td>IoU threshold for Non-Maximum Suppression to filter overlapping boxes.</td>
</tr>
<tr>
<td><code>imgsz</code></td>
<td><code>int</code></td>
<td><code>640</code></td>
<td>Input size for resizing images (must be multiple of 32).</td>
</tr>
<tr>
<td><code>max_det</code></td>
<td><code>int</code></td>
<td><code>300</code></td>
<td>Maximum number of detections per image for memory efficiency.</td>
</tr>
<tr>
<td><code>classes</code></td>
<td><code>list[int]</code></td>
<td><code>None</code></td>
<td>List of class indices to detect (e.g., <code>[0, 1]</code> for person &amp; bicycle).</td>
</tr>
<tr>
<td><code>output_dir</code></td>
<td><code>str</code></td>
<td><code>None</code></td>
<td>Save directory for annotations (defaults to './labels' relative to data path).</td>
</tr>
</tbody>
</table>
<p>This function facilitates the rapid creation of high-quality segmentation datasets, ideal for researchers and developers aiming to accelerate their projects.</p>
<h2 id="limitations">Limitations</h2>
<p>Despite its strengths, SAM 2 has certain limitations:</p>
<ul>
<li><strong>Tracking Stability</strong>: SAM 2 may lose track of objects during extended sequences or significant viewpoint changes.</li>
<li><strong>Object Confusion</strong>: The model can sometimes confuse similar-looking objects, particularly in crowded scenes.</li>
<li><strong>Efficiency with Multiple Objects</strong>: Segmentation efficiency decreases when processing multiple objects simultaneously due to the lack of inter-object communication.</li>
<li><strong>Detail <a href="https://www.ultralytics.com/glossary/accuracy">Accuracy</a></strong>: May miss fine details, especially with fast-moving objects. Additional prompts can partially address this issue, but temporal smoothness is not guaranteed.</li>
</ul>
<h2 id="citations-and-acknowledgements">Citations and Acknowledgements</h2>
<p>If SAM 2 is a crucial part of your research or development work, please cite it using the following reference:</p>
<div class="admonition quote">
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="bibtex" name="__tabbed_6" type="radio"/><div class="tabbed-labels"><label for="bibtex">BibTeX</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span></span><span class="nc">@article</span><span class="p">{</span><span class="nl">ravi2024sam2</span><span class="p">,</span>
<span></span><span class="w">  </span><span class="na">title</span><span class="p">=</span><span class="s">{SAM 2: Segment Anything in Images and Videos}</span><span class="p">,</span>
<span></span><span class="w">  </span><span class="na">author</span><span class="p">=</span><span class="s">{Ravi, Nikhila and Gabeur, Valentin and Hu, Yuan-Ting and Hu, Ronghang and Ryali, Chaitanya and Ma, Tengyu and Khedr, Haitham and R{\"a}dle, Roman and Rolland, Chloe and Gustafson, Laura and Mintun, Eric and Pan, Junting and Alwala, Kalyan Vasudev and Carion, Nicolas and Wu, Chao-Yuan and Girshick, Ross and Doll{\'a}r, Piotr and Feichtenhofer, Christoph}</span><span class="p">,</span>
<span></span><span class="w">  </span><span class="na">journal</span><span class="p">=</span><span class="s">{arXiv preprint}</span><span class="p">,</span>
<span></span><span class="w">  </span><span class="na">year</span><span class="p">=</span><span class="s">{2024}</span>
<span></span><span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<p>We extend our gratitude to Meta AI for their contributions to the AI community with this groundbreaking model and dataset.</p>
<h2 id="faq">FAQ</h2>
<h3 id="what-is-sam-2-and-how-does-it-improve-upon-the-original-segment-anything-model-sam">What is SAM 2 and how does it improve upon the original Segment Anything Model (SAM)?</h3>
<p>SAM 2, the successor to Meta's <a href="../sam/">Segment Anything Model (SAM)</a>, is a cutting-edge tool designed for comprehensive object segmentation in both images and videos. It excels in handling complex visual data through a unified, promptable model architecture that supports real-time processing and zero-shot generalization. SAM 2 offers several improvements over the original SAM, including:</p>
<ul>
<li><strong>Unified Model Architecture</strong>: Combines image and video segmentation capabilities in a single model.</li>
<li><strong>Real-Time Performance</strong>: Processes approximately 44 frames per second, making it suitable for applications requiring immediate feedback.</li>
<li><strong>Zero-Shot Generalization</strong>: Segments objects it has never encountered before, useful in diverse visual domains.</li>
<li><strong>Interactive Refinement</strong>: Allows users to iteratively refine segmentation results by providing additional prompts.</li>
<li><strong>Advanced Handling of Visual Challenges</strong>: Manages common video segmentation challenges like object occlusion and reappearance.</li>
</ul>
<p>For more details on SAM 2's architecture and capabilities, explore the <a href="https://arxiv.org/abs/2408.00714">SAM 2 research paper</a>.</p>
<h3 id="how-can-i-use-sam-2-for-real-time-video-segmentation">How can I use SAM 2 for real-time video segmentation?</h3>
<p>SAM 2 can be utilized for real-time video segmentation by leveraging its promptable interface and real-time inference capabilities. Here's a basic example:</p>
<div class="admonition example">
<p class="admonition-title">Segment with Prompts</p>
<p>Use prompts to segment specific objects in images or videos.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:1"><input checked="checked" id="python_5" name="__tabbed_7" type="radio"/><div class="tabbed-labels"><label for="python_5">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">SAM</span>
<span></span>
<span></span><span class="c1"># Load a model</span>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">SAM</span><span class="p">(</span><span class="s2">"sam2_b.pt"</span><span class="p">)</span>
<span></span>
<span></span><span class="c1"># Display model information (optional)</span>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span></span>
<span></span><span class="c1"># Segment with bounding box prompt</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">,</span> <span class="n">bboxes</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>
<span></span>
<span></span><span class="c1"># Segment with point prompt</span>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<p>For more comprehensive usage, refer to the <a href="#how-to-use-sam-2-versatility-in-image-and-video-segmentation">How to Use SAM 2</a> section.</p>
<h3 id="what-datasets-are-used-to-train-sam-2-and-how-do-they-enhance-its-performance">What datasets are used to train SAM 2, and how do they enhance its performance?</h3>
<p>SAM 2 is trained on the SA-V dataset, one of the largest and most diverse video segmentation datasets available. The SA-V dataset includes:</p>
<ul>
<li><strong>51,000+ Videos</strong>: Captured across 47 countries, providing a wide range of real-world scenarios.</li>
<li><strong>600,000+ Mask Annotations</strong>: Detailed spatio-temporal mask annotations, referred to as "masklets," covering whole objects and parts.</li>
<li><strong>Dataset Scale</strong>: Features 4.5 times more videos and 53 times more annotations than previous largest datasets, offering unprecedented diversity and complexity.</li>
</ul>
<p>This extensive dataset allows SAM 2 to achieve superior performance across major video segmentation benchmarks and enhances its zero-shot generalization capabilities. For more information, see the <a href="#sa-v-dataset">SA-V Dataset</a> section.</p>
<h3 id="how-does-sam-2-handle-occlusions-and-object-reappearances-in-video-segmentation">How does SAM 2 handle occlusions and object reappearances in video segmentation?</h3>
<p>SAM 2 includes a sophisticated memory mechanism to manage temporal dependencies and occlusions in video data. The memory mechanism consists of:</p>
<ul>
<li><strong>Memory Encoder and Memory Bank</strong>: Stores features from past frames.</li>
<li><strong>Memory Attention Module</strong>: Utilizes stored information to maintain consistent object tracking over time.</li>
<li><strong>Occlusion Head</strong>: Specifically handles scenarios where objects are not visible, predicting the likelihood of an object being occluded.</li>
</ul>
<p>This mechanism ensures continuity even when objects are temporarily obscured or exit and re-enter the scene. For more details, refer to the <a href="#memory-mechanism-and-occlusion-handling">Memory Mechanism and Occlusion Handling</a> section.</p>
<h3 id="how-does-sam-2-compare-to-other-segmentation-models-like-yolo11">How does SAM 2 compare to other segmentation models like YOLO11?</h3>
<p>SAM 2 models, such as Meta's SAM2-t and SAM2-b, offer powerful zero-shot segmentation capabilities but are significantly larger and slower compared to YOLO11 models. For instance, YOLO11n-seg is approximately <strong>13 times smaller</strong> and over <strong>860 times faster</strong> than SAM2-b. While SAM 2 excels in versatile, prompt-based, and zero-shot segmentation scenarios, YOLO11 is optimized for speed, efficiency, and real-time applications, making it better suited for deployment in resource-constrained environments.</p>
<br/><br/>
<div class="git-info">
<div class="dates-container">
<span class="date-item" title="This page was first created on July 30, 2024">
<span class="hover-item">📅</span> Created 1 year ago
    </span>
<span class="date-item" title="This page was last updated on September 05, 2025">
<span class="hover-item">✏️</span> Updated 15 days ago
    </span>
</div>
<div class="authors-container">
<a class="author-link" href="https://github.com/RizwanMunawar" title="RizwanMunawar (11 changes)">
<img alt="RizwanMunawar" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62513924?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/Laughing-q" title="Laughing-q (7 changes)">
<img alt="Laughing-q" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/61612323?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/glenn-jocher" title="glenn-jocher (6 changes)">
<img alt="glenn-jocher" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/26833433?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/Y-T-G" title="Y-T-G (2 changes)">
<img alt="Y-T-G" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/32206511?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/ShuaiLYU" title="ShuaiLYU (1 change)">
<img alt="ShuaiLYU" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/31230805?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/joshua-dean" title="joshua-dean (1 change)">
<img alt="joshua-dean" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/7959279?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/MatthewNoyce" title="MatthewNoyce (1 change)">
<img alt="MatthewNoyce" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/131261051?v=4&amp;s=96"/>
</a>
</div></div><div class="share-buttons">
<button class="share-button hover-item" onclick="window.open('https://twitter.com/intent/tweet?url=https://docs.ultralytics.com/models/sam-2', 'TwitterShare', 'width=550,height=680,menubar=no,toolbar=no'); return false;">
<i class="fa-brands fa-x-twitter"></i> Tweet
    </button>
<button class="share-button hover-item linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?url=https://docs.ultralytics.com/models/sam-2', 'LinkedinShare', 'width=550,height=730,menubar=no,toolbar=no'); return false;">
<i class="fa-brands fa-linkedin-in"></i> Share
    </button>
</div>
<br/>
<h2 id="__comments">Comments</h2>
<div id="giscus-container"></div>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: SAM (Segment Anything Model)" class="md-footer__link md-footer__link--prev" href="../sam/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                SAM (Segment Anything Model)
              </div>
</div>
</a>
<a aria-label="Next: MobileSAM (Mobile Segment Anything Model)" class="md-footer__link md-footer__link--next" href="../mobile-sam/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                MobileSAM (Mobile Segment Anything Model)
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
<a href="https://www.ultralytics.com/" target="_blank">© 2025 Ultralytics Inc.</a> All rights reserved.
    </div>
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/ultralytics" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
<a class="md-social__link" href="https://www.linkedin.com/company/ultralytics/" rel="noopener" target="_blank" title="www.linkedin.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"></path></svg>
</a>
<a class="md-social__link" href="https://x.com/ultralytics" rel="noopener" target="_blank" title="x.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"></path></svg>
</a>
<a class="md-social__link" href="https://youtube.com/ultralytics?sub_confirmation=1" rel="noopener" target="_blank" title="youtube.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"></path></svg>
</a>
<a class="md-social__link" href="https://hub.docker.com/r/ultralytics/ultralytics/" rel="noopener" target="_blank" title="hub.docker.com">
<svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"></path></svg>
</a>
<a class="md-social__link" href="https://pypi.org/project/ultralytics/" rel="noopener" target="_blank" title="pypi.org">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"></path></svg>
</a>
<a class="md-social__link" href="https://discord.com/invite/ultralytics" rel="noopener" target="_blank" title="discord.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"></path></svg>
</a>
<a class="md-social__link" href="https://reddit.com/r/ultralytics" rel="noopener" target="_blank" title="reddit.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5"></path></svg>
</a>
<a class="md-social__link" href="https://weixin.qq.com/r/mp/LxckPDfEgWr_rXNf90I9" rel="noopener" target="_blank" title="weixin.qq.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.code.annotate", "content.code.copy", "content.tooltips", "toc.follow", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.prune", "navigation.footer", "navigation.tracking", "navigation.instant", "navigation.instant.progress", "navigation.indexes", "navigation.sections", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
<script src="../../javascript/extra.js"></script>
<script src="../../javascript/giscus.js"></script>
<script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
<script src="../../javascript/tablesort.js"></script>
<script>
                    async function copyMarkdownForLLM(button) {
                        const editBtn = document.querySelector('a[title="Edit this page"]');
                        if (!editBtn) return;
                        const originalHTML = button.innerHTML;
                        const checkIcon = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19L21 7l-1.41-1.41L9 16.17z"></path></svg>';
                        // Handle both /blob/ and /tree/ in GitHub URLs
                        let rawUrl = editBtn.href.replace('github.com', 'raw.githubusercontent.com');
                        // Remove /blob/ or /tree/ from the URL
                        rawUrl = rawUrl.replace('/blob/', '/').replace('/tree/', '/');
                        try {
                            const response = await fetch(rawUrl);
                            let markdown = await response.text();
                            // Remove YAML front matter if present
                            if (markdown.startsWith('---')) {
                                const frontMatterEnd = markdown.indexOf('\n---\n', 3);
                                if (frontMatterEnd !== -1) {
                                    markdown = markdown.substring(frontMatterEnd + 5).trim();
                                }
                            }
                            const title = document.querySelector('h1')?.textContent || document.title;
                            const content = `# ${title}\n\nSource: ${window.location.href}\n\n---\n\n${markdown}`;
                            await navigator.clipboard.writeText(content);
                            button.innerHTML = checkIcon + ' Copied!';
                            setTimeout(() => { button.innerHTML = originalHTML; }, 2000);
                        } catch (err) {
                            button.innerHTML = '❌ Failed';
                            setTimeout(() => { button.innerHTML = originalHTML; }, 2000);
                        }
                    }
                    </script></body>
</html>