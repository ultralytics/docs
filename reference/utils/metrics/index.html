 <!DOCTYPE html><html class="no-js" lang="en"><head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Explore detailed metrics and utility functions for model validation and performance analysis with Ultralytics' metrics module." name="description"/><meta content="Ultralytics" name="author"/><link href="https://docs.ultralytics.com/reference/utils/metrics/" rel="canonical"/><link href="../loss/" rel="prev"/><link href="../nms/" rel="next"/><link href="/" hreflang="en" rel="alternate"/><link href="/zh/" hreflang="zh" rel="alternate"/><link href="/ko/" hreflang="ko" rel="alternate"/><link href="/ja/" hreflang="ja" rel="alternate"/><link href="/ru/" hreflang="ru" rel="alternate"/><link href="/de/" hreflang="de" rel="alternate"/><link href="/fr/" hreflang="fr" rel="alternate"/><link href="/es/" hreflang="es" rel="alternate"/><link href="/pt/" hreflang="pt" rel="alternate"/><link href="/it/" hreflang="it" rel="alternate"/><link href="/tr/" hreflang="tr" rel="alternate"/><link href="/vi/" hreflang="vi" rel="alternate"/><link href="/ar/" hreflang="ar" rel="alternate"/><link href="https://raw.githubusercontent.com/ultralytics/assets/refs/heads/main/logo/favicon-yolo.png" rel="icon"/><meta content="zensical-0.0.10" name="generator"/><title>Reference for ultralytics/utils/metrics.py - Ultralytics YOLO Docs</title><link href="../../../assets/stylesheets/modern/main.eafc6f7f.min.css" rel="stylesheet"/><link href="../../../assets/stylesheets/modern/palette.dfe2e883.min.css" rel="stylesheet"/><style>:root{}</style><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,500,500i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link href="../../../stylesheets/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)),0),__md_get=(e,t=localStorage,a=__md_scope)=>JSON.parse(t.getItem(a.pathname+"."+e)),__md_set=(e,t,a=localStorage,_=__md_scope)=>{try{a.setItem(_.pathname+"."+e,JSON.stringify(t))}catch(e){}},document.documentElement.setAttribute("data-platform",navigator.platform)</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2M5EHKC0BH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2M5EHKC0BH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2M5EHKC0BH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
<style data-doc-kind="true">.doc-kind{display:inline-flex;align-items:center;gap:0.25em;padding:0.21em 0.59em;border-radius:999px;font-weight:700;font-size:0.81em;letter-spacing:0.06em;text-transform:uppercase;line-height:1;color:var(--doc-kind-color,#f8fafc);background:var(--doc-kind-bg,rgba(255,255,255,0.12));}.doc-kind-class{--doc-kind-color:#039dfc;--doc-kind-bg:rgba(3,157,252,0.22);}.doc-kind-function{--doc-kind-color:#fc9803;--doc-kind-bg:rgba(252,152,3,0.22);}.doc-kind-method{--doc-kind-color:#ef5eff;--doc-kind-bg:rgba(239,94,255,0.22);}.doc-kind-property{--doc-kind-color:#02e835;--doc-kind-bg:rgba(2,232,53,0.22);}</style><meta content="Reference for ultralytics/utils/metrics.py" name="title"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"/><meta content="website" property="og:type"/><meta content="https://docs.ultralytics.com/reference/utils/metrics/" property="og:url"/><meta content="Reference for ultralytics/utils/metrics.py" property="og:title"/><meta content="" property="og:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="og:image"/><meta content="summary_large_image" property="twitter:card"/><meta content="https://docs.ultralytics.com/reference/utils/metrics/" property="twitter:url"/><meta content="Reference for ultralytics/utils/metrics.py" property="twitter:title"/><meta content="" property="twitter:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="twitter:image"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "headline": "Reference for ultralytics/utils/metrics.py", "image": ["https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png"], "datePublished": "2023-11-12 02:49:37 +0100", "dateModified": "2025-11-23 19:53:50 +0100", "author": [{"@type": "Organization", "name": "Ultralytics", "url": "https://ultralytics.com/"}], "abstract": ""}</script></head><body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr"><input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/><input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/><label class="md-overlay" for="__drawer"></label><div data-md-component="skip"><a class="md-skip" href="#reference-for-ultralyticsutilsmetricspy"> Skip to content </a></div><div data-md-component="announce"><aside class="md-banner"><div class="md-banner__inner md-grid md-typeset"><a class="banner-wrapper" href="https://www.ultralytics.com/news/ultralytics-raises-30m-series-a" target="_blank"><div class="banner-content-wrapper"><img alt="Ultralytics raises $30M Series A" height="40" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac336b5de2ae8b398bca_writting.svg"/><div class="vc-wrapper"><img alt="Elephant" height="28" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac33c95408144846afc7_image%201.png"/><img alt="SquareOne" height="28" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac3333068d9632cc6df8_image%202.png"/></div></div></a></div></aside></div><header class="md-header md-header--shadow md-header--lifted" data-md-component="header"><nav aria-label="Header" class="md-header__inner md-grid"><a aria-label="Ultralytics YOLO Docs" class="md-header__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs"><img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/></a><label class="md-header__button md-icon" for="__drawer"><svg class="lucide lucide-menu" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 5h16M4 12h16M4 19h16"></path></svg></label><div class="md-header__title" data-md-component="header-title"><div class="md-header__ellipsis"><div class="md-header__topic"><span class="md-ellipsis"> Ultralytics YOLO Docs </span></div><div class="md-header__topic" data-md-component="header-topic"><span class="md-ellipsis"> Reference for ultralytics/utils/metrics.py </span></div></div></div><form class="md-header__option" data-md-component="palette"><input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg></label><input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to system preference"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label><input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label></form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<div class="md-header__option"><div class="md-select"><button aria-label="Select language" class="md-header__button md-icon"><svg class="lucide lucide-languages" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m5 8 6 6M4 14l6-6 2-3M2 5h12M7 2h1M22 22l-5-10-5 10M14 18h6"></path></svg></button><div class="md-select__inner"><ul class="md-select__list"><li class="md-select__item"><a class="md-select__link" href="/" hreflang="en"> ğŸ‡¬ğŸ‡§ English </a></li><li class="md-select__item"><a class="md-select__link" href="/zh/" hreflang="zh"> ğŸ‡¨ğŸ‡³ ç®€ä½“ä¸­æ–‡ </a></li><li class="md-select__item"><a class="md-select__link" href="/ko/" hreflang="ko"> ğŸ‡°ğŸ‡· í•œêµ­ì–´ </a></li><li class="md-select__item"><a class="md-select__link" href="/ja/" hreflang="ja"> ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª </a></li><li class="md-select__item"><a class="md-select__link" href="/ru/" hreflang="ru"> ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹ </a></li><li class="md-select__item"><a class="md-select__link" href="/de/" hreflang="de"> ğŸ‡©ğŸ‡ª Deutsch </a></li><li class="md-select__item"><a class="md-select__link" href="/fr/" hreflang="fr"> ğŸ‡«ğŸ‡· FranÃ§ais </a></li><li class="md-select__item"><a class="md-select__link" href="/es/" hreflang="es"> ğŸ‡ªğŸ‡¸ EspaÃ±ol </a></li><li class="md-select__item"><a class="md-select__link" href="/pt/" hreflang="pt"> ğŸ‡µğŸ‡¹ PortuguÃªs </a></li><li class="md-select__item"><a class="md-select__link" href="/it/" hreflang="it"> ğŸ‡®ğŸ‡¹ Italiano </a></li><li class="md-select__item"><a class="md-select__link" href="/tr/" hreflang="tr"> ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e </a></li><li class="md-select__item"><a class="md-select__link" href="/vi/" hreflang="vi"> ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t </a></li><li class="md-select__item"><a class="md-select__link" href="/ar/" hreflang="ar"> ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© </a></li></ul></div></div></div><label class="md-header__button md-icon" for="__search"><svg class="lucide lucide-search" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m21 21-4.34-4.34"></path><circle cx="11" cy="11" r="8"></circle></svg></label><div aria-label="Search" class="md-search" data-md-component="search" role="dialog"><button class="md-search__button" type="button"> Search </button></div><div class="md-header__source"><a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository"><div class="md-source__icon md-icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></div><div class="md-source__repository"> ultralytics/ultralytics </div></a></div></nav><nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"><div class="md-grid"><ul class="md-tabs__list"><li class="md-tabs__item"><a class="md-tabs__link" href="../../.."> Home </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../quickstart/"> Quickstart </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../modes/"> Modes </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../tasks/"> Tasks </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../models/"> Models </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../datasets/"> Datasets </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../solutions/"> Solutions </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../guides/"> Guides </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../integrations/"> Integrations </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../hub/"> HUB </a></li><li class="md-tabs__item md-tabs__item--active"><a class="md-tabs__link" href="../../__init__/"> Reference </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../help/"> Help </a></li></ul></div></nav></header><div class="md-container" data-md-component="container"><main class="md-main" data-md-component="main"><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0"><label class="md-nav__title" for="__drawer"><a aria-label="Ultralytics YOLO Docs" class="md-nav__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs"><img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/></a> Ultralytics YOLO Docs </label><div class="md-nav__source"><a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository"><div class="md-source__icon md-icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></div><div class="md-source__repository"> ultralytics/ultralytics </div></a></div><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../.."><span class="md-ellipsis"> Home </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../quickstart/"><span class="md-ellipsis"> Quickstart </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../modes/"><span class="md-ellipsis"> Modes </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../tasks/"><span class="md-ellipsis"> Tasks </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../models/"><span class="md-ellipsis"> Models </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../datasets/"><span class="md-ellipsis"> Datasets </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../solutions/"><span class="md-ellipsis"> Solutions </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../guides/"><span class="md-ellipsis"> Guides </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../integrations/"><span class="md-ellipsis"> Integrations </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../hub/"><span class="md-ellipsis"> HUB </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input checked="" class="md-nav__toggle md-toggle" id="__nav_11" type="checkbox"/><label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex=""><span class="md-ellipsis"> Reference </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="true" aria-labelledby="__nav_11_label" class="md-nav" data-md-level="1"><label class="md-nav__title" for="__nav_11"><span class="md-nav__icon md-icon"></span> Reference </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_2" type="checkbox"/><label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex=""><span class="md-ellipsis"> cfg </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_2_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_2"><span class="md-nav__icon md-icon"></span> cfg </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../cfg/__init__/"><span class="md-ellipsis"> __init__ </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_3" type="checkbox"/><label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex=""><span class="md-ellipsis"> data </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_3_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_3"><span class="md-nav__icon md-icon"></span> data </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../data/annotator/"><span class="md-ellipsis"> annotator </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/augment/"><span class="md-ellipsis"> augment </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/base/"><span class="md-ellipsis"> base </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/build/"><span class="md-ellipsis"> build </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/converter/"><span class="md-ellipsis"> converter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/dataset/"><span class="md-ellipsis"> dataset </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/loaders/"><span class="md-ellipsis"> loaders </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/split/"><span class="md-ellipsis"> split </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/split_dota/"><span class="md-ellipsis"> split_dota </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/utils/"><span class="md-ellipsis"> utils </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_4" type="checkbox"/><label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex=""><span class="md-ellipsis"> engine </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_4_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_4"><span class="md-nav__icon md-icon"></span> engine </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../engine/exporter/"><span class="md-ellipsis"> exporter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/model/"><span class="md-ellipsis"> model </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/predictor/"><span class="md-ellipsis"> predictor </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/results/"><span class="md-ellipsis"> results </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/trainer/"><span class="md-ellipsis"> trainer </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/tuner/"><span class="md-ellipsis"> tuner </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/validator/"><span class="md-ellipsis"> validator </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_5" type="checkbox"/><label class="md-nav__link" for="__nav_11_5" id="__nav_11_5_label" tabindex=""><span class="md-ellipsis"> hub </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_5_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_5"><span class="md-nav__icon md-icon"></span> hub </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../hub/__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/auth/"><span class="md-ellipsis"> auth </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../hub/google/__init__/"><span class="md-ellipsis"> google </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/session/"><span class="md-ellipsis"> session </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/utils/"><span class="md-ellipsis"> utils </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_6" type="checkbox"/><label class="md-nav__link" for="__nav_11_6" id="__nav_11_6_label" tabindex=""><span class="md-ellipsis"> models </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_6_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_6"><span class="md-nav__icon md-icon"></span> models </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/fastsam/model/"><span class="md-ellipsis"> fastsam </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/nas/model/"><span class="md-ellipsis"> nas </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/rtdetr/model/"><span class="md-ellipsis"> rtdetr </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/sam/amg/"><span class="md-ellipsis"> sam </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/utils/loss/"><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/yolo/classify/predict/"><span class="md-ellipsis"> yolo </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_7" type="checkbox"/><label class="md-nav__link" for="__nav_11_7" id="__nav_11_7_label" tabindex=""><span class="md-ellipsis"> nn </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_7_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_7"><span class="md-nav__icon md-icon"></span> nn </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../nn/autobackend/"><span class="md-ellipsis"> autobackend </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../nn/modules/activation/"><span class="md-ellipsis"> modules </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../nn/tasks/"><span class="md-ellipsis"> tasks </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../nn/text_model/"><span class="md-ellipsis"> text_model </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_8" type="checkbox"/><label class="md-nav__link" for="__nav_11_8" id="__nav_11_8_label" tabindex=""><span class="md-ellipsis"> solutions </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_8_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_8"><span class="md-nav__icon md-icon"></span> solutions </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/ai_gym/"><span class="md-ellipsis"> ai_gym </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/analytics/"><span class="md-ellipsis"> analytics </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/config/"><span class="md-ellipsis"> config </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/distance_calculation/"><span class="md-ellipsis"> distance_calculation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/heatmap/"><span class="md-ellipsis"> heatmap </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/instance_segmentation/"><span class="md-ellipsis"> instance_segmentation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_blurrer/"><span class="md-ellipsis"> object_blurrer </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_counter/"><span class="md-ellipsis"> object_counter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_cropper/"><span class="md-ellipsis"> object_cropper </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/parking_management/"><span class="md-ellipsis"> parking_management </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/queue_management/"><span class="md-ellipsis"> queue_management </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/region_counter/"><span class="md-ellipsis"> region_counter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/security_alarm/"><span class="md-ellipsis"> security_alarm </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/similarity_search/"><span class="md-ellipsis"> similarity_search </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/solutions/"><span class="md-ellipsis"> solutions </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/speed_estimation/"><span class="md-ellipsis"> speed_estimation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/streamlit_inference/"><span class="md-ellipsis"> streamlit_inference </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/trackzone/"><span class="md-ellipsis"> trackzone </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/vision_eye/"><span class="md-ellipsis"> vision_eye </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_9" type="checkbox"/><label class="md-nav__link" for="__nav_11_9" id="__nav_11_9_label" tabindex=""><span class="md-ellipsis"> trackers </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_9_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_9"><span class="md-nav__icon md-icon"></span> trackers </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/basetrack/"><span class="md-ellipsis"> basetrack </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/bot_sort/"><span class="md-ellipsis"> bot_sort </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/byte_tracker/"><span class="md-ellipsis"> byte_tracker </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/track/"><span class="md-ellipsis"> track </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../trackers/utils/gmc/"><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input checked="" class="md-nav__toggle md-toggle" id="__nav_11_10" type="checkbox"/><label class="md-nav__link" for="__nav_11_10" id="__nav_11_10_label" tabindex=""><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="true" aria-labelledby="__nav_11_10_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_10"><span class="md-nav__icon md-icon"></span> utils </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../autobatch/"><span class="md-ellipsis"> autobatch </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../autodevice/"><span class="md-ellipsis"> autodevice </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../benchmarks/"><span class="md-ellipsis"> benchmarks </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../callbacks/base/"><span class="md-ellipsis"> callbacks </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../checks/"><span class="md-ellipsis"> checks </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../cpu/"><span class="md-ellipsis"> cpu </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../dist/"><span class="md-ellipsis"> dist </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../downloads/"><span class="md-ellipsis"> downloads </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../errors/"><span class="md-ellipsis"> errors </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../events/"><span class="md-ellipsis"> events </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../export/engine/"><span class="md-ellipsis"> export </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../files/"><span class="md-ellipsis"> files </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../git/"><span class="md-ellipsis"> git </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../instance/"><span class="md-ellipsis"> instance </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../logger/"><span class="md-ellipsis"> logger </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../loss/"><span class="md-ellipsis"> loss </span></a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/><label class="md-nav__link md-nav__link--active" for="__toc"><span class="md-ellipsis"> metrics </span><span class="md-nav__icon md-icon"></span></label><a class="md-nav__link md-nav__link--active" href="./"><span class="md-ellipsis"> metrics </span></a><nav aria-label="On this page" class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc"><span class="md-nav__icon md-icon"></span> On this page </label><ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> ConfusionMatrix</span></a><nav aria-label="Class ultralytics.utils.metrics.ConfusionMatrix" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix._append_matches"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> _append_matches</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.matrix"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> matrix</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.plot"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> plot</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.plot_matches"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> plot_matches</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.print"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> print</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.process_batch"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> process_batch</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.process_cls_preds"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> process_cls_preds</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.summary"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> summary</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.tp_fp"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> tp_fp</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> Metric</span></a><nav aria-label="Class ultralytics.utils.metrics.Metric" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.ap50"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> ap50</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.ap"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> ap</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.mp"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> mp</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.mr"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> mr</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.map50"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> map50</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.map75"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> map75</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.map"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> map</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.maps"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> maps</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.curves"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.curves_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.class_result"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> class_result</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.fitness"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> fitness</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.mean_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> mean_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.update"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> update</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> DetMetrics</span></a><nav aria-label="Class ultralytics.utils.metrics.DetMetrics" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.keys"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> keys</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.maps"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> maps</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.fitness"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> fitness</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.ap_class_index"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> ap_class_index</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.results_dict"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> results_dict</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.curves"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.curves_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.class_result"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> class_result</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.clear_stats"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> clear_stats</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.mean_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> mean_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.process"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> process</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.summary"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> summary</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.update_stats"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> update_stats</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> SegmentMetrics</span></a><nav aria-label="Class ultralytics.utils.metrics.SegmentMetrics" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.keys"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> keys</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.maps"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> maps</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.fitness"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> fitness</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.curves"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.curves_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.class_result"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> class_result</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.mean_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> mean_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.process"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> process</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.summary"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> summary</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> PoseMetrics</span></a><nav aria-label="Class ultralytics.utils.metrics.PoseMetrics" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.keys"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> keys</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.maps"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> maps</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.fitness"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> fitness</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.curves"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.curves_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.class_result"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> class_result</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.mean_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> mean_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.process"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> process</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.summary"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> summary</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> ClassifyMetrics</span></a><nav aria-label="Class ultralytics.utils.metrics.ClassifyMetrics" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics.fitness"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> fitness</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics.results_dict"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> results_dict</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics.keys"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> keys</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics.curves"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics.curves_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics.process"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> process</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics.summary"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> summary</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.OBBMetrics"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> OBBMetrics</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.bbox_ioa"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> bbox_ioa</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.box_iou"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> box_iou</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.bbox_iou"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> bbox_iou</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.mask_iou"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> mask_iou</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.kpt_iou"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> kpt_iou</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics._get_covariance_matrix"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> _get_covariance_matrix</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.probiou"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> probiou</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.batch_probiou"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> batch_probiou</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.smooth_bce"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> smooth_bce</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.smooth"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> smooth</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.plot_pr_curve"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> plot_pr_curve</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.plot_mc_curve"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> plot_mc_curve</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.compute_ap"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> compute_ap</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ap_per_class"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> ap_per_class</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="../nms/"><span class="md-ellipsis"> nms </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../ops/"><span class="md-ellipsis"> ops </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../patches/"><span class="md-ellipsis"> patches </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../plotting/"><span class="md-ellipsis"> plotting </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../tal/"><span class="md-ellipsis"> tal </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../torch_utils/"><span class="md-ellipsis"> torch_utils </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../tqdm/"><span class="md-ellipsis"> tqdm </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../triton/"><span class="md-ellipsis"> triton </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../tuner/"><span class="md-ellipsis"> tuner </span></a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../help/"><span class="md-ellipsis"> Help </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav aria-label="On this page" class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc"><span class="md-nav__icon md-icon"></span> On this page </label><ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> ConfusionMatrix</span></a><nav aria-label="Class ultralytics.utils.metrics.ConfusionMatrix" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix._append_matches"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> _append_matches</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.matrix"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> matrix</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.plot"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> plot</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.plot_matches"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> plot_matches</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.print"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> print</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.process_batch"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> process_batch</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.process_cls_preds"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> process_cls_preds</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.summary"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> summary</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ConfusionMatrix.tp_fp"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> tp_fp</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> Metric</span></a><nav aria-label="Class ultralytics.utils.metrics.Metric" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.ap50"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> ap50</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.ap"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> ap</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.mp"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> mp</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.mr"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> mr</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.map50"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> map50</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.map75"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> map75</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.map"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> map</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.maps"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> maps</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.curves"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.curves_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.class_result"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> class_result</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.fitness"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> fitness</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.mean_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> mean_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.Metric.update"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> update</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> DetMetrics</span></a><nav aria-label="Class ultralytics.utils.metrics.DetMetrics" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.keys"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> keys</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.maps"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> maps</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.fitness"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> fitness</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.ap_class_index"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> ap_class_index</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.results_dict"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> results_dict</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.curves"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.curves_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.class_result"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> class_result</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.clear_stats"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> clear_stats</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.mean_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> mean_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.process"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> process</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.summary"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> summary</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.DetMetrics.update_stats"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> update_stats</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> SegmentMetrics</span></a><nav aria-label="Class ultralytics.utils.metrics.SegmentMetrics" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.keys"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> keys</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.maps"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> maps</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.fitness"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> fitness</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.curves"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.curves_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.class_result"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> class_result</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.mean_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> mean_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.process"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> process</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.SegmentMetrics.summary"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> summary</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> PoseMetrics</span></a><nav aria-label="Class ultralytics.utils.metrics.PoseMetrics" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.keys"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> keys</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.maps"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> maps</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.fitness"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> fitness</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.curves"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.curves_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.class_result"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> class_result</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.mean_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> mean_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.process"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> process</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.PoseMetrics.summary"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> summary</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> ClassifyMetrics</span></a><nav aria-label="Class ultralytics.utils.metrics.ClassifyMetrics" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics.fitness"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> fitness</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics.results_dict"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> results_dict</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics.keys"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> keys</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics.curves"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics.curves_results"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> curves_results</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics.process"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> process</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ClassifyMetrics.summary"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> summary</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.OBBMetrics"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> OBBMetrics</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.bbox_ioa"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> bbox_ioa</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.box_iou"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> box_iou</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.bbox_iou"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> bbox_iou</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.mask_iou"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> mask_iou</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.kpt_iou"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> kpt_iou</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics._get_covariance_matrix"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> _get_covariance_matrix</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.probiou"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> probiou</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.batch_probiou"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> batch_probiou</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.smooth_bce"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> smooth_bce</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.smooth"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> smooth</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.plot_pr_curve"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> plot_pr_curve</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.plot_mc_curve"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> plot_mc_curve</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.compute_ap"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> compute_ap</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.utils.metrics.ap_per_class"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> ap_per_class</span></a></li></ul></nav></div></div></div><div class="md-content" data-md-component="content"><article class="md-content__inner md-typeset"><a class="md-content__button md-icon" href="https://github.com/ultralytics/ultralytics/tree/main/docs/en/reference/utils/metrics.md" rel="edit" title="Edit this page"><svg class="lucide lucide-file-pen" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5"></path><path d="M14 2v4a2 2 0 0 0 2 2h4M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z"></path></svg></a><h1 id="reference-for-ultralyticsutilsmetricspy">Reference for <code>ultralytics/utils/metrics.py</code></h1><div class="admonition success"><p class="admonition-title">Improvements</p><p>This page is sourced from <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py">https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py</a>. Have an improvement or example to add? Open a <a href="https://docs.ultralytics.com/help/contributing/">Pull Request</a> â€” thank you! ğŸ™</p></div><p><br/></p><div class="admonition abstract"><p class="admonition-title">Summary</p><div class="tabbed-set tabbed-alternate" data-tabs="1:4"><input checked="checked" id="classes" name="__tabbed_1" type="radio"/><input id="properties" name="__tabbed_1" type="radio"/><input id="methods" name="__tabbed_1" type="radio"/><input id="functions" name="__tabbed_1" type="radio"/><div class="tabbed-labels"><label for="classes"><span class="doc-kind doc-kind-class">Classes</span></label><label for="properties"><span class="doc-kind doc-kind-property">Properties</span></label><label for="methods"><span class="doc-kind doc-kind-method">Methods</span></label><label for="functions"><span class="doc-kind doc-kind-function">Functions</span></label></div><div class="tabbed-content"><div class="tabbed-block"><ul><li><a href="#ultralytics.utils.metrics.ConfusionMatrix"><code>ConfusionMatrix</code></a></li><li><a href="#ultralytics.utils.metrics.Metric"><code>Metric</code></a></li><li><a href="#ultralytics.utils.metrics.DetMetrics"><code>DetMetrics</code></a></li><li><a href="#ultralytics.utils.metrics.SegmentMetrics"><code>SegmentMetrics</code></a></li><li><a href="#ultralytics.utils.metrics.PoseMetrics"><code>PoseMetrics</code></a></li><li><a href="#ultralytics.utils.metrics.ClassifyMetrics"><code>ClassifyMetrics</code></a></li><li><a href="#ultralytics.utils.metrics.OBBMetrics"><code>OBBMetrics</code></a></li></ul></div><div class="tabbed-block"><ul><li><a href="#ultralytics.utils.metrics.Metric.ap50"><code>Metric.ap50</code></a></li><li><a href="#ultralytics.utils.metrics.Metric.ap"><code>Metric.ap</code></a></li><li><a href="#ultralytics.utils.metrics.Metric.mp"><code>Metric.mp</code></a></li><li><a href="#ultralytics.utils.metrics.Metric.mr"><code>Metric.mr</code></a></li><li><a href="#ultralytics.utils.metrics.Metric.map50"><code>Metric.map50</code></a></li><li><a href="#ultralytics.utils.metrics.Metric.map75"><code>Metric.map75</code></a></li><li><a href="#ultralytics.utils.metrics.Metric.map"><code>Metric.map</code></a></li><li><a href="#ultralytics.utils.metrics.Metric.maps"><code>Metric.maps</code></a></li><li><a href="#ultralytics.utils.metrics.Metric.curves"><code>Metric.curves</code></a></li><li><a href="#ultralytics.utils.metrics.Metric.curves_results"><code>Metric.curves_results</code></a></li><li><a href="#ultralytics.utils.metrics.DetMetrics.keys"><code>DetMetrics.keys</code></a></li><li><a href="#ultralytics.utils.metrics.DetMetrics.maps"><code>DetMetrics.maps</code></a></li><li><a href="#ultralytics.utils.metrics.DetMetrics.fitness"><code>DetMetrics.fitness</code></a></li><li><a href="#ultralytics.utils.metrics.DetMetrics.ap_class_index"><code>DetMetrics.ap_class_index</code></a></li><li><a href="#ultralytics.utils.metrics.DetMetrics.results_dict"><code>DetMetrics.results_dict</code></a></li><li><a href="#ultralytics.utils.metrics.DetMetrics.curves"><code>DetMetrics.curves</code></a></li><li><a href="#ultralytics.utils.metrics.DetMetrics.curves_results"><code>DetMetrics.curves_results</code></a></li><li><a href="#ultralytics.utils.metrics.SegmentMetrics.keys"><code>SegmentMetrics.keys</code></a></li><li><a href="#ultralytics.utils.metrics.SegmentMetrics.maps"><code>SegmentMetrics.maps</code></a></li><li><a href="#ultralytics.utils.metrics.SegmentMetrics.fitness"><code>SegmentMetrics.fitness</code></a></li><li><a href="#ultralytics.utils.metrics.SegmentMetrics.curves"><code>SegmentMetrics.curves</code></a></li><li><a href="#ultralytics.utils.metrics.SegmentMetrics.curves_results"><code>SegmentMetrics.curves_results</code></a></li><li><a href="#ultralytics.utils.metrics.PoseMetrics.keys"><code>PoseMetrics.keys</code></a></li><li><a href="#ultralytics.utils.metrics.PoseMetrics.maps"><code>PoseMetrics.maps</code></a></li><li><a href="#ultralytics.utils.metrics.PoseMetrics.fitness"><code>PoseMetrics.fitness</code></a></li><li><a href="#ultralytics.utils.metrics.PoseMetrics.curves"><code>PoseMetrics.curves</code></a></li><li><a href="#ultralytics.utils.metrics.PoseMetrics.curves_results"><code>PoseMetrics.curves_results</code></a></li><li><a href="#ultralytics.utils.metrics.ClassifyMetrics.fitness"><code>ClassifyMetrics.fitness</code></a></li><li><a href="#ultralytics.utils.metrics.ClassifyMetrics.results_dict"><code>ClassifyMetrics.results_dict</code></a></li><li><a href="#ultralytics.utils.metrics.ClassifyMetrics.keys"><code>ClassifyMetrics.keys</code></a></li><li><a href="#ultralytics.utils.metrics.ClassifyMetrics.curves"><code>ClassifyMetrics.curves</code></a></li><li><a href="#ultralytics.utils.metrics.ClassifyMetrics.curves_results"><code>ClassifyMetrics.curves_results</code></a></li></ul></div><div class="tabbed-block"><ul><li><a href="#ultralytics.utils.metrics.ConfusionMatrix._append_matches"><code>ConfusionMatrix._append_matches</code></a></li><li><a href="#ultralytics.utils.metrics.ConfusionMatrix.process_cls_preds"><code>ConfusionMatrix.process_cls_preds</code></a></li><li><a href="#ultralytics.utils.metrics.ConfusionMatrix.process_batch"><code>ConfusionMatrix.process_batch</code></a></li><li><a href="#ultralytics.utils.metrics.ConfusionMatrix.matrix"><code>ConfusionMatrix.matrix</code></a></li><li><a href="#ultralytics.utils.metrics.ConfusionMatrix.tp_fp"><code>ConfusionMatrix.tp_fp</code></a></li><li><a href="#ultralytics.utils.metrics.ConfusionMatrix.plot_matches"><code>ConfusionMatrix.plot_matches</code></a></li><li><a href="#ultralytics.utils.metrics.ConfusionMatrix.plot"><code>ConfusionMatrix.plot</code></a></li><li><a href="#ultralytics.utils.metrics.ConfusionMatrix.print"><code>ConfusionMatrix.print</code></a></li><li><a href="#ultralytics.utils.metrics.ConfusionMatrix.summary"><code>ConfusionMatrix.summary</code></a></li><li><a href="#ultralytics.utils.metrics.Metric.mean_results"><code>Metric.mean_results</code></a></li><li><a href="#ultralytics.utils.metrics.Metric.class_result"><code>Metric.class_result</code></a></li><li><a href="#ultralytics.utils.metrics.Metric.fitness"><code>Metric.fitness</code></a></li><li><a href="#ultralytics.utils.metrics.Metric.update"><code>Metric.update</code></a></li><li><a href="#ultralytics.utils.metrics.DetMetrics.update_stats"><code>DetMetrics.update_stats</code></a></li><li><a href="#ultralytics.utils.metrics.DetMetrics.process"><code>DetMetrics.process</code></a></li><li><a href="#ultralytics.utils.metrics.DetMetrics.clear_stats"><code>DetMetrics.clear_stats</code></a></li><li><a href="#ultralytics.utils.metrics.DetMetrics.mean_results"><code>DetMetrics.mean_results</code></a></li><li><a href="#ultralytics.utils.metrics.DetMetrics.class_result"><code>DetMetrics.class_result</code></a></li><li><a href="#ultralytics.utils.metrics.DetMetrics.summary"><code>DetMetrics.summary</code></a></li><li><a href="#ultralytics.utils.metrics.SegmentMetrics.process"><code>SegmentMetrics.process</code></a></li><li><a href="#ultralytics.utils.metrics.SegmentMetrics.mean_results"><code>SegmentMetrics.mean_results</code></a></li><li><a href="#ultralytics.utils.metrics.SegmentMetrics.class_result"><code>SegmentMetrics.class_result</code></a></li><li><a href="#ultralytics.utils.metrics.SegmentMetrics.summary"><code>SegmentMetrics.summary</code></a></li><li><a href="#ultralytics.utils.metrics.PoseMetrics.process"><code>PoseMetrics.process</code></a></li><li><a href="#ultralytics.utils.metrics.PoseMetrics.mean_results"><code>PoseMetrics.mean_results</code></a></li><li><a href="#ultralytics.utils.metrics.PoseMetrics.class_result"><code>PoseMetrics.class_result</code></a></li><li><a href="#ultralytics.utils.metrics.PoseMetrics.summary"><code>PoseMetrics.summary</code></a></li><li><a href="#ultralytics.utils.metrics.ClassifyMetrics.process"><code>ClassifyMetrics.process</code></a></li><li><a href="#ultralytics.utils.metrics.ClassifyMetrics.summary"><code>ClassifyMetrics.summary</code></a></li></ul></div><div class="tabbed-block"><ul><li><a href="#ultralytics.utils.metrics.bbox_ioa"><code>bbox_ioa</code></a></li><li><a href="#ultralytics.utils.metrics.box_iou"><code>box_iou</code></a></li><li><a href="#ultralytics.utils.metrics.bbox_iou"><code>bbox_iou</code></a></li><li><a href="#ultralytics.utils.metrics.mask_iou"><code>mask_iou</code></a></li><li><a href="#ultralytics.utils.metrics.kpt_iou"><code>kpt_iou</code></a></li><li><a href="#ultralytics.utils.metrics._get_covariance_matrix"><code>_get_covariance_matrix</code></a></li><li><a href="#ultralytics.utils.metrics.probiou"><code>probiou</code></a></li><li><a href="#ultralytics.utils.metrics.batch_probiou"><code>batch_probiou</code></a></li><li><a href="#ultralytics.utils.metrics.smooth_bce"><code>smooth_bce</code></a></li><li><a href="#ultralytics.utils.metrics.smooth"><code>smooth</code></a></li><li><a href="#ultralytics.utils.metrics.plot_pr_curve"><code>plot_pr_curve</code></a></li><li><a href="#ultralytics.utils.metrics.plot_mc_curve"><code>plot_mc_curve</code></a></li><li><a href="#ultralytics.utils.metrics.compute_ap"><code>compute_ap</code></a></li><li><a href="#ultralytics.utils.metrics.ap_per_class"><code>ap_per_class</code></a></li></ul></div></div></div></div><h2 id="ultralytics.utils.metrics.ConfusionMatrix"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.utils.metrics.ConfusionMatrix</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">ConfusionMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"detect"</span><span class="p">,</span> <span class="n">save_matches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</code></pre></div><p><strong>Bases:</strong> <code>DataExportMixin</code></p><p>A class for calculating and updating a confusion matrix for object detection and classification tasks.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>names</code></td><td><code>dict[int, str], optional</code></td><td>Names of classes, used as labels on the plot.</td><td><code>[]</code></td></tr><tr><td><code>task</code></td><td><code>str, optional</code></td><td>Type of task, either 'detect' or 'classify'.</td><td><code>"detect"</code></td></tr><tr><td><code>save_matches</code></td><td><code>bool, optional</code></td><td>Save the indices of GTs, TPs, FPs, FNs for visualization.</td><td><code>False</code></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>task</code></td><td><code>str</code></td><td>The type of task, either 'detect' or 'classify'.</td></tr><tr><td><code>matrix</code></td><td><code>np.ndarray</code></td><td>The confusion matrix, with dimensions depending on the task.</td></tr><tr><td><code>nc</code></td><td><code>int</code></td><td>The number of category.</td></tr><tr><td><code>names</code></td><td><code>list[str]</code></td><td>The names of the classes, used as labels on the plot.</td></tr><tr><td><code>matches</code></td><td><code>dict</code></td><td>Contains the indices of ground truths and predictions categorized into TP, FP and FN.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.utils.metrics.ConfusionMatrix._append_matches"><code>_append_matches</code></a></td><td>Append the matches to TP, FP, FN or GT list for the last batch.</td></tr><tr><td><a href="#ultralytics.utils.metrics.ConfusionMatrix.matrix"><code>matrix</code></a></td><td>Return the confusion matrix.</td></tr><tr><td><a href="#ultralytics.utils.metrics.ConfusionMatrix.plot"><code>plot</code></a></td><td>Plot the confusion matrix using matplotlib and save it to a file.</td></tr><tr><td><a href="#ultralytics.utils.metrics.ConfusionMatrix.plot_matches"><code>plot_matches</code></a></td><td>Plot grid of GT, TP, FP, FN for each image.</td></tr><tr><td><a href="#ultralytics.utils.metrics.ConfusionMatrix.print"><code>print</code></a></td><td>Print the confusion matrix to the console.</td></tr><tr><td><a href="#ultralytics.utils.metrics.ConfusionMatrix.process_batch"><code>process_batch</code></a></td><td>Update confusion matrix for object detection task.</td></tr><tr><td><a href="#ultralytics.utils.metrics.ConfusionMatrix.process_cls_preds"><code>process_cls_preds</code></a></td><td>Update confusion matrix for classification task.</td></tr><tr><td><a href="#ultralytics.utils.metrics.ConfusionMatrix.summary"><code>summary</code></a></td><td>Generate a summarized representation of the confusion matrix as a list of dictionaries, with optional</td></tr><tr><td><a href="#ultralytics.utils.metrics.ConfusionMatrix.tp_fp"><code>tp_fp</code></a></td><td>Return true positives and false positives.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L306-L612"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ConfusionMatrix</span><span class="p">(</span><span class="n">DataExportMixin</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""A class for calculating and updating a confusion matrix for object detection and classification tasks.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        task (str): The type of task, either 'detect' or 'classify'.</span>
<span></span><span class="sd">        matrix (np.ndarray): The confusion matrix, with dimensions depending on the task.</span>
<span></span><span class="sd">        nc (int): The number of category.</span>
<span></span><span class="sd">        names (list[str]): The names of the classes, used as labels on the plot.</span>
<span></span><span class="sd">        matches (dict): Contains the indices of ground truths and predictions categorized into TP, FP and FN.</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"detect"</span><span class="p">,</span> <span class="n">save_matches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize a ConfusionMatrix instance.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            names (dict[int, str], optional): Names of classes, used as labels on the plot.</span>
<span></span><span class="sd">            task (str, optional): Type of task, either 'detect' or 'classify'.</span>
<span></span><span class="sd">            save_matches (bool, optional): Save the indices of GTs, TPs, FPs, FNs for visualization.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="n">task</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>  <span class="c1"># number of classes</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">))</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">==</span> <span class="s2">"classify"</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">names</span>  <span class="c1"># name of classes</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">matches</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">save_matches</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ConfusionMatrix._append_matches"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.ConfusionMatrix._append_matches</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_append_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mtype</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p>Append the matches to TP, FP, FN or GT list for the last batch.</p><p>This method updates the matches dictionary by appending specific batch data to the appropriate match type (True Positive, False Positive, or False Negative).</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>mtype</code></td><td><code>str</code></td><td>Match type identifier ('TP', 'FP', 'FN' or 'GT').</td><td><em>required</em></td></tr><tr><td><code>batch</code></td><td><code>dict[str, Any]</code></td><td>Batch data containing detection results with keys like 'bboxes', 'cls', 'conf', 'keypoints', 'masks'.</td><td><em>required</em></td></tr><tr><td><code>idx</code></td><td><code>int</code></td><td>Index of the specific detection to append from the batch.</td><td><em>required</em></td></tr></tbody></table><div class="admonition note"><p class="admonition-title">Notes</p><p>For masks, handles both overlap and non-overlap cases. When masks.max() &gt; 1.0, it indicates
overlap_mask=True with shape (1, H, W), otherwise uses direct indexing.</p></div><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L331-L354"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_append_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mtype</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Append the matches to TP, FP, FN or GT list for the last batch.</span>
<span></span>
<span></span><span class="sd">    This method updates the matches dictionary by appending specific batch data to the appropriate match type (True</span>
<span></span><span class="sd">    Positive, False Positive, or False Negative).</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        mtype (str): Match type identifier ('TP', 'FP', 'FN' or 'GT').</span>
<span></span><span class="sd">        batch (dict[str, Any]): Batch data containing detection results with keys like 'bboxes', 'cls', 'conf',</span>
<span></span><span class="sd">            'keypoints', 'masks'.</span>
<span></span><span class="sd">        idx (int): Index of the specific detection to append from the batch.</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        For masks, handles both overlap and non-overlap cases. When masks.max() &gt; 1.0, it indicates</span>
<span></span><span class="sd">        overlap_mask=True with shape (1, H, W), otherwise uses direct indexing.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matches</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="k">return</span>
<span></span>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">batch</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span></span>        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"bboxes"</span><span class="p">,</span> <span class="s2">"cls"</span><span class="p">,</span> <span class="s2">"conf"</span><span class="p">,</span> <span class="s2">"keypoints"</span><span class="p">}:</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">matches</span><span class="p">[</span><span class="n">mtype</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">v</span><span class="p">[[</span><span class="n">idx</span><span class="p">]]</span>
<span></span>        <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">"masks"</span><span class="p">:</span>
<span></span>            <span class="c1"># NOTE: masks.max() &gt; 1.0 means overlap_mask=True with (1, H, W) shape</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">matches</span><span class="p">[</span><span class="n">mtype</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="k">else</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ConfusionMatrix.matrix"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.ConfusionMatrix.matrix</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>Return the confusion matrix.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L446-L448"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Return the confusion matrix."""</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ConfusionMatrix.plot"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.ConfusionMatrix.plot</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span> <span class="n">on_plot</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div><p>Plot the confusion matrix using matplotlib and save it to a file.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>normalize</code></td><td><code>bool, optional</code></td><td>Whether to normalize the confusion matrix.</td><td><code>True</code></td></tr><tr><td><code>save_dir</code></td><td><code>str, optional</code></td><td>Directory where the plot will be saved.</td><td><code>""</code></td></tr><tr><td><code>on_plot</code></td><td><code>callable, optional</code></td><td>An optional callback to pass plots path and data when they are rendered.</td><td><code>None</code></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L501-L570"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@TryExcept</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">"ConfusionMatrix plot failure"</span><span class="p">)</span>
<span></span><span class="nd">@plt_settings</span><span class="p">()</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span> <span class="n">on_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Plot the confusion matrix using matplotlib and save it to a file.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        normalize (bool, optional): Whether to normalize the confusion matrix.</span>
<span></span><span class="sd">        save_dir (str, optional): Directory where the plot will be saved.</span>
<span></span><span class="sd">        on_plot (callable, optional): An optional callback to pass plots path and data when they are rendered.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>  <span class="c1"># scope for faster 'import ultralytics'</span>
<span></span>
<span></span>    <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">/</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-9</span><span class="p">)</span> <span class="k">if</span> <span class="n">normalize</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># normalize columns</span>
<span></span>    <span class="n">array</span><span class="p">[</span><span class="n">array</span> <span class="o">&lt;</span> <span class="mf">0.005</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>  <span class="c1"># don't annotate (would appear as 0.00)</span>
<span></span>
<span></span>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span></span>    <span class="n">names</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span> <span class="o">&gt;=</span> <span class="mi">100</span><span class="p">:</span>  <span class="c1"># downsample for large class count</span>
<span></span>        <span class="n">k</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span> <span class="o">//</span> <span class="mi">60</span><span class="p">)</span>  <span class="c1"># step size for downsampling, always &gt; 1</span>
<span></span>        <span class="n">keep_idx</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>  <span class="c1"># create slice instead of array</span>
<span></span>        <span class="n">names</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="n">keep_idx</span><span class="p">]</span>  <span class="c1"># slice class names</span>
<span></span>        <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">keep_idx</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">keep_idx</span><span class="p">]</span>  <span class="c1"># slice matrix rows and cols</span>
<span></span>        <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span> <span class="o">+</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">k</span>  <span class="c1"># number of retained classes</span>
<span></span>    <span class="n">nc</span> <span class="o">=</span> <span class="n">nn</span> <span class="o">=</span> <span class="n">n</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">==</span> <span class="s2">"classify"</span> <span class="k">else</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># adjust for background if needed</span>
<span></span>    <span class="n">ticklabels</span> <span class="o">=</span> <span class="p">([</span><span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="s2">"background"</span><span class="p">])</span> <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">nn</span> <span class="o">&lt;</span> <span class="mi">99</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nn</span> <span class="o">==</span> <span class="n">nc</span><span class="p">)</span> <span class="k">else</span> <span class="s2">"auto"</span>
<span></span>    <span class="n">xy_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ticklabels</span><span class="p">))</span>
<span></span>    <span class="n">tick_fontsize</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">15</span> <span class="o">-</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">nc</span><span class="p">)</span>  <span class="c1"># Minimum size is 6</span>
<span></span>    <span class="n">label_fontsize</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span> <span class="o">-</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">nc</span><span class="p">)</span>
<span></span>    <span class="n">title_fontsize</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span> <span class="o">-</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">nc</span><span class="p">)</span>
<span></span>    <span class="n">btm</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span> <span class="o">-</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">nc</span><span class="p">)</span>  <span class="c1"># Minimum value is 0.1</span>
<span></span>    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<span></span>        <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>  <span class="c1"># suppress empty matrix RuntimeWarning: All-NaN slice encountered</span>
<span></span>        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"Blues"</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">"none"</span><span class="p">)</span>
<span></span>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">"bottom"</span><span class="p">)</span>
<span></span>        <span class="k">if</span> <span class="n">nc</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>  <span class="c1"># Add score for each cell of confusion matrix</span>
<span></span>            <span class="n">color_threshold</span> <span class="o">=</span> <span class="mf">0.45</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">normalize</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>  <span class="c1"># text color threshold</span>
<span></span>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">array</span><span class="p">[:</span><span class="n">nc</span><span class="p">]):</span>
<span></span>                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">[:</span><span class="n">nc</span><span class="p">]):</span>
<span></span>                    <span class="n">val</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
<span></span>                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<span></span>                        <span class="k">continue</span>
<span></span>                    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
<span></span>                        <span class="n">j</span><span class="p">,</span>
<span></span>                        <span class="n">i</span><span class="p">,</span>
<span></span>                        <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span> <span class="k">if</span> <span class="n">normalize</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
<span></span>                        <span class="n">ha</span><span class="o">=</span><span class="s2">"center"</span><span class="p">,</span>
<span></span>                        <span class="n">va</span><span class="o">=</span><span class="s2">"center"</span><span class="p">,</span>
<span></span>                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span></span>                        <span class="n">color</span><span class="o">=</span><span class="s2">"white"</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">color_threshold</span> <span class="k">else</span> <span class="s2">"black"</span><span class="p">,</span>
<span></span>                    <span class="p">)</span>
<span></span>        <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span></span>    <span class="n">title</span> <span class="o">=</span> <span class="s2">"Confusion Matrix"</span> <span class="o">+</span> <span class="s2">" Normalized"</span> <span class="o">*</span> <span class="n">normalize</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"True"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fontsize</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Predicted"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fontsize</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">title_fontsize</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xy_ticks</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">xy_ticks</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">"x"</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">"y"</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">ticklabels</span> <span class="o">!=</span> <span class="s2">"auto"</span><span class="p">:</span>
<span></span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ticklabels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">tick_fontsize</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">"center"</span><span class="p">)</span>
<span></span>        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ticklabels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">tick_fontsize</span><span class="p">)</span>
<span></span>    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"left"</span><span class="p">,</span> <span class="s2">"right"</span><span class="p">,</span> <span class="s2">"bottom"</span><span class="p">,</span> <span class="s2">"top"</span><span class="p">,</span> <span class="s2">"outline"</span><span class="p">}:</span>
<span></span>        <span class="k">if</span> <span class="n">s</span> <span class="o">!=</span> <span class="s2">"outline"</span><span class="p">:</span>
<span></span>            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Confusion matrix plot don't have outline</span>
<span></span>        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span></span>    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.84</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.94</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">btm</span><span class="p">)</span>  <span class="c1"># Adjust layout to ensure equal margins</span>
<span></span>    <span class="n">plot_fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">save_dir</span><span class="p">)</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">title</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span><span class="w"> </span><span class="s1">'_'</span><span class="p">)</span><span class="si">}</span><span class="s2">.png"</span>
<span></span>    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_fname</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span></span>    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">on_plot</span><span class="p">:</span>
<span></span>        <span class="n">on_plot</span><span class="p">(</span><span class="n">plot_fname</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ConfusionMatrix.plot_matches"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.ConfusionMatrix.plot_matches</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">im_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p>Plot grid of GT, TP, FP, FN for each image.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>img</code></td><td><code>torch.Tensor</code></td><td>Image to plot onto.</td><td><em>required</em></td></tr><tr><td><code>im_file</code></td><td><code>str</code></td><td>Image filename to save visualizations.</td><td><em>required</em></td></tr><tr><td><code>save_dir</code></td><td><code>Path</code></td><td>Location to save the visualizations to.</td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L462-L497"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">im_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Plot grid of GT, TP, FP, FN for each image.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        img (torch.Tensor): Image to plot onto.</span>
<span></span><span class="sd">        im_file (str): Image filename to save visualizations.</span>
<span></span><span class="sd">        save_dir (Path): Location to save the visualizations to.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">matches</span><span class="p">:</span>
<span></span>        <span class="k">return</span>
<span></span>    <span class="kn">from</span><span class="w"> </span><span class="nn">.ops</span><span class="w"> </span><span class="kn">import</span> <span class="n">xyxy2xywh</span>
<span></span>    <span class="kn">from</span><span class="w"> </span><span class="nn">.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_images</span>
<span></span>
<span></span>    <span class="c1"># Create batch of 4 (GT, TP, FP, FN)</span>
<span></span>    <span class="n">labels</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span></span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mtype</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s2">"GT"</span><span class="p">,</span> <span class="s2">"FP"</span><span class="p">,</span> <span class="s2">"TP"</span><span class="p">,</span> <span class="s2">"FN"</span><span class="p">]):</span>
<span></span>        <span class="n">mbatch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matches</span><span class="p">[</span><span class="n">mtype</span><span class="p">]</span>
<span></span>        <span class="k">if</span> <span class="s2">"conf"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mbatch</span><span class="p">:</span>
<span></span>            <span class="n">mbatch</span><span class="p">[</span><span class="s2">"conf"</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">mbatch</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]),</span> <span class="n">device</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<span></span>        <span class="n">mbatch</span><span class="p">[</span><span class="s2">"batch_idx"</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mbatch</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]),</span> <span class="n">device</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> <span class="o">*</span> <span class="n">i</span>
<span></span>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">mbatch</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span></span>            <span class="n">labels</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">mbatch</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<span></span>
<span></span>    <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">!=</span> <span class="s2">"obb"</span> <span class="ow">and</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<span></span>        <span class="n">labels</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]</span> <span class="o">=</span> <span class="n">xyxy2xywh</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">])</span>
<span></span>    <span class="p">(</span><span class="n">save_dir</span> <span class="o">/</span> <span class="s2">"visualizations"</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>    <span class="n">plot_images</span><span class="p">(</span>
<span></span>        <span class="n">labels</span><span class="p">,</span>
<span></span>        <span class="n">img</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span></span>        <span class="n">paths</span><span class="o">=</span><span class="p">[</span><span class="s2">"Ground Truth"</span><span class="p">,</span> <span class="s2">"False Positives"</span><span class="p">,</span> <span class="s2">"True Positives"</span><span class="p">,</span> <span class="s2">"False Negatives"</span><span class="p">],</span>
<span></span>        <span class="n">fname</span><span class="o">=</span><span class="n">save_dir</span> <span class="o">/</span> <span class="s2">"visualizations"</span> <span class="o">/</span> <span class="n">Path</span><span class="p">(</span><span class="n">im_file</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span></span>        <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
<span></span>        <span class="n">max_subplots</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span></span>        <span class="n">conf_thres</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
<span></span>    <span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ConfusionMatrix.print"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.ConfusionMatrix.print</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>Print the confusion matrix to the console.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L572-L575"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Print the confusion matrix to the console."""</span>
<span></span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ConfusionMatrix.process_batch"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.ConfusionMatrix.process_batch</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process_batch</span><span class="p">(</span>
<span></span>    <span class="bp">self</span><span class="p">,</span>
<span></span>    <span class="n">detections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span>
<span></span>    <span class="n">batch</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span></span>    <span class="n">conf</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span>
<span></span>    <span class="n">iou_thres</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.45</span><span class="p">,</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p>Update confusion matrix for object detection task.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>detections</code></td><td><code>dict[str, torch.Tensor]</code></td><td>Dictionary containing detected bounding boxes and their associated information. Should contain 'cls', 'conf', and 'bboxes' keys, where 'bboxes' can be Array[N, 4] for regular boxes or Array[N, 5] for OBB with angle.</td><td><em>required</em></td></tr><tr><td><code>batch</code></td><td><code>dict[str, Any]</code></td><td>Batch dictionary containing ground truth data with 'bboxes' (Array[M, 4]</td><td>Array[M, 5]) and 'cls' (Array[M]) keys, where M is the number of ground truth objects.</td></tr><tr><td><code>conf</code></td><td><code>float, optional</code></td><td>Confidence threshold for detections.</td><td><code>0.25</code></td></tr><tr><td><code>iou_thres</code></td><td><code>float, optional</code></td><td>IoU threshold for matching detections to ground truth.</td><td><code>0.45</code></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L367-L444"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process_batch</span><span class="p">(</span>
<span></span>    <span class="bp">self</span><span class="p">,</span>
<span></span>    <span class="n">detections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span>
<span></span>    <span class="n">batch</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span></span>    <span class="n">conf</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span>
<span></span>    <span class="n">iou_thres</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.45</span><span class="p">,</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Update confusion matrix for object detection task.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        detections (dict[str, torch.Tensor]): Dictionary containing detected bounding boxes and their associated</span>
<span></span><span class="sd">            information. Should contain 'cls', 'conf', and 'bboxes' keys, where 'bboxes' can be Array[N, 4] for</span>
<span></span><span class="sd">            regular boxes or Array[N, 5] for OBB with angle.</span>
<span></span><span class="sd">        batch (dict[str, Any]): Batch dictionary containing ground truth data with 'bboxes' (Array[M, 4]| Array[M,</span>
<span></span><span class="sd">            5]) and 'cls' (Array[M]) keys, where M is the number of ground truth objects.</span>
<span></span><span class="sd">        conf (float, optional): Confidence threshold for detections.</span>
<span></span><span class="sd">        iou_thres (float, optional): IoU threshold for matching detections to ground truth.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">gt_cls</span><span class="p">,</span> <span class="n">gt_bboxes</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">],</span> <span class="n">batch</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matches</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># only if visualization is enabled</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">matches</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"TP"</span><span class="p">,</span> <span class="s2">"FP"</span><span class="p">,</span> <span class="s2">"FN"</span><span class="p">,</span> <span class="s2">"GT"</span><span class="p">}}</span>
<span></span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">gt_cls</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">_append_matches</span><span class="p">(</span><span class="s2">"GT"</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>  <span class="c1"># store GT</span>
<span></span>    <span class="n">is_obb</span> <span class="o">=</span> <span class="n">gt_bboxes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5</span>  <span class="c1"># check if boxes contains angle for OBB</span>
<span></span>    <span class="n">conf</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="k">if</span> <span class="n">conf</span> <span class="ow">in</span> <span class="p">{</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.01</span> <span class="k">if</span> <span class="n">is_obb</span> <span class="k">else</span> <span class="mf">0.001</span><span class="p">}</span> <span class="k">else</span> <span class="n">conf</span>  <span class="c1"># apply 0.25 if default val conf is passed</span>
<span></span>    <span class="n">no_pred</span> <span class="o">=</span> <span class="n">detections</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span>
<span></span>    <span class="k">if</span> <span class="n">gt_cls</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Check if labels is empty</span>
<span></span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">no_pred</span><span class="p">:</span>
<span></span>            <span class="n">detections</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">detections</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">detections</span><span class="p">[</span><span class="s2">"conf"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">conf</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">detections</span><span class="p">}</span>
<span></span>            <span class="n">detection_classes</span> <span class="o">=</span> <span class="n">detections</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">]</span><span class="o">.</span><span class="n">int</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span></span>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">detection_classes</span><span class="p">):</span>
<span></span>                <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="n">dc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># FP</span>
<span></span>                <span class="bp">self</span><span class="o">.</span><span class="n">_append_matches</span><span class="p">(</span><span class="s2">"FP"</span><span class="p">,</span> <span class="n">detections</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span></span>        <span class="k">return</span>
<span></span>    <span class="k">if</span> <span class="n">no_pred</span><span class="p">:</span>
<span></span>        <span class="n">gt_classes</span> <span class="o">=</span> <span class="n">gt_cls</span><span class="o">.</span><span class="n">int</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span></span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">gc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gt_classes</span><span class="p">):</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">,</span> <span class="n">gc</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># FN</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">_append_matches</span><span class="p">(</span><span class="s2">"FN"</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span></span>        <span class="k">return</span>
<span></span>
<span></span>    <span class="n">detections</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">detections</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">detections</span><span class="p">[</span><span class="s2">"conf"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">conf</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">detections</span><span class="p">}</span>
<span></span>    <span class="n">gt_classes</span> <span class="o">=</span> <span class="n">gt_cls</span><span class="o">.</span><span class="n">int</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span></span>    <span class="n">detection_classes</span> <span class="o">=</span> <span class="n">detections</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">]</span><span class="o">.</span><span class="n">int</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span></span>    <span class="n">bboxes</span> <span class="o">=</span> <span class="n">detections</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]</span>
<span></span>    <span class="n">iou</span> <span class="o">=</span> <span class="n">batch_probiou</span><span class="p">(</span><span class="n">gt_bboxes</span><span class="p">,</span> <span class="n">bboxes</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_obb</span> <span class="k">else</span> <span class="n">box_iou</span><span class="p">(</span><span class="n">gt_bboxes</span><span class="p">,</span> <span class="n">bboxes</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">iou</span> <span class="o">&gt;</span> <span class="n">iou_thres</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<span></span>        <span class="n">matches</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">iou</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]][:,</span> <span class="kc">None</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span></span>        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span></span>            <span class="n">matches</span> <span class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="n">matches</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span></span>            <span class="n">matches</span> <span class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">matches</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]]</span>
<span></span>            <span class="n">matches</span> <span class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="n">matches</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span></span>            <span class="n">matches</span> <span class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">matches</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]]</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="n">matches</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span></span>
<span></span>    <span class="n">n</span> <span class="o">=</span> <span class="n">matches</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span></span>    <span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">matches</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span></span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">gc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gt_classes</span><span class="p">):</span>
<span></span>        <span class="n">j</span> <span class="o">=</span> <span class="n">m0</span> <span class="o">==</span> <span class="n">i</span>
<span></span>        <span class="k">if</span> <span class="n">n</span> <span class="ow">and</span> <span class="nb">sum</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span></span>            <span class="n">dc</span> <span class="o">=</span> <span class="n">detection_classes</span><span class="p">[</span><span class="n">m1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()]</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="n">dc</span><span class="p">,</span> <span class="n">gc</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># TP if class is correct else both an FP and an FN</span>
<span></span>            <span class="k">if</span> <span class="n">dc</span> <span class="o">==</span> <span class="n">gc</span><span class="p">:</span>
<span></span>                <span class="bp">self</span><span class="o">.</span><span class="n">_append_matches</span><span class="p">(</span><span class="s2">"TP"</span><span class="p">,</span> <span class="n">detections</span><span class="p">,</span> <span class="n">m1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
<span></span>            <span class="k">else</span><span class="p">:</span>
<span></span>                <span class="bp">self</span><span class="o">.</span><span class="n">_append_matches</span><span class="p">(</span><span class="s2">"FP"</span><span class="p">,</span> <span class="n">detections</span><span class="p">,</span> <span class="n">m1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
<span></span>                <span class="bp">self</span><span class="o">.</span><span class="n">_append_matches</span><span class="p">(</span><span class="s2">"FN"</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span></span>        <span class="k">else</span><span class="p">:</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">,</span> <span class="n">gc</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># FN</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">_append_matches</span><span class="p">(</span><span class="s2">"FN"</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">detection_classes</span><span class="p">):</span>
<span></span>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">m1</span> <span class="o">==</span> <span class="n">i</span><span class="p">):</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="n">dc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># FP</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">_append_matches</span><span class="p">(</span><span class="s2">"FP"</span><span class="p">,</span> <span class="n">detections</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ConfusionMatrix.process_cls_preds"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.ConfusionMatrix.process_cls_preds</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process_cls_preds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">preds</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">targets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p>Update confusion matrix for classification task.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>preds (list[N, min(nc,5)]): Predicted class labels.</code></td><td></td><td></td><td><em>required</em></td></tr><tr><td><code>targets</code></td><td><code>list[N, 1]</code></td><td>Ground truth class labels.</td><td><em>required</em></td></tr><tr><td><code>preds</code></td><td><code>list[torch.Tensor]</code></td><td></td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L356-L365"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process_cls_preds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">preds</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">targets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Update confusion matrix for classification task.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        preds (list[N, min(nc,5)]): Predicted class labels.</span>
<span></span><span class="sd">        targets (list[N, 1]): Ground truth class labels.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">preds</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">preds</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
<span></span>    <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">targets</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()):</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ConfusionMatrix.summary"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.ConfusionMatrix.summary</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">decimals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span>
</code></pre></div><p>Generate a summarized representation of the confusion matrix as a list of dictionaries, with optional</p><p>normalization. This is useful for exporting the matrix to various formats such as CSV, XML, HTML, JSON, or SQL.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>normalize</code></td><td><code>bool</code></td><td>Whether to normalize the confusion matrix values.</td><td><code>False</code></td></tr><tr><td><code>decimals</code></td><td><code>int</code></td><td>Number of decimal places to round the output values to.</td><td><code>5</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list[dict[str, float]]</code></td><td>A list of dictionaries, each representing one predicted class with corresponding</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s2">"coco8.yaml"</span><span class="p">,</span> <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">cm_dict</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">cm_dict</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L577-L612"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">decimals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span></span><span class="w">    </span><span class="sd">"""Generate a summarized representation of the confusion matrix as a list of dictionaries, with optional</span>
<span></span><span class="sd">    normalization. This is useful for exporting the matrix to various formats such as CSV, XML, HTML, JSON,</span>
<span></span><span class="sd">    or SQL.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        normalize (bool): Whether to normalize the confusion matrix values.</span>
<span></span><span class="sd">        decimals (int): Number of decimal places to round the output values to.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list[dict[str, float]]): A list of dictionaries, each representing one predicted class with corresponding</span>
<span></span><span class="sd">            values for all actual classes.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model.val(data="coco8.yaml", plots=True)</span>
<span></span><span class="sd">        &gt;&gt;&gt; cm_dict = results.confusion_matrix.summary(normalize=True, decimals=5)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(cm_dict)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span></span>
<span></span>    <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">==</span> <span class="s2">"classify"</span> <span class="k">else</span> <span class="p">[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="s2">"background"</span><span class="p">]</span>
<span></span>    <span class="n">clean_names</span><span class="p">,</span> <span class="n">seen</span> <span class="o">=</span> <span class="p">[],</span> <span class="nb">set</span><span class="p">()</span>
<span></span>    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
<span></span>        <span class="n">clean_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">"[^a-zA-Z0-9_]"</span><span class="p">,</span> <span class="s2">"_"</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span></span>        <span class="n">original_clean</span> <span class="o">=</span> <span class="n">clean_name</span>
<span></span>        <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
<span></span>        <span class="k">while</span> <span class="n">clean_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
<span></span>            <span class="n">clean_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">original_clean</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">counter</span><span class="si">}</span><span class="s2">"</span>
<span></span>            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
<span></span>        <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">clean_name</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<span></span>        <span class="n">clean_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clean_name</span><span class="p">)</span>
<span></span>    <span class="n">array</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">/</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-9</span><span class="p">)</span> <span class="k">if</span> <span class="n">normalize</span> <span class="k">else</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="p">[</span>
<span></span>        <span class="nb">dict</span><span class="p">({</span><span class="s2">"Predicted"</span><span class="p">:</span> <span class="n">clean_names</span><span class="p">[</span><span class="n">i</span><span class="p">]},</span> <span class="o">**</span><span class="p">{</span><span class="n">clean_names</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">clean_names</span><span class="p">))})</span>
<span></span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">clean_names</span><span class="p">))</span>
<span></span>    <span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ConfusionMatrix.tp_fp"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.ConfusionMatrix.tp_fp</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">tp_fp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div><p>Return true positives and false positives.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>tp (np.ndarray)</code></td><td>True positives.</td></tr><tr><td><code>fp (np.ndarray)</code></td><td>False positives.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L450-L460"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">tp_fp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return true positives and false positives.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        tp (np.ndarray): True positives.</span>
<span></span><span class="sd">        fp (np.ndarray): False positives.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">tp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span>  <span class="c1"># true positives</span>
<span></span>    <span class="n">fp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">tp</span>  <span class="c1"># false positives</span>
<span></span>    <span class="c1"># fn = self.matrix.sum(0) - tp  # false negatives (missed detections)</span>
<span></span>    <span class="k">return</span> <span class="p">(</span><span class="n">tp</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">==</span> <span class="s2">"classify"</span> <span class="k">else</span> <span class="p">(</span><span class="n">tp</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">fp</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># remove background class if task=detect</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.Metric"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.utils.metrics.Metric</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">Metric</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p><strong>Bases:</strong> <code>SimpleClass</code></p><p>Class for computing evaluation metrics for Ultralytics YOLO models.</p><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>p</code></td><td><code>list</code></td><td>Precision for each class. Shape: (nc,).</td></tr><tr><td><code>r</code></td><td><code>list</code></td><td>Recall for each class. Shape: (nc,).</td></tr><tr><td><code>f1</code></td><td><code>list</code></td><td>F1 score for each class. Shape: (nc,).</td></tr><tr><td><code>all_ap</code></td><td><code>list</code></td><td>AP scores for all classes and all IoU thresholds. Shape: (nc, 10).</td></tr><tr><td><code>ap_class_index</code></td><td><code>list</code></td><td>Index of class for each AP score. Shape: (nc,).</td></tr><tr><td><code>nc</code></td><td><code>int</code></td><td>Number of classes.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.utils.metrics.Metric.ap50"><code>ap50</code></a></td><td>Return the Average Precision (AP) at an IoU threshold of 0.5 for all classes.</td></tr><tr><td><a href="#ultralytics.utils.metrics.Metric.ap"><code>ap</code></a></td><td>Return the Average Precision (AP) at an IoU threshold of 0.5-0.95 for all classes.</td></tr><tr><td><a href="#ultralytics.utils.metrics.Metric.mp"><code>mp</code></a></td><td>Return the Mean Precision of all classes.</td></tr><tr><td><a href="#ultralytics.utils.metrics.Metric.mr"><code>mr</code></a></td><td>Return the Mean Recall of all classes.</td></tr><tr><td><a href="#ultralytics.utils.metrics.Metric.map50"><code>map50</code></a></td><td>Return the mean Average Precision (mAP) at an IoU threshold of 0.5.</td></tr><tr><td><a href="#ultralytics.utils.metrics.Metric.map75"><code>map75</code></a></td><td>Return the mean Average Precision (mAP) at an IoU threshold of 0.75.</td></tr><tr><td><a href="#ultralytics.utils.metrics.Metric.map"><code>map</code></a></td><td>Return the mean Average Precision (mAP) over IoU thresholds of 0.5 - 0.95 in steps of 0.05.</td></tr><tr><td><a href="#ultralytics.utils.metrics.Metric.maps"><code>maps</code></a></td><td>Return mAP of each class.</td></tr><tr><td><a href="#ultralytics.utils.metrics.Metric.curves"><code>curves</code></a></td><td>Return a list of curves for accessing specific metrics curves.</td></tr><tr><td><a href="#ultralytics.utils.metrics.Metric.curves_results"><code>curves_results</code></a></td><td>Return a list of curves for accessing specific metrics curves.</td></tr><tr><td><a href="#ultralytics.utils.metrics.Metric.class_result"><code>class_result</code></a></td><td>Return class-aware result, p[i], r[i], ap50[i], ap[i].</td></tr><tr><td><a href="#ultralytics.utils.metrics.Metric.fitness"><code>fitness</code></a></td><td>Return model fitness as a weighted combination of metrics.</td></tr><tr><td><a href="#ultralytics.utils.metrics.Metric.mean_results"><code>mean_results</code></a></td><td>Return mean of results, mp, mr, map50, map.</td></tr><tr><td><a href="#ultralytics.utils.metrics.Metric.update"><code>update</code></a></td><td>Update the evaluation metrics with a new set of results.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L839-L1002"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Metric</span><span class="p">(</span><span class="n">SimpleClass</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Class for computing evaluation metrics for Ultralytics YOLO models.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        p (list): Precision for each class. Shape: (nc,).</span>
<span></span><span class="sd">        r (list): Recall for each class. Shape: (nc,).</span>
<span></span><span class="sd">        f1 (list): F1 score for each class. Shape: (nc,).</span>
<span></span><span class="sd">        all_ap (list): AP scores for all classes and all IoU thresholds. Shape: (nc, 10).</span>
<span></span><span class="sd">        ap_class_index (list): Index of class for each AP score. Shape: (nc,).</span>
<span></span><span class="sd">        nc (int): Number of classes.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        ap50: AP at IoU threshold of 0.5 for all classes.</span>
<span></span><span class="sd">        ap: AP at IoU thresholds from 0.5 to 0.95 for all classes.</span>
<span></span><span class="sd">        mp: Mean precision of all classes.</span>
<span></span><span class="sd">        mr: Mean recall of all classes.</span>
<span></span><span class="sd">        map50: Mean AP at IoU threshold of 0.5 for all classes.</span>
<span></span><span class="sd">        map75: Mean AP at IoU threshold of 0.75 for all classes.</span>
<span></span><span class="sd">        map: Mean AP at IoU thresholds from 0.5 to 0.95 for all classes.</span>
<span></span><span class="sd">        mean_results: Mean of results, returns mp, mr, map50, map.</span>
<span></span><span class="sd">        class_result: Class-aware result, returns p[i], r[i], ap50[i], ap[i].</span>
<span></span><span class="sd">        maps: mAP of each class.</span>
<span></span><span class="sd">        fitness: Model fitness as a weighted combination of metrics.</span>
<span></span><span class="sd">        update: Update metric attributes with new evaluation results.</span>
<span></span><span class="sd">        curves: Provides a list of curves for accessing specific metrics like precision, recall, F1, etc.</span>
<span></span><span class="sd">        curves_results: Provide a list of results for accessing specific metrics like precision, recall, F1, etc.</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize a Metric instance for computing evaluation metrics for the YOLOv8 model."""</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># (nc, )</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># (nc, )</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">f1</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># (nc, )</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">all_ap</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># (nc, 10)</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">ap_class_index</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># (nc, )</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">nc</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.Metric.ap50"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.Metric.ap50</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ap50</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span>
</code></pre></div><p>Return the Average Precision (AP) at an IoU threshold of 0.5 for all classes.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>np.ndarray | list</code></td><td>Array of shape (nc,) with AP50 values per class, or an empty list if not available.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L877-L883"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">ap50</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the Average Precision (AP) at an IoU threshold of 0.5 for all classes.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (np.ndarray | list): Array of shape (nc,) with AP50 values per class, or an empty list if not available.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_ap</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_ap</span><span class="p">)</span> <span class="k">else</span> <span class="p">[]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.Metric.ap"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.Metric.ap</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span>
</code></pre></div><p>Return the Average Precision (AP) at an IoU threshold of 0.5-0.95 for all classes.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>np.ndarray | list</code></td><td>Array of shape (nc,) with AP50-95 values per class, or an empty list if not available.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L886-L892"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">ap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the Average Precision (AP) at an IoU threshold of 0.5-0.95 for all classes.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (np.ndarray | list): Array of shape (nc,) with AP50-95 values per class, or an empty list if not available.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_ap</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_ap</span><span class="p">)</span> <span class="k">else</span> <span class="p">[]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.Metric.mp"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.Metric.mp</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div><p>Return the Mean Precision of all classes.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>float</code></td><td>The mean precision of all classes.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L895-L901"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">mp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the Mean Precision of all classes.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (float): The mean precision of all classes.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span> <span class="k">else</span> <span class="mf">0.0</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.Metric.mr"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.Metric.mr</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div><p>Return the Mean Recall of all classes.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>float</code></td><td>The mean recall of all classes.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L904-L910"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">mr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the Mean Recall of all classes.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (float): The mean recall of all classes.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="k">else</span> <span class="mf">0.0</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.Metric.map50"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.Metric.map50</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">map50</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div><p>Return the mean Average Precision (mAP) at an IoU threshold of 0.5.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>float</code></td><td>The mAP at an IoU threshold of 0.5.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L913-L919"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">map50</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the mean Average Precision (mAP) at an IoU threshold of 0.5.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (float): The mAP at an IoU threshold of 0.5.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_ap</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_ap</span><span class="p">)</span> <span class="k">else</span> <span class="mf">0.0</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.Metric.map75"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.Metric.map75</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">map75</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div><p>Return the mean Average Precision (mAP) at an IoU threshold of 0.75.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>float</code></td><td>The mAP at an IoU threshold of 0.75.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L922-L928"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">map75</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the mean Average Precision (mAP) at an IoU threshold of 0.75.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (float): The mAP at an IoU threshold of 0.75.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_ap</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_ap</span><span class="p">)</span> <span class="k">else</span> <span class="mf">0.0</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.Metric.map"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.Metric.map</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div><p>Return the mean Average Precision (mAP) over IoU thresholds of 0.5 - 0.95 in steps of 0.05.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>float</code></td><td>The mAP over IoU thresholds of 0.5 - 0.95 in steps of 0.05.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L931-L937"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the mean Average Precision (mAP) over IoU thresholds of 0.5 - 0.95 in steps of 0.05.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (float): The mAP over IoU thresholds of 0.5 - 0.95 in steps of 0.05.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_ap</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_ap</span><span class="p">)</span> <span class="k">else</span> <span class="mf">0.0</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.Metric.maps"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.Metric.maps</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">maps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return mAP of each class.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L948-L953"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">maps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return mAP of each class."""</span>
<span></span>    <span class="n">maps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nc</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span>
<span></span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ap_class_index</span><span class="p">):</span>
<span></span>        <span class="n">maps</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ap</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span></span>    <span class="k">return</span> <span class="n">maps</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.Metric.curves"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.Metric.curves</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span>
</code></pre></div><p>Return a list of curves for accessing specific metrics curves.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L990-L992"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a list of curves for accessing specific metrics curves."""</span>
<span></span>    <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.Metric.curves_results"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.Metric.curves_results</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span>
</code></pre></div><p>Return a list of curves for accessing specific metrics curves.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L995-L1002"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a list of curves for accessing specific metrics curves."""</span>
<span></span>    <span class="k">return</span> <span class="p">[</span>
<span></span>        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">px</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prec_values</span><span class="p">,</span> <span class="s2">"Recall"</span><span class="p">,</span> <span class="s2">"Precision"</span><span class="p">],</span>
<span></span>        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">px</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">f1_curve</span><span class="p">,</span> <span class="s2">"Confidence"</span><span class="p">,</span> <span class="s2">"F1"</span><span class="p">],</span>
<span></span>        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">px</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_curve</span><span class="p">,</span> <span class="s2">"Confidence"</span><span class="p">,</span> <span class="s2">"Precision"</span><span class="p">],</span>
<span></span>        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">px</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_curve</span><span class="p">,</span> <span class="s2">"Confidence"</span><span class="p">,</span> <span class="s2">"Recall"</span><span class="p">],</span>
<span></span>    <span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.Metric.class_result"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.Metric.class_result</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">class_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div><p>Return class-aware result, p[i], r[i], ap50[i], ap[i].</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>i</code></td><td><code>int</code></td><td></td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L943-L945"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">class_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return class-aware result, p[i], r[i], ap50[i], ap[i]."""</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ap50</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ap</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.Metric.fitness"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.Metric.fitness</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div><p>Return model fitness as a weighted combination of metrics.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L955-L958"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return model fitness as a weighted combination of metrics."""</span>
<span></span>    <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># weights for [P, R, mAP@0.5, mAP@0.5:0.95]</span>
<span></span>    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_results</span><span class="p">()))</span> <span class="o">*</span> <span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.Metric.mean_results"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.Metric.mean_results</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mean_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</code></pre></div><p>Return mean of results, mp, mr, map50, map.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L939-L941"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mean_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return mean of results, mp, mr, map50, map."""</span>
<span></span>    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">map50</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.Metric.update"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.Metric.update</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span>
</code></pre></div><p>Update the evaluation metrics with a new set of results.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>results</code></td><td><code>tuple</code></td><td>A tuple containing evaluation metrics: - p (list): Precision for each class. - r (list): Recall for each class. - f1 (list): F1 score for each class. - all_ap (list): AP scores for all classes and all IoU thresholds. - ap_class_index (list): Index of class for each AP score. - p_curve (list): Precision curve for each class. - r_curve (list): Recall curve for each class. - f1_curve (list): F1 curve for each class. - px (list): X values for the curves. - prec_values (list): Precision values for each class.</td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L960-L987"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Update the evaluation metrics with a new set of results.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        results (tuple): A tuple containing evaluation metrics:</span>
<span></span><span class="sd">            - p (list): Precision for each class.</span>
<span></span><span class="sd">            - r (list): Recall for each class.</span>
<span></span><span class="sd">            - f1 (list): F1 score for each class.</span>
<span></span><span class="sd">            - all_ap (list): AP scores for all classes and all IoU thresholds.</span>
<span></span><span class="sd">            - ap_class_index (list): Index of class for each AP score.</span>
<span></span><span class="sd">            - p_curve (list): Precision curve for each class.</span>
<span></span><span class="sd">            - r_curve (list): Recall curve for each class.</span>
<span></span><span class="sd">            - f1_curve (list): F1 curve for each class.</span>
<span></span><span class="sd">            - px (list): X values for the curves.</span>
<span></span><span class="sd">            - prec_values (list): Precision values for each class.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="p">(</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">f1</span><span class="p">,</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">all_ap</span><span class="p">,</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">ap_class_index</span><span class="p">,</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">p_curve</span><span class="p">,</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">r_curve</span><span class="p">,</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">f1_curve</span><span class="p">,</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">px</span><span class="p">,</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">prec_values</span><span class="p">,</span>
<span></span>    <span class="p">)</span> <span class="o">=</span> <span class="n">results</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.DetMetrics"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.utils.metrics.DetMetrics</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">DetMetrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p><strong>Bases:</strong> <code>SimpleClass</code>, <code>DataExportMixin</code></p><p>Utility class for computing detection metrics such as precision, recall, and mean average precision (mAP).</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>names</code></td><td><code>dict[int, str], optional</code></td><td>Dictionary of class names.</td><td><code>{}</code></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>names</code></td><td><code>dict[int, str]</code></td><td>A dictionary of class names.</td></tr><tr><td><code>box</code></td><td><code>Metric</code></td><td>An instance of the Metric class for storing detection results.</td></tr><tr><td><code>speed</code></td><td><code>dict[str, float]</code></td><td>A dictionary for storing execution times of different parts of the detection process.</td></tr><tr><td><code>task</code></td><td><code>str</code></td><td>The task type, set to 'detect'.</td></tr><tr><td><code>stats</code></td><td><code>dict[str, list]</code></td><td>A dictionary containing lists for true positives, confidence scores, predicted classes, target classes, and target images.</td></tr><tr><td><code>nt_per_class</code></td><td></td><td>Number of targets per class.</td></tr><tr><td><code>nt_per_image</code></td><td></td><td>Number of targets per image.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.utils.metrics.DetMetrics.keys"><code>keys</code></a></td><td>Return a list of keys for accessing specific metrics.</td></tr><tr><td><a href="#ultralytics.utils.metrics.DetMetrics.maps"><code>maps</code></a></td><td>Return mean Average Precision (mAP) scores per class.</td></tr><tr><td><a href="#ultralytics.utils.metrics.DetMetrics.fitness"><code>fitness</code></a></td><td>Return the fitness of box object.</td></tr><tr><td><a href="#ultralytics.utils.metrics.DetMetrics.ap_class_index"><code>ap_class_index</code></a></td><td>Return the average precision index per class.</td></tr><tr><td><a href="#ultralytics.utils.metrics.DetMetrics.results_dict"><code>results_dict</code></a></td><td>Return dictionary of computed performance metrics and statistics.</td></tr><tr><td><a href="#ultralytics.utils.metrics.DetMetrics.curves"><code>curves</code></a></td><td>Return a list of curves for accessing specific metrics curves.</td></tr><tr><td><a href="#ultralytics.utils.metrics.DetMetrics.curves_results"><code>curves_results</code></a></td><td>Return a list of computed performance metrics and statistics.</td></tr><tr><td><a href="#ultralytics.utils.metrics.DetMetrics.class_result"><code>class_result</code></a></td><td>Return the result of evaluating the performance of an object detection model on a specific class.</td></tr><tr><td><a href="#ultralytics.utils.metrics.DetMetrics.clear_stats"><code>clear_stats</code></a></td><td>Clear the stored statistics.</td></tr><tr><td><a href="#ultralytics.utils.metrics.DetMetrics.mean_results"><code>mean_results</code></a></td><td>Calculate mean of detected objects &amp; return precision, recall, mAP50, and mAP50-95.</td></tr><tr><td><a href="#ultralytics.utils.metrics.DetMetrics.process"><code>process</code></a></td><td>Process predicted results for object detection and update metrics.</td></tr><tr><td><a href="#ultralytics.utils.metrics.DetMetrics.summary"><code>summary</code></a></td><td>Generate a summarized representation of per-class detection metrics as a list of dictionaries. Includes</td></tr><tr><td><a href="#ultralytics.utils.metrics.DetMetrics.update_stats"><code>update_stats</code></a></td><td>Update statistics by appending new values to existing stat collections.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1005-L1171"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">DetMetrics</span><span class="p">(</span><span class="n">SimpleClass</span><span class="p">,</span> <span class="n">DataExportMixin</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Utility class for computing detection metrics such as precision, recall, and mean average precision (mAP).</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        names (dict[int, str]): A dictionary of class names.</span>
<span></span><span class="sd">        box (Metric): An instance of the Metric class for storing detection results.</span>
<span></span><span class="sd">        speed (dict[str, float]): A dictionary for storing execution times of different parts of the detection process.</span>
<span></span><span class="sd">        task (str): The task type, set to 'detect'.</span>
<span></span><span class="sd">        stats (dict[str, list]): A dictionary containing lists for true positives, confidence scores, predicted classes,</span>
<span></span><span class="sd">            target classes, and target images.</span>
<span></span><span class="sd">        nt_per_class: Number of targets per class.</span>
<span></span><span class="sd">        nt_per_image: Number of targets per image.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        update_stats: Update statistics by appending new values to existing stat collections.</span>
<span></span><span class="sd">        process: Process predicted results for object detection and update metrics.</span>
<span></span><span class="sd">        clear_stats: Clear the stored statistics.</span>
<span></span><span class="sd">        keys: Return a list of keys for accessing specific metrics.</span>
<span></span><span class="sd">        mean_results: Calculate mean of detected objects &amp; return precision, recall, mAP50, and mAP50-95.</span>
<span></span><span class="sd">        class_result: Return the result of evaluating the performance of an object detection model on a specific class.</span>
<span></span><span class="sd">        maps: Return mean Average Precision (mAP) scores per class.</span>
<span></span><span class="sd">        fitness: Return the fitness of box object.</span>
<span></span><span class="sd">        ap_class_index: Return the average precision index per class.</span>
<span></span><span class="sd">        results_dict: Return dictionary of computed performance metrics and statistics.</span>
<span></span><span class="sd">        curves: Return a list of curves for accessing specific metrics curves.</span>
<span></span><span class="sd">        curves_results: Return a list of computed performance metrics and statistics.</span>
<span></span><span class="sd">        summary: Generate a summarized representation of per-class detection metrics as a list of dictionaries.</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize a DetMetrics instance with a save directory, plot flag, and class names.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            names (dict[int, str], optional): Dictionary of class names.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">names</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="n">Metric</span><span class="p">()</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"preprocess"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">"inference"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">"loss"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">"postprocess"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="s2">"detect"</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">tp</span><span class="o">=</span><span class="p">[],</span> <span class="n">conf</span><span class="o">=</span><span class="p">[],</span> <span class="n">pred_cls</span><span class="o">=</span><span class="p">[],</span> <span class="n">target_cls</span><span class="o">=</span><span class="p">[],</span> <span class="n">target_img</span><span class="o">=</span><span class="p">[])</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">nt_per_class</span> <span class="o">=</span> <span class="kc">None</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">nt_per_image</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.DetMetrics.keys"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.DetMetrics.keys</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div><p>Return a list of keys for accessing specific metrics.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1095-L1097"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a list of keys for accessing specific metrics."""</span>
<span></span>    <span class="k">return</span> <span class="p">[</span><span class="s2">"metrics/precision(B)"</span><span class="p">,</span> <span class="s2">"metrics/recall(B)"</span><span class="p">,</span> <span class="s2">"metrics/mAP50(B)"</span><span class="p">,</span> <span class="s2">"metrics/mAP50-95(B)"</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.DetMetrics.maps"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.DetMetrics.maps</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">maps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return mean Average Precision (mAP) scores per class.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1108-L1110"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">maps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return mean Average Precision (mAP) scores per class."""</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">maps</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.DetMetrics.fitness"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.DetMetrics.fitness</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div><p>Return the fitness of box object.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1113-L1115"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the fitness of box object."""</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">fitness</span><span class="p">()</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.DetMetrics.ap_class_index"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.DetMetrics.ap_class_index</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ap_class_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span>
</code></pre></div><p>Return the average precision index per class.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1118-L1120"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">ap_class_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the average precision index per class."""</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">ap_class_index</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.DetMetrics.results_dict"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.DetMetrics.results_dict</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">results_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div><p>Return dictionary of computed performance metrics and statistics.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1123-L1127"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">results_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return dictionary of computed performance metrics and statistics."""</span>
<span></span>    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">,</span> <span class="s2">"fitness"</span><span class="p">]</span>
<span></span>    <span class="n">values</span> <span class="o">=</span> <span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">"item"</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">([</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_results</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitness</span><span class="p">]))</span>
<span></span>    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.DetMetrics.curves"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.DetMetrics.curves</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div><p>Return a list of curves for accessing specific metrics curves.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1130-L1132"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a list of curves for accessing specific metrics curves."""</span>
<span></span>    <span class="k">return</span> <span class="p">[</span><span class="s2">"Precision-Recall(B)"</span><span class="p">,</span> <span class="s2">"F1-Confidence(B)"</span><span class="p">,</span> <span class="s2">"Precision-Confidence(B)"</span><span class="p">,</span> <span class="s2">"Recall-Confidence(B)"</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.DetMetrics.curves_results"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.DetMetrics.curves_results</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span>
</code></pre></div><p>Return a list of computed performance metrics and statistics.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1135-L1137"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a list of computed performance metrics and statistics."""</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">curves_results</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.DetMetrics.class_result"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.DetMetrics.class_result</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">class_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div><p>Return the result of evaluating the performance of an object detection model on a specific class.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>i</code></td><td><code>int</code></td><td></td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1103-L1105"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">class_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the result of evaluating the performance of an object detection model on a specific class."""</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">class_result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.DetMetrics.clear_stats"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.DetMetrics.clear_stats</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">clear_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>Clear the stored statistics.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1089-L1092"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">clear_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Clear the stored statistics."""</span>
<span></span>    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
<span></span>        <span class="n">v</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.DetMetrics.mean_results"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.DetMetrics.mean_results</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mean_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</code></pre></div><p>Calculate mean of detected objects &amp; return precision, recall, mAP50, and mAP50-95.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1099-L1101"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mean_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Calculate mean of detected objects &amp; return precision, recall, mAP50, and mAP50-95."""</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">mean_results</span><span class="p">()</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.DetMetrics.process"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.DetMetrics.process</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"."</span><span class="p">),</span> <span class="n">plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">on_plot</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div><p>Process predicted results for object detection and update metrics.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>save_dir</code></td><td><code>Path</code></td><td>Directory to save plots. Defaults to Path(".").</td><td><code>Path(".")</code></td></tr><tr><td><code>plot</code></td><td><code>bool</code></td><td>Whether to plot precision-recall curves. Defaults to False.</td><td><code>False</code></td></tr><tr><td><code>on_plot</code></td><td><code>callable, optional</code></td><td>Function to call after plots are generated. Defaults to None.</td><td><code>None</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>dict[str, np.ndarray]</code></td><td>Dictionary containing concatenated statistics arrays.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1058-L1087"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"."</span><span class="p">),</span> <span class="n">plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">on_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Process predicted results for object detection and update metrics.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        save_dir (Path): Directory to save plots. Defaults to Path(".").</span>
<span></span><span class="sd">        plot (bool): Whether to plot precision-recall curves. Defaults to False.</span>
<span></span><span class="sd">        on_plot (callable, optional): Function to call after plots are generated. Defaults to None.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict[str, np.ndarray]): Dictionary containing concatenated statistics arrays.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">stats</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>  <span class="c1"># to numpy</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">stats</span><span class="p">:</span>
<span></span>        <span class="k">return</span> <span class="n">stats</span>
<span></span>    <span class="n">results</span> <span class="o">=</span> <span class="n">ap_per_class</span><span class="p">(</span>
<span></span>        <span class="n">stats</span><span class="p">[</span><span class="s2">"tp"</span><span class="p">],</span>
<span></span>        <span class="n">stats</span><span class="p">[</span><span class="s2">"conf"</span><span class="p">],</span>
<span></span>        <span class="n">stats</span><span class="p">[</span><span class="s2">"pred_cls"</span><span class="p">],</span>
<span></span>        <span class="n">stats</span><span class="p">[</span><span class="s2">"target_cls"</span><span class="p">],</span>
<span></span>        <span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span>
<span></span>        <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">,</span>
<span></span>        <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
<span></span>        <span class="n">on_plot</span><span class="o">=</span><span class="n">on_plot</span><span class="p">,</span>
<span></span>        <span class="n">prefix</span><span class="o">=</span><span class="s2">"Box"</span><span class="p">,</span>
<span></span>    <span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">nt_per_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s2">"target_cls"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">minlength</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">nt_per_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s2">"target_img"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">minlength</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
<span></span>    <span class="k">return</span> <span class="n">stats</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.DetMetrics.summary"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.DetMetrics.summary</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">decimals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
</code></pre></div><p>Generate a summarized representation of per-class detection metrics as a list of dictionaries. Includes</p><p>shared scalar metrics (mAP, mAP50, mAP75) alongside precision, recall, and F1-score for each class.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>normalize</code></td><td><code>bool</code></td><td>For Detect metrics, everything is normalized by default [0-1].</td><td><code>True</code></td></tr><tr><td><code>decimals</code></td><td><code>int</code></td><td>Number of decimal places to round the metrics values to.</td><td><code>5</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list[dict[str, Any]]</code></td><td>A list of dictionaries, each representing one class with corresponding metric</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s2">"coco8.yaml"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">detection_summary</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">detection_summary</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1139-L1171"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">decimals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span></span><span class="w">    </span><span class="sd">"""Generate a summarized representation of per-class detection metrics as a list of dictionaries. Includes</span>
<span></span><span class="sd">    shared scalar metrics (mAP, mAP50, mAP75) alongside precision, recall, and F1-score for each class.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        normalize (bool): For Detect metrics, everything is normalized by default [0-1].</span>
<span></span><span class="sd">        decimals (int): Number of decimal places to round the metrics values to.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list[dict[str, Any]]): A list of dictionaries, each representing one class with corresponding metric</span>
<span></span><span class="sd">            values.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">       &gt;&gt;&gt; results = model.val(data="coco8.yaml")</span>
<span></span><span class="sd">       &gt;&gt;&gt; detection_summary = results.summary()</span>
<span></span><span class="sd">       &gt;&gt;&gt; print(detection_summary)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">per_class</span> <span class="o">=</span> <span class="p">{</span>
<span></span>        <span class="s2">"Box-P"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">p</span><span class="p">,</span>
<span></span>        <span class="s2">"Box-R"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
<span></span>        <span class="s2">"Box-F1"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">f1</span><span class="p">,</span>
<span></span>    <span class="p">}</span>
<span></span>    <span class="k">return</span> <span class="p">[</span>
<span></span>        <span class="p">{</span>
<span></span>            <span class="s2">"Class"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ap_class_index</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
<span></span>            <span class="s2">"Images"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt_per_image</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ap_class_index</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
<span></span>            <span class="s2">"Instances"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt_per_class</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ap_class_index</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
<span></span>            <span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">decimals</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">per_class</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
<span></span>            <span class="s2">"mAP50"</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_result</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">2</span><span class="p">],</span> <span class="n">decimals</span><span class="p">),</span>
<span></span>            <span class="s2">"mAP50-95"</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_result</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">3</span><span class="p">],</span> <span class="n">decimals</span><span class="p">),</span>
<span></span>        <span class="p">}</span>
<span></span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">per_class</span><span class="p">[</span><span class="s2">"Box-P"</span><span class="p">]))</span>
<span></span>    <span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.DetMetrics.update_stats"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.DetMetrics.update_stats</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p>Update statistics by appending new values to existing stat collections.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>stat</code></td><td><code>dict[str, any]</code></td><td>Dictionary containing new statistical values to append. Keys should match existing keys in self.stats.</td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1048-L1056"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Update statistics by appending new values to existing stat collections.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        stat (dict[str, any]): Dictionary containing new statistical values to append. Keys should match existing</span>
<span></span><span class="sd">            keys in self.stats.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stat</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.SegmentMetrics"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.utils.metrics.SegmentMetrics</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">SegmentMetrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p><strong>Bases:</strong> <code>DetMetrics</code></p><p>Calculate and aggregate detection and segmentation metrics over a given set of classes.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>names</code></td><td><code>dict[int, str], optional</code></td><td>Dictionary of class names.</td><td><code>{}</code></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>names</code></td><td><code>dict[int, str]</code></td><td>Dictionary of class names.</td></tr><tr><td><code>box</code></td><td><code>Metric</code></td><td>An instance of the Metric class for storing detection results.</td></tr><tr><td><code>seg</code></td><td><code>Metric</code></td><td>An instance of the Metric class to calculate mask segmentation metrics.</td></tr><tr><td><code>speed</code></td><td><code>dict[str, float]</code></td><td>A dictionary for storing execution times of different parts of the detection process.</td></tr><tr><td><code>task</code></td><td><code>str</code></td><td>The task type, set to 'segment'.</td></tr><tr><td><code>stats</code></td><td><code>dict[str, list]</code></td><td>A dictionary containing lists for true positives, confidence scores, predicted classes, target classes, and target images.</td></tr><tr><td><code>nt_per_class</code></td><td></td><td>Number of targets per class.</td></tr><tr><td><code>nt_per_image</code></td><td></td><td>Number of targets per image.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.utils.metrics.SegmentMetrics.keys"><code>keys</code></a></td><td>Return a list of keys for accessing metrics.</td></tr><tr><td><a href="#ultralytics.utils.metrics.SegmentMetrics.maps"><code>maps</code></a></td><td>Return mAP scores for object detection and semantic segmentation models.</td></tr><tr><td><a href="#ultralytics.utils.metrics.SegmentMetrics.fitness"><code>fitness</code></a></td><td>Return the fitness score for both segmentation and bounding box models.</td></tr><tr><td><a href="#ultralytics.utils.metrics.SegmentMetrics.curves"><code>curves</code></a></td><td>Return a list of curves for accessing specific metrics curves.</td></tr><tr><td><a href="#ultralytics.utils.metrics.SegmentMetrics.curves_results"><code>curves_results</code></a></td><td>Return a list of computed performance metrics and statistics.</td></tr><tr><td><a href="#ultralytics.utils.metrics.SegmentMetrics.class_result"><code>class_result</code></a></td><td>Return classification results for a specified class index.</td></tr><tr><td><a href="#ultralytics.utils.metrics.SegmentMetrics.mean_results"><code>mean_results</code></a></td><td>Return the mean metrics for bounding box and segmentation results.</td></tr><tr><td><a href="#ultralytics.utils.metrics.SegmentMetrics.process"><code>process</code></a></td><td>Process the detection and segmentation metrics over the given set of predictions.</td></tr><tr><td><a href="#ultralytics.utils.metrics.SegmentMetrics.summary"><code>summary</code></a></td><td>Generate a summarized representation of per-class segmentation metrics as a list of dictionaries. Includes</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1174-L1309"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SegmentMetrics</span><span class="p">(</span><span class="n">DetMetrics</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Calculate and aggregate detection and segmentation metrics over a given set of classes.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        names (dict[int, str]): Dictionary of class names.</span>
<span></span><span class="sd">        box (Metric): An instance of the Metric class for storing detection results.</span>
<span></span><span class="sd">        seg (Metric): An instance of the Metric class to calculate mask segmentation metrics.</span>
<span></span><span class="sd">        speed (dict[str, float]): A dictionary for storing execution times of different parts of the detection process.</span>
<span></span><span class="sd">        task (str): The task type, set to 'segment'.</span>
<span></span><span class="sd">        stats (dict[str, list]): A dictionary containing lists for true positives, confidence scores, predicted classes,</span>
<span></span><span class="sd">            target classes, and target images.</span>
<span></span><span class="sd">        nt_per_class: Number of targets per class.</span>
<span></span><span class="sd">        nt_per_image: Number of targets per image.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        process: Process the detection and segmentation metrics over the given set of predictions.</span>
<span></span><span class="sd">        keys: Return a list of keys for accessing metrics.</span>
<span></span><span class="sd">        mean_results: Return the mean metrics for bounding box and segmentation results.</span>
<span></span><span class="sd">        class_result: Return classification results for a specified class index.</span>
<span></span><span class="sd">        maps: Return mAP scores for object detection and semantic segmentation models.</span>
<span></span><span class="sd">        fitness: Return the fitness score for both segmentation and bounding box models.</span>
<span></span><span class="sd">        curves: Return a list of curves for accessing specific metrics curves.</span>
<span></span><span class="sd">        curves_results: Provide a list of computed performance metrics and statistics.</span>
<span></span><span class="sd">        summary: Generate a summarized representation of per-class segmentation metrics as a list of dictionaries.</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize a SegmentMetrics instance with a save directory, plot flag, and class names.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            names (dict[int, str], optional): Dictionary of class names.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="n">DetMetrics</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">seg</span> <span class="o">=</span> <span class="n">Metric</span><span class="p">()</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="s2">"segment"</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">"tp_m"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># add additional stats for masks</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.SegmentMetrics.keys"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.SegmentMetrics.keys</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div><p>Return a list of keys for accessing metrics.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1239-L1247"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a list of keys for accessing metrics."""</span>
<span></span>    <span class="k">return</span> <span class="p">[</span>
<span></span>        <span class="o">*</span><span class="n">DetMetrics</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
<span></span>        <span class="s2">"metrics/precision(M)"</span><span class="p">,</span>
<span></span>        <span class="s2">"metrics/recall(M)"</span><span class="p">,</span>
<span></span>        <span class="s2">"metrics/mAP50(M)"</span><span class="p">,</span>
<span></span>        <span class="s2">"metrics/mAP50-95(M)"</span><span class="p">,</span>
<span></span>    <span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.SegmentMetrics.maps"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.SegmentMetrics.maps</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">maps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return mAP scores for object detection and semantic segmentation models.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1258-L1260"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">maps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return mAP scores for object detection and semantic segmentation models."""</span>
<span></span>    <span class="k">return</span> <span class="n">DetMetrics</span><span class="o">.</span><span class="n">maps</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">seg</span><span class="o">.</span><span class="n">maps</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.SegmentMetrics.fitness"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.SegmentMetrics.fitness</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div><p>Return the fitness score for both segmentation and bounding box models.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1263-L1265"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the fitness score for both segmentation and bounding box models."""</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">seg</span><span class="o">.</span><span class="n">fitness</span><span class="p">()</span> <span class="o">+</span> <span class="n">DetMetrics</span><span class="o">.</span><span class="n">fitness</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.SegmentMetrics.curves"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.SegmentMetrics.curves</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div><p>Return a list of curves for accessing specific metrics curves.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1268-L1276"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a list of curves for accessing specific metrics curves."""</span>
<span></span>    <span class="k">return</span> <span class="p">[</span>
<span></span>        <span class="o">*</span><span class="n">DetMetrics</span><span class="o">.</span><span class="n">curves</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
<span></span>        <span class="s2">"Precision-Recall(M)"</span><span class="p">,</span>
<span></span>        <span class="s2">"F1-Confidence(M)"</span><span class="p">,</span>
<span></span>        <span class="s2">"Precision-Confidence(M)"</span><span class="p">,</span>
<span></span>        <span class="s2">"Recall-Confidence(M)"</span><span class="p">,</span>
<span></span>    <span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.SegmentMetrics.curves_results"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.SegmentMetrics.curves_results</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span>
</code></pre></div><p>Return a list of computed performance metrics and statistics.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1279-L1281"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a list of computed performance metrics and statistics."""</span>
<span></span>    <span class="k">return</span> <span class="n">DetMetrics</span><span class="o">.</span><span class="n">curves_results</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">seg</span><span class="o">.</span><span class="n">curves_results</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.SegmentMetrics.class_result"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.SegmentMetrics.class_result</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">class_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</code></pre></div><p>Return classification results for a specified class index.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>i</code></td><td><code>int</code></td><td></td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1253-L1255"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">class_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return classification results for a specified class index."""</span>
<span></span>    <span class="k">return</span> <span class="n">DetMetrics</span><span class="o">.</span><span class="n">class_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">seg</span><span class="o">.</span><span class="n">class_result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.SegmentMetrics.mean_results"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.SegmentMetrics.mean_results</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mean_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</code></pre></div><p>Return the mean metrics for bounding box and segmentation results.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1249-L1251"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mean_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the mean metrics for bounding box and segmentation results."""</span>
<span></span>    <span class="k">return</span> <span class="n">DetMetrics</span><span class="o">.</span><span class="n">mean_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">seg</span><span class="o">.</span><span class="n">mean_results</span><span class="p">()</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.SegmentMetrics.process"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.SegmentMetrics.process</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"."</span><span class="p">),</span> <span class="n">plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">on_plot</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div><p>Process the detection and segmentation metrics over the given set of predictions.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>save_dir</code></td><td><code>Path</code></td><td>Directory to save plots. Defaults to Path(".").</td><td><code>Path(".")</code></td></tr><tr><td><code>plot</code></td><td><code>bool</code></td><td>Whether to plot precision-recall curves. Defaults to False.</td><td><code>False</code></td></tr><tr><td><code>on_plot</code></td><td><code>callable, optional</code></td><td>Function to call after plots are generated. Defaults to None.</td><td><code>None</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>dict[str, np.ndarray]</code></td><td>Dictionary containing concatenated statistics arrays.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1211-L1236"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"."</span><span class="p">),</span> <span class="n">plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">on_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Process the detection and segmentation metrics over the given set of predictions.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        save_dir (Path): Directory to save plots. Defaults to Path(".").</span>
<span></span><span class="sd">        plot (bool): Whether to plot precision-recall curves. Defaults to False.</span>
<span></span><span class="sd">        on_plot (callable, optional): Function to call after plots are generated. Defaults to None.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict[str, np.ndarray]): Dictionary containing concatenated statistics arrays.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">stats</span> <span class="o">=</span> <span class="n">DetMetrics</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">on_plot</span><span class="o">=</span><span class="n">on_plot</span><span class="p">)</span>  <span class="c1"># process box stats</span>
<span></span>    <span class="n">results_mask</span> <span class="o">=</span> <span class="n">ap_per_class</span><span class="p">(</span>
<span></span>        <span class="n">stats</span><span class="p">[</span><span class="s2">"tp_m"</span><span class="p">],</span>
<span></span>        <span class="n">stats</span><span class="p">[</span><span class="s2">"conf"</span><span class="p">],</span>
<span></span>        <span class="n">stats</span><span class="p">[</span><span class="s2">"pred_cls"</span><span class="p">],</span>
<span></span>        <span class="n">stats</span><span class="p">[</span><span class="s2">"target_cls"</span><span class="p">],</span>
<span></span>        <span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span>
<span></span>        <span class="n">on_plot</span><span class="o">=</span><span class="n">on_plot</span><span class="p">,</span>
<span></span>        <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">,</span>
<span></span>        <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
<span></span>        <span class="n">prefix</span><span class="o">=</span><span class="s2">"Mask"</span><span class="p">,</span>
<span></span>    <span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">seg</span><span class="o">.</span><span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">seg</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">results_mask</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">stats</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.SegmentMetrics.summary"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.SegmentMetrics.summary</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">decimals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
</code></pre></div><p>Generate a summarized representation of per-class segmentation metrics as a list of dictionaries. Includes</p><p>both box and mask scalar metrics (mAP, mAP50, mAP75) alongside precision, recall, and F1-score for each class.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>normalize</code></td><td><code>bool</code></td><td>For Segment metrics, everything is normalized by default [0-1].</td><td><code>True</code></td></tr><tr><td><code>decimals</code></td><td><code>int</code></td><td>Number of decimal places to round the metrics values to.</td><td><code>5</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list[dict[str, Any]]</code></td><td>A list of dictionaries, each representing one class with corresponding metric</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s2">"coco8-seg.yaml"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">seg_summary</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">seg_summary</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1283-L1309"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">decimals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span></span><span class="w">    </span><span class="sd">"""Generate a summarized representation of per-class segmentation metrics as a list of dictionaries. Includes</span>
<span></span><span class="sd">    both box and mask scalar metrics (mAP, mAP50, mAP75) alongside precision, recall, and F1-score for</span>
<span></span><span class="sd">    each class.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        normalize (bool): For Segment metrics, everything is normalized by default [0-1].</span>
<span></span><span class="sd">        decimals (int): Number of decimal places to round the metrics values to.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list[dict[str, Any]]): A list of dictionaries, each representing one class with corresponding metric</span>
<span></span><span class="sd">            values.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model.val(data="coco8-seg.yaml")</span>
<span></span><span class="sd">        &gt;&gt;&gt; seg_summary = results.summary(decimals=4)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(seg_summary)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">per_class</span> <span class="o">=</span> <span class="p">{</span>
<span></span>        <span class="s2">"Mask-P"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">seg</span><span class="o">.</span><span class="n">p</span><span class="p">,</span>
<span></span>        <span class="s2">"Mask-R"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">seg</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
<span></span>        <span class="s2">"Mask-F1"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">seg</span><span class="o">.</span><span class="n">f1</span><span class="p">,</span>
<span></span>    <span class="p">}</span>
<span></span>    <span class="n">summary</span> <span class="o">=</span> <span class="n">DetMetrics</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">,</span> <span class="n">decimals</span><span class="p">)</span>  <span class="c1"># get box summary</span>
<span></span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">summary</span><span class="p">):</span>
<span></span>        <span class="n">s</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">decimals</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">per_class</span><span class="o">.</span><span class="n">items</span><span class="p">()}})</span>
<span></span>    <span class="k">return</span> <span class="n">summary</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.PoseMetrics"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.utils.metrics.PoseMetrics</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">PoseMetrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p><strong>Bases:</strong> <code>DetMetrics</code></p><p>Calculate and aggregate detection and pose metrics over a given set of classes.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>names</code></td><td><code>dict[int, str], optional</code></td><td>Dictionary of class names.</td><td><code>{}</code></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>names</code></td><td><code>dict[int, str]</code></td><td>Dictionary of class names.</td></tr><tr><td><code>pose</code></td><td><code>Metric</code></td><td>An instance of the Metric class to calculate pose metrics.</td></tr><tr><td><code>box</code></td><td><code>Metric</code></td><td>An instance of the Metric class for storing detection results.</td></tr><tr><td><code>speed</code></td><td><code>dict[str, float]</code></td><td>A dictionary for storing execution times of different parts of the detection process.</td></tr><tr><td><code>task</code></td><td><code>str</code></td><td>The task type, set to 'pose'.</td></tr><tr><td><code>stats</code></td><td><code>dict[str, list]</code></td><td>A dictionary containing lists for true positives, confidence scores, predicted classes, target classes, and target images.</td></tr><tr><td><code>nt_per_class</code></td><td></td><td>Number of targets per class.</td></tr><tr><td><code>nt_per_image</code></td><td></td><td>Number of targets per image.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.utils.metrics.PoseMetrics.keys"><code>keys</code></a></td><td>Return a list of evaluation metric keys.</td></tr><tr><td><a href="#ultralytics.utils.metrics.PoseMetrics.maps"><code>maps</code></a></td><td>Return the mean average precision (mAP) per class for both box and pose detections.</td></tr><tr><td><a href="#ultralytics.utils.metrics.PoseMetrics.fitness"><code>fitness</code></a></td><td>Return combined fitness score for pose and box detection.</td></tr><tr><td><a href="#ultralytics.utils.metrics.PoseMetrics.curves"><code>curves</code></a></td><td>Return a list of curves for accessing specific metrics curves.</td></tr><tr><td><a href="#ultralytics.utils.metrics.PoseMetrics.curves_results"><code>curves_results</code></a></td><td>Return a list of computed performance metrics and statistics.</td></tr><tr><td><a href="#ultralytics.utils.metrics.PoseMetrics.class_result"><code>class_result</code></a></td><td>Return the class-wise detection results for a specific class i.</td></tr><tr><td><a href="#ultralytics.utils.metrics.PoseMetrics.mean_results"><code>mean_results</code></a></td><td>Return the mean results of box and pose.</td></tr><tr><td><a href="#ultralytics.utils.metrics.PoseMetrics.process"><code>process</code></a></td><td>Process the detection and pose metrics over the given set of predictions.</td></tr><tr><td><a href="#ultralytics.utils.metrics.PoseMetrics.summary"><code>summary</code></a></td><td>Generate a summarized representation of per-class pose metrics as a list of dictionaries. Includes both box</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1312-L1450"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">PoseMetrics</span><span class="p">(</span><span class="n">DetMetrics</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Calculate and aggregate detection and pose metrics over a given set of classes.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        names (dict[int, str]): Dictionary of class names.</span>
<span></span><span class="sd">        pose (Metric): An instance of the Metric class to calculate pose metrics.</span>
<span></span><span class="sd">        box (Metric): An instance of the Metric class for storing detection results.</span>
<span></span><span class="sd">        speed (dict[str, float]): A dictionary for storing execution times of different parts of the detection process.</span>
<span></span><span class="sd">        task (str): The task type, set to 'pose'.</span>
<span></span><span class="sd">        stats (dict[str, list]): A dictionary containing lists for true positives, confidence scores, predicted classes,</span>
<span></span><span class="sd">            target classes, and target images.</span>
<span></span><span class="sd">        nt_per_class: Number of targets per class.</span>
<span></span><span class="sd">        nt_per_image: Number of targets per image.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        process: Process the detection and pose metrics over the given set of predictions. R</span>
<span></span><span class="sd">        keys: Return a list of keys for accessing metrics.</span>
<span></span><span class="sd">        mean_results: Return the mean results of box and pose.</span>
<span></span><span class="sd">        class_result: Return the class-wise detection results for a specific class i.</span>
<span></span><span class="sd">        maps: Return the mean average precision (mAP) per class for both box and pose detections.</span>
<span></span><span class="sd">        fitness: Return combined fitness score for pose and box detection.</span>
<span></span><span class="sd">        curves: Return a list of curves for accessing specific metrics curves.</span>
<span></span><span class="sd">        curves_results: Provide a list of computed performance metrics and statistics.</span>
<span></span><span class="sd">        summary: Generate a summarized representation of per-class pose metrics as a list of dictionaries.</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize the PoseMetrics class with directory path, class names, and plotting options.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            names (dict[int, str], optional): Dictionary of class names.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">pose</span> <span class="o">=</span> <span class="n">Metric</span><span class="p">()</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="s2">"pose"</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">"tp_p"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># add additional stats for pose</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.PoseMetrics.keys"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.PoseMetrics.keys</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div><p>Return a list of evaluation metric keys.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1377-L1385"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a list of evaluation metric keys."""</span>
<span></span>    <span class="k">return</span> <span class="p">[</span>
<span></span>        <span class="o">*</span><span class="n">DetMetrics</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
<span></span>        <span class="s2">"metrics/precision(P)"</span><span class="p">,</span>
<span></span>        <span class="s2">"metrics/recall(P)"</span><span class="p">,</span>
<span></span>        <span class="s2">"metrics/mAP50(P)"</span><span class="p">,</span>
<span></span>        <span class="s2">"metrics/mAP50-95(P)"</span><span class="p">,</span>
<span></span>    <span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.PoseMetrics.maps"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.PoseMetrics.maps</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">maps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return the mean average precision (mAP) per class for both box and pose detections.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1396-L1398"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">maps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the mean average precision (mAP) per class for both box and pose detections."""</span>
<span></span>    <span class="k">return</span> <span class="n">DetMetrics</span><span class="o">.</span><span class="n">maps</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose</span><span class="o">.</span><span class="n">maps</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.PoseMetrics.fitness"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.PoseMetrics.fitness</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div><p>Return combined fitness score for pose and box detection.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1401-L1403"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return combined fitness score for pose and box detection."""</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose</span><span class="o">.</span><span class="n">fitness</span><span class="p">()</span> <span class="o">+</span> <span class="n">DetMetrics</span><span class="o">.</span><span class="n">fitness</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.PoseMetrics.curves"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.PoseMetrics.curves</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div><p>Return a list of curves for accessing specific metrics curves.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1406-L1418"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a list of curves for accessing specific metrics curves."""</span>
<span></span>    <span class="k">return</span> <span class="p">[</span>
<span></span>        <span class="o">*</span><span class="n">DetMetrics</span><span class="o">.</span><span class="n">curves</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
<span></span>        <span class="s2">"Precision-Recall(B)"</span><span class="p">,</span>
<span></span>        <span class="s2">"F1-Confidence(B)"</span><span class="p">,</span>
<span></span>        <span class="s2">"Precision-Confidence(B)"</span><span class="p">,</span>
<span></span>        <span class="s2">"Recall-Confidence(B)"</span><span class="p">,</span>
<span></span>        <span class="s2">"Precision-Recall(P)"</span><span class="p">,</span>
<span></span>        <span class="s2">"F1-Confidence(P)"</span><span class="p">,</span>
<span></span>        <span class="s2">"Precision-Confidence(P)"</span><span class="p">,</span>
<span></span>        <span class="s2">"Recall-Confidence(P)"</span><span class="p">,</span>
<span></span>    <span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.PoseMetrics.curves_results"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.PoseMetrics.curves_results</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span>
</code></pre></div><p>Return a list of computed performance metrics and statistics.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1421-L1423"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a list of computed performance metrics and statistics."""</span>
<span></span>    <span class="k">return</span> <span class="n">DetMetrics</span><span class="o">.</span><span class="n">curves_results</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose</span><span class="o">.</span><span class="n">curves_results</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.PoseMetrics.class_result"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.PoseMetrics.class_result</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">class_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</code></pre></div><p>Return the class-wise detection results for a specific class i.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>i</code></td><td><code>int</code></td><td></td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1391-L1393"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">class_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the class-wise detection results for a specific class i."""</span>
<span></span>    <span class="k">return</span> <span class="n">DetMetrics</span><span class="o">.</span><span class="n">class_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose</span><span class="o">.</span><span class="n">class_result</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.PoseMetrics.mean_results"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.PoseMetrics.mean_results</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mean_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</code></pre></div><p>Return the mean results of box and pose.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1387-L1389"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mean_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the mean results of box and pose."""</span>
<span></span>    <span class="k">return</span> <span class="n">DetMetrics</span><span class="o">.</span><span class="n">mean_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose</span><span class="o">.</span><span class="n">mean_results</span><span class="p">()</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.PoseMetrics.process"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.PoseMetrics.process</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"."</span><span class="p">),</span> <span class="n">plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">on_plot</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div><p>Process the detection and pose metrics over the given set of predictions.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>save_dir</code></td><td><code>Path</code></td><td>Directory to save plots. Defaults to Path(".").</td><td><code>Path(".")</code></td></tr><tr><td><code>plot</code></td><td><code>bool</code></td><td>Whether to plot precision-recall curves. Defaults to False.</td><td><code>False</code></td></tr><tr><td><code>on_plot</code></td><td><code>callable, optional</code></td><td>Function to call after plots are generated.</td><td><code>None</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>dict[str, np.ndarray]</code></td><td>Dictionary containing concatenated statistics arrays.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1349-L1374"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"."</span><span class="p">),</span> <span class="n">plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">on_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Process the detection and pose metrics over the given set of predictions.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        save_dir (Path): Directory to save plots. Defaults to Path(".").</span>
<span></span><span class="sd">        plot (bool): Whether to plot precision-recall curves. Defaults to False.</span>
<span></span><span class="sd">        on_plot (callable, optional): Function to call after plots are generated.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict[str, np.ndarray]): Dictionary containing concatenated statistics arrays.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">stats</span> <span class="o">=</span> <span class="n">DetMetrics</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">on_plot</span><span class="o">=</span><span class="n">on_plot</span><span class="p">)</span>  <span class="c1"># process box stats</span>
<span></span>    <span class="n">results_pose</span> <span class="o">=</span> <span class="n">ap_per_class</span><span class="p">(</span>
<span></span>        <span class="n">stats</span><span class="p">[</span><span class="s2">"tp_p"</span><span class="p">],</span>
<span></span>        <span class="n">stats</span><span class="p">[</span><span class="s2">"conf"</span><span class="p">],</span>
<span></span>        <span class="n">stats</span><span class="p">[</span><span class="s2">"pred_cls"</span><span class="p">],</span>
<span></span>        <span class="n">stats</span><span class="p">[</span><span class="s2">"target_cls"</span><span class="p">],</span>
<span></span>        <span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span>
<span></span>        <span class="n">on_plot</span><span class="o">=</span><span class="n">on_plot</span><span class="p">,</span>
<span></span>        <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">,</span>
<span></span>        <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
<span></span>        <span class="n">prefix</span><span class="o">=</span><span class="s2">"Pose"</span><span class="p">,</span>
<span></span>    <span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">pose</span><span class="o">.</span><span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">pose</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">results_pose</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">stats</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.PoseMetrics.summary"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.PoseMetrics.summary</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">decimals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
</code></pre></div><p>Generate a summarized representation of per-class pose metrics as a list of dictionaries. Includes both box</p><p>and pose scalar metrics (mAP, mAP50, mAP75) alongside precision, recall, and F1-score for each class.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>normalize</code></td><td><code>bool</code></td><td>For Pose metrics, everything is normalized by default [0-1].</td><td><code>True</code></td></tr><tr><td><code>decimals</code></td><td><code>int</code></td><td>Number of decimal places to round the metrics values to.</td><td><code>5</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list[dict[str, Any]]</code></td><td>A list of dictionaries, each representing one class with corresponding metric</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s2">"coco8-pose.yaml"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">pose_summary</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">pose_summary</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1425-L1450"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">decimals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span></span><span class="w">    </span><span class="sd">"""Generate a summarized representation of per-class pose metrics as a list of dictionaries. Includes both box</span>
<span></span><span class="sd">    and pose scalar metrics (mAP, mAP50, mAP75) alongside precision, recall, and F1-score for each class.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        normalize (bool): For Pose metrics, everything is normalized by default [0-1].</span>
<span></span><span class="sd">        decimals (int): Number of decimal places to round the metrics values to.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list[dict[str, Any]]): A list of dictionaries, each representing one class with corresponding metric</span>
<span></span><span class="sd">            values.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model.val(data="coco8-pose.yaml")</span>
<span></span><span class="sd">        &gt;&gt;&gt; pose_summary = results.summary(decimals=4)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(pose_summary)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">per_class</span> <span class="o">=</span> <span class="p">{</span>
<span></span>        <span class="s2">"Pose-P"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose</span><span class="o">.</span><span class="n">p</span><span class="p">,</span>
<span></span>        <span class="s2">"Pose-R"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
<span></span>        <span class="s2">"Pose-F1"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pose</span><span class="o">.</span><span class="n">f1</span><span class="p">,</span>
<span></span>    <span class="p">}</span>
<span></span>    <span class="n">summary</span> <span class="o">=</span> <span class="n">DetMetrics</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">,</span> <span class="n">decimals</span><span class="p">)</span>  <span class="c1"># get box summary</span>
<span></span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">summary</span><span class="p">):</span>
<span></span>        <span class="n">s</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">decimals</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">per_class</span><span class="o">.</span><span class="n">items</span><span class="p">()}})</span>
<span></span>    <span class="k">return</span> <span class="n">summary</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.ClassifyMetrics"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.utils.metrics.ClassifyMetrics</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">ClassifyMetrics</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p><strong>Bases:</strong> <code>SimpleClass</code>, <code>DataExportMixin</code></p><p>Class for computing classification metrics including top-1 and top-5 accuracy.</p><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>top1</code></td><td><code>float</code></td><td>The top-1 accuracy.</td></tr><tr><td><code>top5</code></td><td><code>float</code></td><td>The top-5 accuracy.</td></tr><tr><td><code>speed</code></td><td><code>dict</code></td><td>A dictionary containing the time taken for each step in the pipeline.</td></tr><tr><td><code>task</code></td><td><code>str</code></td><td>The task type, set to 'classify'.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.utils.metrics.ClassifyMetrics.fitness"><code>fitness</code></a></td><td>Return mean of top-1 and top-5 accuracies as fitness score.</td></tr><tr><td><a href="#ultralytics.utils.metrics.ClassifyMetrics.results_dict"><code>results_dict</code></a></td><td>Return a dictionary with model's performance metrics and fitness score.</td></tr><tr><td><a href="#ultralytics.utils.metrics.ClassifyMetrics.keys"><code>keys</code></a></td><td>Return a list of keys for the results_dict property.</td></tr><tr><td><a href="#ultralytics.utils.metrics.ClassifyMetrics.curves"><code>curves</code></a></td><td>Return a list of curves for accessing specific metrics curves.</td></tr><tr><td><a href="#ultralytics.utils.metrics.ClassifyMetrics.curves_results"><code>curves_results</code></a></td><td>Return a list of curves for accessing specific metrics curves.</td></tr><tr><td><a href="#ultralytics.utils.metrics.ClassifyMetrics.process"><code>process</code></a></td><td>Process target classes and predicted classes to compute metrics.</td></tr><tr><td><a href="#ultralytics.utils.metrics.ClassifyMetrics.summary"><code>summary</code></a></td><td>Generate a single-row summary of classification metrics (Top-1 and Top-5 accuracy).</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1453-L1531"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ClassifyMetrics</span><span class="p">(</span><span class="n">SimpleClass</span><span class="p">,</span> <span class="n">DataExportMixin</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Class for computing classification metrics including top-1 and top-5 accuracy.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        top1 (float): The top-1 accuracy.</span>
<span></span><span class="sd">        top5 (float): The top-5 accuracy.</span>
<span></span><span class="sd">        speed (dict): A dictionary containing the time taken for each step in the pipeline.</span>
<span></span><span class="sd">        task (str): The task type, set to 'classify'.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        process: Process target classes and predicted classes to compute metrics.</span>
<span></span><span class="sd">        fitness: Return mean of top-1 and top-5 accuracies as fitness score.</span>
<span></span><span class="sd">        results_dict: Return a dictionary with model's performance metrics and fitness score.</span>
<span></span><span class="sd">        keys: Return a list of keys for the results_dict property.</span>
<span></span><span class="sd">        curves: Return a list of curves for accessing specific metrics curves.</span>
<span></span><span class="sd">        curves_results: Provide a list of computed performance metrics and statistics.</span>
<span></span><span class="sd">        summary: Generate a single-row summary of classification metrics (Top-1 and Top-5 accuracy).</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize a ClassifyMetrics instance."""</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">top1</span> <span class="o">=</span> <span class="mi">0</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">top5</span> <span class="o">=</span> <span class="mi">0</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"preprocess"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">"inference"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">"loss"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">"postprocess"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="s2">"classify"</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ClassifyMetrics.fitness"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.ClassifyMetrics.fitness</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div><p>Return mean of top-1 and top-5 accuracies as fitness score.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1492-L1494"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return mean of top-1 and top-5 accuracies as fitness score."""</span>
<span></span>    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">top5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ClassifyMetrics.results_dict"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.ClassifyMetrics.results_dict</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">results_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div><p>Return a dictionary with model's performance metrics and fitness score.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1497-L1499"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">results_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a dictionary with model's performance metrics and fitness score."""</span>
<span></span>    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">,</span> <span class="s2">"fitness"</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">top1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">top5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitness</span><span class="p">]))</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ClassifyMetrics.keys"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.ClassifyMetrics.keys</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div><p>Return a list of keys for the results_dict property.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1502-L1504"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a list of keys for the results_dict property."""</span>
<span></span>    <span class="k">return</span> <span class="p">[</span><span class="s2">"metrics/accuracy_top1"</span><span class="p">,</span> <span class="s2">"metrics/accuracy_top5"</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ClassifyMetrics.curves"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.ClassifyMetrics.curves</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span>
</code></pre></div><p>Return a list of curves for accessing specific metrics curves.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1507-L1509"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a list of curves for accessing specific metrics curves."""</span>
<span></span>    <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ClassifyMetrics.curves_results"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.utils.metrics.ClassifyMetrics.curves_results</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span>
</code></pre></div><p>Return a list of curves for accessing specific metrics curves.</p><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1512-L1514"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">curves_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a list of curves for accessing specific metrics curves."""</span>
<span></span>    <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ClassifyMetrics.process"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.ClassifyMetrics.process</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targets</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">pred</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span>
</code></pre></div><p>Process target classes and predicted classes to compute metrics.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>targets</code></td><td><code>torch.Tensor</code></td><td>Target classes.</td><td><em>required</em></td></tr><tr><td><code>pred</code></td><td><code>torch.Tensor</code></td><td>Predicted classes.</td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1479-L1489"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targets</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">pred</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Process target classes and predicted classes to compute metrics.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        targets (torch.Tensor): Target classes.</span>
<span></span><span class="sd">        pred (torch.Tensor): Predicted classes.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">pred</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">pred</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
<span></span>    <span class="n">correct</span> <span class="o">=</span> <span class="p">(</span><span class="n">targets</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">==</span> <span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<span></span>    <span class="n">acc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">correct</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">correct</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># (top1, top5) accuracy</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">top1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">top5</span> <span class="o">=</span> <span class="n">acc</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.utils.metrics.ClassifyMetrics.summary"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.utils.metrics.ClassifyMetrics.summary</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">decimals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span>
</code></pre></div><p>Generate a single-row summary of classification metrics (Top-1 and Top-5 accuracy).</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>normalize</code></td><td><code>bool</code></td><td>For Classify metrics, everything is normalized by default [0-1].</td><td><code>True</code></td></tr><tr><td><code>decimals</code></td><td><code>int</code></td><td>Number of decimal places to round the metrics values to.</td><td><code>5</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list[dict[str, float]]</code></td><td>A list with one dictionary containing Top-1 and Top-5 classification accuracy.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s2">"imagenet10"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">classify_summary</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">classify_summary</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1516-L1531"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">decimals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span></span><span class="w">    </span><span class="sd">"""Generate a single-row summary of classification metrics (Top-1 and Top-5 accuracy).</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        normalize (bool): For Classify metrics, everything is normalized by default [0-1].</span>
<span></span><span class="sd">        decimals (int): Number of decimal places to round the metrics values to.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list[dict[str, float]]): A list with one dictionary containing Top-1 and Top-5 classification accuracy.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model.val(data="imagenet10")</span>
<span></span><span class="sd">        &gt;&gt;&gt; classify_summary = results.summary(decimals=4)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(classify_summary)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="p">[{</span><span class="s2">"top1_acc"</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top1</span><span class="p">,</span> <span class="n">decimals</span><span class="p">),</span> <span class="s2">"top5_acc"</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top5</span><span class="p">,</span> <span class="n">decimals</span><span class="p">)}]</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.OBBMetrics"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.utils.metrics.OBBMetrics</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">OBBMetrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p><strong>Bases:</strong> <code>DetMetrics</code></p><p>Metrics for evaluating oriented bounding box (OBB) detection.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>names</code></td><td><code>dict[int, str], optional</code></td><td>Dictionary of class names.</td><td><code>{}</code></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>names</code></td><td><code>dict[int, str]</code></td><td>Dictionary of class names.</td></tr><tr><td><code>box</code></td><td><code>Metric</code></td><td>An instance of the Metric class for storing detection results.</td></tr><tr><td><code>speed</code></td><td><code>dict[str, float]</code></td><td>A dictionary for storing execution times of different parts of the detection process.</td></tr><tr><td><code>task</code></td><td><code>str</code></td><td>The task type, set to 'obb'.</td></tr><tr><td><code>stats</code></td><td><code>dict[str, list]</code></td><td>A dictionary containing lists for true positives, confidence scores, predicted classes, target classes, and target images.</td></tr><tr><td><code>nt_per_class</code></td><td></td><td>Number of targets per class.</td></tr><tr><td><code>nt_per_image</code></td><td></td><td>Number of targets per image.</td></tr><tr><td><code>References</code></td><td></td><td></td></tr><tr><td><code>https</code></td><td></td><td>//arxiv.org/pdf/2106.06072.pdf</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L1534-L1559"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">OBBMetrics</span><span class="p">(</span><span class="n">DetMetrics</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Metrics for evaluating oriented bounding box (OBB) detection.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        names (dict[int, str]): Dictionary of class names.</span>
<span></span><span class="sd">        box (Metric): An instance of the Metric class for storing detection results.</span>
<span></span><span class="sd">        speed (dict[str, float]): A dictionary for storing execution times of different parts of the detection process.</span>
<span></span><span class="sd">        task (str): The task type, set to 'obb'.</span>
<span></span><span class="sd">        stats (dict[str, list]): A dictionary containing lists for true positives, confidence scores, predicted classes,</span>
<span></span><span class="sd">            target classes, and target images.</span>
<span></span><span class="sd">        nt_per_class: Number of targets per class.</span>
<span></span><span class="sd">        nt_per_image: Number of targets per image.</span>
<span></span>
<span></span><span class="sd">    References:</span>
<span></span><span class="sd">        https://arxiv.org/pdf/2106.06072.pdf</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize an OBBMetrics instance with directory, plotting, and class names.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            names (dict[int, str], optional): Dictionary of class names.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="n">DetMetrics</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
<span></span>        <span class="c1"># TODO: probably remove task as well</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="s2">"obb"</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.bbox_ioa"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.utils.metrics.bbox_ioa</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">bbox_ioa</span><span class="p">(</span><span class="n">box1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">box2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">iou</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Calculate the intersection over box2 area given box1 and box2.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>box1</code></td><td><code>np.ndarray</code></td><td>A numpy array of shape (N, 4) representing N bounding boxes in x1y1x2y2 format.</td><td><em>required</em></td></tr><tr><td><code>box2</code></td><td><code>np.ndarray</code></td><td>A numpy array of shape (M, 4) representing M bounding boxes in x1y1x2y2 format.</td><td><em>required</em></td></tr><tr><td><code>iou</code></td><td><code>bool, optional</code></td><td>Calculate the standard IoU if True else return inter_area/box2_area.</td><td><code>False</code></td></tr><tr><td><code>eps</code></td><td><code>float, optional</code></td><td>A small value to avoid division by zero.</td><td><code>1e-7</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>np.ndarray</code></td><td>A numpy array of shape (N, M) representing the intersection over box2 area.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L26-L54"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">bbox_ioa</span><span class="p">(</span><span class="n">box1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">box2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">iou</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Calculate the intersection over box2 area given box1 and box2.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        box1 (np.ndarray): A numpy array of shape (N, 4) representing N bounding boxes in x1y1x2y2 format.</span>
<span></span><span class="sd">        box2 (np.ndarray): A numpy array of shape (M, 4) representing M bounding boxes in x1y1x2y2 format.</span>
<span></span><span class="sd">        iou (bool, optional): Calculate the standard IoU if True else return inter_area/box2_area.</span>
<span></span><span class="sd">        eps (float, optional): A small value to avoid division by zero.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (np.ndarray): A numpy array of shape (N, M) representing the intersection over box2 area.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="c1"># Get the coordinates of bounding boxes</span>
<span></span>    <span class="n">b1_x1</span><span class="p">,</span> <span class="n">b1_y1</span><span class="p">,</span> <span class="n">b1_x2</span><span class="p">,</span> <span class="n">b1_y2</span> <span class="o">=</span> <span class="n">box1</span><span class="o">.</span><span class="n">T</span>
<span></span>    <span class="n">b2_x1</span><span class="p">,</span> <span class="n">b2_y1</span><span class="p">,</span> <span class="n">b2_x2</span><span class="p">,</span> <span class="n">b2_y2</span> <span class="o">=</span> <span class="n">box2</span><span class="o">.</span><span class="n">T</span>
<span></span>
<span></span>    <span class="c1"># Intersection area</span>
<span></span>    <span class="n">inter_area</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">b1_x2</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">b2_x2</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">b1_x1</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">b2_x1</span><span class="p">))</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
<span></span>        <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">b1_y2</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">b2_y2</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">b1_y1</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">b2_y1</span><span class="p">)</span>
<span></span>    <span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Box2 area</span>
<span></span>    <span class="n">area</span> <span class="o">=</span> <span class="p">(</span><span class="n">b2_x2</span> <span class="o">-</span> <span class="n">b2_x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b2_y2</span> <span class="o">-</span> <span class="n">b2_y1</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">iou</span><span class="p">:</span>
<span></span>        <span class="n">box1_area</span> <span class="o">=</span> <span class="p">(</span><span class="n">b1_x2</span> <span class="o">-</span> <span class="n">b1_x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b1_y2</span> <span class="o">-</span> <span class="n">b1_y1</span><span class="p">)</span>
<span></span>        <span class="n">area</span> <span class="o">=</span> <span class="n">area</span> <span class="o">+</span> <span class="n">box1_area</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">-</span> <span class="n">inter_area</span>
<span></span>
<span></span>    <span class="c1"># Intersection over box2 area</span>
<span></span>    <span class="k">return</span> <span class="n">inter_area</span> <span class="o">/</span> <span class="p">(</span><span class="n">area</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.box_iou"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.utils.metrics.box_iou</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">box_iou</span><span class="p">(</span><span class="n">box1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">box2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div><p>Calculate intersection-over-union (IoU) of boxes.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>box1</code></td><td><code>torch.Tensor</code></td><td>A tensor of shape (N, 4) representing N bounding boxes in (x1, y1, x2, y2) format.</td><td><em>required</em></td></tr><tr><td><code>box2</code></td><td><code>torch.Tensor</code></td><td>A tensor of shape (M, 4) representing M bounding boxes in (x1, y1, x2, y2) format.</td><td><em>required</em></td></tr><tr><td><code>eps</code></td><td><code>float, optional</code></td><td>A small value to avoid division by zero.</td><td><code>1e-7</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor</code></td><td>An NxM tensor containing the pairwise IoU values for every element in box1 and box2.</td></tr><tr><td><code>References</code></td><td></td></tr><tr><td><code>https</code></td><td>//github.com/pytorch/vision/blob/main/torchvision/ops/boxes.py</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L57-L77"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">box_iou</span><span class="p">(</span><span class="n">box1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">box2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Calculate intersection-over-union (IoU) of boxes.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        box1 (torch.Tensor): A tensor of shape (N, 4) representing N bounding boxes in (x1, y1, x2, y2) format.</span>
<span></span><span class="sd">        box2 (torch.Tensor): A tensor of shape (M, 4) representing M bounding boxes in (x1, y1, x2, y2) format.</span>
<span></span><span class="sd">        eps (float, optional): A small value to avoid division by zero.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor): An NxM tensor containing the pairwise IoU values for every element in box1 and box2.</span>
<span></span>
<span></span><span class="sd">    References:</span>
<span></span><span class="sd">        https://github.com/pytorch/vision/blob/main/torchvision/ops/boxes.py</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="c1"># NOTE: Need .float() to get accurate iou values</span>
<span></span>    <span class="c1"># inter(N,M) = (rb(N,M,2) - lt(N,M,2)).clamp(0).prod(2)</span>
<span></span>    <span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">),</span> <span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span> <span class="o">=</span> <span class="n">box1</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">box2</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span></span>    <span class="n">inter</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">))</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># IoU = inter / (area1 + area2 - inter)</span>
<span></span>    <span class="k">return</span> <span class="n">inter</span> <span class="o">/</span> <span class="p">((</span><span class="n">a2</span> <span class="o">-</span> <span class="n">a1</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">b2</span> <span class="o">-</span> <span class="n">b1</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">inter</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.bbox_iou"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.utils.metrics.bbox_iou</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">bbox_iou</span><span class="p">(</span>
<span></span>    <span class="n">box1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<span></span>    <span class="n">box2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<span></span>    <span class="n">xywh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">GIoU</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">DIoU</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">CIoU</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">,</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div><p>Calculate the Intersection over Union (IoU) between bounding boxes.</p><p>This function supports various shapes for <code>box1</code> and <code>box2</code> as long as the last dimension is 4. For instance, you may pass tensors shaped like (4,), (N, 4), (B, N, 4), or (B, N, 1, 4). Internally, the code will split the last dimension into (x, y, w, h) if <code>xywh=True</code>, or (x1, y1, x2, y2) if <code>xywh=False</code>.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>box1</code></td><td><code>torch.Tensor</code></td><td>A tensor representing one or more bounding boxes, with the last dimension being 4.</td><td><em>required</em></td></tr><tr><td><code>box2</code></td><td><code>torch.Tensor</code></td><td>A tensor representing one or more bounding boxes, with the last dimension being 4.</td><td><em>required</em></td></tr><tr><td><code>xywh</code></td><td><code>bool, optional</code></td><td>If True, input boxes are in (x, y, w, h) format. If False, input boxes are in (x1, y1, x2, y2) format.</td><td><code>True</code></td></tr><tr><td><code>GIoU</code></td><td><code>bool, optional</code></td><td>If True, calculate Generalized IoU.</td><td><code>False</code></td></tr><tr><td><code>DIoU</code></td><td><code>bool, optional</code></td><td>If True, calculate Distance IoU.</td><td><code>False</code></td></tr><tr><td><code>CIoU</code></td><td><code>bool, optional</code></td><td>If True, calculate Complete IoU.</td><td><code>False</code></td></tr><tr><td><code>eps</code></td><td><code>float, optional</code></td><td>A small value to avoid division by zero.</td><td><code>1e-7</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor</code></td><td>IoU, GIoU, DIoU, or CIoU values depending on the specified flags.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L80-L146"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">bbox_iou</span><span class="p">(</span>
<span></span>    <span class="n">box1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<span></span>    <span class="n">box2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<span></span>    <span class="n">xywh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">GIoU</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">DIoU</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">CIoU</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">,</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Calculate the Intersection over Union (IoU) between bounding boxes.</span>
<span></span>
<span></span><span class="sd">    This function supports various shapes for `box1` and `box2` as long as the last dimension is 4. For instance, you</span>
<span></span><span class="sd">    may pass tensors shaped like (4,), (N, 4), (B, N, 4), or (B, N, 1, 4). Internally, the code will split the last</span>
<span></span><span class="sd">    dimension into (x, y, w, h) if `xywh=True`, or (x1, y1, x2, y2) if `xywh=False`.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        box1 (torch.Tensor): A tensor representing one or more bounding boxes, with the last dimension being 4.</span>
<span></span><span class="sd">        box2 (torch.Tensor): A tensor representing one or more bounding boxes, with the last dimension being 4.</span>
<span></span><span class="sd">        xywh (bool, optional): If True, input boxes are in (x, y, w, h) format. If False, input boxes are in (x1, y1,</span>
<span></span><span class="sd">            x2, y2) format.</span>
<span></span><span class="sd">        GIoU (bool, optional): If True, calculate Generalized IoU.</span>
<span></span><span class="sd">        DIoU (bool, optional): If True, calculate Distance IoU.</span>
<span></span><span class="sd">        CIoU (bool, optional): If True, calculate Complete IoU.</span>
<span></span><span class="sd">        eps (float, optional): A small value to avoid division by zero.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor): IoU, GIoU, DIoU, or CIoU values depending on the specified flags.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="c1"># Get the coordinates of bounding boxes</span>
<span></span>    <span class="k">if</span> <span class="n">xywh</span><span class="p">:</span>  <span class="c1"># transform from xywh to xyxy</span>
<span></span>        <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">h1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span> <span class="o">=</span> <span class="n">box1</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">box2</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span></span>        <span class="n">w1_</span><span class="p">,</span> <span class="n">h1_</span><span class="p">,</span> <span class="n">w2_</span><span class="p">,</span> <span class="n">h2_</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">h1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">w2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">h2</span> <span class="o">/</span> <span class="mi">2</span>
<span></span>        <span class="n">b1_x1</span><span class="p">,</span> <span class="n">b1_x2</span><span class="p">,</span> <span class="n">b1_y1</span><span class="p">,</span> <span class="n">b1_y2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">w1_</span><span class="p">,</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">w1_</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">h1_</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">h1_</span>
<span></span>        <span class="n">b2_x1</span><span class="p">,</span> <span class="n">b2_x2</span><span class="p">,</span> <span class="n">b2_y1</span><span class="p">,</span> <span class="n">b2_y2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">w2_</span><span class="p">,</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">w2_</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">h2_</span><span class="p">,</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">h2_</span>
<span></span>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># x1, y1, x2, y2 = box1</span>
<span></span>        <span class="n">b1_x1</span><span class="p">,</span> <span class="n">b1_y1</span><span class="p">,</span> <span class="n">b1_x2</span><span class="p">,</span> <span class="n">b1_y2</span> <span class="o">=</span> <span class="n">box1</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span></span>        <span class="n">b2_x1</span><span class="p">,</span> <span class="n">b2_y1</span><span class="p">,</span> <span class="n">b2_x2</span><span class="p">,</span> <span class="n">b2_y2</span> <span class="o">=</span> <span class="n">box2</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span></span>        <span class="n">w1</span><span class="p">,</span> <span class="n">h1</span> <span class="o">=</span> <span class="n">b1_x2</span> <span class="o">-</span> <span class="n">b1_x1</span><span class="p">,</span> <span class="n">b1_y2</span> <span class="o">-</span> <span class="n">b1_y1</span> <span class="o">+</span> <span class="n">eps</span>
<span></span>        <span class="n">w2</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">b2_x2</span> <span class="o">-</span> <span class="n">b2_x1</span><span class="p">,</span> <span class="n">b2_y2</span> <span class="o">-</span> <span class="n">b2_y1</span> <span class="o">+</span> <span class="n">eps</span>
<span></span>
<span></span>    <span class="c1"># Intersection area</span>
<span></span>    <span class="n">inter</span> <span class="o">=</span> <span class="p">(</span><span class="n">b1_x2</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">b2_x2</span><span class="p">)</span> <span class="o">-</span> <span class="n">b1_x1</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">b2_x1</span><span class="p">))</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
<span></span>        <span class="n">b1_y2</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">b2_y2</span><span class="p">)</span> <span class="o">-</span> <span class="n">b1_y1</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">b2_y1</span><span class="p">)</span>
<span></span>    <span class="p">)</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Union Area</span>
<span></span>    <span class="n">union</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">h1</span> <span class="o">+</span> <span class="n">w2</span> <span class="o">*</span> <span class="n">h2</span> <span class="o">-</span> <span class="n">inter</span> <span class="o">+</span> <span class="n">eps</span>
<span></span>
<span></span>    <span class="c1"># IoU</span>
<span></span>    <span class="n">iou</span> <span class="o">=</span> <span class="n">inter</span> <span class="o">/</span> <span class="n">union</span>
<span></span>    <span class="k">if</span> <span class="n">CIoU</span> <span class="ow">or</span> <span class="n">DIoU</span> <span class="ow">or</span> <span class="n">GIoU</span><span class="p">:</span>
<span></span>        <span class="n">cw</span> <span class="o">=</span> <span class="n">b1_x2</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">b2_x2</span><span class="p">)</span> <span class="o">-</span> <span class="n">b1_x1</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">b2_x1</span><span class="p">)</span>  <span class="c1"># convex (smallest enclosing box) width</span>
<span></span>        <span class="n">ch</span> <span class="o">=</span> <span class="n">b1_y2</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">b2_y2</span><span class="p">)</span> <span class="o">-</span> <span class="n">b1_y1</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">b2_y1</span><span class="p">)</span>  <span class="c1"># convex height</span>
<span></span>        <span class="k">if</span> <span class="n">CIoU</span> <span class="ow">or</span> <span class="n">DIoU</span><span class="p">:</span>  <span class="c1"># Distance or Complete IoU https://arxiv.org/abs/1911.08287v1</span>
<span></span>            <span class="n">c2</span> <span class="o">=</span> <span class="n">cw</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">ch</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">eps</span>  <span class="c1"># convex diagonal squared</span>
<span></span>            <span class="n">rho2</span> <span class="o">=</span> <span class="p">(</span>
<span></span>                <span class="p">(</span><span class="n">b2_x1</span> <span class="o">+</span> <span class="n">b2_x2</span> <span class="o">-</span> <span class="n">b1_x1</span> <span class="o">-</span> <span class="n">b1_x2</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">b2_y1</span> <span class="o">+</span> <span class="n">b2_y2</span> <span class="o">-</span> <span class="n">b1_y1</span> <span class="o">-</span> <span class="n">b1_y2</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span></span>            <span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>  <span class="c1"># center dist**2</span>
<span></span>            <span class="k">if</span> <span class="n">CIoU</span><span class="p">:</span>  <span class="c1"># https://github.com/Zzh-tju/DIoU-SSD-pytorch/blob/master/utils/box/box_utils.py#L47</span>
<span></span>                <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">w2</span> <span class="o">/</span> <span class="n">h2</span><span class="p">)</span><span class="o">.</span><span class="n">atan</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">w1</span> <span class="o">/</span> <span class="n">h1</span><span class="p">)</span><span class="o">.</span><span class="n">atan</span><span class="p">())</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span></span>                <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<span></span>                    <span class="n">alpha</span> <span class="o">=</span> <span class="n">v</span> <span class="o">/</span> <span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">iou</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">eps</span><span class="p">))</span>
<span></span>                <span class="k">return</span> <span class="n">iou</span> <span class="o">-</span> <span class="p">(</span><span class="n">rho2</span> <span class="o">/</span> <span class="n">c2</span> <span class="o">+</span> <span class="n">v</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>  <span class="c1"># CIoU</span>
<span></span>            <span class="k">return</span> <span class="n">iou</span> <span class="o">-</span> <span class="n">rho2</span> <span class="o">/</span> <span class="n">c2</span>  <span class="c1"># DIoU</span>
<span></span>        <span class="n">c_area</span> <span class="o">=</span> <span class="n">cw</span> <span class="o">*</span> <span class="n">ch</span> <span class="o">+</span> <span class="n">eps</span>  <span class="c1"># convex area</span>
<span></span>        <span class="k">return</span> <span class="n">iou</span> <span class="o">-</span> <span class="p">(</span><span class="n">c_area</span> <span class="o">-</span> <span class="n">union</span><span class="p">)</span> <span class="o">/</span> <span class="n">c_area</span>  <span class="c1"># GIoU https://arxiv.org/pdf/1902.09630.pdf</span>
<span></span>    <span class="k">return</span> <span class="n">iou</span>  <span class="c1"># IoU</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.mask_iou"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.utils.metrics.mask_iou</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mask_iou</span><span class="p">(</span><span class="n">mask1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">mask2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div><p>Calculate masks IoU.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>mask1</code></td><td><code>torch.Tensor</code></td><td>A tensor of shape (N, n) where N is the number of ground truth objects and n is the product of image width and height.</td><td><em>required</em></td></tr><tr><td><code>mask2</code></td><td><code>torch.Tensor</code></td><td>A tensor of shape (M, n) where M is the number of predicted objects and n is the product of image width and height.</td><td><em>required</em></td></tr><tr><td><code>eps</code></td><td><code>float, optional</code></td><td>A small value to avoid division by zero.</td><td><code>1e-7</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor</code></td><td>A tensor of shape (N, M) representing masks IoU.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L149-L164"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mask_iou</span><span class="p">(</span><span class="n">mask1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">mask2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Calculate masks IoU.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        mask1 (torch.Tensor): A tensor of shape (N, n) where N is the number of ground truth objects and n is the</span>
<span></span><span class="sd">            product of image width and height.</span>
<span></span><span class="sd">        mask2 (torch.Tensor): A tensor of shape (M, n) where M is the number of predicted objects and n is the product</span>
<span></span><span class="sd">            of image width and height.</span>
<span></span><span class="sd">        eps (float, optional): A small value to avoid division by zero.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor): A tensor of shape (N, M) representing masks IoU.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">intersection</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mask1</span><span class="p">,</span> <span class="n">mask2</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span></span>    <span class="n">union</span> <span class="o">=</span> <span class="p">(</span><span class="n">mask1</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">mask2</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="kc">None</span><span class="p">])</span> <span class="o">-</span> <span class="n">intersection</span>  <span class="c1"># (area1 + area2) - intersection</span>
<span></span>    <span class="k">return</span> <span class="n">intersection</span> <span class="o">/</span> <span class="p">(</span><span class="n">union</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.kpt_iou"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.utils.metrics.kpt_iou</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kpt_iou</span><span class="p">(</span>
<span></span>    <span class="n">kpt1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">kpt2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">area</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div><p>Calculate Object Keypoint Similarity (OKS).</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>kpt1</code></td><td><code>torch.Tensor</code></td><td>A tensor of shape (N, 17, 3) representing ground truth keypoints.</td><td><em>required</em></td></tr><tr><td><code>kpt2</code></td><td><code>torch.Tensor</code></td><td>A tensor of shape (M, 17, 3) representing predicted keypoints.</td><td><em>required</em></td></tr><tr><td><code>area</code></td><td><code>torch.Tensor</code></td><td>A tensor of shape (N,) representing areas from ground truth.</td><td><em>required</em></td></tr><tr><td><code>sigma</code></td><td><code>list</code></td><td>A list containing 17 values representing keypoint scales.</td><td><em>required</em></td></tr><tr><td><code>eps</code></td><td><code>float, optional</code></td><td>A small value to avoid division by zero.</td><td><code>1e-7</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor</code></td><td>A tensor of shape (N, M) representing keypoint similarities.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L167-L187"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kpt_iou</span><span class="p">(</span>
<span></span>    <span class="n">kpt1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">kpt2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">area</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Calculate Object Keypoint Similarity (OKS).</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        kpt1 (torch.Tensor): A tensor of shape (N, 17, 3) representing ground truth keypoints.</span>
<span></span><span class="sd">        kpt2 (torch.Tensor): A tensor of shape (M, 17, 3) representing predicted keypoints.</span>
<span></span><span class="sd">        area (torch.Tensor): A tensor of shape (N,) representing areas from ground truth.</span>
<span></span><span class="sd">        sigma (list): A list containing 17 values representing keypoint scales.</span>
<span></span><span class="sd">        eps (float, optional): A small value to avoid division by zero.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor): A tensor of shape (N, M) representing keypoint similarities.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">kpt1</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">kpt2</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">kpt1</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">kpt2</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># (N, M, 17)</span>
<span></span>    <span class="n">sigma</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">kpt1</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">kpt1</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># (17, )</span>
<span></span>    <span class="n">kpt_mask</span> <span class="o">=</span> <span class="n">kpt1</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span>  <span class="c1"># (N, 17)</span>
<span></span>    <span class="n">e</span> <span class="o">=</span> <span class="n">d</span> <span class="o">/</span> <span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">area</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># from cocoeval</span>
<span></span>    <span class="c1"># e = d / ((area[None, :, None] + eps) * sigma) ** 2 / 2  # from formula</span>
<span></span>    <span class="k">return</span> <span class="p">((</span><span class="o">-</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span> <span class="o">*</span> <span class="n">kpt_mask</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">kpt_mask</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics._get_covariance_matrix"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.utils.metrics._get_covariance_matrix</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_get_covariance_matrix</span><span class="p">(</span><span class="n">boxes</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span>
</code></pre></div><p>Generate covariance matrix from oriented bounding boxes.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>boxes</code></td><td><code>torch.Tensor</code></td><td>A tensor of shape (N, 5) representing rotated bounding boxes, with xywhr format.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor</code></td><td>Covariance matrices corresponding to original rotated bounding boxes.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L190-L206"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_get_covariance_matrix</span><span class="p">(</span><span class="n">boxes</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Generate covariance matrix from oriented bounding boxes.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        boxes (torch.Tensor): A tensor of shape (N, 5) representing rotated bounding boxes, with xywhr format.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor): Covariance matrices corresponding to original rotated bounding boxes.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="c1"># Gaussian bounding boxes, ignore the center points (the first two columns) because they are not needed here.</span>
<span></span>    <span class="n">gbbs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">boxes</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span><span class="p">,</span> <span class="n">boxes</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:]),</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">gbbs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="n">cos</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">cos</span><span class="p">()</span>
<span></span>    <span class="n">sin</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">sin</span><span class="p">()</span>
<span></span>    <span class="n">cos2</span> <span class="o">=</span> <span class="n">cos</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span></span>    <span class="n">sin2</span> <span class="o">=</span> <span class="n">sin</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">cos2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">sin2</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">sin2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">cos2</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span> <span class="o">*</span> <span class="n">sin</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.probiou"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.utils.metrics.probiou</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">probiou</span><span class="p">(</span><span class="n">obb1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">obb2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">CIoU</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div><p>Calculate probabilistic IoU between oriented bounding boxes.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>obb1</code></td><td><code>torch.Tensor</code></td><td>Ground truth OBBs, shape (N, 5), format xywhr.</td><td><em>required</em></td></tr><tr><td><code>obb2</code></td><td><code>torch.Tensor</code></td><td>Predicted OBBs, shape (N, 5), format xywhr.</td><td><em>required</em></td></tr><tr><td><code>CIoU</code></td><td><code>bool, optional</code></td><td>If True, calculate CIoU.</td><td><code>False</code></td></tr><tr><td><code>eps</code></td><td><code>float, optional</code></td><td>Small value to avoid division by zero.</td><td><code>1e-7</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor</code></td><td>OBB similarities, shape (N,).</td></tr></tbody></table><div class="admonition note"><p class="admonition-title">Notes</p><p>OBB format: [center_x, center_y, width, height, rotation_angle].</p><p>References: <a href="https://arxiv.org/pdf/2106.06072v1.pdf">https://arxiv.org/pdf/2106.06072v1.pdf</a></p></div><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L209-L251"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">probiou</span><span class="p">(</span><span class="n">obb1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">obb2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">CIoU</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Calculate probabilistic IoU between oriented bounding boxes.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        obb1 (torch.Tensor): Ground truth OBBs, shape (N, 5), format xywhr.</span>
<span></span><span class="sd">        obb2 (torch.Tensor): Predicted OBBs, shape (N, 5), format xywhr.</span>
<span></span><span class="sd">        CIoU (bool, optional): If True, calculate CIoU.</span>
<span></span><span class="sd">        eps (float, optional): Small value to avoid division by zero.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor): OBB similarities, shape (N,).</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        OBB format: [center_x, center_y, width, height, rotation_angle].</span>
<span></span>
<span></span><span class="sd">    References:</span>
<span></span><span class="sd">        https://arxiv.org/pdf/2106.06072v1.pdf</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">obb1</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">obb2</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">_get_covariance_matrix</span><span class="p">(</span><span class="n">obb1</span><span class="p">)</span>
<span></span>    <span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">_get_covariance_matrix</span><span class="p">(</span><span class="n">obb2</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span>
<span></span>        <span class="p">((</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>
<span></span>    <span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span>
<span></span>    <span class="n">t2</span> <span class="o">=</span> <span class="p">(((</span><span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">eps</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.5</span>
<span></span>    <span class="n">t3</span> <span class="o">=</span> <span class="p">(</span>
<span></span>        <span class="p">((</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span></span>        <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="p">((</span><span class="n">a1</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">-</span> <span class="n">c1</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a2</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">c2</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>
<span></span>        <span class="o">+</span> <span class="n">eps</span>
<span></span>    <span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.5</span>
<span></span>    <span class="n">bd</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1</span> <span class="o">+</span> <span class="n">t2</span> <span class="o">+</span> <span class="n">t3</span><span class="p">)</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="n">eps</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span>
<span></span>    <span class="n">hd</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">bd</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span></span>    <span class="n">iou</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">hd</span>
<span></span>    <span class="k">if</span> <span class="n">CIoU</span><span class="p">:</span>  <span class="c1"># only include the wh aspect ratio part</span>
<span></span>        <span class="n">w1</span><span class="p">,</span> <span class="n">h1</span> <span class="o">=</span> <span class="n">obb1</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span></span>        <span class="n">w2</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">obb2</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span></span>        <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">w2</span> <span class="o">/</span> <span class="n">h2</span><span class="p">)</span><span class="o">.</span><span class="n">atan</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">w1</span> <span class="o">/</span> <span class="n">h1</span><span class="p">)</span><span class="o">.</span><span class="n">atan</span><span class="p">())</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span></span>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<span></span>            <span class="n">alpha</span> <span class="o">=</span> <span class="n">v</span> <span class="o">/</span> <span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">iou</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">eps</span><span class="p">))</span>
<span></span>        <span class="k">return</span> <span class="n">iou</span> <span class="o">-</span> <span class="n">v</span> <span class="o">*</span> <span class="n">alpha</span>  <span class="c1"># CIoU</span>
<span></span>    <span class="k">return</span> <span class="n">iou</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.batch_probiou"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.utils.metrics.batch_probiou</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">batch_probiou</span><span class="p">(</span><span class="n">obb1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">obb2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div><p>Calculate the probabilistic IoU between oriented bounding boxes.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>obb1</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>A tensor of shape (N, 5) representing ground truth obbs, with xywhr format.</td><td><em>required</em></td></tr><tr><td><code>obb2</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>A tensor of shape (M, 5) representing predicted obbs, with xywhr format.</td><td><em>required</em></td></tr><tr><td><code>eps</code></td><td><code>float, optional</code></td><td>A small value to avoid division by zero.</td><td><code>1e-7</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor</code></td><td>A tensor of shape (N, M) representing obb similarities.</td></tr><tr><td><code>References</code></td><td></td></tr><tr><td><code>https</code></td><td>//arxiv.org/pdf/2106.06072v1.pdf</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L254-L287"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">batch_probiou</span><span class="p">(</span><span class="n">obb1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">obb2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Calculate the probabilistic IoU between oriented bounding boxes.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        obb1 (torch.Tensor | np.ndarray): A tensor of shape (N, 5) representing ground truth obbs, with xywhr format.</span>
<span></span><span class="sd">        obb2 (torch.Tensor | np.ndarray): A tensor of shape (M, 5) representing predicted obbs, with xywhr format.</span>
<span></span><span class="sd">        eps (float, optional): A small value to avoid division by zero.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor): A tensor of shape (N, M) representing obb similarities.</span>
<span></span>
<span></span><span class="sd">    References:</span>
<span></span><span class="sd">        https://arxiv.org/pdf/2106.06072v1.pdf</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">obb1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obb1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obb1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">else</span> <span class="n">obb1</span>
<span></span>    <span class="n">obb2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obb2</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obb2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">else</span> <span class="n">obb2</span>
<span></span>
<span></span>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">obb1</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="kc">None</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">obb2</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
<span></span>    <span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">_get_covariance_matrix</span><span class="p">(</span><span class="n">obb1</span><span class="p">)</span>
<span></span>    <span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="kc">None</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">_get_covariance_matrix</span><span class="p">(</span><span class="n">obb2</span><span class="p">))</span>
<span></span>
<span></span>    <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span>
<span></span>        <span class="p">((</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>
<span></span>    <span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span>
<span></span>    <span class="n">t2</span> <span class="o">=</span> <span class="p">(((</span><span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">eps</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.5</span>
<span></span>    <span class="n">t3</span> <span class="o">=</span> <span class="p">(</span>
<span></span>        <span class="p">((</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span></span>        <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="p">((</span><span class="n">a1</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">-</span> <span class="n">c1</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a2</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">c2</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">clamp_</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>
<span></span>        <span class="o">+</span> <span class="n">eps</span>
<span></span>    <span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.5</span>
<span></span>    <span class="n">bd</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1</span> <span class="o">+</span> <span class="n">t2</span> <span class="o">+</span> <span class="n">t3</span><span class="p">)</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="n">eps</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span>
<span></span>    <span class="n">hd</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">bd</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span></span>    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">hd</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.smooth_bce"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.utils.metrics.smooth_bce</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">smooth_bce</span><span class="p">(</span><span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div><p>Compute smoothed positive and negative Binary Cross-Entropy targets.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>eps</code></td><td><code>float, optional</code></td><td>The epsilon value for label smoothing.</td><td><code>0.1</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>pos (float)</code></td><td>Positive label smoothing BCE target.</td></tr><tr><td><code>neg (float)</code></td><td>Negative label smoothing BCE target.</td></tr><tr><td><code>References</code></td><td></td></tr><tr><td><code>https</code></td><td>//github.com/ultralytics/yolov3/issues/238#issuecomment-598028441</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L290-L303"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">smooth_bce</span><span class="p">(</span><span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Compute smoothed positive and negative Binary Cross-Entropy targets.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        eps (float, optional): The epsilon value for label smoothing.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        pos (float): Positive label smoothing BCE target.</span>
<span></span><span class="sd">        neg (float): Negative label smoothing BCE target.</span>
<span></span>
<span></span><span class="sd">    References:</span>
<span></span><span class="sd">        https://github.com/ultralytics/yolov3/issues/238#issuecomment-598028441</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">eps</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">eps</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.smooth"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.utils.metrics.smooth</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">smooth</span><span class="p">(</span><span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Box filter of fraction f.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>y</code></td><td><code>np.ndarray</code></td><td></td><td><em>required</em></td></tr><tr><td><code>f</code></td><td><code>float</code></td><td></td><td><code>0.05</code></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L615-L620"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">smooth</span><span class="p">(</span><span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Box filter of fraction f."""</span>
<span></span>    <span class="n">nf</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># number of filter elements (must be odd)</span>
<span></span>    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nf</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># ones padding</span>
<span></span>    <span class="n">yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">p</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># y padded</span>
<span></span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">yp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span> <span class="o">/</span> <span class="n">nf</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"valid"</span><span class="p">)</span>  <span class="c1"># y-smoothed</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.plot_pr_curve"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.utils.metrics.plot_pr_curve</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_pr_curve</span><span class="p">(</span>
<span></span>    <span class="n">px</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">py</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">ap</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"pr_curve.png"</span><span class="p">),</span>
<span></span>    <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
<span></span>    <span class="n">on_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span><span class="p">)</span>
</code></pre></div><p>Plot precision-recall curve.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>px</code></td><td><code>np.ndarray</code></td><td>X values for the PR curve.</td><td><em>required</em></td></tr><tr><td><code>py</code></td><td><code>np.ndarray</code></td><td>Y values for the PR curve.</td><td><em>required</em></td></tr><tr><td><code>ap</code></td><td><code>np.ndarray</code></td><td>Average precision values.</td><td><em>required</em></td></tr><tr><td><code>save_dir</code></td><td><code>Path, optional</code></td><td>Path to save the plot.</td><td><code>Path("pr_curve.png")</code></td></tr><tr><td><code>names</code></td><td><code>dict[int, str], optional</code></td><td>Dictionary mapping class indices to class names.</td><td><code>{}</code></td></tr><tr><td><code>on_plot</code></td><td><code>callable, optional</code></td><td>Function to call after plot is saved.</td><td><code>None</code></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L624-L663"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@plt_settings</span><span class="p">()</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_pr_curve</span><span class="p">(</span>
<span></span>    <span class="n">px</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">py</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">ap</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"pr_curve.png"</span><span class="p">),</span>
<span></span>    <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
<span></span>    <span class="n">on_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Plot precision-recall curve.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        px (np.ndarray): X values for the PR curve.</span>
<span></span><span class="sd">        py (np.ndarray): Y values for the PR curve.</span>
<span></span><span class="sd">        ap (np.ndarray): Average precision values.</span>
<span></span><span class="sd">        save_dir (Path, optional): Path to save the plot.</span>
<span></span><span class="sd">        names (dict[int, str], optional): Dictionary mapping class indices to class names.</span>
<span></span><span class="sd">        on_plot (callable, optional): Function to call after plot is saved.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>  <span class="c1"># scope for faster 'import ultralytics'</span>
<span></span>
<span></span>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>    <span class="n">py</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">py</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">21</span><span class="p">:</span>  <span class="c1"># display per-class legend if &lt; 21 classes</span>
<span></span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">py</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
<span></span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">ap</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># plot(recall, precision)</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>  <span class="c1"># plot(recall, precision)</span>
<span></span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"all classes </span><span class="si">{</span><span class="n">ap</span><span class="p">[:,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> mAP@0.5"</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Recall"</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Precision"</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.04</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">"upper left"</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Precision-Recall Curve"</span><span class="p">)</span>
<span></span>    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span></span>    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">on_plot</span><span class="p">:</span>
<span></span>        <span class="n">on_plot</span><span class="p">(</span><span class="n">save_dir</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.plot_mc_curve"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.utils.metrics.plot_mc_curve</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_mc_curve</span><span class="p">(</span>
<span></span>    <span class="n">px</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">py</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"mc_curve.png"</span><span class="p">),</span>
<span></span>    <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
<span></span>    <span class="n">xlabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"Confidence"</span><span class="p">,</span>
<span></span>    <span class="n">ylabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span>
<span></span>    <span class="n">on_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span><span class="p">)</span>
</code></pre></div><p>Plot metric-confidence curve.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>px</code></td><td><code>np.ndarray</code></td><td>X values for the metric-confidence curve.</td><td><em>required</em></td></tr><tr><td><code>py</code></td><td><code>np.ndarray</code></td><td>Y values for the metric-confidence curve.</td><td><em>required</em></td></tr><tr><td><code>save_dir</code></td><td><code>Path, optional</code></td><td>Path to save the plot.</td><td><code>Path("mc_curve.png")</code></td></tr><tr><td><code>names</code></td><td><code>dict[int, str], optional</code></td><td>Dictionary mapping class indices to class names.</td><td><code>{}</code></td></tr><tr><td><code>xlabel</code></td><td><code>str, optional</code></td><td>X-axis label.</td><td><code>"Confidence"</code></td></tr><tr><td><code>ylabel</code></td><td><code>str, optional</code></td><td>Y-axis label.</td><td><code>"Metric"</code></td></tr><tr><td><code>on_plot</code></td><td><code>callable, optional</code></td><td>Function to call after plot is saved.</td><td><code>None</code></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L667-L708"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@plt_settings</span><span class="p">()</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_mc_curve</span><span class="p">(</span>
<span></span>    <span class="n">px</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">py</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"mc_curve.png"</span><span class="p">),</span>
<span></span>    <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
<span></span>    <span class="n">xlabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"Confidence"</span><span class="p">,</span>
<span></span>    <span class="n">ylabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span>
<span></span>    <span class="n">on_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Plot metric-confidence curve.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        px (np.ndarray): X values for the metric-confidence curve.</span>
<span></span><span class="sd">        py (np.ndarray): Y values for the metric-confidence curve.</span>
<span></span><span class="sd">        save_dir (Path, optional): Path to save the plot.</span>
<span></span><span class="sd">        names (dict[int, str], optional): Dictionary mapping class indices to class names.</span>
<span></span><span class="sd">        xlabel (str, optional): X-axis label.</span>
<span></span><span class="sd">        ylabel (str, optional): Y-axis label.</span>
<span></span><span class="sd">        on_plot (callable, optional): Function to call after plot is saved.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>  <span class="c1"># scope for faster 'import ultralytics'</span>
<span></span>
<span></span>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">21</span><span class="p">:</span>  <span class="c1"># display per-class legend if &lt; 21 classes</span>
<span></span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">py</span><span class="p">):</span>
<span></span>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># plot(confidence, metric)</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>  <span class="c1"># plot(confidence, metric)</span>
<span></span>
<span></span>    <span class="n">y</span> <span class="o">=</span> <span class="n">smooth</span><span class="p">(</span><span class="n">py</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"all classes </span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="n">px</span><span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.04</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">"upper left"</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">ylabel</span><span class="si">}</span><span class="s2">-Confidence Curve"</span><span class="p">)</span>
<span></span>    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span></span>    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">on_plot</span><span class="p">:</span>
<span></span>        <span class="n">on_plot</span><span class="p">(</span><span class="n">save_dir</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.compute_ap"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.utils.metrics.compute_ap</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_ap</span><span class="p">(</span><span class="n">recall</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">precision</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div><p>Compute the average precision (AP) given the recall and precision curves.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>recall</code></td><td><code>list</code></td><td>The recall curve.</td><td><em>required</em></td></tr><tr><td><code>precision</code></td><td><code>list</code></td><td>The precision curve.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>ap (float)</code></td><td>Average precision.</td></tr><tr><td><code>mpre (np.ndarray)</code></td><td>Precision envelope curve.</td></tr><tr><td><code>mrec (np.ndarray)</code></td><td>Modified recall curve with sentinel values added at the beginning and end.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L711-L740"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_ap</span><span class="p">(</span><span class="n">recall</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">precision</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Compute the average precision (AP) given the recall and precision curves.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        recall (list): The recall curve.</span>
<span></span><span class="sd">        precision (list): The precision curve.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        ap (float): Average precision.</span>
<span></span><span class="sd">        mpre (np.ndarray): Precision envelope curve.</span>
<span></span><span class="sd">        mrec (np.ndarray): Modified recall curve with sentinel values added at the beginning and end.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="c1"># Append sentinel values to beginning and end</span>
<span></span>    <span class="n">mrec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">recall</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]))</span>
<span></span>    <span class="n">mpre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="mf">1.0</span><span class="p">],</span> <span class="n">precision</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]))</span>
<span></span>
<span></span>    <span class="c1"># Compute the precision envelope</span>
<span></span>    <span class="n">mpre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">mpre</span><span class="p">)))</span>
<span></span>
<span></span>    <span class="c1"># Integrate area under curve</span>
<span></span>    <span class="n">method</span> <span class="o">=</span> <span class="s2">"interp"</span>  <span class="c1"># methods: 'continuous', 'interp'</span>
<span></span>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">"interp"</span><span class="p">:</span>
<span></span>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>  <span class="c1"># 101-point interp (COCO)</span>
<span></span>        <span class="n">func</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapezoid</span> <span class="k">if</span> <span class="n">checks</span><span class="o">.</span><span class="n">check_version</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span> <span class="s2">"&gt;=2.0"</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span>  <span class="c1"># np.trapz deprecated</span>
<span></span>        <span class="n">ap</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mrec</span><span class="p">,</span> <span class="n">mpre</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>  <span class="c1"># integrate</span>
<span></span>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># 'continuous'</span>
<span></span>        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mrec</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">mrec</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># points where x-axis (recall) changes</span>
<span></span>        <span class="n">ap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">mrec</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">mrec</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">mpre</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># area under curve</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="n">ap</span><span class="p">,</span> <span class="n">mpre</span><span class="p">,</span> <span class="n">mrec</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.utils.metrics.ap_per_class"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.utils.metrics.ap_per_class</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ap_per_class</span><span class="p">(</span>
<span></span>    <span class="n">tp</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">conf</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">pred_cls</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">target_cls</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">on_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(),</span>
<span></span>    <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
<span></span>    <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-16</span><span class="p">,</span>
<span></span>    <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span>
</code></pre></div><p>Compute the average precision per class for object detection evaluation.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>tp</code></td><td><code>np.ndarray</code></td><td>Binary array indicating whether the detection is correct (True) or not (False).</td><td><em>required</em></td></tr><tr><td><code>conf</code></td><td><code>np.ndarray</code></td><td>Array of confidence scores of the detections.</td><td><em>required</em></td></tr><tr><td><code>pred_cls</code></td><td><code>np.ndarray</code></td><td>Array of predicted classes of the detections.</td><td><em>required</em></td></tr><tr><td><code>target_cls</code></td><td><code>np.ndarray</code></td><td>Array of true classes of the detections.</td><td><em>required</em></td></tr><tr><td><code>plot</code></td><td><code>bool, optional</code></td><td>Whether to plot PR curves or not.</td><td><code>False</code></td></tr><tr><td><code>on_plot</code></td><td><code>callable, optional</code></td><td>A callback to pass plots path and data when they are rendered.</td><td><code>None</code></td></tr><tr><td><code>save_dir</code></td><td><code>Path, optional</code></td><td>Directory to save the PR curves.</td><td><code>Path()</code></td></tr><tr><td><code>names</code></td><td><code>dict[int, str], optional</code></td><td>Dictionary of class names to plot PR curves.</td><td><code>{}</code></td></tr><tr><td><code>eps</code></td><td><code>float, optional</code></td><td>A small value to avoid division by zero.</td><td><code>1e-16</code></td></tr><tr><td><code>prefix</code></td><td><code>str, optional</code></td><td>A prefix string for saving the plot files.</td><td><code>""</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>tp (np.ndarray)</code></td><td>True positive counts at threshold given by max F1 metric for each class.</td></tr><tr><td><code>fp (np.ndarray)</code></td><td>False positive counts at threshold given by max F1 metric for each class.</td></tr><tr><td><code>p (np.ndarray)</code></td><td>Precision values at threshold given by max F1 metric for each class.</td></tr><tr><td><code>r (np.ndarray)</code></td><td>Recall values at threshold given by max F1 metric for each class.</td></tr><tr><td><code>f1 (np.ndarray)</code></td><td>F1-score values at threshold given by max F1 metric for each class.</td></tr><tr><td><code>ap (np.ndarray)</code></td><td>Average precision for each class at different IoU thresholds.</td></tr><tr><td><code>unique_classes (np.ndarray)</code></td><td>An array of unique classes that have data.</td></tr><tr><td><code>p_curve (np.ndarray)</code></td><td>Precision curves for each class.</td></tr><tr><td><code>r_curve (np.ndarray)</code></td><td>Recall curves for each class.</td></tr><tr><td><code>f1_curve (np.ndarray)</code></td><td>F1-score curves for each class.</td></tr><tr><td><code>x (np.ndarray)</code></td><td>X-axis values for the curves.</td></tr><tr><td><code>prec_values (np.ndarray)</code></td><td>Precision values at mAP@0.5 for each class.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/utils/metrics.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/metrics.py#L743-L836"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ap_per_class</span><span class="p">(</span>
<span></span>    <span class="n">tp</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">conf</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">pred_cls</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">target_cls</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">on_plot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(),</span>
<span></span>    <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
<span></span>    <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-16</span><span class="p">,</span>
<span></span>    <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Compute the average precision per class for object detection evaluation.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        tp (np.ndarray): Binary array indicating whether the detection is correct (True) or not (False).</span>
<span></span><span class="sd">        conf (np.ndarray): Array of confidence scores of the detections.</span>
<span></span><span class="sd">        pred_cls (np.ndarray): Array of predicted classes of the detections.</span>
<span></span><span class="sd">        target_cls (np.ndarray): Array of true classes of the detections.</span>
<span></span><span class="sd">        plot (bool, optional): Whether to plot PR curves or not.</span>
<span></span><span class="sd">        on_plot (callable, optional): A callback to pass plots path and data when they are rendered.</span>
<span></span><span class="sd">        save_dir (Path, optional): Directory to save the PR curves.</span>
<span></span><span class="sd">        names (dict[int, str], optional): Dictionary of class names to plot PR curves.</span>
<span></span><span class="sd">        eps (float, optional): A small value to avoid division by zero.</span>
<span></span><span class="sd">        prefix (str, optional): A prefix string for saving the plot files.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        tp (np.ndarray): True positive counts at threshold given by max F1 metric for each class.</span>
<span></span><span class="sd">        fp (np.ndarray): False positive counts at threshold given by max F1 metric for each class.</span>
<span></span><span class="sd">        p (np.ndarray): Precision values at threshold given by max F1 metric for each class.</span>
<span></span><span class="sd">        r (np.ndarray): Recall values at threshold given by max F1 metric for each class.</span>
<span></span><span class="sd">        f1 (np.ndarray): F1-score values at threshold given by max F1 metric for each class.</span>
<span></span><span class="sd">        ap (np.ndarray): Average precision for each class at different IoU thresholds.</span>
<span></span><span class="sd">        unique_classes (np.ndarray): An array of unique classes that have data.</span>
<span></span><span class="sd">        p_curve (np.ndarray): Precision curves for each class.</span>
<span></span><span class="sd">        r_curve (np.ndarray): Recall curves for each class.</span>
<span></span><span class="sd">        f1_curve (np.ndarray): F1-score curves for each class.</span>
<span></span><span class="sd">        x (np.ndarray): X-axis values for the curves.</span>
<span></span><span class="sd">        prec_values (np.ndarray): Precision values at mAP@0.5 for each class.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="c1"># Sort by objectness</span>
<span></span>    <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">conf</span><span class="p">)</span>
<span></span>    <span class="n">tp</span><span class="p">,</span> <span class="n">conf</span><span class="p">,</span> <span class="n">pred_cls</span> <span class="o">=</span> <span class="n">tp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">conf</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pred_cls</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span></span>
<span></span>    <span class="c1"># Find unique classes</span>
<span></span>    <span class="n">unique_classes</span><span class="p">,</span> <span class="n">nt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">target_cls</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>    <span class="n">nc</span> <span class="o">=</span> <span class="n">unique_classes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># number of classes, number of detections</span>
<span></span>
<span></span>    <span class="c1"># Create Precision-Recall curve and compute AP for each class</span>
<span></span>    <span class="n">x</span><span class="p">,</span> <span class="n">prec_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="p">[]</span>
<span></span>
<span></span>    <span class="c1"># Average precision, precision and recall curves</span>
<span></span>    <span class="n">ap</span><span class="p">,</span> <span class="n">p_curve</span><span class="p">,</span> <span class="n">r_curve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nc</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nc</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nc</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span></span>    <span class="k">for</span> <span class="n">ci</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_classes</span><span class="p">):</span>
<span></span>        <span class="n">i</span> <span class="o">=</span> <span class="n">pred_cls</span> <span class="o">==</span> <span class="n">c</span>
<span></span>        <span class="n">n_l</span> <span class="o">=</span> <span class="n">nt</span><span class="p">[</span><span class="n">ci</span><span class="p">]</span>  <span class="c1"># number of labels</span>
<span></span>        <span class="n">n_p</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># number of predictions</span>
<span></span>        <span class="k">if</span> <span class="n">n_p</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n_l</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>            <span class="k">continue</span>
<span></span>
<span></span>        <span class="c1"># Accumulate FPs and TPs</span>
<span></span>        <span class="n">fpc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">tp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span></span>        <span class="n">tpc</span> <span class="o">=</span> <span class="n">tp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span></span>
<span></span>        <span class="c1"># Recall</span>
<span></span>        <span class="n">recall</span> <span class="o">=</span> <span class="n">tpc</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_l</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>  <span class="c1"># recall curve</span>
<span></span>        <span class="n">r_curve</span><span class="p">[</span><span class="n">ci</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">conf</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">recall</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># negative x, xp because xp decreases</span>
<span></span>
<span></span>        <span class="c1"># Precision</span>
<span></span>        <span class="n">precision</span> <span class="o">=</span> <span class="n">tpc</span> <span class="o">/</span> <span class="p">(</span><span class="n">tpc</span> <span class="o">+</span> <span class="n">fpc</span><span class="p">)</span>  <span class="c1"># precision curve</span>
<span></span>        <span class="n">p_curve</span><span class="p">[</span><span class="n">ci</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">conf</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">precision</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">left</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># p at pr_score</span>
<span></span>
<span></span>        <span class="c1"># AP from recall-precision curve</span>
<span></span>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<span></span>            <span class="n">ap</span><span class="p">[</span><span class="n">ci</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">mpre</span><span class="p">,</span> <span class="n">mrec</span> <span class="o">=</span> <span class="n">compute_ap</span><span class="p">(</span><span class="n">recall</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">precision</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])</span>
<span></span>            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>                <span class="n">prec_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mrec</span><span class="p">,</span> <span class="n">mpre</span><span class="p">))</span>  <span class="c1"># precision at mAP@0.5</span>
<span></span>
<span></span>    <span class="n">prec_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">prec_values</span><span class="p">)</span> <span class="k">if</span> <span class="n">prec_values</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>  <span class="c1"># (nc, 1000)</span>
<span></span>
<span></span>    <span class="c1"># Compute F1 (harmonic mean of precision and recall)</span>
<span></span>    <span class="n">f1_curve</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">p_curve</span> <span class="o">*</span> <span class="n">r_curve</span> <span class="o">/</span> <span class="p">(</span><span class="n">p_curve</span> <span class="o">+</span> <span class="n">r_curve</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>
<span></span>    <span class="n">names</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">names</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_classes</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">names</span><span class="p">}</span>  <span class="c1"># dict: only classes that have data</span>
<span></span>    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
<span></span>        <span class="n">plot_pr_curve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prec_values</span><span class="p">,</span> <span class="n">ap</span><span class="p">,</span> <span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">PR_curve.png"</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">on_plot</span><span class="o">=</span><span class="n">on_plot</span><span class="p">)</span>
<span></span>        <span class="n">plot_mc_curve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f1_curve</span><span class="p">,</span> <span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">F1_curve.png"</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">"F1"</span><span class="p">,</span> <span class="n">on_plot</span><span class="o">=</span><span class="n">on_plot</span><span class="p">)</span>
<span></span>        <span class="n">plot_mc_curve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p_curve</span><span class="p">,</span> <span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">P_curve.png"</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Precision"</span><span class="p">,</span> <span class="n">on_plot</span><span class="o">=</span><span class="n">on_plot</span><span class="p">)</span>
<span></span>        <span class="n">plot_mc_curve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">r_curve</span><span class="p">,</span> <span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">R_curve.png"</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Recall"</span><span class="p">,</span> <span class="n">on_plot</span><span class="o">=</span><span class="n">on_plot</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">i</span> <span class="o">=</span> <span class="n">smooth</span><span class="p">(</span><span class="n">f1_curve</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>  <span class="c1"># max F1 index</span>
<span></span>    <span class="n">p</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">p_curve</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">r_curve</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">f1_curve</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>  <span class="c1"># max-F1 precision, recall, F1 values</span>
<span></span>    <span class="n">tp</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">nt</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>  <span class="c1"># true positives</span>
<span></span>    <span class="n">fp</span> <span class="o">=</span> <span class="p">(</span><span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span> <span class="o">-</span> <span class="n">tp</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>  <span class="c1"># false positives</span>
<span></span>    <span class="k">return</span> <span class="n">tp</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">ap</span><span class="p">,</span> <span class="n">unique_classes</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">p_curve</span><span class="p">,</span> <span class="n">r_curve</span><span class="p">,</span> <span class="n">f1_curve</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">prec_values</span>
</code></pre></div></details><p><br/><br/></p><br/><br/><div class="git-info"><div class="dates-container"><span class="date-item" title="This page was first created on November 12, 2023"><span class="hover-item">ğŸ“…</span> Created 2 years ago </span><span class="date-item" title="This page was last updated on November 23, 2025"><span class="hover-item">âœï¸</span> Updated 8 days ago </span></div><div class="authors-container"><a class="author-link" href="https://github.com/glenn-jocher" title="glenn-jocher (9 changes)"><img alt="glenn-jocher" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/26833433?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/RizwanMunawar" title="RizwanMunawar (1 change)"><img alt="RizwanMunawar" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62513924?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/jk4e" title="jk4e (1 change)"><img alt="jk4e" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/116908874?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/Burhan-Q" title="Burhan-Q (1 change)"><img alt="Burhan-Q" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62214284?v=4&amp;s=96"/></a></div></div><div class="share-buttons"><button class="share-button hover-item" onclick="window.open('https://twitter.com/intent/tweet?url=https%3A%2F%2Fdocs.ultralytics.com%2Freference%2Futils%2Fmetrics%2F', 'TwitterShare', 'width=550,height=680,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-x-twitter"></i> Tweet </button><button class="share-button hover-item linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fdocs.ultralytics.com%2Freference%2Futils%2Fmetrics%2F', 'LinkedinShare', 'width=550,height=730,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-linkedin-in"></i> Share </button></div><br/></article></div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div><button class="md-top md-icon" data-md-component="top" hidden="" type="button"><svg class="lucide lucide-circle-arrow-up" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10"></circle><path d="m16 12-4-4-4 4M12 16V8"></path></svg> Back to top
</button></main><footer class="md-footer"><nav aria-label="Footer" class="md-footer__inner md-grid"><a aria-label="Previous: loss" class="md-footer__link md-footer__link--prev" href="../loss/"><div class="md-footer__button md-icon"><svg class="lucide lucide-arrow-left" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12 19-7-7 7-7M19 12H5"></path></svg></div><div class="md-footer__title"><span class="md-footer__direction"> Previous </span><div class="md-ellipsis"> loss </div></div></a><a aria-label="Next: nms" class="md-footer__link md-footer__link--next" href="../nms/"><div class="md-footer__title"><span class="md-footer__direction"> Next </span><div class="md-ellipsis"> nms </div></div><div class="md-footer__button md-icon"><svg class="lucide lucide-arrow-right" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 12h14M12 5l7 7-7 7"></path></svg></div></a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-copyright"><div class="md-copyright__highlight"><a href="https://www.ultralytics.com/" target="_blank">Â© 2025 Ultralytics Inc.</a> All rights reserved. </div> Made with <a href="https://zensical.org/" rel="noopener" target="_blank"> Zensical </a></div><div class="md-social"><a class="md-social__link" href="https://github.com/ultralytics" rel="noopener" target="_blank" title="github.com"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://www.linkedin.com/company/ultralytics/" rel="noopener" target="_blank" title="www.linkedin.com"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://x.com/ultralytics" rel="noopener" target="_blank" title="x.com"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://youtube.com/ultralytics?sub_confirmation=1" rel="noopener" target="_blank" title="youtube.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://hub.docker.com/r/ultralytics/ultralytics/" rel="noopener" target="_blank" title="hub.docker.com"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://pypi.org/project/ultralytics/" rel="noopener" target="_blank" title="pypi.org"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://discord.com/invite/ultralytics" rel="noopener" target="_blank" title="discord.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://reddit.com/r/ultralytics" rel="noopener" target="_blank" title="reddit.com"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://weixin.qq.com/r/mp/LxckPDfEgWr_rXNf90I9" rel="noopener" target="_blank" title="weixin.qq.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6" fill="currentColor"></path></svg></a></div></div></div></footer></div><div class="md-dialog" data-md-component="dialog"><div class="md-dialog__inner md-typeset"></div></div><div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"annotate":null,"base":"../../..","features":["content.action.edit","content.code.annotate","content.code.copy","content.tooltips","toc.follow","navigation.top","navigation.tabs","navigation.tabs.sticky","navigation.prune","navigation.footer","navigation.tracking","navigation.instant","navigation.instant.progress","navigation.indexes","navigation.sections","content.tabs.link"],"search":"../../../assets/javascripts/workers/search.5df7522c.min.js","tags":null,"translations":{"clipboard.copied":"Copied to clipboard","clipboard.copy":"Copy to clipboard","search.result.more.one":"1 more on this page","search.result.more.other":"# more on this page","search.result.none":"No matching documents","search.result.one":"1 matching document","search.result.other":"# matching documents","search.result.placeholder":"Type to start searching","search.result.term.missing":"Missing","select.version":"Select version"},"version":null}</script>
<script src="../../../assets/javascripts/bundle.21aa498e.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/ultralytics/llm@v0.1.2/js/chat.min.js"></script>
<script src="https://unpkg.com/tablesort@5.6.0/dist/tablesort.min.js"></script>
<script src="../../../javascript/extra.js"></script>
<script src="../../../javascript/giscus.js"></script>
<script src="../../../javascript/tablesort.js"></script>
</body></html>