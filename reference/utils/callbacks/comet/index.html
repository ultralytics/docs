<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Explore the integration of Comet callbacks in Ultralytics YOLO, enabling advanced logging and monitoring for your machine learning experiments." name="description"/>
<meta content="Ultralytics" name="author"/>
<link href="https://docs.ultralytics.com/reference/utils/callbacks/comet/" rel="canonical"/>
<link href="../clearml/" rel="prev"/>
<link href="../dvc/" rel="next"/>
<link href="https://raw.githubusercontent.com/ultralytics/assets/refs/heads/main/logo/favicon-yolo.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.16" name="generator"/>
<title>Reference for ultralytics/utils/callbacks/comet.py</title>
<link href="../../../../assets/stylesheets/main.7e37652d.min.css" rel="stylesheet"/>
<link href="../../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../../assets/_mkdocstrings.css" rel="stylesheet"/>
<link href="../../../../stylesheets/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2M5EHKC0BH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2M5EHKC0BH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2M5EHKC0BH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
<meta content="comet" name="title"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"/><meta content="Ultralytics, YOLO, Comet, callbacks, logging, machine learning, monitoring, integration" name="keywords"/><meta content="website" property="og:type"/><meta content="https://docs.ultralytics.com/reference/utils/callbacks/comet" property="og:url"/><meta content="comet" property="og:title"/><meta content="Explore the integration of Comet callbacks in Ultralytics YOLO, enabling advanced logging and monitoring for your machine learning experiments." property="og:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="og:image"/><meta content="summary_large_image" property="twitter:card"/><meta content="https://docs.ultralytics.com/reference/utils/callbacks/comet" property="twitter:url"/><meta content="comet" property="twitter:title"/><meta content="Explore the integration of Comet callbacks in Ultralytics YOLO, enabling advanced logging and monitoring for your machine learning experiments." property="twitter:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="twitter:image"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "headline": "comet", "image": ["https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png"], "datePublished": "2023-11-12 02:49:37 +0100", "dateModified": "2025-03-14 15:24:19 +0100", "author": [{"@type": "Organization", "name": "Ultralytics", "url": "https://ultralytics.com/"}], "abstract": "Explore the integration of Comet callbacks in Ultralytics YOLO, enabling advanced logging and monitoring for your machine learning experiments."}</script></head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#reference-for-ultralyticsutilscallbackscometpy">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
<aside class="md-banner">
<div class="md-banner__inner md-grid md-typeset">
<div class="banner-wrapper">
<div class="banner-content-wrapper" onclick="window.open('https://docs.ultralytics.com/models/yolo11/')">
<p>Introducing</p>
<img alt="Ultralytics YOLO11" height="40" loading="lazy" src="https://assets-global.website-files.com/646dd1f1a3703e451ba81ecc/67d044caa316aa50fba40a08_Ultralytics_YOLO11_Logotype_Reverse.svg"/>
</div>
</div>
</div>
</aside>
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Ultralytics YOLO Docs" class="md-header__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs">
<img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Ultralytics YOLO Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
              comet
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<div class="md-header__option">
<div class="md-select">
<button aria-label="Select language" class="md-header__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"></path></svg>
</button>
<div class="md-select__inner">
<ul class="md-select__list">
<li class="md-select__item">
<a class="md-select__link" href="/" hreflang="en">
              ğŸ‡¬ğŸ‡§ English
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/zh/" hreflang="zh">
              ğŸ‡¨ğŸ‡³ ç®€ä½“ä¸­æ–‡
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/ko/" hreflang="ko">
              ğŸ‡°ğŸ‡· í•œêµ­ì–´
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/ja/" hreflang="ja">
              ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/ru/" hreflang="ru">
              ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/de/" hreflang="de">
              ğŸ‡©ğŸ‡ª Deutsch
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/fr/" hreflang="fr">
              ğŸ‡«ğŸ‡· FranÃ§ais
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/es/" hreflang="es">
              ğŸ‡ªğŸ‡¸ EspaÃ±ol
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/pt/" hreflang="pt">
              ğŸ‡µğŸ‡¹ PortuguÃªs
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/it/" hreflang="it">
              ğŸ‡®ğŸ‡¹ Italiano
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/tr/" hreflang="tr">
              ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/vi/" hreflang="vi">
              ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="/ar/" hreflang="ar">
              ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
            </a>
</li>
</ul>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg>
</div>
<div class="md-source__repository">
    ultralytics/ultralytics
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../..">
  Home
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../quickstart/">
  Quickstart
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../modes/">
  Modes
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../tasks/">
  Tasks
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../models/">
  Models
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../datasets/">
  Datasets
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../solutions/">
  Solutions ğŸš€
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../guides/">
  Guides
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../integrations/">
  Integrations
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../hub/">
  HUB
        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../../../cfg/__init__/">
  Reference
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../help/">
  Help
        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Ultralytics YOLO Docs" class="md-nav__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs">
<img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/>
</a>
    Ultralytics YOLO Docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg>
</div>
<div class="md-source__repository">
    ultralytics/ultralytics
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../..">
<span class="md-ellipsis">
    Home
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../../quickstart/">
<span class="md-ellipsis">
    Quickstart
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../../modes/">
<span class="md-ellipsis">
    Modes
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../../tasks/">
<span class="md-ellipsis">
    Tasks
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../../models/">
<span class="md-ellipsis">
    Models
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../../datasets/">
<span class="md-ellipsis">
    Datasets
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../../solutions/">
<span class="md-ellipsis">
    Solutions ğŸš€
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../../guides/">
<span class="md-ellipsis">
    Guides
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../../integrations/">
<span class="md-ellipsis">
    Integrations
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../../hub/">
<span class="md-ellipsis">
    HUB
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_11" type="checkbox"/>
<label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="">
<span class="md-ellipsis">
    Reference
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_11_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_11">
<span class="md-nav__icon md-icon"></span>
            Reference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_1" id="__nav_11_1_label" tabindex="">
<span class="md-ellipsis">
    cfg
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_1">
<span class="md-nav__icon md-icon"></span>
            cfg
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../cfg/__init__/">
<span class="md-ellipsis">
    __init__
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex="">
<span class="md-ellipsis">
    data
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_2">
<span class="md-nav__icon md-icon"></span>
            data
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data/annotator/">
<span class="md-ellipsis">
    annotator
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data/augment/">
<span class="md-ellipsis">
    augment
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data/base/">
<span class="md-ellipsis">
    base
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data/build/">
<span class="md-ellipsis">
    build
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data/converter/">
<span class="md-ellipsis">
    converter
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data/dataset/">
<span class="md-ellipsis">
    dataset
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data/loaders/">
<span class="md-ellipsis">
    loaders
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data/split/">
<span class="md-ellipsis">
    split
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data/split_dota/">
<span class="md-ellipsis">
    split_dota
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data/utils/">
<span class="md-ellipsis">
    utils
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex="">
<span class="md-ellipsis">
    engine
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_3">
<span class="md-nav__icon md-icon"></span>
            engine
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../engine/exporter/">
<span class="md-ellipsis">
    exporter
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../engine/model/">
<span class="md-ellipsis">
    model
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../engine/predictor/">
<span class="md-ellipsis">
    predictor
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../engine/results/">
<span class="md-ellipsis">
    results
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../engine/trainer/">
<span class="md-ellipsis">
    trainer
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../engine/tuner/">
<span class="md-ellipsis">
    tuner
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../engine/validator/">
<span class="md-ellipsis">
    validator
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex="">
<span class="md-ellipsis">
    hub
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_4">
<span class="md-nav__icon md-icon"></span>
            hub
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../hub/__init__/">
<span class="md-ellipsis">
    __init__
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../hub/auth/">
<span class="md-ellipsis">
    auth
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../hub/google/__init__/">
<span class="md-ellipsis">
    google
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../hub/session/">
<span class="md-ellipsis">
    session
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../hub/utils/">
<span class="md-ellipsis">
    utils
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_5" id="__nav_11_5_label" tabindex="">
<span class="md-ellipsis">
    models
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_5">
<span class="md-nav__icon md-icon"></span>
            models
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../models/fastsam/model/">
<span class="md-ellipsis">
    fastsam
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../models/nas/model/">
<span class="md-ellipsis">
    nas
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../models/rtdetr/model/">
<span class="md-ellipsis">
    rtdetr
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../models/sam/amg/">
<span class="md-ellipsis">
    sam
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../models/utils/loss/">
<span class="md-ellipsis">
    utils
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../models/yolo/classify/predict/">
<span class="md-ellipsis">
    yolo
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_6" id="__nav_11_6_label" tabindex="">
<span class="md-ellipsis">
    nn
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_6">
<span class="md-nav__icon md-icon"></span>
            nn
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../nn/autobackend/">
<span class="md-ellipsis">
    autobackend
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../nn/modules/activation/">
<span class="md-ellipsis">
    modules
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../nn/tasks/">
<span class="md-ellipsis">
    tasks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../nn/text_model/">
<span class="md-ellipsis">
    text_model
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_7" id="__nav_11_7_label" tabindex="">
<span class="md-ellipsis">
    solutions
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_7">
<span class="md-nav__icon md-icon"></span>
            solutions
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/ai_gym/">
<span class="md-ellipsis">
    ai_gym
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/analytics/">
<span class="md-ellipsis">
    analytics
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/config/">
<span class="md-ellipsis">
    config
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/distance_calculation/">
<span class="md-ellipsis">
    distance_calculation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/heatmap/">
<span class="md-ellipsis">
    heatmap
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/instance_segmentation/">
<span class="md-ellipsis">
    instance_segmentation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/object_blurrer/">
<span class="md-ellipsis">
    object_blurrer
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/object_counter/">
<span class="md-ellipsis">
    object_counter
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/object_cropper/">
<span class="md-ellipsis">
    object_cropper
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/parking_management/">
<span class="md-ellipsis">
    parking_management
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/queue_management/">
<span class="md-ellipsis">
    queue_management
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/region_counter/">
<span class="md-ellipsis">
    region_counter
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/security_alarm/">
<span class="md-ellipsis">
    security_alarm
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/similarity_search/">
<span class="md-ellipsis">
    similarity_search
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/solutions/">
<span class="md-ellipsis">
    solutions
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/speed_estimation/">
<span class="md-ellipsis">
    speed_estimation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/streamlit_inference/">
<span class="md-ellipsis">
    streamlit_inference
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/trackzone/">
<span class="md-ellipsis">
    trackzone
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../solutions/vision_eye/">
<span class="md-ellipsis">
    vision_eye
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_8" id="__nav_11_8_label" tabindex="">
<span class="md-ellipsis">
    trackers
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_8_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_8">
<span class="md-nav__icon md-icon"></span>
            trackers
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../trackers/basetrack/">
<span class="md-ellipsis">
    basetrack
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../trackers/bot_sort/">
<span class="md-ellipsis">
    bot_sort
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../trackers/byte_tracker/">
<span class="md-ellipsis">
    byte_tracker
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../trackers/track/">
<span class="md-ellipsis">
    track
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../trackers/utils/gmc/">
<span class="md-ellipsis">
    utils
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_11_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_9" id="__nav_11_9_label" tabindex="">
<span class="md-ellipsis">
    utils
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_11_9_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_9">
<span class="md-nav__icon md-icon"></span>
            utils
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../__init__/">
<span class="md-ellipsis">
    __init__
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../autobatch/">
<span class="md-ellipsis">
    autobatch
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../autodevice/">
<span class="md-ellipsis">
    autodevice
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../benchmarks/">
<span class="md-ellipsis">
    benchmarks
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_11_9_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_9_5" id="__nav_11_9_5_label" tabindex="0">
<span class="md-ellipsis">
    callbacks
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_11_9_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_11_9_5">
<span class="md-nav__icon md-icon"></span>
            callbacks
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../base/">
<span class="md-ellipsis">
    base
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../clearml/">
<span class="md-ellipsis">
    clearml
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    comet
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    comet
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._get_comet_mode">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _get_comet_mode
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._get_comet_model_name">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _get_comet_model_name
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._get_eval_batch_logging_interval">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _get_eval_batch_logging_interval
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._get_max_image_predictions_to_log">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _get_max_image_predictions_to_log
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._scale_confidence_score">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _scale_confidence_score
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._should_log_confusion_matrix">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _should_log_confusion_matrix
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._should_log_image_predictions">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _should_log_image_predictions
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._resume_or_create_experiment">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _resume_or_create_experiment
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._fetch_trainer_metadata">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _fetch_trainer_metadata
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._scale_bounding_box_to_original_image_shape">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _scale_bounding_box_to_original_image_shape
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._format_ground_truth_annotations_for_detection">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _format_ground_truth_annotations_for_detection
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._format_prediction_annotations">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _format_prediction_annotations
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._extract_segmentation_annotation">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _extract_segmentation_annotation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._fetch_annotations">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _fetch_annotations
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._create_prediction_metadata_map">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _create_prediction_metadata_map
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_confusion_matrix">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_confusion_matrix
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_images">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_images
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_image_predictions">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_image_predictions
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_plots">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_plots
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_model">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_model
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_image_batches">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_image_batches
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_asset">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_asset
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_table">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_table
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet.on_pretrain_routine_start">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â on_pretrain_routine_start
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet.on_train_epoch_end">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â on_train_epoch_end
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet.on_fit_epoch_end">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â on_fit_epoch_end
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet.on_train_end">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â on_train_end
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dvc/">
<span class="md-ellipsis">
    dvc
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hub/">
<span class="md-ellipsis">
    hub
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../mlflow/">
<span class="md-ellipsis">
    mlflow
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../neptune/">
<span class="md-ellipsis">
    neptune
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../raytune/">
<span class="md-ellipsis">
    raytune
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tensorboard/">
<span class="md-ellipsis">
    tensorboard
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../wb/">
<span class="md-ellipsis">
    wb
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../checks/">
<span class="md-ellipsis">
    checks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dist/">
<span class="md-ellipsis">
    dist
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../downloads/">
<span class="md-ellipsis">
    downloads
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../errors/">
<span class="md-ellipsis">
    errors
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../export/">
<span class="md-ellipsis">
    export
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../files/">
<span class="md-ellipsis">
    files
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../instance/">
<span class="md-ellipsis">
    instance
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../loss/">
<span class="md-ellipsis">
    loss
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../metrics/">
<span class="md-ellipsis">
    metrics
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ops/">
<span class="md-ellipsis">
    ops
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../patches/">
<span class="md-ellipsis">
    patches
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../plotting/">
<span class="md-ellipsis">
    plotting
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tal/">
<span class="md-ellipsis">
    tal
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../torch_utils/">
<span class="md-ellipsis">
    torch_utils
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../triton/">
<span class="md-ellipsis">
    triton
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tuner/">
<span class="md-ellipsis">
    tuner
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../../help/">
<span class="md-ellipsis">
    Help
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._get_comet_mode">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _get_comet_mode
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._get_comet_model_name">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _get_comet_model_name
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._get_eval_batch_logging_interval">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _get_eval_batch_logging_interval
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._get_max_image_predictions_to_log">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _get_max_image_predictions_to_log
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._scale_confidence_score">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _scale_confidence_score
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._should_log_confusion_matrix">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _should_log_confusion_matrix
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._should_log_image_predictions">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _should_log_image_predictions
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._resume_or_create_experiment">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _resume_or_create_experiment
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._fetch_trainer_metadata">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _fetch_trainer_metadata
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._scale_bounding_box_to_original_image_shape">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _scale_bounding_box_to_original_image_shape
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._format_ground_truth_annotations_for_detection">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _format_ground_truth_annotations_for_detection
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._format_prediction_annotations">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _format_prediction_annotations
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._extract_segmentation_annotation">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _extract_segmentation_annotation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._fetch_annotations">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _fetch_annotations
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._create_prediction_metadata_map">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _create_prediction_metadata_map
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_confusion_matrix">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_confusion_matrix
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_images">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_images
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_image_predictions">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_image_predictions
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_plots">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_plots
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_model">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_model
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_image_batches">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_image_batches
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_asset">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_asset
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet._log_table">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â _log_table
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet.on_pretrain_routine_start">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â on_pretrain_routine_start
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet.on_train_epoch_end">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â on_train_epoch_end
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet.on_fit_epoch_end">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â on_fit_epoch_end
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.utils.callbacks.comet.on_train_end">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>Â on_train_end
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/ultralytics/ultralytics/tree/main/docs/en/reference/utils/callbacks/comet.md" rel="edit" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
</a><a class="md-content__button md-icon" href="javascript:void(0)" onclick="copyMarkdownForLLM(this); return false;" title="Copy page in Markdown format"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg></a>
<h1 id="reference-for-ultralyticsutilscallbackscometpy">Reference for <code>ultralytics/utils/callbacks/comet.py</code></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This file is available at <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/callbacks/comet.py">https://github.com/ultralytics/ultralytics/blob/main/ultralytics/utils/callbacks/comet.py</a>. If you spot a problem please help fix it by <a href="https://docs.ultralytics.com/help/contributing/">contributing</a> a <a href="https://github.com/ultralytics/ultralytics/edit/main/ultralytics/utils/callbacks/comet.py">Pull Request</a> ğŸ› ï¸. Thank you ğŸ™!</p>
</div>
<p><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._get_comet_mode">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._get_comet_mode</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_get_comet_mode</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Return the Comet mode from environment variables, defaulting to 'online'.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>42</span>
<span>43</span>
<span>44</span>
<span>45</span>
<span>46</span>
<span>47</span>
<span>48</span>
<span>49</span>
<span>50</span>
<span>51</span>
<span>52</span>
<span>53</span>
<span>54</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_get_comet_mode</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the Comet mode from environment variables, defaulting to 'online'."""</span>
<span></span>    <span class="n">comet_mode</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">"COMET_MODE"</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">comet_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<span></span>            <span class="s2">"The COMET_MODE environment variable is deprecated. "</span>
<span></span>            <span class="s2">"Please use COMET_START_ONLINE to set the Comet experiment mode. "</span>
<span></span>            <span class="s2">"To start an offline Comet experiment, use 'export COMET_START_ONLINE=0'. "</span>
<span></span>            <span class="s2">"If COMET_START_ONLINE is not set or is set to '1', an online Comet experiment will be created."</span>
<span></span>        <span class="p">)</span>
<span></span>        <span class="k">return</span> <span class="n">comet_mode</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="s2">"online"</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._get_comet_model_name">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._get_comet_model_name</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_get_comet_model_name</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Return the Comet model name from environment variable or default to 'Ultralytics'.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>57</span>
<span>58</span>
<span>59</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_get_comet_model_name</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the Comet model name from environment variable or default to 'Ultralytics'."""</span>
<span></span>    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">"COMET_MODEL_NAME"</span><span class="p">,</span> <span class="s2">"Ultralytics"</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._get_eval_batch_logging_interval">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._get_eval_batch_logging_interval</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_get_eval_batch_logging_interval</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Get the evaluation batch logging interval from environment variable or use default value 1.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>62</span>
<span>63</span>
<span>64</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_get_eval_batch_logging_interval</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Get the evaluation batch logging interval from environment variable or use default value 1."""</span>
<span></span>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">"COMET_EVAL_BATCH_LOGGING_INTERVAL"</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._get_max_image_predictions_to_log">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._get_max_image_predictions_to_log</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_get_max_image_predictions_to_log</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Get the maximum number of image predictions to log from environment variables.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>67</span>
<span>68</span>
<span>69</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_get_max_image_predictions_to_log</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Get the maximum number of image predictions to log from environment variables."""</span>
<span></span>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">"COMET_MAX_IMAGE_PREDICTIONS"</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._scale_confidence_score">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._scale_confidence_score</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_scale_confidence_score</span><span class="p">(</span><span class="n">score</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Scale the confidence score by a factor specified in environment variable.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>72</span>
<span>73</span>
<span>74</span>
<span>75</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_scale_confidence_score</span><span class="p">(</span><span class="n">score</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Scale the confidence score by a factor specified in environment variable."""</span>
<span></span>    <span class="n">scale</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">"COMET_MAX_CONFIDENCE_SCORE"</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">))</span>
<span></span>    <span class="k">return</span> <span class="n">score</span> <span class="o">*</span> <span class="n">scale</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._should_log_confusion_matrix">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._should_log_confusion_matrix</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_should_log_confusion_matrix</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Determine if the confusion matrix should be logged based on environment variable settings.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>78</span>
<span>79</span>
<span>80</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_should_log_confusion_matrix</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Determine if the confusion matrix should be logged based on environment variable settings."""</span>
<span></span>    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">"COMET_EVAL_LOG_CONFUSION_MATRIX"</span><span class="p">,</span> <span class="s2">"false"</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"true"</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._should_log_image_predictions">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._should_log_image_predictions</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_should_log_image_predictions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Determine whether to log image predictions based on environment variable.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>83</span>
<span>84</span>
<span>85</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_should_log_image_predictions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Determine whether to log image predictions based on environment variable."""</span>
<span></span>    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">"COMET_EVAL_LOG_IMAGE_PREDICTIONS"</span><span class="p">,</span> <span class="s2">"true"</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"true"</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._resume_or_create_experiment">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._resume_or_create_experiment</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_resume_or_create_experiment</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="n">SimpleNamespace</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Resume CometML experiment or create a new experiment based on args.</p>
<p>Ensures that the experiment object is only created in a single process during distributed training.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>args</code>
</td>
<td>
<code><span title="types.SimpleNamespace">SimpleNamespace</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Training arguments containing project configuration and other parameters.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span> 88</span>
<span> 89</span>
<span> 90</span>
<span> 91</span>
<span> 92</span>
<span> 93</span>
<span> 94</span>
<span> 95</span>
<span> 96</span>
<span> 97</span>
<span> 98</span>
<span> 99</span>
<span>100</span>
<span>101</span>
<span>102</span>
<span>103</span>
<span>104</span>
<span>105</span>
<span>106</span>
<span>107</span>
<span>108</span>
<span>109</span>
<span>110</span>
<span>111</span>
<span>112</span>
<span>113</span>
<span>114</span>
<span>115</span>
<span>116</span>
<span>117</span>
<span>118</span>
<span>119</span>
<span>120</span>
<span>121</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_resume_or_create_experiment</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="n">SimpleNamespace</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Resume CometML experiment or create a new experiment based on args.</span>
<span></span>
<span></span><span class="sd">    Ensures that the experiment object is only created in a single process during distributed training.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        args (SimpleNamespace): Training arguments containing project configuration and other parameters.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="n">RANK</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">}:</span>
<span></span>        <span class="k">return</span>
<span></span>
<span></span>    <span class="c1"># Set environment variable (if not set by the user) to configure the Comet experiment's online mode under the hood.</span>
<span></span>    <span class="c1"># IF COMET_START_ONLINE is set by the user it will override COMET_MODE value.</span>
<span></span>    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">"COMET_START_ONLINE"</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="n">comet_mode</span> <span class="o">=</span> <span class="n">_get_comet_mode</span><span class="p">()</span>
<span></span>        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">"COMET_START_ONLINE"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"1"</span> <span class="k">if</span> <span class="n">comet_mode</span> <span class="o">!=</span> <span class="s2">"offline"</span> <span class="k">else</span> <span class="s2">"0"</span>
<span></span>
<span></span>    <span class="k">try</span><span class="p">:</span>
<span></span>        <span class="n">_project_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">"COMET_PROJECT_NAME"</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">project</span><span class="p">)</span>
<span></span>        <span class="n">experiment</span> <span class="o">=</span> <span class="n">comet_ml</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">project_name</span><span class="o">=</span><span class="n">_project_name</span><span class="p">)</span>
<span></span>        <span class="n">experiment</span><span class="o">.</span><span class="n">log_parameters</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
<span></span>        <span class="n">experiment</span><span class="o">.</span><span class="n">log_others</span><span class="p">(</span>
<span></span>            <span class="p">{</span>
<span></span>                <span class="s2">"eval_batch_logging_interval"</span><span class="p">:</span> <span class="n">_get_eval_batch_logging_interval</span><span class="p">(),</span>
<span></span>                <span class="s2">"log_confusion_matrix_on_eval"</span><span class="p">:</span> <span class="n">_should_log_confusion_matrix</span><span class="p">(),</span>
<span></span>                <span class="s2">"log_image_predictions"</span><span class="p">:</span> <span class="n">_should_log_image_predictions</span><span class="p">(),</span>
<span></span>                <span class="s2">"max_image_predictions"</span><span class="p">:</span> <span class="n">_get_max_image_predictions_to_log</span><span class="p">(),</span>
<span></span>            <span class="p">}</span>
<span></span>        <span class="p">)</span>
<span></span>        <span class="n">experiment</span><span class="o">.</span><span class="n">log_other</span><span class="p">(</span><span class="s2">"Created from"</span><span class="p">,</span> <span class="s2">"ultralytics"</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Comet installed but not initialized correctly, not logging this run. </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._fetch_trainer_metadata">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._fetch_trainer_metadata</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_fetch_trainer_metadata</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Return metadata for YOLO training including epoch and asset saving status.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>trainer</code>
</td>
<td>
<code><a class="autorefs autorefs-internal" href="../../../engine/trainer/#ultralytics.engine.trainer.BaseTrainer" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-class"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-class-name"&gt;ultralytics.engine.trainer.BaseTrainer&lt;/span&gt;'>BaseTrainer</a></code>
</td>
<td>
<div class="doc-md-description">
<p>The YOLO trainer object containing training state and config.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Dictionary containing current epoch, step, save assets flag, and final epoch flag.</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>124</span>
<span>125</span>
<span>126</span>
<span>127</span>
<span>128</span>
<span>129</span>
<span>130</span>
<span>131</span>
<span>132</span>
<span>133</span>
<span>134</span>
<span>135</span>
<span>136</span>
<span>137</span>
<span>138</span>
<span>139</span>
<span>140</span>
<span>141</span>
<span>142</span>
<span>143</span>
<span>144</span>
<span>145</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_fetch_trainer_metadata</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Return metadata for YOLO training including epoch and asset saving status.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        trainer (ultralytics.engine.trainer.BaseTrainer): The YOLO trainer object containing training state and config.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): Dictionary containing current epoch, step, save assets flag, and final epoch flag.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">curr_epoch</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span>
<span></span>
<span></span>    <span class="n">train_num_steps_per_epoch</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">train_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span> <span class="o">//</span> <span class="n">trainer</span><span class="o">.</span><span class="n">batch_size</span>
<span></span>    <span class="n">curr_step</span> <span class="o">=</span> <span class="n">curr_epoch</span> <span class="o">*</span> <span class="n">train_num_steps_per_epoch</span>
<span></span>    <span class="n">final_epoch</span> <span class="o">=</span> <span class="n">curr_epoch</span> <span class="o">==</span> <span class="n">trainer</span><span class="o">.</span><span class="n">epochs</span>
<span></span>
<span></span>    <span class="n">save</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">save</span>
<span></span>    <span class="n">save_period</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">save_period</span>
<span></span>    <span class="n">save_interval</span> <span class="o">=</span> <span class="n">curr_epoch</span> <span class="o">%</span> <span class="n">save_period</span> <span class="o">==</span> <span class="mi">0</span>
<span></span>    <span class="n">save_assets</span> <span class="o">=</span> <span class="n">save</span> <span class="ow">and</span> <span class="n">save_period</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">save_interval</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">final_epoch</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">curr_epoch</span><span class="o">=</span><span class="n">curr_epoch</span><span class="p">,</span> <span class="n">curr_step</span><span class="o">=</span><span class="n">curr_step</span><span class="p">,</span> <span class="n">save_assets</span><span class="o">=</span><span class="n">save_assets</span><span class="p">,</span> <span class="n">final_epoch</span><span class="o">=</span><span class="n">final_epoch</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._scale_bounding_box_to_original_image_shape">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._scale_bounding_box_to_original_image_shape</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_scale_bounding_box_to_original_image_shape</span><span class="p">(</span>
<span></span>    <span class="n">box</span><span class="p">,</span> <span class="n">resized_image_shape</span><span class="p">,</span> <span class="n">original_image_shape</span><span class="p">,</span> <span class="n">ratio_pad</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Scale bounding box from resized image coordinates to original image coordinates.</p>
<p>YOLO resizes images during training and the label values are normalized based on this resized shape.
This function rescales the bounding box labels to the original image shape.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>box</code>
</td>
<td>
<code><span title="torch.Tensor">Tensor</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Bounding box in normalized xywh format.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>resized_image_shape</code>
</td>
<td>
<code><span title="tuple">tuple</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Shape of the resized image (height, width).</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>original_image_shape</code>
</td>
<td>
<code><span title="tuple">tuple</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Shape of the original image (height, width).</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>ratio_pad</code>
</td>
<td>
<code><span title="tuple">tuple</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Ratio and padding information for scaling.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="typing.List">List</span>[<span title="float">float</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>Scaled bounding box coordinates in xywh format with top-left corner adjustment.</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>148</span>
<span>149</span>
<span>150</span>
<span>151</span>
<span>152</span>
<span>153</span>
<span>154</span>
<span>155</span>
<span>156</span>
<span>157</span>
<span>158</span>
<span>159</span>
<span>160</span>
<span>161</span>
<span>162</span>
<span>163</span>
<span>164</span>
<span>165</span>
<span>166</span>
<span>167</span>
<span>168</span>
<span>169</span>
<span>170</span>
<span>171</span>
<span>172</span>
<span>173</span>
<span>174</span>
<span>175</span>
<span>176</span>
<span>177</span>
<span>178</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_scale_bounding_box_to_original_image_shape</span><span class="p">(</span>
<span></span>    <span class="n">box</span><span class="p">,</span> <span class="n">resized_image_shape</span><span class="p">,</span> <span class="n">original_image_shape</span><span class="p">,</span> <span class="n">ratio_pad</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Scale bounding box from resized image coordinates to original image coordinates.</span>
<span></span>
<span></span><span class="sd">    YOLO resizes images during training and the label values are normalized based on this resized shape.</span>
<span></span><span class="sd">    This function rescales the bounding box labels to the original image shape.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        box (torch.Tensor): Bounding box in normalized xywh format.</span>
<span></span><span class="sd">        resized_image_shape (tuple): Shape of the resized image (height, width).</span>
<span></span><span class="sd">        original_image_shape (tuple): Shape of the original image (height, width).</span>
<span></span><span class="sd">        ratio_pad (tuple): Ratio and padding information for scaling.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (List[float]): Scaled bounding box coordinates in xywh format with top-left corner adjustment.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">resized_image_height</span><span class="p">,</span> <span class="n">resized_image_width</span> <span class="o">=</span> <span class="n">resized_image_shape</span>
<span></span>
<span></span>    <span class="c1"># Convert normalized xywh format predictions to xyxy in resized scale format</span>
<span></span>    <span class="n">box</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">xywhn2xyxy</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">resized_image_height</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">resized_image_width</span><span class="p">)</span>
<span></span>    <span class="c1"># Scale box predictions from resized image scale back to original image scale</span>
<span></span>    <span class="n">box</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">scale_boxes</span><span class="p">(</span><span class="n">resized_image_shape</span><span class="p">,</span> <span class="n">box</span><span class="p">,</span> <span class="n">original_image_shape</span><span class="p">,</span> <span class="n">ratio_pad</span><span class="p">)</span>
<span></span>    <span class="c1"># Convert bounding box format from xyxy to xywh for Comet logging</span>
<span></span>    <span class="n">box</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">xyxy2xywh</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
<span></span>    <span class="c1"># Adjust xy center to correspond top-left corner</span>
<span></span>    <span class="n">box</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">box</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">/</span> <span class="mi">2</span>
<span></span>    <span class="n">box</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="n">box</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._format_ground_truth_annotations_for_detection">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._format_ground_truth_annotations_for_detection</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_format_ground_truth_annotations_for_detection</span><span class="p">(</span>
<span></span>    <span class="n">img_idx</span><span class="p">,</span> <span class="n">image_path</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">class_name_map</span><span class="o">=</span><span class="kc">None</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Format ground truth annotations for object detection.</p>
<p>This function processes ground truth annotations from a batch of images for object detection tasks. It extracts
bounding boxes, class labels, and other metadata for a specific image in the batch, and formats them for
visualization or evaluation.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>img_idx</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Index of the image in the batch to process.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>image_path</code>
</td>
<td>
<code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Path to the image file.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>batch</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Batch dictionary containing detection data with keys:
- 'batch_idx': Tensor of batch indices
- 'bboxes': Tensor of bounding boxes in normalized xywh format
- 'cls': Tensor of class labels
- 'ori_shape': Original image shapes
- 'resized_shape': Resized image shapes
- 'ratio_pad': Ratio and padding information</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>class_name_map</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Mapping from class indices to class names.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="dict">dict</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>Formatted ground truth annotations with the following structure:
- 'boxes': List of box coordinates [x, y, width, height]
- 'label': Label string with format "gt_{class_name}"
- 'score': Confidence score (always 1.0, scaled by _scale_confidence_score)</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>Returns None if no bounding boxes are found for the image.</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>181</span>
<span>182</span>
<span>183</span>
<span>184</span>
<span>185</span>
<span>186</span>
<span>187</span>
<span>188</span>
<span>189</span>
<span>190</span>
<span>191</span>
<span>192</span>
<span>193</span>
<span>194</span>
<span>195</span>
<span>196</span>
<span>197</span>
<span>198</span>
<span>199</span>
<span>200</span>
<span>201</span>
<span>202</span>
<span>203</span>
<span>204</span>
<span>205</span>
<span>206</span>
<span>207</span>
<span>208</span>
<span>209</span>
<span>210</span>
<span>211</span>
<span>212</span>
<span>213</span>
<span>214</span>
<span>215</span>
<span>216</span>
<span>217</span>
<span>218</span>
<span>219</span>
<span>220</span>
<span>221</span>
<span>222</span>
<span>223</span>
<span>224</span>
<span>225</span>
<span>226</span>
<span>227</span>
<span>228</span>
<span>229</span>
<span>230</span>
<span>231</span>
<span>232</span>
<span>233</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_format_ground_truth_annotations_for_detection</span><span class="p">(</span><span class="n">img_idx</span><span class="p">,</span> <span class="n">image_path</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">class_name_map</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Format ground truth annotations for object detection.</span>
<span></span>
<span></span><span class="sd">    This function processes ground truth annotations from a batch of images for object detection tasks. It extracts</span>
<span></span><span class="sd">    bounding boxes, class labels, and other metadata for a specific image in the batch, and formats them for</span>
<span></span><span class="sd">    visualization or evaluation.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        img_idx (int): Index of the image in the batch to process.</span>
<span></span><span class="sd">        image_path (str | Path): Path to the image file.</span>
<span></span><span class="sd">        batch (dict): Batch dictionary containing detection data with keys:</span>
<span></span><span class="sd">            - 'batch_idx': Tensor of batch indices</span>
<span></span><span class="sd">            - 'bboxes': Tensor of bounding boxes in normalized xywh format</span>
<span></span><span class="sd">            - 'cls': Tensor of class labels</span>
<span></span><span class="sd">            - 'ori_shape': Original image shapes</span>
<span></span><span class="sd">            - 'resized_shape': Resized image shapes</span>
<span></span><span class="sd">            - 'ratio_pad': Ratio and padding information</span>
<span></span><span class="sd">        class_name_map (dict, optional): Mapping from class indices to class names.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict | None): Formatted ground truth annotations with the following structure:</span>
<span></span><span class="sd">            - 'boxes': List of box coordinates [x, y, width, height]</span>
<span></span><span class="sd">            - 'label': Label string with format "gt_{class_name}"</span>
<span></span><span class="sd">            - 'score': Confidence score (always 1.0, scaled by _scale_confidence_score)</span>
<span></span><span class="sd">        Returns None if no bounding boxes are found for the image.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">indices</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s2">"batch_idx"</span><span class="p">]</span> <span class="o">==</span> <span class="n">img_idx</span>
<span></span>    <span class="n">bboxes</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">][</span><span class="n">indices</span><span class="p">]</span>
<span></span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bboxes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Comet Image: </span><span class="si">{</span><span class="n">image_path</span><span class="si">}</span><span class="s2"> has no bounding boxes labels"</span><span class="p">)</span>
<span></span>        <span class="k">return</span> <span class="kc">None</span>
<span></span>
<span></span>    <span class="n">cls_labels</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">][</span><span class="n">indices</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span></span>    <span class="k">if</span> <span class="n">class_name_map</span><span class="p">:</span>
<span></span>        <span class="n">cls_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">class_name_map</span><span class="p">[</span><span class="n">label</span><span class="p">])</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">cls_labels</span><span class="p">]</span>
<span></span>
<span></span>    <span class="n">original_image_shape</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s2">"ori_shape"</span><span class="p">][</span><span class="n">img_idx</span><span class="p">]</span>
<span></span>    <span class="n">resized_image_shape</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s2">"resized_shape"</span><span class="p">][</span><span class="n">img_idx</span><span class="p">]</span>
<span></span>    <span class="n">ratio_pad</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s2">"ratio_pad"</span><span class="p">][</span><span class="n">img_idx</span><span class="p">]</span>
<span></span>
<span></span>    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>    <span class="k">for</span> <span class="n">box</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bboxes</span><span class="p">,</span> <span class="n">cls_labels</span><span class="p">):</span>
<span></span>        <span class="n">box</span> <span class="o">=</span> <span class="n">_scale_bounding_box_to_original_image_shape</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">resized_image_shape</span><span class="p">,</span> <span class="n">original_image_shape</span><span class="p">,</span> <span class="n">ratio_pad</span><span class="p">)</span>
<span></span>        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<span></span>            <span class="p">{</span>
<span></span>                <span class="s2">"boxes"</span><span class="p">:</span> <span class="p">[</span><span class="n">box</span><span class="p">],</span>
<span></span>                <span class="s2">"label"</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"gt_</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
<span></span>                <span class="s2">"score"</span><span class="p">:</span> <span class="n">_scale_confidence_score</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>
<span></span>            <span class="p">}</span>
<span></span>        <span class="p">)</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"ground_truth"</span><span class="p">,</span> <span class="s2">"data"</span><span class="p">:</span> <span class="n">data</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._format_prediction_annotations">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._format_prediction_annotations</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_format_prediction_annotations</span><span class="p">(</span>
<span></span>    <span class="n">image_path</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">class_label_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">class_map</span><span class="o">=</span><span class="kc">None</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Format YOLO predictions for object detection visualization.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>image_path</code>
</td>
<td>
<code><span title="pathlib.Path">Path</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Path to the image file.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>metadata</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Prediction metadata containing bounding boxes and class information.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>class_label_map</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Mapping from class indices to class names.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>class_map</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Additional class mapping for label conversion.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="dict">dict</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>Formatted prediction annotations or None if no predictions exist.</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>236</span>
<span>237</span>
<span>238</span>
<span>239</span>
<span>240</span>
<span>241</span>
<span>242</span>
<span>243</span>
<span>244</span>
<span>245</span>
<span>246</span>
<span>247</span>
<span>248</span>
<span>249</span>
<span>250</span>
<span>251</span>
<span>252</span>
<span>253</span>
<span>254</span>
<span>255</span>
<span>256</span>
<span>257</span>
<span>258</span>
<span>259</span>
<span>260</span>
<span>261</span>
<span>262</span>
<span>263</span>
<span>264</span>
<span>265</span>
<span>266</span>
<span>267</span>
<span>268</span>
<span>269</span>
<span>270</span>
<span>271</span>
<span>272</span>
<span>273</span>
<span>274</span>
<span>275</span>
<span>276</span>
<span>277</span>
<span>278</span>
<span>279</span>
<span>280</span>
<span>281</span>
<span>282</span>
<span>283</span>
<span>284</span>
<span>285</span>
<span>286</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_format_prediction_annotations</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">class_label_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">class_map</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Format YOLO predictions for object detection visualization.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        image_path (Path): Path to the image file.</span>
<span></span><span class="sd">        metadata (dict): Prediction metadata containing bounding boxes and class information.</span>
<span></span><span class="sd">        class_label_map (dict, optional): Mapping from class indices to class names.</span>
<span></span><span class="sd">        class_map (dict, optional): Additional class mapping for label conversion.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict | None): Formatted prediction annotations or None if no predictions exist.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">stem</span> <span class="o">=</span> <span class="n">image_path</span><span class="o">.</span><span class="n">stem</span>
<span></span>    <span class="n">image_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">stem</span><span class="p">)</span> <span class="k">if</span> <span class="n">stem</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="k">else</span> <span class="n">stem</span>
<span></span>
<span></span>    <span class="n">predictions</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image_id</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">predictions</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Comet Image: </span><span class="si">{</span><span class="n">image_path</span><span class="si">}</span><span class="s2"> has no bounding boxes predictions"</span><span class="p">)</span>
<span></span>        <span class="k">return</span> <span class="kc">None</span>
<span></span>
<span></span>    <span class="c1"># apply the mapping that was used to map the predicted classes when the JSON was created</span>
<span></span>    <span class="k">if</span> <span class="n">class_label_map</span> <span class="ow">and</span> <span class="n">class_map</span><span class="p">:</span>
<span></span>        <span class="n">class_label_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">class_map</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">class_label_map</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span></span>    <span class="k">try</span><span class="p">:</span>
<span></span>        <span class="c1"># import pycotools utilities to decompress annotations for various tasks, e.g. segmentation</span>
<span></span>        <span class="kn">from</span><span class="w"> </span><span class="nn">faster_coco_eval.core.mask</span><span class="w"> </span><span class="kn">import</span> <span class="n">decode</span>  <span class="c1"># noqa</span>
<span></span>    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<span></span>        <span class="n">decode</span> <span class="o">=</span> <span class="kc">None</span>
<span></span>
<span></span>    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>    <span class="k">for</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">predictions</span><span class="p">:</span>
<span></span>        <span class="n">boxes</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[</span><span class="s2">"bbox"</span><span class="p">]</span>
<span></span>        <span class="n">score</span> <span class="o">=</span> <span class="n">_scale_confidence_score</span><span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="s2">"score"</span><span class="p">])</span>
<span></span>        <span class="n">cls_label</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[</span><span class="s2">"category_id"</span><span class="p">]</span>
<span></span>        <span class="k">if</span> <span class="n">class_label_map</span><span class="p">:</span>
<span></span>            <span class="n">cls_label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">class_label_map</span><span class="p">[</span><span class="n">cls_label</span><span class="p">])</span>
<span></span>
<span></span>        <span class="n">annotation_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"boxes"</span><span class="p">:</span> <span class="p">[</span><span class="n">boxes</span><span class="p">],</span> <span class="s2">"label"</span><span class="p">:</span> <span class="n">cls_label</span><span class="p">,</span> <span class="s2">"score"</span><span class="p">:</span> <span class="n">score</span><span class="p">}</span>
<span></span>
<span></span>        <span class="k">if</span> <span class="n">decode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>            <span class="c1"># do segmentation processing only if we are able to decode it</span>
<span></span>            <span class="n">segments</span> <span class="o">=</span> <span class="n">prediction</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"segmentation"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span></span>            <span class="k">if</span> <span class="n">segments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>                <span class="n">segments</span> <span class="o">=</span> <span class="n">_extract_segmentation_annotation</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">decode</span><span class="p">)</span>
<span></span>            <span class="k">if</span> <span class="n">segments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>                <span class="n">annotation_data</span><span class="p">[</span><span class="s2">"points"</span><span class="p">]</span> <span class="o">=</span> <span class="n">segments</span>
<span></span>
<span></span>        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">annotation_data</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"prediction"</span><span class="p">,</span> <span class="s2">"data"</span><span class="p">:</span> <span class="n">data</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._extract_segmentation_annotation">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._extract_segmentation_annotation</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_extract_segmentation_annotation</span><span class="p">(</span>
<span></span>    <span class="n">segmentation_raw</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">decode</span><span class="p">:</span> <span class="n">Callable</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]]</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Extract segmentation annotation from compressed segmentations as list of polygons.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>segmentation_raw</code>
</td>
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Raw segmentation data in compressed format.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>decode</code>
</td>
<td>
<code><span title="collections.abc.Callable">Callable</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Function to decode the compressed segmentation data.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="typing.Any">Any</span>]] | None</code>
</td>
<td>
<div class="doc-md-description">
<p>List of polygon points or None if extraction fails.</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>289</span>
<span>290</span>
<span>291</span>
<span>292</span>
<span>293</span>
<span>294</span>
<span>295</span>
<span>296</span>
<span>297</span>
<span>298</span>
<span>299</span>
<span>300</span>
<span>301</span>
<span>302</span>
<span>303</span>
<span>304</span>
<span>305</span>
<span>306</span>
<span>307</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_extract_segmentation_annotation</span><span class="p">(</span><span class="n">segmentation_raw</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">decode</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]]:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Extract segmentation annotation from compressed segmentations as list of polygons.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        segmentation_raw (str): Raw segmentation data in compressed format.</span>
<span></span><span class="sd">        decode (Callable): Function to decode the compressed segmentation data.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (List[List[Any]] | None): List of polygon points or None if extraction fails.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">try</span><span class="p">:</span>
<span></span>        <span class="n">mask</span> <span class="o">=</span> <span class="n">decode</span><span class="p">(</span><span class="n">segmentation_raw</span><span class="p">)</span>
<span></span>        <span class="n">contours</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_LIST</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_SIMPLE</span><span class="p">)</span>
<span></span>        <span class="n">annotations</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span> <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">]</span>
<span></span>        <span class="k">return</span> <span class="p">[</span><span class="n">annotation</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">]</span>
<span></span>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Comet Failed to extract segmentation annotation: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._fetch_annotations">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._fetch_annotations</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_fetch_annotations</span><span class="p">(</span>
<span></span>    <span class="n">img_idx</span><span class="p">,</span>
<span></span>    <span class="n">image_path</span><span class="p">,</span>
<span></span>    <span class="n">batch</span><span class="p">,</span>
<span></span>    <span class="n">prediction_metadata_map</span><span class="p">,</span>
<span></span>    <span class="n">class_label_map</span><span class="p">,</span>
<span></span>    <span class="n">class_map</span><span class="p">,</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">]</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Join the ground truth and prediction annotations if they exist.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>img_idx</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Index of the image in the batch.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>image_path</code>
</td>
<td>
<code><span title="pathlib.Path">Path</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Path to the image file.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>batch</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Batch data containing ground truth annotations.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>prediction_metadata_map</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Map of prediction metadata by image ID.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>class_label_map</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Mapping from class indices to class names.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>class_map</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Additional class mapping for label conversion.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="typing.List">List</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>List of annotation dictionaries or None if no annotations exist.</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>310</span>
<span>311</span>
<span>312</span>
<span>313</span>
<span>314</span>
<span>315</span>
<span>316</span>
<span>317</span>
<span>318</span>
<span>319</span>
<span>320</span>
<span>321</span>
<span>322</span>
<span>323</span>
<span>324</span>
<span>325</span>
<span>326</span>
<span>327</span>
<span>328</span>
<span>329</span>
<span>330</span>
<span>331</span>
<span>332</span>
<span>333</span>
<span>334</span>
<span>335</span>
<span>336</span>
<span>337</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_fetch_annotations</span><span class="p">(</span>
<span></span>    <span class="n">img_idx</span><span class="p">,</span> <span class="n">image_path</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">prediction_metadata_map</span><span class="p">,</span> <span class="n">class_label_map</span><span class="p">,</span> <span class="n">class_map</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Join the ground truth and prediction annotations if they exist.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        img_idx (int): Index of the image in the batch.</span>
<span></span><span class="sd">        image_path (Path): Path to the image file.</span>
<span></span><span class="sd">        batch (dict): Batch data containing ground truth annotations.</span>
<span></span><span class="sd">        prediction_metadata_map (dict): Map of prediction metadata by image ID.</span>
<span></span><span class="sd">        class_label_map (dict): Mapping from class indices to class names.</span>
<span></span><span class="sd">        class_map (dict): Additional class mapping for label conversion.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (List | None): List of annotation dictionaries or None if no annotations exist.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">ground_truth_annotations</span> <span class="o">=</span> <span class="n">_format_ground_truth_annotations_for_detection</span><span class="p">(</span>
<span></span>        <span class="n">img_idx</span><span class="p">,</span> <span class="n">image_path</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">class_label_map</span>
<span></span>    <span class="p">)</span>
<span></span>    <span class="n">prediction_annotations</span> <span class="o">=</span> <span class="n">_format_prediction_annotations</span><span class="p">(</span>
<span></span>        <span class="n">image_path</span><span class="p">,</span> <span class="n">prediction_metadata_map</span><span class="p">,</span> <span class="n">class_label_map</span><span class="p">,</span> <span class="n">class_map</span>
<span></span>    <span class="p">)</span>
<span></span>
<span></span>    <span class="n">annotations</span> <span class="o">=</span> <span class="p">[</span>
<span></span>        <span class="n">annotation</span> <span class="k">for</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ground_truth_annotations</span><span class="p">,</span> <span class="n">prediction_annotations</span><span class="p">]</span> <span class="k">if</span> <span class="n">annotation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span></span>    <span class="p">]</span>
<span></span>    <span class="k">return</span> <span class="p">[</span><span class="n">annotations</span><span class="p">]</span> <span class="k">if</span> <span class="n">annotations</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._create_prediction_metadata_map">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._create_prediction_metadata_map</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_create_prediction_metadata_map</span><span class="p">(</span><span class="n">model_predictions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Create metadata map for model predictions by grouping them based on image ID.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>340</span>
<span>341</span>
<span>342</span>
<span>343</span>
<span>344</span>
<span>345</span>
<span>346</span>
<span>347</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_create_prediction_metadata_map</span><span class="p">(</span><span class="n">model_predictions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Create metadata map for model predictions by grouping them based on image ID."""</span>
<span></span>    <span class="n">pred_metadata_map</span> <span class="o">=</span> <span class="p">{}</span>
<span></span>    <span class="k">for</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">model_predictions</span><span class="p">:</span>
<span></span>        <span class="n">pred_metadata_map</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="s2">"image_id"</span><span class="p">],</span> <span class="p">[])</span>
<span></span>        <span class="n">pred_metadata_map</span><span class="p">[</span><span class="n">prediction</span><span class="p">[</span><span class="s2">"image_id"</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="n">pred_metadata_map</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._log_confusion_matrix">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._log_confusion_matrix</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_log_confusion_matrix</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">curr_step</span><span class="p">,</span> <span class="n">curr_epoch</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Log the confusion matrix to Comet experiment.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>350</span>
<span>351</span>
<span>352</span>
<span>353</span>
<span>354</span>
<span>355</span>
<span>356</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_log_confusion_matrix</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">curr_step</span><span class="p">,</span> <span class="n">curr_epoch</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Log the confusion matrix to Comet experiment."""</span>
<span></span>    <span class="n">conf_mat</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">validator</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="o">.</span><span class="n">matrix</span>
<span></span>    <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">"names"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="p">[</span><span class="s2">"background"</span><span class="p">]</span>
<span></span>    <span class="n">experiment</span><span class="o">.</span><span class="n">log_confusion_matrix</span><span class="p">(</span>
<span></span>        <span class="n">matrix</span><span class="o">=</span><span class="n">conf_mat</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">max_categories</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">),</span> <span class="n">epoch</span><span class="o">=</span><span class="n">curr_epoch</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">curr_step</span>
<span></span>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._log_images">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._log_images</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_log_images</span><span class="p">(</span>
<span></span>    <span class="n">experiment</span><span class="p">,</span> <span class="n">image_paths</span><span class="p">,</span> <span class="n">curr_step</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">annotations</span><span class="o">=</span><span class="kc">None</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Log images to the experiment with optional annotations.</p>
<p>This function logs images to a Comet ML experiment, optionally including annotation data for visualization
such as bounding boxes or segmentation masks.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>experiment</code>
</td>
<td>
<code><span title="comet_ml.CometExperiment">CometExperiment</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The Comet ML experiment to log images to.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>image_paths</code>
</td>
<td>
<code><span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>List of paths to images that will be logged.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>curr_step</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Current training step/iteration for tracking in the experiment timeline.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>annotations</code>
</td>
<td>
<code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="dict">dict</span>]]</code>
</td>
<td>
<div class="doc-md-description">
<p>Nested list of annotation dictionaries for each image. Each
annotation contains visualization data like bounding boxes, labels, and confidence scores.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>359</span>
<span>360</span>
<span>361</span>
<span>362</span>
<span>363</span>
<span>364</span>
<span>365</span>
<span>366</span>
<span>367</span>
<span>368</span>
<span>369</span>
<span>370</span>
<span>371</span>
<span>372</span>
<span>373</span>
<span>374</span>
<span>375</span>
<span>376</span>
<span>377</span>
<span>378</span>
<span>379</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_log_images</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">image_paths</span><span class="p">,</span> <span class="n">curr_step</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">annotations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Log images to the experiment with optional annotations.</span>
<span></span>
<span></span><span class="sd">    This function logs images to a Comet ML experiment, optionally including annotation data for visualization</span>
<span></span><span class="sd">    such as bounding boxes or segmentation masks.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        experiment (comet_ml.CometExperiment): The Comet ML experiment to log images to.</span>
<span></span><span class="sd">        image_paths (List[Path]): List of paths to images that will be logged.</span>
<span></span><span class="sd">        curr_step (int): Current training step/iteration for tracking in the experiment timeline.</span>
<span></span><span class="sd">        annotations (List[List[dict]], optional): Nested list of annotation dictionaries for each image. Each</span>
<span></span><span class="sd">            annotation contains visualization data like bounding boxes, labels, and confidence scores.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="n">annotations</span><span class="p">:</span>
<span></span>        <span class="k">for</span> <span class="n">image_path</span><span class="p">,</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">image_paths</span><span class="p">,</span> <span class="n">annotations</span><span class="p">):</span>
<span></span>            <span class="n">experiment</span><span class="o">.</span><span class="n">log_image</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">image_path</span><span class="o">.</span><span class="n">stem</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">curr_step</span><span class="p">,</span> <span class="n">annotations</span><span class="o">=</span><span class="n">annotation</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="k">for</span> <span class="n">image_path</span> <span class="ow">in</span> <span class="n">image_paths</span><span class="p">:</span>
<span></span>            <span class="n">experiment</span><span class="o">.</span><span class="n">log_image</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">image_path</span><span class="o">.</span><span class="n">stem</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">curr_step</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._log_image_predictions">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._log_image_predictions</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_log_image_predictions</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">validator</span><span class="p">,</span> <span class="n">curr_step</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Log predicted boxes for a single image during training.</p>
<p>This function logs image predictions to a Comet ML experiment during model validation. It processes
validation data and formats both ground truth and prediction annotations for visualization in the Comet
dashboard. The function respects configured limits on the number of images to log.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>experiment</code>
</td>
<td>
<code><span title="comet_ml.CometExperiment">CometExperiment</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The Comet ML experiment to log to.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>validator</code>
</td>
<td>
<code><span title="BaseValidator">BaseValidator</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The validator instance containing validation data and predictions.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>curr_step</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The current training step for logging timeline.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<details class="notes" open="">
<summary>Notes</summary>
<p>This function uses global state to track the number of logged predictions across calls.
It only logs predictions for supported tasks defined in COMET_SUPPORTED_TASKS.
The number of logged images is limited by the COMET_MAX_IMAGE_PREDICTIONS environment variable.</p>
</details>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>382</span>
<span>383</span>
<span>384</span>
<span>385</span>
<span>386</span>
<span>387</span>
<span>388</span>
<span>389</span>
<span>390</span>
<span>391</span>
<span>392</span>
<span>393</span>
<span>394</span>
<span>395</span>
<span>396</span>
<span>397</span>
<span>398</span>
<span>399</span>
<span>400</span>
<span>401</span>
<span>402</span>
<span>403</span>
<span>404</span>
<span>405</span>
<span>406</span>
<span>407</span>
<span>408</span>
<span>409</span>
<span>410</span>
<span>411</span>
<span>412</span>
<span>413</span>
<span>414</span>
<span>415</span>
<span>416</span>
<span>417</span>
<span>418</span>
<span>419</span>
<span>420</span>
<span>421</span>
<span>422</span>
<span>423</span>
<span>424</span>
<span>425</span>
<span>426</span>
<span>427</span>
<span>428</span>
<span>429</span>
<span>430</span>
<span>431</span>
<span>432</span>
<span>433</span>
<span>434</span>
<span>435</span>
<span>436</span>
<span>437</span>
<span>438</span>
<span>439</span>
<span>440</span>
<span>441</span>
<span>442</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_log_image_predictions</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">validator</span><span class="p">,</span> <span class="n">curr_step</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Log predicted boxes for a single image during training.</span>
<span></span>
<span></span><span class="sd">    This function logs image predictions to a Comet ML experiment during model validation. It processes</span>
<span></span><span class="sd">    validation data and formats both ground truth and prediction annotations for visualization in the Comet</span>
<span></span><span class="sd">    dashboard. The function respects configured limits on the number of images to log.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        experiment (comet_ml.CometExperiment): The Comet ML experiment to log to.</span>
<span></span><span class="sd">        validator (BaseValidator): The validator instance containing validation data and predictions.</span>
<span></span><span class="sd">        curr_step (int): The current training step for logging timeline.</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        This function uses global state to track the number of logged predictions across calls.</span>
<span></span><span class="sd">        It only logs predictions for supported tasks defined in COMET_SUPPORTED_TASKS.</span>
<span></span><span class="sd">        The number of logged images is limited by the COMET_MAX_IMAGE_PREDICTIONS environment variable.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">global</span> <span class="n">_comet_image_prediction_count</span>
<span></span>
<span></span>    <span class="n">task</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">task</span>
<span></span>    <span class="k">if</span> <span class="n">task</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">COMET_SUPPORTED_TASKS</span><span class="p">:</span>
<span></span>        <span class="k">return</span>
<span></span>
<span></span>    <span class="n">jdict</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="n">jdict</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">jdict</span><span class="p">:</span>
<span></span>        <span class="k">return</span>
<span></span>
<span></span>    <span class="n">predictions_metadata_map</span> <span class="o">=</span> <span class="n">_create_prediction_metadata_map</span><span class="p">(</span><span class="n">jdict</span><span class="p">)</span>
<span></span>    <span class="n">dataloader</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="n">dataloader</span>
<span></span>    <span class="n">class_label_map</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="n">names</span>
<span></span>    <span class="n">class_map</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">validator</span><span class="p">,</span> <span class="s2">"class_map"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">batch_logging_interval</span> <span class="o">=</span> <span class="n">_get_eval_batch_logging_interval</span><span class="p">()</span>
<span></span>    <span class="n">max_image_predictions</span> <span class="o">=</span> <span class="n">_get_max_image_predictions_to_log</span><span class="p">()</span>
<span></span>
<span></span>    <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataloader</span><span class="p">):</span>
<span></span>        <span class="k">if</span> <span class="p">(</span><span class="n">batch_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">batch_logging_interval</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span></span>            <span class="k">continue</span>
<span></span>
<span></span>        <span class="n">image_paths</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s2">"im_file"</span><span class="p">]</span>
<span></span>        <span class="k">for</span> <span class="n">img_idx</span><span class="p">,</span> <span class="n">image_path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">image_paths</span><span class="p">):</span>
<span></span>            <span class="k">if</span> <span class="n">_comet_image_prediction_count</span> <span class="o">&gt;=</span> <span class="n">max_image_predictions</span><span class="p">:</span>
<span></span>                <span class="k">return</span>
<span></span>
<span></span>            <span class="n">image_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
<span></span>            <span class="n">annotations</span> <span class="o">=</span> <span class="n">_fetch_annotations</span><span class="p">(</span>
<span></span>                <span class="n">img_idx</span><span class="p">,</span>
<span></span>                <span class="n">image_path</span><span class="p">,</span>
<span></span>                <span class="n">batch</span><span class="p">,</span>
<span></span>                <span class="n">predictions_metadata_map</span><span class="p">,</span>
<span></span>                <span class="n">class_label_map</span><span class="p">,</span>
<span></span>                <span class="n">class_map</span><span class="o">=</span><span class="n">class_map</span><span class="p">,</span>
<span></span>            <span class="p">)</span>
<span></span>            <span class="n">_log_images</span><span class="p">(</span>
<span></span>                <span class="n">experiment</span><span class="p">,</span>
<span></span>                <span class="p">[</span><span class="n">image_path</span><span class="p">],</span>
<span></span>                <span class="n">curr_step</span><span class="p">,</span>
<span></span>                <span class="n">annotations</span><span class="o">=</span><span class="n">annotations</span><span class="p">,</span>
<span></span>            <span class="p">)</span>
<span></span>            <span class="n">_comet_image_prediction_count</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._log_plots">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._log_plots</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_log_plots</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Log evaluation plots and label plots for the experiment.</p>
<p>This function logs various evaluation plots and confusion matrices to the experiment tracking system. It handles
different types of metrics (SegmentMetrics, PoseMetrics, DetMetrics, OBBMetrics) and logs the appropriate plots
for each type.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>experiment</code>
</td>
<td>
<code><span title="comet_ml.CometExperiment">CometExperiment</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The Comet ML experiment to log plots to.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>trainer</code>
</td>
<td>
<code><a class="autorefs autorefs-internal" href="../../../engine/trainer/#ultralytics.engine.trainer.BaseTrainer" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-class"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-class-name"&gt;ultralytics.engine.trainer.BaseTrainer&lt;/span&gt;'>BaseTrainer</a></code>
</td>
<td>
<div class="doc-md-description">
<p>The trainer object containing validation metrics and save
directory information.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.utils.callbacks.comet</span><span class="w"> </span><span class="kn">import</span> <span class="n">_log_plots</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">_log_plots</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>445</span>
<span>446</span>
<span>447</span>
<span>448</span>
<span>449</span>
<span>450</span>
<span>451</span>
<span>452</span>
<span>453</span>
<span>454</span>
<span>455</span>
<span>456</span>
<span>457</span>
<span>458</span>
<span>459</span>
<span>460</span>
<span>461</span>
<span>462</span>
<span>463</span>
<span>464</span>
<span>465</span>
<span>466</span>
<span>467</span>
<span>468</span>
<span>469</span>
<span>470</span>
<span>471</span>
<span>472</span>
<span>473</span>
<span>474</span>
<span>475</span>
<span>476</span>
<span>477</span>
<span>478</span>
<span>479</span>
<span>480</span>
<span>481</span>
<span>482</span>
<span>483</span>
<span>484</span>
<span>485</span>
<span>486</span>
<span>487</span>
<span>488</span>
<span>489</span>
<span>490</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_log_plots</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Log evaluation plots and label plots for the experiment.</span>
<span></span>
<span></span><span class="sd">    This function logs various evaluation plots and confusion matrices to the experiment tracking system. It handles</span>
<span></span><span class="sd">    different types of metrics (SegmentMetrics, PoseMetrics, DetMetrics, OBBMetrics) and logs the appropriate plots</span>
<span></span><span class="sd">    for each type.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        experiment (comet_ml.CometExperiment): The Comet ML experiment to log plots to.</span>
<span></span><span class="sd">        trainer (ultralytics.engine.trainer.BaseTrainer): The trainer object containing validation metrics and save</span>
<span></span><span class="sd">            directory information.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics.utils.callbacks.comet import _log_plots</span>
<span></span><span class="sd">        &gt;&gt;&gt; _log_plots(experiment, trainer)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">plot_filenames</span> <span class="o">=</span> <span class="kc">None</span>
<span></span>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">validator</span><span class="o">.</span><span class="n">metrics</span><span class="p">,</span> <span class="n">SegmentMetrics</span><span class="p">):</span>
<span></span>        <span class="n">plot_filenames</span> <span class="o">=</span> <span class="p">[</span>
<span></span>            <span class="n">trainer</span><span class="o">.</span><span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">plots</span><span class="si">}</span><span class="s2">.png"</span>
<span></span>            <span class="k">for</span> <span class="n">plots</span> <span class="ow">in</span> <span class="n">EVALUATION_PLOT_NAMES</span>
<span></span>            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">SEGMENT_METRICS_PLOT_PREFIX</span>
<span></span>        <span class="p">]</span>
<span></span>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">validator</span><span class="o">.</span><span class="n">metrics</span><span class="p">,</span> <span class="n">PoseMetrics</span><span class="p">):</span>
<span></span>        <span class="n">plot_filenames</span> <span class="o">=</span> <span class="p">[</span>
<span></span>            <span class="n">trainer</span><span class="o">.</span><span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">plots</span><span class="si">}</span><span class="s2">.png"</span>
<span></span>            <span class="k">for</span> <span class="n">plots</span> <span class="ow">in</span> <span class="n">EVALUATION_PLOT_NAMES</span>
<span></span>            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">POSE_METRICS_PLOT_PREFIX</span>
<span></span>        <span class="p">]</span>
<span></span>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">validator</span><span class="o">.</span><span class="n">metrics</span><span class="p">,</span> <span class="p">(</span><span class="n">DetMetrics</span><span class="p">,</span> <span class="n">OBBMetrics</span><span class="p">)):</span>
<span></span>        <span class="n">plot_filenames</span> <span class="o">=</span> <span class="p">[</span>
<span></span>            <span class="n">trainer</span><span class="o">.</span><span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">plots</span><span class="si">}</span><span class="s2">.png"</span>
<span></span>            <span class="k">for</span> <span class="n">plots</span> <span class="ow">in</span> <span class="n">EVALUATION_PLOT_NAMES</span>
<span></span>            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">DETECTION_METRICS_PLOT_PREFIX</span>
<span></span>        <span class="p">]</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="n">plot_filenames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="n">_log_images</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">plot_filenames</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">confusion_matrix_filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">trainer</span><span class="o">.</span><span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">plots</span><span class="si">}</span><span class="s2">.png"</span> <span class="k">for</span> <span class="n">plots</span> <span class="ow">in</span> <span class="n">CONFUSION_MATRIX_PLOT_NAMES</span><span class="p">]</span>
<span></span>    <span class="n">_log_images</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">confusion_matrix_filenames</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">validator</span><span class="o">.</span><span class="n">metrics</span><span class="p">,</span> <span class="n">ClassifyMetrics</span><span class="p">):</span>
<span></span>        <span class="n">label_plot_filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">trainer</span><span class="o">.</span><span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">labels</span><span class="si">}</span><span class="s2">.jpg"</span> <span class="k">for</span> <span class="n">labels</span> <span class="ow">in</span> <span class="n">LABEL_PLOT_NAMES</span><span class="p">]</span>
<span></span>        <span class="n">_log_images</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">label_plot_filenames</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._log_model">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._log_model</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_log_model</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Log the best-trained model to Comet.ml.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>493</span>
<span>494</span>
<span>495</span>
<span>496</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_log_model</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Log the best-trained model to Comet.ml."""</span>
<span></span>    <span class="n">model_name</span> <span class="o">=</span> <span class="n">_get_comet_model_name</span><span class="p">()</span>
<span></span>    <span class="n">experiment</span><span class="o">.</span><span class="n">log_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">file_or_folder</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">best</span><span class="p">),</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"best.pt"</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._log_image_batches">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._log_image_batches</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_log_image_batches</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">curr_step</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Log samples of image batches for train, validation, and test.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>499</span>
<span>500</span>
<span>501</span>
<span>502</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_log_image_batches</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">curr_step</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Log samples of image batches for train, validation, and test."""</span>
<span></span>    <span class="n">_log_images</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="o">.</span><span class="n">save_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">"train_batch*.jpg"</span><span class="p">),</span> <span class="n">curr_step</span><span class="p">)</span>
<span></span>    <span class="n">_log_images</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="o">.</span><span class="n">save_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">"val_batch*.jpg"</span><span class="p">),</span> <span class="n">curr_step</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._log_asset">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._log_asset</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_log_asset</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">asset_path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Logs a specific asset file to the given experiment.</p>
<p>This function facilitates logging an asset, such as a file, to the provided
experiment. It enables integration with experiment tracking platforms.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>experiment</code>
</td>
<td>
<code><span title="comet_ml.CometExperiment">CometExperiment</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The experiment instance to which the asset will be logged.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>asset_path</code>
</td>
<td>
<code><span title="pathlib.Path">Path</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The file path of the asset to log.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>505</span>
<span>506</span>
<span>507</span>
<span>508</span>
<span>509</span>
<span>510</span>
<span>511</span>
<span>512</span>
<span>513</span>
<span>514</span>
<span>515</span>
<span>516</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_log_asset</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">asset_path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Logs a specific asset file to the given experiment.</span>
<span></span>
<span></span><span class="sd">    This function facilitates logging an asset, such as a file, to the provided</span>
<span></span><span class="sd">    experiment. It enables integration with experiment tracking platforms.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        experiment (comet_ml.CometExperiment): The experiment instance to which the asset will be logged.</span>
<span></span><span class="sd">        asset_path (Path): The file path of the asset to log.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">experiment</span><span class="o">.</span><span class="n">log_asset</span><span class="p">(</span><span class="n">asset_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet._log_table">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet._log_table</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">_log_table</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">table_path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Logs a table to the provided experiment.</p>
<p>This function is used to log a table file to the given experiment. The table
is identified by its file path.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>experiment</code>
</td>
<td>
<code><span title="comet_ml.CometExperiment">CometExperiment</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The experiment object where the table file will be logged.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>table_path</code>
</td>
<td>
<code><span title="pathlib.Path">Path</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The file path of the table to be logged.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>519</span>
<span>520</span>
<span>521</span>
<span>522</span>
<span>523</span>
<span>524</span>
<span>525</span>
<span>526</span>
<span>527</span>
<span>528</span>
<span>529</span>
<span>530</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_log_table</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">table_path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Logs a table to the provided experiment.</span>
<span></span>
<span></span><span class="sd">    This function is used to log a table file to the given experiment. The table</span>
<span></span><span class="sd">    is identified by its file path.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        experiment (comet_ml.CometExperiment): The experiment object where the table file will be logged.</span>
<span></span><span class="sd">        table_path (Path): The file path of the table to be logged.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">experiment</span><span class="o">.</span><span class="n">log_table</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">table_path</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet.on_pretrain_routine_start">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet.on_pretrain_routine_start</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">on_pretrain_routine_start</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Create or resume a CometML experiment at the start of a YOLO pre-training routine.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>533</span>
<span>534</span>
<span>535</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">on_pretrain_routine_start</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Create or resume a CometML experiment at the start of a YOLO pre-training routine."""</span>
<span></span>    <span class="n">_resume_or_create_experiment</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet.on_train_epoch_end">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet.on_train_epoch_end</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">on_train_epoch_end</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Log metrics and save batch images at the end of training epochs.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>538</span>
<span>539</span>
<span>540</span>
<span>541</span>
<span>542</span>
<span>543</span>
<span>544</span>
<span>545</span>
<span>546</span>
<span>547</span>
<span>548</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">on_train_epoch_end</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Log metrics and save batch images at the end of training epochs."""</span>
<span></span>    <span class="n">experiment</span> <span class="o">=</span> <span class="n">comet_ml</span><span class="o">.</span><span class="n">get_running_experiment</span><span class="p">()</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">experiment</span><span class="p">:</span>
<span></span>        <span class="k">return</span>
<span></span>
<span></span>    <span class="n">metadata</span> <span class="o">=</span> <span class="n">_fetch_trainer_metadata</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span>
<span></span>    <span class="n">curr_epoch</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">"curr_epoch"</span><span class="p">]</span>
<span></span>    <span class="n">curr_step</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">"curr_step"</span><span class="p">]</span>
<span></span>
<span></span>    <span class="n">experiment</span><span class="o">.</span><span class="n">log_metrics</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">label_loss_items</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">tloss</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">"train"</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="n">curr_step</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="n">curr_epoch</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet.on_fit_epoch_end">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet.on_fit_epoch_end</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">on_fit_epoch_end</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Log model assets at the end of each epoch during training.</p>
<p>This function is called at the end of each training epoch to log metrics, learning rates, and model information
to a Comet ML experiment. It also logs model assets, confusion matrices, and image predictions based on
configuration settings.</p>
<p>The function retrieves the current Comet ML experiment and logs various training metrics. If it's the first epoch,
it also logs model information. On specified save intervals, it logs the model, confusion matrix (if enabled),
and image predictions (if enabled).</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>trainer</code>
</td>
<td>
<code><span title="BaseTrainer">BaseTrainer</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The YOLO trainer object containing training state, metrics, and configuration.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Inside a training loop</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_fit_epoch_end</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span>  <span class="c1"># Log metrics and assets to Comet ML</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>551</span>
<span>552</span>
<span>553</span>
<span>554</span>
<span>555</span>
<span>556</span>
<span>557</span>
<span>558</span>
<span>559</span>
<span>560</span>
<span>561</span>
<span>562</span>
<span>563</span>
<span>564</span>
<span>565</span>
<span>566</span>
<span>567</span>
<span>568</span>
<span>569</span>
<span>570</span>
<span>571</span>
<span>572</span>
<span>573</span>
<span>574</span>
<span>575</span>
<span>576</span>
<span>577</span>
<span>578</span>
<span>579</span>
<span>580</span>
<span>581</span>
<span>582</span>
<span>583</span>
<span>584</span>
<span>585</span>
<span>586</span>
<span>587</span>
<span>588</span>
<span>589</span>
<span>590</span>
<span>591</span>
<span>592</span>
<span>593</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">on_fit_epoch_end</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Log model assets at the end of each epoch during training.</span>
<span></span>
<span></span><span class="sd">    This function is called at the end of each training epoch to log metrics, learning rates, and model information</span>
<span></span><span class="sd">    to a Comet ML experiment. It also logs model assets, confusion matrices, and image predictions based on</span>
<span></span><span class="sd">    configuration settings.</span>
<span></span>
<span></span><span class="sd">    The function retrieves the current Comet ML experiment and logs various training metrics. If it's the first epoch,</span>
<span></span><span class="sd">    it also logs model information. On specified save intervals, it logs the model, confusion matrix (if enabled),</span>
<span></span><span class="sd">    and image predictions (if enabled).</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        trainer (BaseTrainer): The YOLO trainer object containing training state, metrics, and configuration.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; # Inside a training loop</span>
<span></span><span class="sd">        &gt;&gt;&gt; on_fit_epoch_end(trainer)  # Log metrics and assets to Comet ML</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">experiment</span> <span class="o">=</span> <span class="n">comet_ml</span><span class="o">.</span><span class="n">get_running_experiment</span><span class="p">()</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">experiment</span><span class="p">:</span>
<span></span>        <span class="k">return</span>
<span></span>
<span></span>    <span class="n">metadata</span> <span class="o">=</span> <span class="n">_fetch_trainer_metadata</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span>
<span></span>    <span class="n">curr_epoch</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">"curr_epoch"</span><span class="p">]</span>
<span></span>    <span class="n">curr_step</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">"curr_step"</span><span class="p">]</span>
<span></span>    <span class="n">save_assets</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">"save_assets"</span><span class="p">]</span>
<span></span>
<span></span>    <span class="n">experiment</span><span class="o">.</span><span class="n">log_metrics</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">metrics</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">curr_step</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="n">curr_epoch</span><span class="p">)</span>
<span></span>    <span class="n">experiment</span><span class="o">.</span><span class="n">log_metrics</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">curr_step</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="n">curr_epoch</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">curr_epoch</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span></span>        <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.utils.torch_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">model_info_for_loggers</span>
<span></span>
<span></span>        <span class="n">experiment</span><span class="o">.</span><span class="n">log_metrics</span><span class="p">(</span><span class="n">model_info_for_loggers</span><span class="p">(</span><span class="n">trainer</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="n">curr_step</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="n">curr_epoch</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">save_assets</span><span class="p">:</span>
<span></span>        <span class="k">return</span>
<span></span>
<span></span>    <span class="n">_log_model</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">_should_log_confusion_matrix</span><span class="p">():</span>
<span></span>        <span class="n">_log_confusion_matrix</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">curr_step</span><span class="p">,</span> <span class="n">curr_epoch</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">_should_log_image_predictions</span><span class="p">():</span>
<span></span>        <span class="n">_log_image_predictions</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="o">.</span><span class="n">validator</span><span class="p">,</span> <span class="n">curr_step</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.utils.callbacks.comet.on_train_end">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.utils.callbacks.comet.on_train_end</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">on_train_end</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Perform operations at the end of training.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/utils/callbacks/comet.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>596</span>
<span>597</span>
<span>598</span>
<span>599</span>
<span>600</span>
<span>601</span>
<span>602</span>
<span>603</span>
<span>604</span>
<span>605</span>
<span>606</span>
<span>607</span>
<span>608</span>
<span>609</span>
<span>610</span>
<span>611</span>
<span>612</span>
<span>613</span>
<span>614</span>
<span>615</span>
<span>616</span>
<span>617</span>
<span>618</span>
<span>619</span>
<span>620</span>
<span>621</span>
<span>622</span>
<span>623</span>
<span>624</span>
<span>625</span>
<span>626</span>
<span>627</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">on_train_end</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Perform operations at the end of training."""</span>
<span></span>    <span class="n">experiment</span> <span class="o">=</span> <span class="n">comet_ml</span><span class="o">.</span><span class="n">get_running_experiment</span><span class="p">()</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">experiment</span><span class="p">:</span>
<span></span>        <span class="k">return</span>
<span></span>
<span></span>    <span class="n">metadata</span> <span class="o">=</span> <span class="n">_fetch_trainer_metadata</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span>
<span></span>    <span class="n">curr_epoch</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">"curr_epoch"</span><span class="p">]</span>
<span></span>    <span class="n">curr_step</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">"curr_step"</span><span class="p">]</span>
<span></span>    <span class="n">plots</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">plots</span>
<span></span>
<span></span>    <span class="n">_log_model</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">plots</span><span class="p">:</span>
<span></span>        <span class="n">_log_plots</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">_log_confusion_matrix</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">curr_step</span><span class="p">,</span> <span class="n">curr_epoch</span><span class="p">)</span>
<span></span>    <span class="n">_log_image_predictions</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="o">.</span><span class="n">validator</span><span class="p">,</span> <span class="n">curr_step</span><span class="p">)</span>
<span></span>    <span class="n">_log_image_batches</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">curr_step</span><span class="p">)</span>
<span></span>    <span class="c1"># log results table</span>
<span></span>    <span class="n">table_path</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">save_dir</span> <span class="o">/</span> <span class="n">RESULTS_TABLE_NAME</span>
<span></span>    <span class="k">if</span> <span class="n">table_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<span></span>        <span class="n">_log_table</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">table_path</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># log arguments YAML</span>
<span></span>    <span class="n">args_path</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">save_dir</span> <span class="o">/</span> <span class="n">ARGS_YAML_NAME</span>
<span></span>    <span class="k">if</span> <span class="n">args_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<span></span>        <span class="n">_log_asset</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">args_path</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">experiment</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
<span></span>
<span></span>    <span class="k">global</span> <span class="n">_comet_image_prediction_count</span>
<span></span>    <span class="n">_comet_image_prediction_count</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/></p>
<br/><br/>
<div class="git-info">
<div class="dates-container">
<span class="date-item" title="This page was first created on November 12, 2023">
<span class="hover-item">ğŸ“…</span> Created 1 year ago
    </span>
<span class="date-item" title="This page was last updated on March 14, 2025">
<span class="hover-item">âœï¸</span> Updated 4 months ago
    </span>
</div>
<div class="authors-container">
<a class="author-link" href="https://github.com/glenn-jocher" title="glenn-jocher (7 changes)">
<img alt="glenn-jocher" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/26833433?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/UltralyticsAssistant" title="UltralyticsAssistant (1 change)">
<img alt="UltralyticsAssistant" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/135830346?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/jk4e" title="jk4e (1 change)">
<img alt="jk4e" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/116908874?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/Burhan-Q" title="Burhan-Q (1 change)">
<img alt="Burhan-Q" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62214284?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/Laughing-q" title="Laughing-q (1 change)">
<img alt="Laughing-q" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/61612323?v=4&amp;s=96"/>
</a>
</div></div><div class="share-buttons">
<button class="share-button hover-item" onclick="window.open('https://twitter.com/intent/tweet?url=https://docs.ultralytics.com/reference/utils/callbacks/comet', 'TwitterShare', 'width=550,height=680,menubar=no,toolbar=no'); return false;">
<i class="fa-brands fa-x-twitter"></i> Tweet
    </button>
<button class="share-button hover-item linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?url=https://docs.ultralytics.com/reference/utils/callbacks/comet', 'LinkedinShare', 'width=550,height=730,menubar=no,toolbar=no'); return false;">
<i class="fa-brands fa-linkedin-in"></i> Share
    </button>
</div>
<br/>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: clearml" class="md-footer__link md-footer__link--prev" href="../clearml/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                clearml
              </div>
</div>
</a>
<a aria-label="Next: dvc" class="md-footer__link md-footer__link--next" href="../dvc/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                dvc
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
<a href="https://www.ultralytics.com/" target="_blank">Â© 2025 Ultralytics Inc.</a> All rights reserved.
    </div>
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/ultralytics" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg>
</a>
<a class="md-social__link" href="https://www.linkedin.com/company/ultralytics/" rel="noopener" target="_blank" title="www.linkedin.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z" fill="currentColor"></path></svg>
</a>
<a class="md-social__link" href="https://x.com/ultralytics" rel="noopener" target="_blank" title="x.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z" fill="currentColor"></path></svg>
</a>
<a class="md-social__link" href="https://youtube.com/ultralytics?sub_confirmation=1" rel="noopener" target="_blank" title="youtube.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z" fill="currentColor"></path></svg>
</a>
<a class="md-social__link" href="https://hub.docker.com/r/ultralytics/ultralytics/" rel="noopener" target="_blank" title="hub.docker.com">
<svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z" fill="currentColor"></path></svg>
</a>
<a class="md-social__link" href="https://pypi.org/project/ultralytics/" rel="noopener" target="_blank" title="pypi.org">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8" fill="currentColor"></path></svg>
</a>
<a class="md-social__link" href="https://discord.com/invite/ultralytics" rel="noopener" target="_blank" title="discord.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2" fill="currentColor"></path></svg>
</a>
<a class="md-social__link" href="https://reddit.com/r/ultralytics" rel="noopener" target="_blank" title="reddit.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5" fill="currentColor"></path></svg>
</a>
<a class="md-social__link" href="https://weixin.qq.com/r/mp/LxckPDfEgWr_rXNf90I9" rel="noopener" target="_blank" title="weixin.qq.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6" fill="currentColor"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"base": "../../../..", "features": ["content.action.edit", "content.code.annotate", "content.code.copy", "content.tooltips", "toc.follow", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.prune", "navigation.footer", "navigation.tracking", "navigation.instant", "navigation.instant.progress", "navigation.indexes", "navigation.sections", "content.tabs.link"], "search": "../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../../../assets/javascripts/bundle.50899def.min.js"></script>
<script src="../../../../javascript/extra.js"></script>
<script src="../../../../javascript/giscus.js"></script>
<script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
<script src="../../../../javascript/tablesort.js"></script>
<script>
                    async function copyMarkdownForLLM(button) {
                        const editBtn = document.querySelector('a[title="Edit this page"]');
                        if (!editBtn) return;
                        const originalHTML = button.innerHTML;
                        const checkIcon = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19L21 7l-1.41-1.41L9 16.17z"></path></svg>';
                        // Handle both /blob/ and /tree/ in GitHub URLs
                        let rawUrl = editBtn.href.replace('github.com', 'raw.githubusercontent.com');
                        // Remove /blob/ or /tree/ from the URL
                        rawUrl = rawUrl.replace('/blob/', '/').replace('/tree/', '/');
                        try {
                            const response = await fetch(rawUrl);
                            let markdown = await response.text();
                            // Remove YAML front matter if present
                            if (markdown.startsWith('---')) {
                                const frontMatterEnd = markdown.indexOf('\n---\n', 3);
                                if (frontMatterEnd !== -1) {
                                    markdown = markdown.substring(frontMatterEnd + 5).trim();
                                }
                            }
                            const title = document.querySelector('h1')?.textContent || document.title;
                            const content = `# ${title}\n\nSource: ${window.location.href}\n\n---\n\n${markdown}`;
                            await navigator.clipboard.writeText(content);
                            button.innerHTML = checkIcon + ' Copied!';
                            setTimeout(() => { button.innerHTML = originalHTML; }, 2000);
                        } catch (err) {
                            button.innerHTML = 'âŒ Failed';
                            setTimeout(() => { button.innerHTML = originalHTML; }, 2000);
                        }
                    }
                    </script></body>
</html>