 <!DOCTYPE html><html class="no-js" lang="en"><head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Explore Kalman filter implementations like KalmanFilterXYAH and KalmanFilterXYWH for tracking bounding boxes in image space using Ultralytics." name="description"/><meta content="Ultralytics" name="author"/><link href="https://docs.ultralytics.com/reference/trackers/utils/kalman_filter/" rel="canonical"/><link href="../gmc/" rel="prev"/><link href="../matching/" rel="next"/><link href="/" hreflang="en" rel="alternate"/><link href="/zh/" hreflang="zh" rel="alternate"/><link href="/ko/" hreflang="ko" rel="alternate"/><link href="/ja/" hreflang="ja" rel="alternate"/><link href="/ru/" hreflang="ru" rel="alternate"/><link href="/de/" hreflang="de" rel="alternate"/><link href="/fr/" hreflang="fr" rel="alternate"/><link href="/es/" hreflang="es" rel="alternate"/><link href="/pt/" hreflang="pt" rel="alternate"/><link href="/it/" hreflang="it" rel="alternate"/><link href="/tr/" hreflang="tr" rel="alternate"/><link href="/vi/" hreflang="vi" rel="alternate"/><link href="/ar/" hreflang="ar" rel="alternate"/><link href="https://raw.githubusercontent.com/ultralytics/assets/refs/heads/main/logo/favicon-yolo.png" rel="icon"/><meta content="zensical-0.0.10" name="generator"/><title>Reference for ultralytics/trackers/utils/kalman_filter.py</title><link href="../../../../assets/stylesheets/modern/main.eafc6f7f.min.css" rel="stylesheet"/><link href="../../../../assets/stylesheets/modern/palette.dfe2e883.min.css" rel="stylesheet"/><style>:root{}</style><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,500,500i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link href="../../../../stylesheets/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)),0),__md_get=(e,t=localStorage,a=__md_scope)=>JSON.parse(t.getItem(a.pathname+"."+e)),__md_set=(e,t,a=localStorage,_=__md_scope)=>{try{a.setItem(_.pathname+"."+e,JSON.stringify(t))}catch(e){}},document.documentElement.setAttribute("data-platform",navigator.platform)</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2M5EHKC0BH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2M5EHKC0BH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2M5EHKC0BH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
<style data-doc-kind="true">.doc-kind{display:inline-flex;align-items:center;gap:0.25em;padding:0.21em 0.59em;border-radius:999px;font-weight:700;font-size:0.81em;letter-spacing:0.06em;text-transform:uppercase;line-height:1;color:var(--doc-kind-color,#f8fafc);background:var(--doc-kind-bg,rgba(255,255,255,0.12));}.doc-kind-class{--doc-kind-color:#039dfc;--doc-kind-bg:rgba(3,157,252,0.22);}.doc-kind-function{--doc-kind-color:#fc9803;--doc-kind-bg:rgba(252,152,3,0.22);}.doc-kind-method{--doc-kind-color:#ef5eff;--doc-kind-bg:rgba(239,94,255,0.22);}.doc-kind-property{--doc-kind-color:#02e835;--doc-kind-bg:rgba(2,232,53,0.22);}</style><meta content="Reference for ultralytics/trackers/utils/kalman_filter.py" name="title"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"/><meta content="website" property="og:type"/><meta content="https://docs.ultralytics.com/reference/trackers/utils/kalman_filter/" property="og:url"/><meta content="Reference for ultralytics/trackers/utils/kalman_filter.py" property="og:title"/><meta content="" property="og:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="og:image"/><meta content="summary_large_image" property="twitter:card"/><meta content="https://docs.ultralytics.com/reference/trackers/utils/kalman_filter/" property="twitter:url"/><meta content="Reference for ultralytics/trackers/utils/kalman_filter.py" property="twitter:title"/><meta content="" property="twitter:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="twitter:image"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "headline": "Reference for ultralytics/trackers/utils/kalman_filter.py", "image": ["https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png"], "datePublished": "2023-11-12 02:49:37 +0100", "dateModified": "2025-11-23 19:53:50 +0100", "author": [{"@type": "Organization", "name": "Ultralytics", "url": "https://ultralytics.com/"}], "abstract": ""}</script></head><body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr"><input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/><input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/><label class="md-overlay" for="__drawer"></label><div data-md-component="skip"><a class="md-skip" href="#reference-for-ultralyticstrackersutilskalman_filterpy"> Skip to content </a></div><div data-md-component="announce"><aside class="md-banner"><div class="md-banner__inner md-grid md-typeset"><a class="banner-wrapper" href="https://www.ultralytics.com/news/ultralytics-raises-30m-series-a" target="_blank"><div class="banner-content-wrapper"><img alt="Ultralytics raises $30M Series A" height="40" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac336b5de2ae8b398bca_writting.svg"/><div class="vc-wrapper"><img alt="Elephant" height="28" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac33c95408144846afc7_image%201.png"/><img alt="SquareOne" height="28" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac3333068d9632cc6df8_image%202.png"/></div></div></a></div></aside></div><header class="md-header md-header--shadow md-header--lifted" data-md-component="header"><nav aria-label="Header" class="md-header__inner md-grid"><a aria-label="Ultralytics YOLO Docs" class="md-header__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs"><img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/></a><label class="md-header__button md-icon" for="__drawer"><svg class="lucide lucide-menu" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 5h16M4 12h16M4 19h16"></path></svg></label><div class="md-header__title" data-md-component="header-title"><div class="md-header__ellipsis"><div class="md-header__topic"><span class="md-ellipsis"> Ultralytics YOLO Docs </span></div><div class="md-header__topic" data-md-component="header-topic"><span class="md-ellipsis"> Reference for ultralytics/trackers/utils/kalman_filter.py </span></div></div></div><form class="md-header__option" data-md-component="palette"><input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg></label><input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to system preference"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label><input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label></form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<div class="md-header__option"><div class="md-select"><button aria-label="Select language" class="md-header__button md-icon"><svg class="lucide lucide-languages" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m5 8 6 6M4 14l6-6 2-3M2 5h12M7 2h1M22 22l-5-10-5 10M14 18h6"></path></svg></button><div class="md-select__inner"><ul class="md-select__list"><li class="md-select__item"><a class="md-select__link" href="/" hreflang="en"> ğŸ‡¬ğŸ‡§ English </a></li><li class="md-select__item"><a class="md-select__link" href="/zh/" hreflang="zh"> ğŸ‡¨ğŸ‡³ ç®€ä½“ä¸­æ–‡ </a></li><li class="md-select__item"><a class="md-select__link" href="/ko/" hreflang="ko"> ğŸ‡°ğŸ‡· í•œêµ­ì–´ </a></li><li class="md-select__item"><a class="md-select__link" href="/ja/" hreflang="ja"> ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª </a></li><li class="md-select__item"><a class="md-select__link" href="/ru/" hreflang="ru"> ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹ </a></li><li class="md-select__item"><a class="md-select__link" href="/de/" hreflang="de"> ğŸ‡©ğŸ‡ª Deutsch </a></li><li class="md-select__item"><a class="md-select__link" href="/fr/" hreflang="fr"> ğŸ‡«ğŸ‡· FranÃ§ais </a></li><li class="md-select__item"><a class="md-select__link" href="/es/" hreflang="es"> ğŸ‡ªğŸ‡¸ EspaÃ±ol </a></li><li class="md-select__item"><a class="md-select__link" href="/pt/" hreflang="pt"> ğŸ‡µğŸ‡¹ PortuguÃªs </a></li><li class="md-select__item"><a class="md-select__link" href="/it/" hreflang="it"> ğŸ‡®ğŸ‡¹ Italiano </a></li><li class="md-select__item"><a class="md-select__link" href="/tr/" hreflang="tr"> ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e </a></li><li class="md-select__item"><a class="md-select__link" href="/vi/" hreflang="vi"> ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t </a></li><li class="md-select__item"><a class="md-select__link" href="/ar/" hreflang="ar"> ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© </a></li></ul></div></div></div><label class="md-header__button md-icon" for="__search"><svg class="lucide lucide-search" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m21 21-4.34-4.34"></path><circle cx="11" cy="11" r="8"></circle></svg></label><div aria-label="Search" class="md-search" data-md-component="search" role="dialog"><button class="md-search__button" type="button"> Search </button></div><div class="md-header__source"><a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository"><div class="md-source__icon md-icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></div><div class="md-source__repository"> ultralytics/ultralytics </div></a></div></nav><nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"><div class="md-grid"><ul class="md-tabs__list"><li class="md-tabs__item"><a class="md-tabs__link" href="../../../.."> Home </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../../quickstart/"> Quickstart </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../../modes/"> Modes </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../../tasks/"> Tasks </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../../models/"> Models </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../../datasets/"> Datasets </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../../solutions/"> Solutions </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../../guides/"> Guides </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../../integrations/"> Integrations </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../../hub/"> HUB </a></li><li class="md-tabs__item md-tabs__item--active"><a class="md-tabs__link" href="../../../__init__/"> Reference </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../../help/"> Help </a></li></ul></div></nav></header><div class="md-container" data-md-component="container"><main class="md-main" data-md-component="main"><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0"><label class="md-nav__title" for="__drawer"><a aria-label="Ultralytics YOLO Docs" class="md-nav__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs"><img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/></a> Ultralytics YOLO Docs </label><div class="md-nav__source"><a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository"><div class="md-source__icon md-icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></div><div class="md-source__repository"> ultralytics/ultralytics </div></a></div><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../.."><span class="md-ellipsis"> Home </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../../quickstart/"><span class="md-ellipsis"> Quickstart </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../../modes/"><span class="md-ellipsis"> Modes </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../../tasks/"><span class="md-ellipsis"> Tasks </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../../models/"><span class="md-ellipsis"> Models </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../../datasets/"><span class="md-ellipsis"> Datasets </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../../solutions/"><span class="md-ellipsis"> Solutions </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../../guides/"><span class="md-ellipsis"> Guides </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../../integrations/"><span class="md-ellipsis"> Integrations </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../../hub/"><span class="md-ellipsis"> HUB </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input checked="" class="md-nav__toggle md-toggle" id="__nav_11" type="checkbox"/><label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex=""><span class="md-ellipsis"> Reference </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="true" aria-labelledby="__nav_11_label" class="md-nav" data-md-level="1"><label class="md-nav__title" for="__nav_11"><span class="md-nav__icon md-icon"></span> Reference </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../../__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_2" type="checkbox"/><label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex=""><span class="md-ellipsis"> cfg </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_2_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_2"><span class="md-nav__icon md-icon"></span> cfg </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../../cfg/__init__/"><span class="md-ellipsis"> __init__ </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_3" type="checkbox"/><label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex=""><span class="md-ellipsis"> data </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_3_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_3"><span class="md-nav__icon md-icon"></span> data </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../../data/annotator/"><span class="md-ellipsis"> annotator </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../data/augment/"><span class="md-ellipsis"> augment </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../data/base/"><span class="md-ellipsis"> base </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../data/build/"><span class="md-ellipsis"> build </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../data/converter/"><span class="md-ellipsis"> converter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../data/dataset/"><span class="md-ellipsis"> dataset </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../data/loaders/"><span class="md-ellipsis"> loaders </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../data/split/"><span class="md-ellipsis"> split </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../data/split_dota/"><span class="md-ellipsis"> split_dota </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../data/utils/"><span class="md-ellipsis"> utils </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_4" type="checkbox"/><label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex=""><span class="md-ellipsis"> engine </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_4_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_4"><span class="md-nav__icon md-icon"></span> engine </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../../engine/exporter/"><span class="md-ellipsis"> exporter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../engine/model/"><span class="md-ellipsis"> model </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../engine/predictor/"><span class="md-ellipsis"> predictor </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../engine/results/"><span class="md-ellipsis"> results </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../engine/trainer/"><span class="md-ellipsis"> trainer </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../engine/tuner/"><span class="md-ellipsis"> tuner </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../engine/validator/"><span class="md-ellipsis"> validator </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_5" type="checkbox"/><label class="md-nav__link" for="__nav_11_5" id="__nav_11_5_label" tabindex=""><span class="md-ellipsis"> hub </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_5_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_5"><span class="md-nav__icon md-icon"></span> hub </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../../hub/__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../hub/auth/"><span class="md-ellipsis"> auth </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../hub/google/__init__/"><span class="md-ellipsis"> google </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../hub/session/"><span class="md-ellipsis"> session </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../hub/utils/"><span class="md-ellipsis"> utils </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_6" type="checkbox"/><label class="md-nav__link" for="__nav_11_6" id="__nav_11_6_label" tabindex=""><span class="md-ellipsis"> models </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_6_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_6"><span class="md-nav__icon md-icon"></span> models </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../models/fastsam/model/"><span class="md-ellipsis"> fastsam </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../models/nas/model/"><span class="md-ellipsis"> nas </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../models/rtdetr/model/"><span class="md-ellipsis"> rtdetr </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../models/sam/amg/"><span class="md-ellipsis"> sam </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../models/utils/loss/"><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../models/yolo/classify/predict/"><span class="md-ellipsis"> yolo </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_7" type="checkbox"/><label class="md-nav__link" for="__nav_11_7" id="__nav_11_7_label" tabindex=""><span class="md-ellipsis"> nn </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_7_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_7"><span class="md-nav__icon md-icon"></span> nn </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../../nn/autobackend/"><span class="md-ellipsis"> autobackend </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../nn/modules/activation/"><span class="md-ellipsis"> modules </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../nn/tasks/"><span class="md-ellipsis"> tasks </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../nn/text_model/"><span class="md-ellipsis"> text_model </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_8" type="checkbox"/><label class="md-nav__link" for="__nav_11_8" id="__nav_11_8_label" tabindex=""><span class="md-ellipsis"> solutions </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_8_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_8"><span class="md-nav__icon md-icon"></span> solutions </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/ai_gym/"><span class="md-ellipsis"> ai_gym </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/analytics/"><span class="md-ellipsis"> analytics </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/config/"><span class="md-ellipsis"> config </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/distance_calculation/"><span class="md-ellipsis"> distance_calculation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/heatmap/"><span class="md-ellipsis"> heatmap </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/instance_segmentation/"><span class="md-ellipsis"> instance_segmentation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/object_blurrer/"><span class="md-ellipsis"> object_blurrer </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/object_counter/"><span class="md-ellipsis"> object_counter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/object_cropper/"><span class="md-ellipsis"> object_cropper </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/parking_management/"><span class="md-ellipsis"> parking_management </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/queue_management/"><span class="md-ellipsis"> queue_management </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/region_counter/"><span class="md-ellipsis"> region_counter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/security_alarm/"><span class="md-ellipsis"> security_alarm </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/similarity_search/"><span class="md-ellipsis"> similarity_search </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/solutions/"><span class="md-ellipsis"> solutions </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/speed_estimation/"><span class="md-ellipsis"> speed_estimation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/streamlit_inference/"><span class="md-ellipsis"> streamlit_inference </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/trackzone/"><span class="md-ellipsis"> trackzone </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../solutions/vision_eye/"><span class="md-ellipsis"> vision_eye </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input checked="" class="md-nav__toggle md-toggle" id="__nav_11_9" type="checkbox"/><label class="md-nav__link" for="__nav_11_9" id="__nav_11_9_label" tabindex=""><span class="md-ellipsis"> trackers </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="true" aria-labelledby="__nav_11_9_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_9"><span class="md-nav__icon md-icon"></span> trackers </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../basetrack/"><span class="md-ellipsis"> basetrack </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../bot_sort/"><span class="md-ellipsis"> bot_sort </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../byte_tracker/"><span class="md-ellipsis"> byte_tracker </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../track/"><span class="md-ellipsis"> track </span></a></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input checked="" class="md-nav__toggle md-toggle" id="__nav_11_9_5" type="checkbox"/><label class="md-nav__link" for="__nav_11_9_5" id="__nav_11_9_5_label" tabindex="0"><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="true" aria-labelledby="__nav_11_9_5_label" class="md-nav" data-md-level="3"><label class="md-nav__title" for="__nav_11_9_5"><span class="md-nav__icon md-icon"></span> utils </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../gmc/"><span class="md-ellipsis"> gmc </span></a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/><label class="md-nav__link md-nav__link--active" for="__toc"><span class="md-ellipsis"> kalman_filter </span><span class="md-nav__icon md-icon"></span></label><a class="md-nav__link md-nav__link--active" href="./"><span class="md-ellipsis"> kalman_filter </span></a><nav aria-label="On this page" class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc"><span class="md-nav__icon md-icon"></span> On this page </label><ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> KalmanFilterXYAH</span></a><nav aria-label="Class ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.gating_distance"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> gating_distance</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.initiate"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> initiate</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.multi_predict"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> multi_predict</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.predict"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> predict</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.project"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> project</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.update"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> update</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> KalmanFilterXYWH</span></a><nav aria-label="Class ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.initiate"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> initiate</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.multi_predict"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> multi_predict</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.predict"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> predict</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.project"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> project</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.update"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> update</span></a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="../matching/"><span class="md-ellipsis"> matching </span></a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_10" type="checkbox"/><label class="md-nav__link" for="__nav_11_10" id="__nav_11_10_label" tabindex=""><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_10_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_10"><span class="md-nav__icon md-icon"></span> utils </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/autobatch/"><span class="md-ellipsis"> autobatch </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/autodevice/"><span class="md-ellipsis"> autodevice </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/benchmarks/"><span class="md-ellipsis"> benchmarks </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../utils/callbacks/base/"><span class="md-ellipsis"> callbacks </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/checks/"><span class="md-ellipsis"> checks </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/cpu/"><span class="md-ellipsis"> cpu </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/dist/"><span class="md-ellipsis"> dist </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/downloads/"><span class="md-ellipsis"> downloads </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/errors/"><span class="md-ellipsis"> errors </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/events/"><span class="md-ellipsis"> events </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../utils/export/engine/"><span class="md-ellipsis"> export </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/files/"><span class="md-ellipsis"> files </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/git/"><span class="md-ellipsis"> git </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/instance/"><span class="md-ellipsis"> instance </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/logger/"><span class="md-ellipsis"> logger </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/loss/"><span class="md-ellipsis"> loss </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/metrics/"><span class="md-ellipsis"> metrics </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/nms/"><span class="md-ellipsis"> nms </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/ops/"><span class="md-ellipsis"> ops </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/patches/"><span class="md-ellipsis"> patches </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/plotting/"><span class="md-ellipsis"> plotting </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/tal/"><span class="md-ellipsis"> tal </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/torch_utils/"><span class="md-ellipsis"> torch_utils </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/tqdm/"><span class="md-ellipsis"> tqdm </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/triton/"><span class="md-ellipsis"> triton </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../../utils/tuner/"><span class="md-ellipsis"> tuner </span></a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../../help/"><span class="md-ellipsis"> Help </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav aria-label="On this page" class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc"><span class="md-nav__icon md-icon"></span> On this page </label><ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> KalmanFilterXYAH</span></a><nav aria-label="Class ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.gating_distance"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> gating_distance</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.initiate"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> initiate</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.multi_predict"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> multi_predict</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.predict"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> predict</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.project"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> project</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.update"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> update</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> KalmanFilterXYWH</span></a><nav aria-label="Class ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.initiate"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> initiate</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.multi_predict"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> multi_predict</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.predict"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> predict</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.project"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> project</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.update"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> update</span></a></li></ul></nav></li></ul></nav></div></div></div><div class="md-content" data-md-component="content"><article class="md-content__inner md-typeset"><a class="md-content__button md-icon" href="https://github.com/ultralytics/ultralytics/tree/main/docs/en/reference/trackers/utils/kalman_filter.md" rel="edit" title="Edit this page"><svg class="lucide lucide-file-pen" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5"></path><path d="M14 2v4a2 2 0 0 0 2 2h4M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z"></path></svg></a><h1 id="reference-for-ultralyticstrackersutilskalman_filterpy">Reference for <code>ultralytics/trackers/utils/kalman_filter.py</code></h1><div class="admonition success"><p class="admonition-title">Improvements</p><p>This page is sourced from <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py">https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py</a>. Have an improvement or example to add? Open a <a href="https://docs.ultralytics.com/help/contributing/">Pull Request</a> â€” thank you! ğŸ™</p></div><p><br/></p><div class="admonition abstract"><p class="admonition-title">Summary</p><div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="classes" name="__tabbed_1" type="radio"/><input id="methods" name="__tabbed_1" type="radio"/><div class="tabbed-labels"><label for="classes"><span class="doc-kind doc-kind-class">Classes</span></label><label for="methods"><span class="doc-kind doc-kind-method">Methods</span></label></div><div class="tabbed-content"><div class="tabbed-block"><ul><li><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH"><code>KalmanFilterXYAH</code></a></li><li><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH"><code>KalmanFilterXYWH</code></a></li></ul></div><div class="tabbed-block"><ul><li><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.initiate"><code>KalmanFilterXYAH.initiate</code></a></li><li><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.predict"><code>KalmanFilterXYAH.predict</code></a></li><li><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.project"><code>KalmanFilterXYAH.project</code></a></li><li><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.multi_predict"><code>KalmanFilterXYAH.multi_predict</code></a></li><li><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.update"><code>KalmanFilterXYAH.update</code></a></li><li><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.gating_distance"><code>KalmanFilterXYAH.gating_distance</code></a></li><li><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.initiate"><code>KalmanFilterXYWH.initiate</code></a></li><li><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.predict"><code>KalmanFilterXYWH.predict</code></a></li><li><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.project"><code>KalmanFilterXYWH.project</code></a></li><li><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.multi_predict"><code>KalmanFilterXYWH.multi_predict</code></a></li><li><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.update"><code>KalmanFilterXYWH.update</code></a></li></ul></div></div></div></div><h2 id="ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">KalmanFilterXYAH</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>A KalmanFilterXYAH class for tracking bounding boxes in image space using a Kalman filter.</p><p>Implements a simple Kalman filter for tracking bounding boxes in image space. The 8-dimensional state space (x, y, a, h, vx, vy, va, vh) contains the bounding box center position (x, y), aspect ratio a, height h, and their respective velocities. Object motion follows a constant velocity model, and bounding box location (x, y, a, h) is taken as a direct observation of the state space (linear observation model).</p><p>The Kalman filter is initialized with an 8-dimensional state space (x, y, a, h, vx, vy, va, vh), where (x, y) represents the bounding box center position, 'a' is the aspect ratio, 'h' is the height, and their respective velocities are (vx, vy, va, vh). The filter uses a constant velocity model for object motion and a linear observation model for bounding box location.</p><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>_motion_mat</code></td><td><code>np.ndarray</code></td><td>The motion matrix for the Kalman filter.</td></tr><tr><td><code>_update_mat</code></td><td><code>np.ndarray</code></td><td>The update matrix for the Kalman filter.</td></tr><tr><td><code>_std_weight_position</code></td><td><code>float</code></td><td>Standard deviation weight for position.</td></tr><tr><td><code>_std_weight_velocity</code></td><td><code>float</code></td><td>Standard deviation weight for velocity.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.gating_distance"><code>gating_distance</code></a></td><td>Compute gating distance between state distribution and measurements.</td></tr><tr><td><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.initiate"><code>initiate</code></a></td><td>Create a track from an unassociated measurement.</td></tr><tr><td><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.multi_predict"><code>multi_predict</code></a></td><td>Run Kalman filter prediction step for multiple object states (Vectorized version).</td></tr><tr><td><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.predict"><code>predict</code></a></td><td>Run Kalman filter prediction step.</td></tr><tr><td><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.project"><code>project</code></a></td><td>Project state distribution to measurement space.</td></tr><tr><td><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.update"><code>update</code></a></td><td>Run Kalman filter correction step.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="n">Initialize</span> <span class="n">the</span> <span class="n">Kalman</span> <span class="nb">filter</span> <span class="ow">and</span> <span class="n">create</span> <span class="n">a</span> <span class="n">track</span> <span class="kn">from</span><span class="w"> </span><span class="nn">a</span> <span class="n">measurement</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">kf</span> <span class="o">=</span> <span class="n">KalmanFilterXYAH</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">measurement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="n">initiate</span><span class="p">(</span><span class="n">measurement</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">covariance</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/trackers/utils/kalman_filter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py#L7-L277"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">KalmanFilterXYAH</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""A KalmanFilterXYAH class for tracking bounding boxes in image space using a Kalman filter.</span>
<span></span>
<span></span><span class="sd">    Implements a simple Kalman filter for tracking bounding boxes in image space. The 8-dimensional state space (x, y,</span>
<span></span><span class="sd">    a, h, vx, vy, va, vh) contains the bounding box center position (x, y), aspect ratio a, height h, and their</span>
<span></span><span class="sd">    respective velocities. Object motion follows a constant velocity model, and bounding box location (x, y, a, h) is</span>
<span></span><span class="sd">    taken as a direct observation of the state space (linear observation model).</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        _motion_mat (np.ndarray): The motion matrix for the Kalman filter.</span>
<span></span><span class="sd">        _update_mat (np.ndarray): The update matrix for the Kalman filter.</span>
<span></span><span class="sd">        _std_weight_position (float): Standard deviation weight for position.</span>
<span></span><span class="sd">        _std_weight_velocity (float): Standard deviation weight for velocity.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        initiate: Create a track from an unassociated measurement.</span>
<span></span><span class="sd">        predict: Run the Kalman filter prediction step.</span>
<span></span><span class="sd">        project: Project the state distribution to measurement space.</span>
<span></span><span class="sd">        multi_predict: Run the Kalman filter prediction step (vectorized version).</span>
<span></span><span class="sd">        update: Run the Kalman filter correction step.</span>
<span></span><span class="sd">        gating_distance: Compute the gating distance between state distribution and measurements.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        Initialize the Kalman filter and create a track from a measurement</span>
<span></span><span class="sd">        &gt;&gt;&gt; kf = KalmanFilterXYAH()</span>
<span></span><span class="sd">        &gt;&gt;&gt; measurement = np.array([100, 200, 1.5, 50])</span>
<span></span><span class="sd">        &gt;&gt;&gt; mean, covariance = kf.initiate(measurement)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(mean)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(covariance)</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize Kalman filter model matrices with motion and observation uncertainty weights.</span>
<span></span>
<span></span><span class="sd">        The Kalman filter is initialized with an 8-dimensional state space (x, y, a, h, vx, vy, va, vh), where (x, y)</span>
<span></span><span class="sd">        represents the bounding box center position, 'a' is the aspect ratio, 'h' is the height, and their respective</span>
<span></span><span class="sd">        velocities are (vx, vy, va, vh). The filter uses a constant velocity model for object motion and a linear</span>
<span></span><span class="sd">        observation model for bounding box location.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="n">ndim</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">1.0</span>
<span></span>
<span></span>        <span class="c1"># Create Kalman filter model matrices</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ndim</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ndim</span><span class="p">)</span>
<span></span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dt</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ndim</span><span class="p">)</span>
<span></span>
<span></span>        <span class="c1"># Motion and observation uncertainty are chosen relative to the current state estimate</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mi">20</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mi">160</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.gating_distance"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.gating_distance</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">gating_distance</span><span class="p">(</span>
<span></span>    <span class="bp">self</span><span class="p">,</span>
<span></span>    <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">measurements</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">only_position</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"maha"</span><span class="p">,</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Compute gating distance between state distribution and measurements.</p><p>A suitable distance threshold can be obtained from <code>chi2inv95</code>. If <code>only_position</code> is False, the chi-square distribution has 4 degrees of freedom, otherwise 2.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>mean</code></td><td><code>np.ndarray</code></td><td>Mean vector over the state distribution (8 dimensional).</td><td><em>required</em></td></tr><tr><td><code>covariance</code></td><td><code>np.ndarray</code></td><td>Covariance of the state distribution (8x8 dimensional).</td><td><em>required</em></td></tr><tr><td><code>measurements</code></td><td><code>np.ndarray</code></td><td>An (N, 4) matrix of N measurements, each in format (x, y, a, h) where (x, y) is the bounding box center position, a the aspect ratio, and h the height.</td><td><em>required</em></td></tr><tr><td><code>only_position</code></td><td><code>bool, optional</code></td><td>If True, distance computation is done with respect to box center position only.</td><td><code>False</code></td></tr><tr><td><code>metric</code></td><td><code>str, optional</code></td><td>The metric to use for calculating the distance. Options are 'gaussian' for the squared Euclidean distance and 'maha' for the squared Mahalanobis distance.</td><td><code>"maha"</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>np.ndarray</code></td><td>Returns an array of length N, where the i-th element contains the squared distance between</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="n">Compute</span> <span class="n">gating</span> <span class="n">distance</span> <span class="n">using</span> <span class="n">Mahalanobis</span> <span class="n">metric</span><span class="p">:</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">kf</span> <span class="o">=</span> <span class="n">KalmanFilterXYAH</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">measurements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">distances</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="n">gating_distance</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">,</span> <span class="n">measurements</span><span class="p">,</span> <span class="n">only_position</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">"maha"</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/trackers/utils/kalman_filter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py#L229-L277"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">gating_distance</span><span class="p">(</span>
<span></span>    <span class="bp">self</span><span class="p">,</span>
<span></span>    <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">measurements</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">only_position</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"maha"</span><span class="p">,</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Compute gating distance between state distribution and measurements.</span>
<span></span>
<span></span><span class="sd">    A suitable distance threshold can be obtained from `chi2inv95`. If `only_position` is False, the chi-square</span>
<span></span><span class="sd">    distribution has 4 degrees of freedom, otherwise 2.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        mean (np.ndarray): Mean vector over the state distribution (8 dimensional).</span>
<span></span><span class="sd">        covariance (np.ndarray): Covariance of the state distribution (8x8 dimensional).</span>
<span></span><span class="sd">        measurements (np.ndarray): An (N, 4) matrix of N measurements, each in format (x, y, a, h) where (x, y) is</span>
<span></span><span class="sd">            the bounding box center position, a the aspect ratio, and h the height.</span>
<span></span><span class="sd">        only_position (bool, optional): If True, distance computation is done with respect to box center position</span>
<span></span><span class="sd">            only.</span>
<span></span><span class="sd">        metric (str, optional): The metric to use for calculating the distance. Options are 'gaussian' for the</span>
<span></span><span class="sd">            squared Euclidean distance and 'maha' for the squared Mahalanobis distance.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (np.ndarray): Returns an array of length N, where the i-th element contains the squared distance between</span>
<span></span><span class="sd">            (mean, covariance) and `measurements[i]`.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        Compute gating distance using Mahalanobis metric:</span>
<span></span><span class="sd">        &gt;&gt;&gt; kf = KalmanFilterXYAH()</span>
<span></span><span class="sd">        &gt;&gt;&gt; mean = np.array([0, 0, 1, 1, 0, 0, 0, 0])</span>
<span></span><span class="sd">        &gt;&gt;&gt; covariance = np.eye(8)</span>
<span></span><span class="sd">        &gt;&gt;&gt; measurements = np.array([[1, 1, 1, 1], [2, 2, 1, 1]])</span>
<span></span><span class="sd">        &gt;&gt;&gt; distances = kf.gating_distance(mean, covariance, measurements, only_position=False, metric="maha")</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">only_position</span><span class="p">:</span>
<span></span>        <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">mean</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">covariance</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span></span>        <span class="n">measurements</span> <span class="o">=</span> <span class="n">measurements</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span></span>
<span></span>    <span class="n">d</span> <span class="o">=</span> <span class="n">measurements</span> <span class="o">-</span> <span class="n">mean</span>
<span></span>    <span class="k">if</span> <span class="n">metric</span> <span class="o">==</span> <span class="s2">"gaussian"</span><span class="p">:</span>
<span></span>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">d</span> <span class="o">*</span> <span class="n">d</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="k">elif</span> <span class="n">metric</span> <span class="o">==</span> <span class="s2">"maha"</span><span class="p">:</span>
<span></span>        <span class="n">cholesky_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">covariance</span><span class="p">)</span>
<span></span>        <span class="n">z</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve_triangular</span><span class="p">(</span><span class="n">cholesky_factor</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite_b</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">z</span> <span class="o">*</span> <span class="n">z</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># square maha</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Invalid distance metric"</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.initiate"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.initiate</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">initiate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measurement</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</code></pre></div><p>Create a track from an unassociated measurement.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>measurement</code></td><td><code>np.ndarray</code></td><td>Bounding box coordinates (x, y, a, h) with center position (x, y), aspect ratio a, and height h.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>mean (np.ndarray)</code></td><td>Mean vector (8-dimensional) of the new track. Unobserved velocities are initialized to 0</td></tr><tr><td><code>covariance (np.ndarray)</code></td><td>Covariance matrix (8x8 dimensional) of the new track.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">kf</span> <span class="o">=</span> <span class="n">KalmanFilterXYAH</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">measurement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="n">initiate</span><span class="p">(</span><span class="n">measurement</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/trackers/utils/kalman_filter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py#L58-L90"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">initiate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measurement</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Create a track from an unassociated measurement.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        measurement (np.ndarray): Bounding box coordinates (x, y, a, h) with center position (x, y), aspect ratio a,</span>
<span></span><span class="sd">            and height h.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        mean (np.ndarray): Mean vector (8-dimensional) of the new track. Unobserved velocities are initialized to 0</span>
<span></span><span class="sd">            mean.</span>
<span></span><span class="sd">        covariance (np.ndarray): Covariance matrix (8x8 dimensional) of the new track.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; kf = KalmanFilterXYAH()</span>
<span></span><span class="sd">        &gt;&gt;&gt; measurement = np.array([100, 50, 1.5, 200])</span>
<span></span><span class="sd">        &gt;&gt;&gt; mean, covariance = kf.initiate(measurement)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">mean_pos</span> <span class="o">=</span> <span class="n">measurement</span>
<span></span>    <span class="n">mean_vel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">mean_pos</span><span class="p">)</span>
<span></span>    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">mean_pos</span><span class="p">,</span> <span class="n">mean_vel</span><span class="p">]</span>
<span></span>
<span></span>    <span class="n">std</span> <span class="o">=</span> <span class="p">[</span>
<span></span>        <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="mf">1e-2</span><span class="p">,</span>
<span></span>        <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="mf">1e-5</span><span class="p">,</span>
<span></span>        <span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>    <span class="p">]</span>
<span></span>    <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">std</span><span class="p">))</span>
<span></span>    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.multi_predict"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.multi_predict</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">multi_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</code></pre></div><p>Run Kalman filter prediction step for multiple object states (Vectorized version).</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>mean</code></td><td><code>np.ndarray</code></td><td>The Nx8 dimensional mean matrix of the object states at the previous time step.</td><td><em>required</em></td></tr><tr><td><code>covariance</code></td><td><code>np.ndarray</code></td><td>The Nx8x8 covariance matrix of the object states at the previous time step.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>mean (np.ndarray)</code></td><td>Mean matrix of the predicted states with shape (N, 8).</td></tr><tr><td><code>covariance (np.ndarray)</code></td><td>Covariance matrix of the predicted states with shape (N, 8, 8).</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># 10 object states</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># Covariance matrices for 10 object states</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">predicted_mean</span><span class="p">,</span> <span class="n">predicted_covariance</span> <span class="o">=</span> <span class="n">kalman_filter</span><span class="o">.</span><span class="n">multi_predict</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/trackers/utils/kalman_filter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py#L158-L195"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">multi_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Run Kalman filter prediction step for multiple object states (Vectorized version).</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        mean (np.ndarray): The Nx8 dimensional mean matrix of the object states at the previous time step.</span>
<span></span><span class="sd">        covariance (np.ndarray): The Nx8x8 covariance matrix of the object states at the previous time step.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        mean (np.ndarray): Mean matrix of the predicted states with shape (N, 8).</span>
<span></span><span class="sd">        covariance (np.ndarray): Covariance matrix of the predicted states with shape (N, 8, 8).</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; mean = np.random.rand(10, 8)  # 10 object states</span>
<span></span><span class="sd">        &gt;&gt;&gt; covariance = np.random.rand(10, 8, 8)  # Covariance matrices for 10 object states</span>
<span></span><span class="sd">        &gt;&gt;&gt; predicted_mean, predicted_covariance = kalman_filter.multi_predict(mean, covariance)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">std_pos</span> <span class="o">=</span> <span class="p">[</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="mf">1e-2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]),</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
<span></span>    <span class="p">]</span>
<span></span>    <span class="n">std_vel</span> <span class="o">=</span> <span class="p">[</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="mf">1e-5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]),</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
<span></span>    <span class="p">]</span>
<span></span>    <span class="n">sqr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">std_pos</span><span class="p">,</span> <span class="n">std_vel</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span></span>
<span></span>    <span class="n">motion_cov</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">sqr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mean</span><span class="p">))]</span>
<span></span>    <span class="n">motion_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">motion_cov</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span></span>    <span class="n">left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span></span>    <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">motion_cov</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.predict"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.predict</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</code></pre></div><p>Run Kalman filter prediction step.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>mean</code></td><td><code>np.ndarray</code></td><td>The 8-dimensional mean vector of the object state at the previous time step.</td><td><em>required</em></td></tr><tr><td><code>covariance</code></td><td><code>np.ndarray</code></td><td>The 8x8-dimensional covariance matrix of the object state at the previous time step.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>mean (np.ndarray)</code></td><td>Mean vector of the predicted state. Unobserved velocities are initialized to 0 mean.</td></tr><tr><td><code>covariance (np.ndarray)</code></td><td>Covariance matrix of the predicted state.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">kf</span> <span class="o">=</span> <span class="n">KalmanFilterXYAH</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">predicted_mean</span><span class="p">,</span> <span class="n">predicted_covariance</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/trackers/utils/kalman_filter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py#L92-L127"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Run Kalman filter prediction step.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        mean (np.ndarray): The 8-dimensional mean vector of the object state at the previous time step.</span>
<span></span><span class="sd">        covariance (np.ndarray): The 8x8-dimensional covariance matrix of the object state at the previous time</span>
<span></span><span class="sd">            step.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        mean (np.ndarray): Mean vector of the predicted state. Unobserved velocities are initialized to 0 mean.</span>
<span></span><span class="sd">        covariance (np.ndarray): Covariance matrix of the predicted state.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; kf = KalmanFilterXYAH()</span>
<span></span><span class="sd">        &gt;&gt;&gt; mean = np.array([0, 0, 1, 1, 0, 0, 0, 0])</span>
<span></span><span class="sd">        &gt;&gt;&gt; covariance = np.eye(8)</span>
<span></span><span class="sd">        &gt;&gt;&gt; predicted_mean, predicted_covariance = kf.predict(mean, covariance)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">std_pos</span> <span class="o">=</span> <span class="p">[</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="mf">1e-2</span><span class="p">,</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>    <span class="p">]</span>
<span></span>    <span class="n">std_vel</span> <span class="o">=</span> <span class="p">[</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="mf">1e-5</span><span class="p">,</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>    <span class="p">]</span>
<span></span>    <span class="n">motion_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">std_pos</span><span class="p">,</span> <span class="n">std_vel</span><span class="p">]))</span>
<span></span>
<span></span>    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span></span>    <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">multi_dot</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="p">,</span> <span class="n">covariance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="n">motion_cov</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.project"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.project</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</code></pre></div><p>Project state distribution to measurement space.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>mean</code></td><td><code>np.ndarray</code></td><td>The state's mean vector (8 dimensional array).</td><td><em>required</em></td></tr><tr><td><code>covariance</code></td><td><code>np.ndarray</code></td><td>The state's covariance matrix (8x8 dimensional).</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>mean (np.ndarray)</code></td><td>Projected mean of the given state estimate.</td></tr><tr><td><code>covariance (np.ndarray)</code></td><td>Projected covariance matrix of the given state estimate.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">kf</span> <span class="o">=</span> <span class="n">KalmanFilterXYAH</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">projected_mean</span><span class="p">,</span> <span class="n">projected_covariance</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/trackers/utils/kalman_filter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py#L129-L156"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Project state distribution to measurement space.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        mean (np.ndarray): The state's mean vector (8 dimensional array).</span>
<span></span><span class="sd">        covariance (np.ndarray): The state's covariance matrix (8x8 dimensional).</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        mean (np.ndarray): Projected mean of the given state estimate.</span>
<span></span><span class="sd">        covariance (np.ndarray): Projected covariance matrix of the given state estimate.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; kf = KalmanFilterXYAH()</span>
<span></span><span class="sd">        &gt;&gt;&gt; mean = np.array([0, 0, 1, 1, 0, 0, 0, 0])</span>
<span></span><span class="sd">        &gt;&gt;&gt; covariance = np.eye(8)</span>
<span></span><span class="sd">        &gt;&gt;&gt; projected_mean, projected_covariance = kf.project(mean, covariance)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">std</span> <span class="o">=</span> <span class="p">[</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="mf">1e-1</span><span class="p">,</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>    <span class="p">]</span>
<span></span>    <span class="n">innovation_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">std</span><span class="p">))</span>
<span></span>
<span></span>    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>
<span></span>    <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">multi_dot</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="p">,</span> <span class="n">covariance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
<span></span>    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span> <span class="o">+</span> <span class="n">innovation_cov</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.update"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.trackers.utils.kalman_filter.KalmanFilterXYAH.update</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">measurement</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</code></pre></div><p>Run Kalman filter correction step.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>mean</code></td><td><code>np.ndarray</code></td><td>The predicted state's mean vector (8 dimensional).</td><td><em>required</em></td></tr><tr><td><code>covariance</code></td><td><code>np.ndarray</code></td><td>The state's covariance matrix (8x8 dimensional).</td><td><em>required</em></td></tr><tr><td><code>measurement</code></td><td><code>np.ndarray</code></td><td>The 4 dimensional measurement vector (x, y, a, h), where (x, y) is the center position, a the aspect ratio, and h the height of the bounding box.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>new_mean (np.ndarray)</code></td><td>Measurement-corrected state mean.</td></tr><tr><td><code>new_covariance (np.ndarray)</code></td><td>Measurement-corrected state covariance.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">kf</span> <span class="o">=</span> <span class="n">KalmanFilterXYAH</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">measurement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">new_mean</span><span class="p">,</span> <span class="n">new_covariance</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">,</span> <span class="n">measurement</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/trackers/utils/kalman_filter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py#L197-L227"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">measurement</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Run Kalman filter correction step.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        mean (np.ndarray): The predicted state's mean vector (8 dimensional).</span>
<span></span><span class="sd">        covariance (np.ndarray): The state's covariance matrix (8x8 dimensional).</span>
<span></span><span class="sd">        measurement (np.ndarray): The 4 dimensional measurement vector (x, y, a, h), where (x, y) is the center</span>
<span></span><span class="sd">            position, a the aspect ratio, and h the height of the bounding box.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        new_mean (np.ndarray): Measurement-corrected state mean.</span>
<span></span><span class="sd">        new_covariance (np.ndarray): Measurement-corrected state covariance.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; kf = KalmanFilterXYAH()</span>
<span></span><span class="sd">        &gt;&gt;&gt; mean = np.array([0, 0, 1, 1, 0, 0, 0, 0])</span>
<span></span><span class="sd">        &gt;&gt;&gt; covariance = np.eye(8)</span>
<span></span><span class="sd">        &gt;&gt;&gt; measurement = np.array([1, 1, 1, 1])</span>
<span></span><span class="sd">        &gt;&gt;&gt; new_mean, new_covariance = kf.update(mean, covariance, measurement)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">projected_mean</span><span class="p">,</span> <span class="n">projected_cov</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">chol_factor</span><span class="p">,</span> <span class="n">lower</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cho_factor</span><span class="p">(</span><span class="n">projected_cov</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span></span>    <span class="n">kalman_gain</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cho_solve</span><span class="p">(</span>
<span></span>        <span class="p">(</span><span class="n">chol_factor</span><span class="p">,</span> <span class="n">lower</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">covariance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">False</span>
<span></span>    <span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span></span>    <span class="n">innovation</span> <span class="o">=</span> <span class="n">measurement</span> <span class="o">-</span> <span class="n">projected_mean</span>
<span></span>
<span></span>    <span class="n">new_mean</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">innovation</span><span class="p">,</span> <span class="n">kalman_gain</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span></span>    <span class="n">new_covariance</span> <span class="o">=</span> <span class="n">covariance</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">multi_dot</span><span class="p">((</span><span class="n">kalman_gain</span><span class="p">,</span> <span class="n">projected_cov</span><span class="p">,</span> <span class="n">kalman_gain</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
<span></span>    <span class="k">return</span> <span class="n">new_mean</span><span class="p">,</span> <span class="n">new_covariance</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">KalmanFilterXYWH</span><span class="p">()</span>
</code></pre></div><p><strong>Bases:</strong> <code>KalmanFilterXYAH</code></p><p>A KalmanFilterXYWH class for tracking bounding boxes in image space using a Kalman filter.</p><p>Implements a Kalman filter for tracking bounding boxes with state space (x, y, w, h, vx, vy, vw, vh), where (x, y) is the center position, w is the width, h is the height, and vx, vy, vw, vh are their respective velocities. The object motion follows a constant velocity model, and the bounding box location (x, y, w, h) is taken as a direct observation of the state space (linear observation model).</p><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>_motion_mat</code></td><td><code>np.ndarray</code></td><td>The motion matrix for the Kalman filter.</td></tr><tr><td><code>_update_mat</code></td><td><code>np.ndarray</code></td><td>The update matrix for the Kalman filter.</td></tr><tr><td><code>_std_weight_position</code></td><td><code>float</code></td><td>Standard deviation weight for position.</td></tr><tr><td><code>_std_weight_velocity</code></td><td><code>float</code></td><td>Standard deviation weight for velocity.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.initiate"><code>initiate</code></a></td><td>Create track from unassociated measurement.</td></tr><tr><td><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.multi_predict"><code>multi_predict</code></a></td><td>Run Kalman filter prediction step (Vectorized version).</td></tr><tr><td><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.predict"><code>predict</code></a></td><td>Run Kalman filter prediction step.</td></tr><tr><td><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.project"><code>project</code></a></td><td>Project state distribution to measurement space.</td></tr><tr><td><a href="#ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.update"><code>update</code></a></td><td>Run Kalman filter correction step.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="n">Create</span> <span class="n">a</span> <span class="n">Kalman</span> <span class="nb">filter</span> <span class="ow">and</span> <span class="n">initialize</span> <span class="n">a</span> <span class="n">track</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">kf</span> <span class="o">=</span> <span class="n">KalmanFilterXYWH</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">measurement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="n">initiate</span><span class="p">(</span><span class="n">measurement</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">covariance</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/trackers/utils/kalman_filter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py#L280-L481"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">KalmanFilterXYWH</span><span class="p">(</span><span class="n">KalmanFilterXYAH</span><span class="p">):</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.initiate"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.initiate</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">initiate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measurement</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</code></pre></div><p>Create track from unassociated measurement.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>measurement</code></td><td><code>np.ndarray</code></td><td>Bounding box coordinates (x, y, w, h) with center position (x, y), width, and height.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>mean (np.ndarray)</code></td><td>Mean vector (8 dimensional) of the new track. Unobserved velocities are initialized to 0</td></tr><tr><td><code>covariance (np.ndarray)</code></td><td>Covariance matrix (8x8 dimensional) of the new track.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">kf</span> <span class="o">=</span> <span class="n">KalmanFilterXYWH</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">measurement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="n">initiate</span><span class="p">(</span><span class="n">measurement</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
<span></span><span class="p">[</span><span class="mf">100.</span>  <span class="mf">50.</span>  <span class="mf">20.</span>  <span class="mf">40.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span>   <span class="mf">0.</span><span class="p">]</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">covariance</span><span class="p">)</span>
<span></span><span class="p">[[</span> <span class="mf">4.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span><span class="p">]</span>
<span></span> <span class="p">[</span> <span class="mf">0.</span>  <span class="mf">4.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span><span class="p">]</span>
<span></span> <span class="p">[</span> <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">4.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span><span class="p">]</span>
<span></span> <span class="p">[</span> <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">4.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span><span class="p">]</span>
<span></span> <span class="p">[</span> <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.25</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span><span class="p">]</span>
<span></span> <span class="p">[</span> <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.25</span>  <span class="mf">0.</span>  <span class="mf">0.</span><span class="p">]</span>
<span></span> <span class="p">[</span> <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.25</span>  <span class="mf">0.</span><span class="p">]</span>
<span></span> <span class="p">[</span> <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.25</span><span class="p">]]</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/trackers/utils/kalman_filter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py#L310-L353"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">initiate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measurement</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Create track from unassociated measurement.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        measurement (np.ndarray): Bounding box coordinates (x, y, w, h) with center position (x, y), width, and</span>
<span></span><span class="sd">            height.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        mean (np.ndarray): Mean vector (8 dimensional) of the new track. Unobserved velocities are initialized to 0</span>
<span></span><span class="sd">            mean.</span>
<span></span><span class="sd">        covariance (np.ndarray): Covariance matrix (8x8 dimensional) of the new track.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; kf = KalmanFilterXYWH()</span>
<span></span><span class="sd">        &gt;&gt;&gt; measurement = np.array([100, 50, 20, 40])</span>
<span></span><span class="sd">        &gt;&gt;&gt; mean, covariance = kf.initiate(measurement)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(mean)</span>
<span></span><span class="sd">        [100.  50.  20.  40.   0.   0.   0.   0.]</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(covariance)</span>
<span></span><span class="sd">        [[ 4.  0.  0.  0.  0.  0.  0.  0.]</span>
<span></span><span class="sd">         [ 0.  4.  0.  0.  0.  0.  0.  0.]</span>
<span></span><span class="sd">         [ 0.  0.  4.  0.  0.  0.  0.  0.]</span>
<span></span><span class="sd">         [ 0.  0.  0.  4.  0.  0.  0.  0.]</span>
<span></span><span class="sd">         [ 0.  0.  0.  0.  0.25  0.  0.  0.]</span>
<span></span><span class="sd">         [ 0.  0.  0.  0.  0.  0.25  0.  0.]</span>
<span></span><span class="sd">         [ 0.  0.  0.  0.  0.  0.  0.25  0.]</span>
<span></span><span class="sd">         [ 0.  0.  0.  0.  0.  0.  0.  0.25]]</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">mean_pos</span> <span class="o">=</span> <span class="n">measurement</span>
<span></span>    <span class="n">mean_vel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">mean_pos</span><span class="p">)</span>
<span></span>    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">mean_pos</span><span class="p">,</span> <span class="n">mean_vel</span><span class="p">]</span>
<span></span>
<span></span>    <span class="n">std</span> <span class="o">=</span> <span class="p">[</span>
<span></span>        <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span></span>        <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span></span>        <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span></span>        <span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span></span>        <span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">measurement</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>    <span class="p">]</span>
<span></span>    <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">std</span><span class="p">))</span>
<span></span>    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.multi_predict"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.multi_predict</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">multi_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</code></pre></div><p>Run Kalman filter prediction step (Vectorized version).</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>mean</code></td><td><code>np.ndarray</code></td><td>The Nx8 dimensional mean matrix of the object states at the previous time step.</td><td><em>required</em></td></tr><tr><td><code>covariance</code></td><td><code>np.ndarray</code></td><td>The Nx8x8 covariance matrix of the object states at the previous time step.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>mean (np.ndarray)</code></td><td>Mean matrix of the predicted states with shape (N, 8).</td></tr><tr><td><code>covariance (np.ndarray)</code></td><td>Covariance matrix of the predicted states with shape (N, 8, 8).</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># 5 objects with 8-dimensional state vectors</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># 5 objects with 8x8 covariance matrices</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">kf</span> <span class="o">=</span> <span class="n">KalmanFilterXYWH</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">predicted_mean</span><span class="p">,</span> <span class="n">predicted_covariance</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="n">multi_predict</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/trackers/utils/kalman_filter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py#L421-L459"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">multi_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Run Kalman filter prediction step (Vectorized version).</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        mean (np.ndarray): The Nx8 dimensional mean matrix of the object states at the previous time step.</span>
<span></span><span class="sd">        covariance (np.ndarray): The Nx8x8 covariance matrix of the object states at the previous time step.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        mean (np.ndarray): Mean matrix of the predicted states with shape (N, 8).</span>
<span></span><span class="sd">        covariance (np.ndarray): Covariance matrix of the predicted states with shape (N, 8, 8).</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; mean = np.random.rand(5, 8)  # 5 objects with 8-dimensional state vectors</span>
<span></span><span class="sd">        &gt;&gt;&gt; covariance = np.random.rand(5, 8, 8)  # 5 objects with 8x8 covariance matrices</span>
<span></span><span class="sd">        &gt;&gt;&gt; kf = KalmanFilterXYWH()</span>
<span></span><span class="sd">        &gt;&gt;&gt; predicted_mean, predicted_covariance = kf.multi_predict(mean, covariance)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">std_pos</span> <span class="o">=</span> <span class="p">[</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
<span></span>    <span class="p">]</span>
<span></span>    <span class="n">std_vel</span> <span class="o">=</span> <span class="p">[</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>
<span></span>    <span class="p">]</span>
<span></span>    <span class="n">sqr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">std_pos</span><span class="p">,</span> <span class="n">std_vel</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span></span>
<span></span>    <span class="n">motion_cov</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">sqr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mean</span><span class="p">))]</span>
<span></span>    <span class="n">motion_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">motion_cov</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span></span>    <span class="n">left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span></span>    <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">motion_cov</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.predict"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.predict</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</code></pre></div><p>Run Kalman filter prediction step.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>mean</code></td><td><code>np.ndarray</code></td><td>The 8-dimensional mean vector of the object state at the previous time step.</td><td><em>required</em></td></tr><tr><td><code>covariance</code></td><td><code>np.ndarray</code></td><td>The 8x8-dimensional covariance matrix of the object state at the previous time step.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>mean (np.ndarray)</code></td><td>Mean vector of the predicted state. Unobserved velocities are initialized to 0 mean.</td></tr><tr><td><code>covariance (np.ndarray)</code></td><td>Covariance matrix of the predicted state.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">kf</span> <span class="o">=</span> <span class="n">KalmanFilterXYWH</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">predicted_mean</span><span class="p">,</span> <span class="n">predicted_covariance</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/trackers/utils/kalman_filter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py#L355-L390"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Run Kalman filter prediction step.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        mean (np.ndarray): The 8-dimensional mean vector of the object state at the previous time step.</span>
<span></span><span class="sd">        covariance (np.ndarray): The 8x8-dimensional covariance matrix of the object state at the previous time</span>
<span></span><span class="sd">            step.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        mean (np.ndarray): Mean vector of the predicted state. Unobserved velocities are initialized to 0 mean.</span>
<span></span><span class="sd">        covariance (np.ndarray): Covariance matrix of the predicted state.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; kf = KalmanFilterXYWH()</span>
<span></span><span class="sd">        &gt;&gt;&gt; mean = np.array([0, 0, 1, 1, 0, 0, 0, 0])</span>
<span></span><span class="sd">        &gt;&gt;&gt; covariance = np.eye(8)</span>
<span></span><span class="sd">        &gt;&gt;&gt; predicted_mean, predicted_covariance = kf.predict(mean, covariance)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">std_pos</span> <span class="o">=</span> <span class="p">[</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>    <span class="p">]</span>
<span></span>    <span class="n">std_vel</span> <span class="o">=</span> <span class="p">[</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_velocity</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>    <span class="p">]</span>
<span></span>    <span class="n">motion_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">std_pos</span><span class="p">,</span> <span class="n">std_vel</span><span class="p">]))</span>
<span></span>
<span></span>    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span></span>    <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">multi_dot</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="p">,</span> <span class="n">covariance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_motion_mat</span><span class="o">.</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="n">motion_cov</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.project"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.project</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</code></pre></div><p>Project state distribution to measurement space.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>mean</code></td><td><code>np.ndarray</code></td><td>The state's mean vector (8 dimensional array).</td><td><em>required</em></td></tr><tr><td><code>covariance</code></td><td><code>np.ndarray</code></td><td>The state's covariance matrix (8x8 dimensional).</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>mean (np.ndarray)</code></td><td>Projected mean of the given state estimate.</td></tr><tr><td><code>covariance (np.ndarray)</code></td><td>Projected covariance matrix of the given state estimate.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">kf</span> <span class="o">=</span> <span class="n">KalmanFilterXYWH</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">projected_mean</span><span class="p">,</span> <span class="n">projected_cov</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/trackers/utils/kalman_filter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py#L392-L419"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Project state distribution to measurement space.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        mean (np.ndarray): The state's mean vector (8 dimensional array).</span>
<span></span><span class="sd">        covariance (np.ndarray): The state's covariance matrix (8x8 dimensional).</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        mean (np.ndarray): Projected mean of the given state estimate.</span>
<span></span><span class="sd">        covariance (np.ndarray): Projected covariance matrix of the given state estimate.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; kf = KalmanFilterXYWH()</span>
<span></span><span class="sd">        &gt;&gt;&gt; mean = np.array([0, 0, 1, 1, 0, 0, 0, 0])</span>
<span></span><span class="sd">        &gt;&gt;&gt; covariance = np.eye(8)</span>
<span></span><span class="sd">        &gt;&gt;&gt; projected_mean, projected_cov = kf.project(mean, covariance)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">std</span> <span class="o">=</span> <span class="p">[</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_std_weight_position</span> <span class="o">*</span> <span class="n">mean</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<span></span>    <span class="p">]</span>
<span></span>    <span class="n">innovation_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">std</span><span class="p">))</span>
<span></span>
<span></span>    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>
<span></span>    <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">multi_dot</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="p">,</span> <span class="n">covariance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_mat</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
<span></span>    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span> <span class="o">+</span> <span class="n">innovation_cov</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.update"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.trackers.utils.kalman_filter.KalmanFilterXYWH.update</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">measurement</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</code></pre></div><p>Run Kalman filter correction step.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>mean</code></td><td><code>np.ndarray</code></td><td>The predicted state's mean vector (8 dimensional).</td><td><em>required</em></td></tr><tr><td><code>covariance</code></td><td><code>np.ndarray</code></td><td>The state's covariance matrix (8x8 dimensional).</td><td><em>required</em></td></tr><tr><td><code>measurement</code></td><td><code>np.ndarray</code></td><td>The 4 dimensional measurement vector (x, y, w, h), where (x, y) is the center position, w the width, and h the height of the bounding box.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>new_mean (np.ndarray)</code></td><td>Measurement-corrected state mean.</td></tr><tr><td><code>new_covariance (np.ndarray)</code></td><td>Measurement-corrected state covariance.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">kf</span> <span class="o">=</span> <span class="n">KalmanFilterXYWH</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">measurement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">new_mean</span><span class="p">,</span> <span class="n">new_covariance</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">,</span> <span class="n">measurement</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/trackers/utils/kalman_filter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/trackers/utils/kalman_filter.py#L461-L481"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">covariance</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">measurement</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Run Kalman filter correction step.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        mean (np.ndarray): The predicted state's mean vector (8 dimensional).</span>
<span></span><span class="sd">        covariance (np.ndarray): The state's covariance matrix (8x8 dimensional).</span>
<span></span><span class="sd">        measurement (np.ndarray): The 4 dimensional measurement vector (x, y, w, h), where (x, y) is the center</span>
<span></span><span class="sd">            position, w the width, and h the height of the bounding box.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        new_mean (np.ndarray): Measurement-corrected state mean.</span>
<span></span><span class="sd">        new_covariance (np.ndarray): Measurement-corrected state covariance.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; kf = KalmanFilterXYWH()</span>
<span></span><span class="sd">        &gt;&gt;&gt; mean = np.array([0, 0, 1, 1, 0, 0, 0, 0])</span>
<span></span><span class="sd">        &gt;&gt;&gt; covariance = np.eye(8)</span>
<span></span><span class="sd">        &gt;&gt;&gt; measurement = np.array([0.5, 0.5, 1.2, 1.2])</span>
<span></span><span class="sd">        &gt;&gt;&gt; new_mean, new_covariance = kf.update(mean, covariance, measurement)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">,</span> <span class="n">measurement</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/></p><br/><br/><div class="git-info"><div class="dates-container"><span class="date-item" title="This page was first created on November 12, 2023"><span class="hover-item">ğŸ“…</span> Created 2 years ago </span><span class="date-item" title="This page was last updated on November 23, 2025"><span class="hover-item">âœï¸</span> Updated 8 days ago </span></div><div class="authors-container"><a class="author-link" href="https://github.com/glenn-jocher" title="glenn-jocher (7 changes)"><img alt="glenn-jocher" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/26833433?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/jk4e" title="jk4e (1 change)"><img alt="jk4e" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/116908874?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/Burhan-Q" title="Burhan-Q (1 change)"><img alt="Burhan-Q" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62214284?v=4&amp;s=96"/></a></div></div><div class="share-buttons"><button class="share-button hover-item" onclick="window.open('https://twitter.com/intent/tweet?url=https%3A%2F%2Fdocs.ultralytics.com%2Freference%2Ftrackers%2Futils%2Fkalman_filter%2F', 'TwitterShare', 'width=550,height=680,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-x-twitter"></i> Tweet </button><button class="share-button hover-item linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fdocs.ultralytics.com%2Freference%2Ftrackers%2Futils%2Fkalman_filter%2F', 'LinkedinShare', 'width=550,height=730,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-linkedin-in"></i> Share </button></div><br/></article></div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div><button class="md-top md-icon" data-md-component="top" hidden="" type="button"><svg class="lucide lucide-circle-arrow-up" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10"></circle><path d="m16 12-4-4-4 4M12 16V8"></path></svg> Back to top
</button></main><footer class="md-footer"><nav aria-label="Footer" class="md-footer__inner md-grid"><a aria-label="Previous: gmc" class="md-footer__link md-footer__link--prev" href="../gmc/"><div class="md-footer__button md-icon"><svg class="lucide lucide-arrow-left" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12 19-7-7 7-7M19 12H5"></path></svg></div><div class="md-footer__title"><span class="md-footer__direction"> Previous </span><div class="md-ellipsis"> gmc </div></div></a><a aria-label="Next: matching" class="md-footer__link md-footer__link--next" href="../matching/"><div class="md-footer__title"><span class="md-footer__direction"> Next </span><div class="md-ellipsis"> matching </div></div><div class="md-footer__button md-icon"><svg class="lucide lucide-arrow-right" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 12h14M12 5l7 7-7 7"></path></svg></div></a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-copyright"><div class="md-copyright__highlight"><a href="https://www.ultralytics.com/" target="_blank">Â© 2025 Ultralytics Inc.</a> All rights reserved. </div> Made with <a href="https://zensical.org/" rel="noopener" target="_blank"> Zensical </a></div><div class="md-social"><a class="md-social__link" href="https://github.com/ultralytics" rel="noopener" target="_blank" title="github.com"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://www.linkedin.com/company/ultralytics/" rel="noopener" target="_blank" title="www.linkedin.com"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://x.com/ultralytics" rel="noopener" target="_blank" title="x.com"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://youtube.com/ultralytics?sub_confirmation=1" rel="noopener" target="_blank" title="youtube.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://hub.docker.com/r/ultralytics/ultralytics/" rel="noopener" target="_blank" title="hub.docker.com"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://pypi.org/project/ultralytics/" rel="noopener" target="_blank" title="pypi.org"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://discord.com/invite/ultralytics" rel="noopener" target="_blank" title="discord.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://reddit.com/r/ultralytics" rel="noopener" target="_blank" title="reddit.com"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://weixin.qq.com/r/mp/LxckPDfEgWr_rXNf90I9" rel="noopener" target="_blank" title="weixin.qq.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6" fill="currentColor"></path></svg></a></div></div></div></footer></div><div class="md-dialog" data-md-component="dialog"><div class="md-dialog__inner md-typeset"></div></div><div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"annotate":null,"base":"../../../..","features":["content.action.edit","content.code.annotate","content.code.copy","content.tooltips","toc.follow","navigation.top","navigation.tabs","navigation.tabs.sticky","navigation.prune","navigation.footer","navigation.tracking","navigation.instant","navigation.instant.progress","navigation.indexes","navigation.sections","content.tabs.link"],"search":"../../../../assets/javascripts/workers/search.5df7522c.min.js","tags":null,"translations":{"clipboard.copied":"Copied to clipboard","clipboard.copy":"Copy to clipboard","search.result.more.one":"1 more on this page","search.result.more.other":"# more on this page","search.result.none":"No matching documents","search.result.one":"1 matching document","search.result.other":"# matching documents","search.result.placeholder":"Type to start searching","search.result.term.missing":"Missing","select.version":"Select version"},"version":null}</script>
<script src="../../../../assets/javascripts/bundle.21aa498e.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/ultralytics/llm@v0.1.2/js/chat.min.js"></script>
<script src="https://unpkg.com/tablesort@5.6.0/dist/tablesort.min.js"></script>
<script src="../../../../javascript/extra.js"></script>
<script src="../../../../javascript/giscus.js"></script>
<script src="../../../../javascript/tablesort.js"></script>
</body></html>