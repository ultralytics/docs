<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Explore Ultralytics image augmentation techniques like MixUp, Mosaic, and Random Perspective for enhancing model training. Improve your deep learning models now." name="description"/>
<meta content="Ultralytics" name="author"/>
<link href="https://docs.ultralytics.com/reference/data/augment/" rel="canonical"/>
<link href="../annotator/" rel="prev"/>
<link href="../base/" rel="next"/>
<link href="https://raw.githubusercontent.com/ultralytics/assets/refs/heads/main/logo/favicon-yolo.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.12" name="generator"/>
<title>Reference for ultralytics/data/augment.py - Ultralytics YOLO Docs</title>
<link href="../../../assets/stylesheets/main.2afb09e1.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../assets/_mkdocstrings.css" rel="stylesheet"/>
<link href="../../../stylesheets/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2M5EHKC0BH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2M5EHKC0BH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2M5EHKC0BH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
<meta content="augment" name="title"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"/><meta content="Ultralytics, image augmentation, MixUp, Mosaic, Random Perspective, deep learning, model training, YOLO" name="keywords"/><meta content="website" property="og:type"/><meta content="https://docs.ultralytics.com/reference/data/augment" property="og:url"/><meta content="augment" property="og:title"/><meta content="Explore Ultralytics image augmentation techniques like MixUp, Mosaic, and Random Perspective for enhancing model training. Improve your deep learning models now." property="og:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="og:image"/><meta content="summary_large_image" property="twitter:card"/><meta content="https://docs.ultralytics.com/reference/data/augment" property="twitter:url"/><meta content="augment" property="twitter:title"/><meta content="Explore Ultralytics image augmentation techniques like MixUp, Mosaic, and Random Perspective for enhancing model training. Improve your deep learning models now." property="twitter:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="twitter:image"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "headline": "augment", "image": ["https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png"], "datePublished": "2023-11-12 02:49:37 +0100", "dateModified": "2025-03-31 13:50:01 +0500", "author": [{"@type": "Organization", "name": "Ultralytics", "url": "https://ultralytics.com/"}], "abstract": "Explore Ultralytics image augmentation techniques like MixUp, Mosaic, and Random Perspective for enhancing model training. Improve your deep learning models now."}</script></head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#reference-for-ultralyticsdataaugmentpy">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
<aside class="md-banner">
<div class="md-banner__inner md-grid md-typeset">
<div class="banner-wrapper">
<div class="banner-content-wrapper" onclick="window.open('https://docs.ultralytics.com/models/yolo11/')">
<p>Introducing</p>
<img alt="Ultralytics YOLO11" height="40" loading="lazy" src="https://assets-global.website-files.com/646dd1f1a3703e451ba81ecc/67d044caa316aa50fba40a08_Ultralytics_YOLO11_Logotype_Reverse.svg"/>
</div>
</div>
</div>
</aside>
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Ultralytics YOLO Docs" class="md-header__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs">
<img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Ultralytics YOLO Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
              augment
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    ultralytics/ultralytics
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
  Home
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../quickstart/">
  Quickstart
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../modes/">
  Modes
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../tasks/">
  Tasks
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../models/">
  Models
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../datasets/">
  Datasets
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../solutions/">
  Solutions 🚀
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../guides/">
  Guides
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../integrations/">
  Integrations
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../hub/">
  HUB
        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../../cfg/__init__/">
  Reference
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../help/">
  Help
        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Ultralytics YOLO Docs" class="md-nav__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs">
<img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/>
</a>
    Ultralytics YOLO Docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    ultralytics/ultralytics
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Home
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../quickstart/">
<span class="md-ellipsis">
    Quickstart
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../modes/">
<span class="md-ellipsis">
    Modes
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../tasks/">
<span class="md-ellipsis">
    Tasks
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../models/">
<span class="md-ellipsis">
    Models
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../datasets/">
<span class="md-ellipsis">
    Datasets
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../solutions/">
<span class="md-ellipsis">
    Solutions 🚀
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../guides/">
<span class="md-ellipsis">
    Guides
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../integrations/">
<span class="md-ellipsis">
    Integrations
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../hub/">
<span class="md-ellipsis">
    HUB
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_11" type="checkbox"/>
<label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="">
<span class="md-ellipsis">
    Reference
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_11_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_11">
<span class="md-nav__icon md-icon"></span>
            Reference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_1" id="__nav_11_1_label" tabindex="">
<span class="md-ellipsis">
    cfg
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_1">
<span class="md-nav__icon md-icon"></span>
            cfg
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../cfg/__init__/">
<span class="md-ellipsis">
    __init__
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_11_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex="">
<span class="md-ellipsis">
    data
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_11_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_2">
<span class="md-nav__icon md-icon"></span>
            data
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../annotator/">
<span class="md-ellipsis">
    annotator
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    augment
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    augment
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseTransform">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> BaseTransform
    </span>
</a>
<nav aria-label=" BaseTransform" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseTransform.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseTransform.apply_image">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> apply_image
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseTransform.apply_instances">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> apply_instances
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseTransform.apply_semantic">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> apply_semantic
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> Compose
    </span>
</a>
<nav aria-label=" Compose" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose.__getitem__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __getitem__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose.__repr__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __repr__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose.__setitem__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __setitem__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose.append">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> append
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose.insert">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> insert
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose.tolist">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> tolist
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseMixTransform">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> BaseMixTransform
    </span>
</a>
<nav aria-label=" BaseMixTransform" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseMixTransform.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseMixTransform.get_indexes">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> get_indexes
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Mosaic">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> Mosaic
    </span>
</a>
<nav aria-label=" Mosaic" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Mosaic.get_indexes">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> get_indexes
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.MixUp">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> MixUp
    </span>
</a>
<nav aria-label=" MixUp" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.MixUp.get_indexes">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> get_indexes
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomPerspective">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> RandomPerspective
    </span>
</a>
<nav aria-label=" RandomPerspective" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomPerspective.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomPerspective.affine_transform">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> affine_transform
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomPerspective.apply_bboxes">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> apply_bboxes
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomPerspective.apply_keypoints">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> apply_keypoints
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomPerspective.apply_segments">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> apply_segments
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomPerspective.box_candidates">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> box_candidates
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomHSV">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> RandomHSV
    </span>
</a>
<nav aria-label=" RandomHSV" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomHSV.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomFlip">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> RandomFlip
    </span>
</a>
<nav aria-label=" RandomFlip" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomFlip.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.LetterBox">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> LetterBox
    </span>
</a>
<nav aria-label=" LetterBox" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.LetterBox.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.CopyPaste">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> CopyPaste
    </span>
</a>
<nav aria-label=" CopyPaste" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.CopyPaste.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.CopyPaste.get_indexes">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> get_indexes
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Albumentations">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> Albumentations
    </span>
</a>
<nav aria-label=" Albumentations" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Albumentations.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Format">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> Format
    </span>
</a>
<nav aria-label=" Format" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Format.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.LoadVisualPrompt">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> LoadVisualPrompt
    </span>
</a>
<nav aria-label=" LoadVisualPrompt" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.LoadVisualPrompt.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.LoadVisualPrompt.get_visuals">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> get_visuals
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.LoadVisualPrompt.make_mask">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> make_mask
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomLoadText">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> RandomLoadText
    </span>
</a>
<nav aria-label=" RandomLoadText" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomLoadText.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.ClassifyLetterBox">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> ClassifyLetterBox
    </span>
</a>
<nav aria-label=" ClassifyLetterBox" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.ClassifyLetterBox.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.CenterCrop">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> CenterCrop
    </span>
</a>
<nav aria-label=" CenterCrop" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.CenterCrop.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.ToTensor">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> ToTensor
    </span>
</a>
<nav aria-label=" ToTensor" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.ToTensor.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.v8_transforms">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code> v8_transforms
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.classify_transforms">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code> classify_transforms
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.classify_augmentations">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code> classify_augmentations
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../base/">
<span class="md-ellipsis">
    base
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../build/">
<span class="md-ellipsis">
    build
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../converter/">
<span class="md-ellipsis">
    converter
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dataset/">
<span class="md-ellipsis">
    dataset
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../loaders/">
<span class="md-ellipsis">
    loaders
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../split/">
<span class="md-ellipsis">
    split
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../split_dota/">
<span class="md-ellipsis">
    split_dota
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../utils/">
<span class="md-ellipsis">
    utils
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex="">
<span class="md-ellipsis">
    engine
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_3">
<span class="md-nav__icon md-icon"></span>
            engine
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../engine/exporter/">
<span class="md-ellipsis">
    exporter
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../engine/model/">
<span class="md-ellipsis">
    model
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../engine/predictor/">
<span class="md-ellipsis">
    predictor
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../engine/results/">
<span class="md-ellipsis">
    results
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../engine/trainer/">
<span class="md-ellipsis">
    trainer
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../engine/tuner/">
<span class="md-ellipsis">
    tuner
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../engine/validator/">
<span class="md-ellipsis">
    validator
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex="">
<span class="md-ellipsis">
    hub
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_4">
<span class="md-nav__icon md-icon"></span>
            hub
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../hub/__init__/">
<span class="md-ellipsis">
    __init__
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../hub/auth/">
<span class="md-ellipsis">
    auth
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../hub/google/__init__/">
<span class="md-ellipsis">
    google
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../hub/session/">
<span class="md-ellipsis">
    session
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../hub/utils/">
<span class="md-ellipsis">
    utils
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_5" id="__nav_11_5_label" tabindex="">
<span class="md-ellipsis">
    models
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_5">
<span class="md-nav__icon md-icon"></span>
            models
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../models/fastsam/model/">
<span class="md-ellipsis">
    fastsam
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../models/nas/model/">
<span class="md-ellipsis">
    nas
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../models/rtdetr/model/">
<span class="md-ellipsis">
    rtdetr
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../models/sam/amg/">
<span class="md-ellipsis">
    sam
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../models/utils/loss/">
<span class="md-ellipsis">
    utils
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../models/yolo/classify/predict/">
<span class="md-ellipsis">
    yolo
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_6" id="__nav_11_6_label" tabindex="">
<span class="md-ellipsis">
    nn
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_6">
<span class="md-nav__icon md-icon"></span>
            nn
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../nn/autobackend/">
<span class="md-ellipsis">
    autobackend
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../nn/modules/activation/">
<span class="md-ellipsis">
    modules
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../nn/tasks/">
<span class="md-ellipsis">
    tasks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../nn/text_model/">
<span class="md-ellipsis">
    text_model
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_7" id="__nav_11_7_label" tabindex="">
<span class="md-ellipsis">
    solutions
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_7">
<span class="md-nav__icon md-icon"></span>
            solutions
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/ai_gym/">
<span class="md-ellipsis">
    ai_gym
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/analytics/">
<span class="md-ellipsis">
    analytics
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/distance_calculation/">
<span class="md-ellipsis">
    distance_calculation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/heatmap/">
<span class="md-ellipsis">
    heatmap
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/instance_segmentation/">
<span class="md-ellipsis">
    instance_segmentation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/object_blurrer/">
<span class="md-ellipsis">
    object_blurrer
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/object_counter/">
<span class="md-ellipsis">
    object_counter
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/object_cropper/">
<span class="md-ellipsis">
    object_cropper
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/parking_management/">
<span class="md-ellipsis">
    parking_management
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/queue_management/">
<span class="md-ellipsis">
    queue_management
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/region_counter/">
<span class="md-ellipsis">
    region_counter
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/security_alarm/">
<span class="md-ellipsis">
    security_alarm
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/solutions/">
<span class="md-ellipsis">
    solutions
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/speed_estimation/">
<span class="md-ellipsis">
    speed_estimation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/streamlit_inference/">
<span class="md-ellipsis">
    streamlit_inference
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/trackzone/">
<span class="md-ellipsis">
    trackzone
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solutions/vision_eye/">
<span class="md-ellipsis">
    vision_eye
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_8" id="__nav_11_8_label" tabindex="">
<span class="md-ellipsis">
    trackers
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_8_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_8">
<span class="md-nav__icon md-icon"></span>
            trackers
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../trackers/basetrack/">
<span class="md-ellipsis">
    basetrack
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../trackers/bot_sort/">
<span class="md-ellipsis">
    bot_sort
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../trackers/byte_tracker/">
<span class="md-ellipsis">
    byte_tracker
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../trackers/track/">
<span class="md-ellipsis">
    track
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../trackers/utils/gmc/">
<span class="md-ellipsis">
    utils
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_11_9" id="__nav_11_9_label" tabindex="">
<span class="md-ellipsis">
    utils
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_11_9_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_11_9">
<span class="md-nav__icon md-icon"></span>
            utils
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/__init__/">
<span class="md-ellipsis">
    __init__
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/autobatch/">
<span class="md-ellipsis">
    autobatch
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/benchmarks/">
<span class="md-ellipsis">
    benchmarks
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../utils/callbacks/base/">
<span class="md-ellipsis">
    callbacks
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/checks/">
<span class="md-ellipsis">
    checks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/dist/">
<span class="md-ellipsis">
    dist
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/downloads/">
<span class="md-ellipsis">
    downloads
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/errors/">
<span class="md-ellipsis">
    errors
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/export/">
<span class="md-ellipsis">
    export
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/files/">
<span class="md-ellipsis">
    files
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/instance/">
<span class="md-ellipsis">
    instance
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/loss/">
<span class="md-ellipsis">
    loss
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/metrics/">
<span class="md-ellipsis">
    metrics
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/ops/">
<span class="md-ellipsis">
    ops
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/patches/">
<span class="md-ellipsis">
    patches
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/plotting/">
<span class="md-ellipsis">
    plotting
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/tal/">
<span class="md-ellipsis">
    tal
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/torch_utils/">
<span class="md-ellipsis">
    torch_utils
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/triton/">
<span class="md-ellipsis">
    triton
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../utils/tuner/">
<span class="md-ellipsis">
    tuner
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../help/">
<span class="md-ellipsis">
    Help
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseTransform">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> BaseTransform
    </span>
</a>
<nav aria-label=" BaseTransform" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseTransform.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseTransform.apply_image">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> apply_image
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseTransform.apply_instances">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> apply_instances
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseTransform.apply_semantic">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> apply_semantic
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> Compose
    </span>
</a>
<nav aria-label=" Compose" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose.__getitem__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __getitem__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose.__repr__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __repr__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose.__setitem__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __setitem__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose.append">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> append
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose.insert">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> insert
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Compose.tolist">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> tolist
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseMixTransform">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> BaseMixTransform
    </span>
</a>
<nav aria-label=" BaseMixTransform" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseMixTransform.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.BaseMixTransform.get_indexes">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> get_indexes
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Mosaic">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> Mosaic
    </span>
</a>
<nav aria-label=" Mosaic" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Mosaic.get_indexes">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> get_indexes
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.MixUp">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> MixUp
    </span>
</a>
<nav aria-label=" MixUp" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.MixUp.get_indexes">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> get_indexes
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomPerspective">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> RandomPerspective
    </span>
</a>
<nav aria-label=" RandomPerspective" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomPerspective.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomPerspective.affine_transform">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> affine_transform
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomPerspective.apply_bboxes">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> apply_bboxes
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomPerspective.apply_keypoints">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> apply_keypoints
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomPerspective.apply_segments">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> apply_segments
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomPerspective.box_candidates">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> box_candidates
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomHSV">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> RandomHSV
    </span>
</a>
<nav aria-label=" RandomHSV" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomHSV.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomFlip">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> RandomFlip
    </span>
</a>
<nav aria-label=" RandomFlip" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomFlip.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.LetterBox">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> LetterBox
    </span>
</a>
<nav aria-label=" LetterBox" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.LetterBox.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.CopyPaste">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> CopyPaste
    </span>
</a>
<nav aria-label=" CopyPaste" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.CopyPaste.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.CopyPaste.get_indexes">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> get_indexes
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Albumentations">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> Albumentations
    </span>
</a>
<nav aria-label=" Albumentations" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Albumentations.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Format">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> Format
    </span>
</a>
<nav aria-label=" Format" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.Format.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.LoadVisualPrompt">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> LoadVisualPrompt
    </span>
</a>
<nav aria-label=" LoadVisualPrompt" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.LoadVisualPrompt.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.LoadVisualPrompt.get_visuals">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> get_visuals
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.LoadVisualPrompt.make_mask">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> make_mask
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomLoadText">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> RandomLoadText
    </span>
</a>
<nav aria-label=" RandomLoadText" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.RandomLoadText.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.ClassifyLetterBox">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> ClassifyLetterBox
    </span>
</a>
<nav aria-label=" ClassifyLetterBox" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.ClassifyLetterBox.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.CenterCrop">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> CenterCrop
    </span>
</a>
<nav aria-label=" CenterCrop" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.CenterCrop.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.ToTensor">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-class"></code> ToTensor
    </span>
</a>
<nav aria-label=" ToTensor" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.ToTensor.__call__">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-method"></code> __call__
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.v8_transforms">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code> v8_transforms
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.classify_transforms">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code> classify_transforms
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ultralytics.data.augment.classify_augmentations">
<span class="md-ellipsis">
<code class="doc-symbol doc-symbol-toc doc-symbol-function"></code> classify_augmentations
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/ultralytics/ultralytics/tree/main/docs/en/reference/data/augment.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
</a>
<h1 id="reference-for-ultralyticsdataaugmentpy">Reference for <code>ultralytics/data/augment.py</code></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This file is available at <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/augment.py">https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/augment.py</a>. If you spot a problem please help fix it by <a href="https://docs.ultralytics.com/help/contributing/">contributing</a> a <a href="https://github.com/ultralytics/ultralytics/edit/main/ultralytics/data/augment.py">Pull Request</a> 🛠️. Thank you 🙏!</p>
</div>
<p><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.BaseTransform">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.BaseTransform</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">BaseTransform</span><span class="p">()</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Base class for image transformations in the Ultralytics library.</p>
<p>This class serves as a foundation for implementing various image processing operations, designed to be
compatible with both classification and semantic segmentation tasks.</p>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.BaseTransform.apply_image" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;apply_image&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.BaseTransform.apply_image&lt;/code&gt;)'>apply_image</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies image transformations to labels.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.BaseTransform.apply_instances" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;apply_instances&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.BaseTransform.apply_instances&lt;/code&gt;)'>apply_instances</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies transformations to object instances in labels.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.BaseTransform.apply_semantic" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;apply_semantic&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.BaseTransform.apply_semantic&lt;/code&gt;)'>apply_semantic</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies semantic segmentation to an image.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.BaseTransform.__call__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__call__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.BaseTransform.__call__&lt;/code&gt;)'>__call__</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies all label transformations to an image, instances, and semantic masks.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">BaseTransform</span><span class="p">()</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"image"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="o">...</span><span class="p">),</span> <span class="s2">"instances"</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="s2">"semantic"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="o">...</span><span class="p">)}</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed_labels</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</code></pre></div>
<p>This constructor sets up the base transformation object, which can be extended for specific image
processing tasks. It is designed to be compatible with both classification and semantic segmentation.</p>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">BaseTransform</span><span class="p">()</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>45</span>
<span>46</span>
<span>47</span>
<span>48</span>
<span>49</span>
<span>50</span>
<span>51</span>
<span>52</span>
<span>53</span>
<span>54</span>
<span>55</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initializes the BaseTransform object.</span>
<span></span>
<span></span><span class="sd">    This constructor sets up the base transformation object, which can be extended for specific image</span>
<span></span><span class="sd">    processing tasks. It is designed to be compatible with both classification and semantic segmentation.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = BaseTransform()</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.BaseTransform.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">labels</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Applies all label transformations to an image, instances, and semantic masks.</p>
<p>This method orchestrates the application of various transformations defined in the BaseTransform class
to the input labels. It sequentially calls the apply_image and apply_instances methods to process the
image and object instances, respectively.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>labels</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A dictionary containing image data and annotations. Expected keys include 'img' for
the image data, and 'instances' for object instances.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The input labels dictionary with transformed image and instances.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">BaseTransform</span><span class="p">()</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"img"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s2">"instances"</span><span class="p">:</span> <span class="p">[]}</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed_labels</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>121</span>
<span>122</span>
<span>123</span>
<span>124</span>
<span>125</span>
<span>126</span>
<span>127</span>
<span>128</span>
<span>129</span>
<span>130</span>
<span>131</span>
<span>132</span>
<span>133</span>
<span>134</span>
<span>135</span>
<span>136</span>
<span>137</span>
<span>138</span>
<span>139</span>
<span>140</span>
<span>141</span>
<span>142</span>
<span>143</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Applies all label transformations to an image, instances, and semantic masks.</span>
<span></span>
<span></span><span class="sd">    This method orchestrates the application of various transformations defined in the BaseTransform class</span>
<span></span><span class="sd">    to the input labels. It sequentially calls the apply_image and apply_instances methods to process the</span>
<span></span><span class="sd">    image and object instances, respectively.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels (dict): A dictionary containing image data and annotations. Expected keys include 'img' for</span>
<span></span><span class="sd">            the image data, and 'instances' for object instances.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): The input labels dictionary with transformed image and instances.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = BaseTransform()</span>
<span></span><span class="sd">        &gt;&gt;&gt; labels = {"img": np.random.rand(640, 640, 3), "instances": []}</span>
<span></span><span class="sd">        &gt;&gt;&gt; transformed_labels = transform(labels)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">apply_image</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">apply_instances</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">apply_semantic</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.BaseTransform.apply_image">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">apply_image</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">apply_image</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Applies image transformations to labels.</p>
<p>This method is intended to be overridden by subclasses to implement specific image transformation
logic. In its base form, it returns the input labels unchanged.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>labels</code>
</td>
<td>
<code><span title="Any">Any</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The input labels to be transformed. The exact type and structure of labels may
vary depending on the specific implementation.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="Any">Any</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The transformed labels. In the base implementation, this is identical to the input.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">BaseTransform</span><span class="p">()</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">original_labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed_labels</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply_image</span><span class="p">(</span><span class="n">original_labels</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">transformed_labels</span><span class="p">)</span>
<span></span><span class="go">[1, 2, 3]</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>57</span>
<span>58</span>
<span>59</span>
<span>60</span>
<span>61</span>
<span>62</span>
<span>63</span>
<span>64</span>
<span>65</span>
<span>66</span>
<span>67</span>
<span>68</span>
<span>69</span>
<span>70</span>
<span>71</span>
<span>72</span>
<span>73</span>
<span>74</span>
<span>75</span>
<span>76</span>
<span>77</span>
<span>78</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">apply_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Applies image transformations to labels.</span>
<span></span>
<span></span><span class="sd">    This method is intended to be overridden by subclasses to implement specific image transformation</span>
<span></span><span class="sd">    logic. In its base form, it returns the input labels unchanged.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels (Any): The input labels to be transformed. The exact type and structure of labels may</span>
<span></span><span class="sd">            vary depending on the specific implementation.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Any): The transformed labels. In the base implementation, this is identical to the input.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = BaseTransform()</span>
<span></span><span class="sd">        &gt;&gt;&gt; original_labels = [1, 2, 3]</span>
<span></span><span class="sd">        &gt;&gt;&gt; transformed_labels = transform.apply_image(original_labels)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(transformed_labels)</span>
<span></span><span class="sd">        [1, 2, 3]</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.BaseTransform.apply_instances">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">apply_instances</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">apply_instances</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Applies transformations to object instances in labels.</p>
<p>This method is responsible for applying various transformations to object instances within the given
labels. It is designed to be overridden by subclasses to implement specific instance transformation
logic.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>labels</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A dictionary containing label information, including object instances.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The modified labels dictionary with transformed object instances.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">BaseTransform</span><span class="p">()</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"instances"</span><span class="p">:</span> <span class="n">Instances</span><span class="p">(</span><span class="n">xyxy</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="bp">cls</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,)))}</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed_labels</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply_instances</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>80</span>
<span>81</span>
<span>82</span>
<span>83</span>
<span>84</span>
<span>85</span>
<span>86</span>
<span>87</span>
<span>88</span>
<span>89</span>
<span>90</span>
<span>91</span>
<span>92</span>
<span>93</span>
<span>94</span>
<span>95</span>
<span>96</span>
<span>97</span>
<span>98</span>
<span>99</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">apply_instances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Applies transformations to object instances in labels.</span>
<span></span>
<span></span><span class="sd">    This method is responsible for applying various transformations to object instances within the given</span>
<span></span><span class="sd">    labels. It is designed to be overridden by subclasses to implement specific instance transformation</span>
<span></span><span class="sd">    logic.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels (dict): A dictionary containing label information, including object instances.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): The modified labels dictionary with transformed object instances.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = BaseTransform()</span>
<span></span><span class="sd">        &gt;&gt;&gt; labels = {"instances": Instances(xyxy=torch.rand(5, 4), cls=torch.randint(0, 80, (5,)))}</span>
<span></span><span class="sd">        &gt;&gt;&gt; transformed_labels = transform.apply_instances(labels)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.BaseTransform.apply_semantic">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">apply_semantic</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">apply_semantic</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Applies semantic segmentation transformations to an image.</p>
<p>This method is intended to be overridden by subclasses to implement specific semantic segmentation
transformations. In its base form, it does not perform any operations.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>labels</code>
</td>
<td>
<code><span title="Any">Any</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The input labels or semantic segmentation mask to be transformed.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="Any">Any</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The transformed semantic segmentation mask or labels.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">BaseTransform</span><span class="p">()</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">semantic_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed_mask</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply_semantic</span><span class="p">(</span><span class="n">semantic_mask</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>101</span>
<span>102</span>
<span>103</span>
<span>104</span>
<span>105</span>
<span>106</span>
<span>107</span>
<span>108</span>
<span>109</span>
<span>110</span>
<span>111</span>
<span>112</span>
<span>113</span>
<span>114</span>
<span>115</span>
<span>116</span>
<span>117</span>
<span>118</span>
<span>119</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">apply_semantic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Applies semantic segmentation transformations to an image.</span>
<span></span>
<span></span><span class="sd">    This method is intended to be overridden by subclasses to implement specific semantic segmentation</span>
<span></span><span class="sd">    transformations. In its base form, it does not perform any operations.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels (Any): The input labels or semantic segmentation mask to be transformed.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Any): The transformed semantic segmentation mask or labels.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = BaseTransform()</span>
<span></span><span class="sd">        &gt;&gt;&gt; semantic_mask = np.zeros((100, 100), dtype=np.uint8)</span>
<span></span><span class="sd">        &gt;&gt;&gt; transformed_mask = transform.apply_semantic(semantic_mask)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.Compose">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.Compose</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">Compose</span><span class="p">(</span><span class="n">transforms</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>A class for composing multiple image transformations.</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Compose.transforms">transforms</span></code></td>
<td>
<code><span title="typing.List">List</span>[<span title="Callable">Callable</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>A list of transformation functions to be applied sequentially.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.Compose.__call__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__call__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.Compose.__call__&lt;/code&gt;)'>__call__</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies a series of transformations to input data.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.Compose.append" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;append&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.Compose.append&lt;/code&gt;)'>append</a></code></td>
<td>
<div class="doc-md-description">
<p>Appends a new transform to the existing list of transforms.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.Compose.insert" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;insert&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.Compose.insert&lt;/code&gt;)'>insert</a></code></td>
<td>
<div class="doc-md-description">
<p>Inserts a new transform at a specified index in the list of transforms.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.Compose.__getitem__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__getitem__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.Compose.__getitem__&lt;/code&gt;)'>__getitem__</a></code></td>
<td>
<div class="doc-md-description">
<p>Retrieves a specific transform or a set of transforms using indexing.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.Compose.__setitem__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__setitem__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.Compose.__setitem__&lt;/code&gt;)'>__setitem__</a></code></td>
<td>
<div class="doc-md-description">
<p>Sets a specific transform or a set of transforms using indexing.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.Compose.tolist" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;tolist&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.Compose.tolist&lt;/code&gt;)'>tolist</a></code></td>
<td>
<div class="doc-md-description">
<p>Converts the list of transforms to a standard Python list.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span><span class="n">RandomFlip</span><span class="p">(),</span> <span class="n">RandomPerspective</span><span class="p">(</span><span class="mi">30</span><span class="p">)]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">(</span><span class="n">transforms</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed_data</span> <span class="o">=</span> <span class="n">compose</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CenterCrop</span><span class="p">((</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)))</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">RandomFlip</span><span class="p">())</span>
</code></pre></div>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>transforms</code>
</td>
<td>
<code><span title="typing.List">List</span>[<span title="Callable">Callable</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>A list of callable transform objects to be applied sequentially.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.augment</span><span class="w"> </span><span class="kn">import</span> <span class="n">Compose</span><span class="p">,</span> <span class="n">RandomHSV</span><span class="p">,</span> <span class="n">RandomFlip</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span><span class="n">RandomHSV</span><span class="p">(),</span> <span class="n">RandomFlip</span><span class="p">()]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">(</span><span class="n">transforms</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>169</span>
<span>170</span>
<span>171</span>
<span>172</span>
<span>173</span>
<span>174</span>
<span>175</span>
<span>176</span>
<span>177</span>
<span>178</span>
<span>179</span>
<span>180</span>
<span>181</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transforms</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initializes the Compose object with a list of transforms.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        transforms (List[Callable]): A list of callable transform objects to be applied sequentially.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics.data.augment import Compose, RandomHSV, RandomFlip</span>
<span></span><span class="sd">        &gt;&gt;&gt; transforms = [RandomHSV(), RandomFlip()]</span>
<span></span><span class="sd">        &gt;&gt;&gt; compose = Compose(transforms)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">transforms</span> <span class="o">=</span> <span class="n">transforms</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transforms</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">transforms</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.Compose.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">data</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Applies a series of transformations to input data. This method sequentially applies each transformation in the
Compose object's list of transforms to the input data.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>data</code>
</td>
<td>
<code><span title="Any">Any</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The input data to be transformed. This can be of any type, depending on the
transformations in the list.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="Any">Any</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The transformed data after applying all transformations in sequence.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span><span class="n">Transform1</span><span class="p">(),</span> <span class="n">Transform2</span><span class="p">(),</span> <span class="n">Transform3</span><span class="p">()]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">(</span><span class="n">transforms</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed_data</span> <span class="o">=</span> <span class="n">compose</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>183</span>
<span>184</span>
<span>185</span>
<span>186</span>
<span>187</span>
<span>188</span>
<span>189</span>
<span>190</span>
<span>191</span>
<span>192</span>
<span>193</span>
<span>194</span>
<span>195</span>
<span>196</span>
<span>197</span>
<span>198</span>
<span>199</span>
<span>200</span>
<span>201</span>
<span>202</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Applies a series of transformations to input data. This method sequentially applies each transformation in the</span>
<span></span><span class="sd">    Compose object's list of transforms to the input data.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        data (Any): The input data to be transformed. This can be of any type, depending on the</span>
<span></span><span class="sd">            transformations in the list.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Any): The transformed data after applying all transformations in sequence.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transforms = [Transform1(), Transform2(), Transform3()]</span>
<span></span><span class="sd">        &gt;&gt;&gt; compose = Compose(transforms)</span>
<span></span><span class="sd">        &gt;&gt;&gt; transformed_data = compose(input_data)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transforms</span><span class="p">:</span>
<span></span>        <span class="n">data</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.Compose.__getitem__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__getitem__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__getitem__</span><span class="p">(</span><span class="nf">index</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Compose</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Retrieves a specific transform or a set of transforms using indexing.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>index</code>
</td>
<td>
<code><span title="int">int</span> | <span title="typing.List">List</span>[<span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>Index or list of indices of the transforms to retrieve.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.Compose" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-class"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-class-name"&gt;ultralytics.data.augment.Compose&lt;/span&gt;'>Compose</a></code>
</td>
<td>
<div class="doc-md-description">
<p>A new Compose object containing the selected transform(s).</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Raises:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="AssertionError">AssertionError</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If the index is not of type int or list.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span><span class="n">RandomFlip</span><span class="p">(),</span> <span class="n">RandomPerspective</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">RandomHSV</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">(</span><span class="n">transforms</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">single_transform</span> <span class="o">=</span> <span class="n">compose</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Returns a Compose object with only RandomPerspective</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">multiple_transforms</span> <span class="o">=</span> <span class="n">compose</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># Returns a Compose object with RandomFlip and RandomPerspective</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>233</span>
<span>234</span>
<span>235</span>
<span>236</span>
<span>237</span>
<span>238</span>
<span>239</span>
<span>240</span>
<span>241</span>
<span>242</span>
<span>243</span>
<span>244</span>
<span>245</span>
<span>246</span>
<span>247</span>
<span>248</span>
<span>249</span>
<span>250</span>
<span>251</span>
<span>252</span>
<span>253</span>
<span>254</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">"Compose"</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Retrieves a specific transform or a set of transforms using indexing.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        index (int | List[int]): Index or list of indices of the transforms to retrieve.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Compose): A new Compose object containing the selected transform(s).</span>
<span></span>
<span></span><span class="sd">    Raises:</span>
<span></span><span class="sd">        AssertionError: If the index is not of type int or list.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transforms = [RandomFlip(), RandomPerspective(10), RandomHSV(0.5, 0.5, 0.5)]</span>
<span></span><span class="sd">        &gt;&gt;&gt; compose = Compose(transforms)</span>
<span></span><span class="sd">        &gt;&gt;&gt; single_transform = compose[1]  # Returns a Compose object with only RandomPerspective</span>
<span></span><span class="sd">        &gt;&gt;&gt; multiple_transforms = compose[0:2]  # Returns a Compose object with RandomFlip and RandomPerspective</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">)),</span> <span class="sa">f</span><span class="s2">"The indices should be either list or int type but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
<span></span>    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">index</span>
<span></span>    <span class="k">return</span> <span class="n">Compose</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">transforms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.Compose.__repr__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__repr__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__repr__</span><span class="p">()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Returns a string representation of the Compose object.</p>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A string representation of the Compose object, including the list of transforms.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span><span class="n">RandomFlip</span><span class="p">(),</span> <span class="n">RandomPerspective</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">(</span><span class="n">transforms</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">compose</span><span class="p">)</span>
<span></span><span class="go">Compose([</span>
<span></span><span class="go">    RandomFlip(),</span>
<span></span><span class="go">    RandomPerspective(degrees=10, translate=0.1, scale=0.1)</span>
<span></span><span class="go">])</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>299</span>
<span>300</span>
<span>301</span>
<span>302</span>
<span>303</span>
<span>304</span>
<span>305</span>
<span>306</span>
<span>307</span>
<span>308</span>
<span>309</span>
<span>310</span>
<span>311</span>
<span>312</span>
<span>313</span>
<span>314</span>
<span>315</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Returns a string representation of the Compose object.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (str): A string representation of the Compose object, including the list of transforms.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transforms = [RandomFlip(), RandomPerspective(degrees=10, translate=0.1, scale=0.1)]</span>
<span></span><span class="sd">        &gt;&gt;&gt; compose = Compose(transforms)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(compose)</span>
<span></span><span class="sd">        Compose([</span>
<span></span><span class="sd">            RandomFlip(),</span>
<span></span><span class="sd">            RandomPerspective(degrees=10, translate=0.1, scale=0.1)</span>
<span></span><span class="sd">        ])</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">'</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">transforms</span><span class="p">])</span><span class="si">}</span><span class="s2">)"</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.Compose.__setitem__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__setitem__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__setitem__</span><span class="p">(</span><span class="nf">index</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Sets one or more transforms in the composition using indexing.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>index</code>
</td>
<td>
<code><span title="int">int</span> | <span title="typing.List">List</span>[<span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>Index or list of indices to set transforms at.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>value</code>
</td>
<td>
<code><span title="Any">Any</span> | <span title="typing.List">List</span>[<span title="Any">Any</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>Transform or list of transforms to set at the specified index(es).</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Raises:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="AssertionError">AssertionError</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If index type is invalid, value type doesn't match index type, or index is out of range.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">([</span><span class="n">Transform1</span><span class="p">(),</span> <span class="n">Transform2</span><span class="p">(),</span> <span class="n">Transform3</span><span class="p">()])</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">NewTransform</span><span class="p">()</span>  <span class="c1"># Replace second transform</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">NewTransform1</span><span class="p">(),</span> <span class="n">NewTransform2</span><span class="p">()]</span>  <span class="c1"># Replace first two transforms</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>256</span>
<span>257</span>
<span>258</span>
<span>259</span>
<span>260</span>
<span>261</span>
<span>262</span>
<span>263</span>
<span>264</span>
<span>265</span>
<span>266</span>
<span>267</span>
<span>268</span>
<span>269</span>
<span>270</span>
<span>271</span>
<span>272</span>
<span>273</span>
<span>274</span>
<span>275</span>
<span>276</span>
<span>277</span>
<span>278</span>
<span>279</span>
<span>280</span>
<span>281</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Sets one or more transforms in the composition using indexing.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        index (int | List[int]): Index or list of indices to set transforms at.</span>
<span></span><span class="sd">        value (Any | List[Any]): Transform or list of transforms to set at the specified index(es).</span>
<span></span>
<span></span><span class="sd">    Raises:</span>
<span></span><span class="sd">        AssertionError: If index type is invalid, value type doesn't match index type, or index is out of range.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; compose = Compose([Transform1(), Transform2(), Transform3()])</span>
<span></span><span class="sd">        &gt;&gt;&gt; compose[1] = NewTransform()  # Replace second transform</span>
<span></span><span class="sd">        &gt;&gt;&gt; compose[0:2] = [NewTransform1(), NewTransform2()]  # Replace first two transforms</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">)),</span> <span class="sa">f</span><span class="s2">"The indices should be either list or int type but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
<span></span>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<span></span>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="p">(</span>
<span></span>            <span class="sa">f</span><span class="s2">"The indices should be the same type as values, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
<span></span>        <span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<span></span>        <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span>
<span></span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span></span>        <span class="k">assert</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transforms</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"list index </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> out of range </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transforms</span><span class="p">)</span><span class="si">}</span><span class="s2">."</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">transforms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.Compose.append">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">append</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">append</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Appends a new transform to the existing list of transforms.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>transform</code>
</td>
<td>
<code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.BaseTransform" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-class"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-class-name"&gt;ultralytics.data.augment.BaseTransform&lt;/span&gt;'>BaseTransform</a></code>
</td>
<td>
<div class="doc-md-description">
<p>The transformation to be added to the composition.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">([</span><span class="n">RandomFlip</span><span class="p">(),</span> <span class="n">RandomPerspective</span><span class="p">()])</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RandomHSV</span><span class="p">())</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>204</span>
<span>205</span>
<span>206</span>
<span>207</span>
<span>208</span>
<span>209</span>
<span>210</span>
<span>211</span>
<span>212</span>
<span>213</span>
<span>214</span>
<span>215</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Appends a new transform to the existing list of transforms.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        transform (BaseTransform): The transformation to be added to the composition.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; compose = Compose([RandomFlip(), RandomPerspective()])</span>
<span></span><span class="sd">        &gt;&gt;&gt; compose.append(RandomHSV())</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.Compose.insert">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">insert</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">insert</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Inserts a new transform at a specified index in the existing list of transforms.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>index</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The index at which to insert the new transform.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>transform</code>
</td>
<td>
<code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.BaseTransform" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-class"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-class-name"&gt;ultralytics.data.augment.BaseTransform&lt;/span&gt;'>BaseTransform</a></code>
</td>
<td>
<div class="doc-md-description">
<p>The transform object to be inserted.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">([</span><span class="n">Transform1</span><span class="p">(),</span> <span class="n">Transform2</span><span class="p">()])</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Transform3</span><span class="p">())</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">compose</span><span class="o">.</span><span class="n">transforms</span><span class="p">)</span>
<span></span><span class="go">3</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>217</span>
<span>218</span>
<span>219</span>
<span>220</span>
<span>221</span>
<span>222</span>
<span>223</span>
<span>224</span>
<span>225</span>
<span>226</span>
<span>227</span>
<span>228</span>
<span>229</span>
<span>230</span>
<span>231</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">transform</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Inserts a new transform at a specified index in the existing list of transforms.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        index (int): The index at which to insert the new transform.</span>
<span></span><span class="sd">        transform (BaseTransform): The transform object to be inserted.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; compose = Compose([Transform1(), Transform2()])</span>
<span></span><span class="sd">        &gt;&gt;&gt; compose.insert(1, Transform3())</span>
<span></span><span class="sd">        &gt;&gt;&gt; len(compose.transforms)</span>
<span></span><span class="sd">        3</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.Compose.tolist">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">tolist</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">tolist</span><span class="p">()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Converts the list of transforms to a standard Python list.</p>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="list">list</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A list containing all the transform objects in the Compose instance.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span><span class="n">RandomFlip</span><span class="p">(),</span> <span class="n">RandomPerspective</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">CenterCrop</span><span class="p">()]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compose</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">(</span><span class="n">transforms</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform_list</span> <span class="o">=</span> <span class="n">compose</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">transform_list</span><span class="p">))</span>
<span></span><span class="go">3</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>283</span>
<span>284</span>
<span>285</span>
<span>286</span>
<span>287</span>
<span>288</span>
<span>289</span>
<span>290</span>
<span>291</span>
<span>292</span>
<span>293</span>
<span>294</span>
<span>295</span>
<span>296</span>
<span>297</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">tolist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Converts the list of transforms to a standard Python list.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list): A list containing all the transform objects in the Compose instance.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transforms = [RandomFlip(), RandomPerspective(10), CenterCrop()]</span>
<span></span><span class="sd">        &gt;&gt;&gt; compose = Compose(transforms)</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform_list = compose.tolist()</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(len(transform_list))</span>
<span></span><span class="sd">        3</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transforms</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.BaseMixTransform">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.BaseMixTransform</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">BaseMixTransform</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">pre_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Base class for mix transformations like MixUp and Mosaic.</p>
<p>This class provides a foundation for implementing mix transformations on datasets. It handles the
probability-based application of transforms and manages the mixing of multiple images and labels.</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.BaseMixTransform.dataset">dataset</span></code></td>
<td>
<code><span title="Any">Any</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The dataset object containing images and labels.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.BaseMixTransform.pre_transform">pre_transform</span></code></td>
<td>
<code><span title="Callable">Callable</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>Optional transform to apply before mixing.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.BaseMixTransform.p">p</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of applying the mix transformation.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.BaseMixTransform.__call__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__call__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.BaseMixTransform.__call__&lt;/code&gt;)'>__call__</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies the mix transformation to the input labels.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.BaseMixTransform._mix_transform">_mix_transform</span></code></td>
<td>
<div class="doc-md-description">
<p>Abstract method to be implemented by subclasses for specific mix operations.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.BaseMixTransform.get_indexes" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;get_indexes&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.BaseMixTransform.get_indexes&lt;/code&gt;)'>get_indexes</a></code></td>
<td>
<div class="doc-md-description">
<p>Abstract method to get indexes of images to be mixed.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.BaseMixTransform._update_label_text">_update_label_text</span></code></td>
<td>
<div class="doc-md-description">
<p>Updates label text for mixed images.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">CustomMixTransform</span><span class="p">(</span><span class="n">BaseMixTransform</span><span class="p">):</span>
<span></span><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">_mix_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<span></span><span class="gp">... </span>        <span class="c1"># Implement custom mix logic here</span>
<span></span><span class="gp">... </span>        <span class="k">return</span> <span class="n">labels</span>
<span></span><span class="gp">...</span>
<span></span><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">get_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="gp">... </span>        <span class="k">return</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">YourDataset</span><span class="p">()</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">CustomMixTransform</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mixed_labels</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">original_labels</span><span class="p">)</span>
</code></pre></div>
<p>This class serves as a base for implementing mix transformations in image processing pipelines.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>dataset</code>
</td>
<td>
<code><span title="Any">Any</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The dataset object containing images and labels for mixing.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>pre_transform</code>
</td>
<td>
<code><span title="Callable">Callable</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>Optional transform to apply before mixing.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>p</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of applying the mix transformation. Should be in the range [0.0, 1.0].</p>
</div>
</td>
<td>
<code>0.0</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">YOLODataset</span><span class="p">(</span><span class="s2">"path/to/data"</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pre_transform</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">([</span><span class="n">RandomFlip</span><span class="p">(),</span> <span class="n">RandomPerspective</span><span class="p">()])</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mix_transform</span> <span class="o">=</span> <span class="n">BaseMixTransform</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">pre_transform</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>349</span>
<span>350</span>
<span>351</span>
<span>352</span>
<span>353</span>
<span>354</span>
<span>355</span>
<span>356</span>
<span>357</span>
<span>358</span>
<span>359</span>
<span>360</span>
<span>361</span>
<span>362</span>
<span>363</span>
<span>364</span>
<span>365</span>
<span>366</span>
<span>367</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">pre_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initializes the BaseMixTransform object for mix transformations like MixUp and Mosaic.</span>
<span></span>
<span></span><span class="sd">    This class serves as a base for implementing mix transformations in image processing pipelines.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        dataset (Any): The dataset object containing images and labels for mixing.</span>
<span></span><span class="sd">        pre_transform (Callable | None): Optional transform to apply before mixing.</span>
<span></span><span class="sd">        p (float): Probability of applying the mix transformation. Should be in the range [0.0, 1.0].</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; dataset = YOLODataset("path/to/data")</span>
<span></span><span class="sd">        &gt;&gt;&gt; pre_transform = Compose([RandomFlip(), RandomPerspective()])</span>
<span></span><span class="sd">        &gt;&gt;&gt; mix_transform = BaseMixTransform(dataset, pre_transform, p=0.5)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">pre_transform</span> <span class="o">=</span> <span class="n">pre_transform</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.BaseMixTransform.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">labels</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Applies pre-processing transforms and mixup/mosaic transforms to labels data.</p>
<p>This method determines whether to apply the mix transform based on a probability factor. If applied, it
selects additional images, applies pre-transforms if specified, and then performs the mix transform.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>labels</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A dictionary containing label data for an image.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The transformed labels dictionary, which may include mixed data from other images.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">BaseMixTransform</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">pre_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="p">({</span><span class="s2">"image"</span><span class="p">:</span> <span class="n">img</span><span class="p">,</span> <span class="s2">"bboxes"</span><span class="p">:</span> <span class="n">boxes</span><span class="p">,</span> <span class="s2">"cls"</span><span class="p">:</span> <span class="n">classes</span><span class="p">})</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>369</span>
<span>370</span>
<span>371</span>
<span>372</span>
<span>373</span>
<span>374</span>
<span>375</span>
<span>376</span>
<span>377</span>
<span>378</span>
<span>379</span>
<span>380</span>
<span>381</span>
<span>382</span>
<span>383</span>
<span>384</span>
<span>385</span>
<span>386</span>
<span>387</span>
<span>388</span>
<span>389</span>
<span>390</span>
<span>391</span>
<span>392</span>
<span>393</span>
<span>394</span>
<span>395</span>
<span>396</span>
<span>397</span>
<span>398</span>
<span>399</span>
<span>400</span>
<span>401</span>
<span>402</span>
<span>403</span>
<span>404</span>
<span>405</span>
<span>406</span>
<span>407</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Applies pre-processing transforms and mixup/mosaic transforms to labels data.</span>
<span></span>
<span></span><span class="sd">    This method determines whether to apply the mix transform based on a probability factor. If applied, it</span>
<span></span><span class="sd">    selects additional images, applies pre-transforms if specified, and then performs the mix transform.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels (dict): A dictionary containing label data for an image.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): The transformed labels dictionary, which may include mixed data from other images.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = BaseMixTransform(dataset, pre_transform=None, p=0.5)</span>
<span></span><span class="sd">        &gt;&gt;&gt; result = transform({"image": img, "bboxes": boxes, "cls": classes})</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
<span></span>        <span class="k">return</span> <span class="n">labels</span>
<span></span>
<span></span>    <span class="c1"># Get index of one or three other images</span>
<span></span>    <span class="n">indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_indexes</span><span class="p">()</span>
<span></span>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indexes</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<span></span>        <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">indexes</span><span class="p">]</span>
<span></span>
<span></span>    <span class="c1"># Get images information will be used for Mosaic or MixUp</span>
<span></span>    <span class="n">mix_labels</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_image_and_label</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">]</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_transform</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mix_labels</span><span class="p">):</span>
<span></span>            <span class="n">mix_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"mix_labels"</span><span class="p">]</span> <span class="o">=</span> <span class="n">mix_labels</span>
<span></span>
<span></span>    <span class="c1"># Update cls and texts</span>
<span></span>    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_label_text</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span>    <span class="c1"># Mosaic or MixUp</span>
<span></span>    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mix_transform</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span>    <span class="n">labels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"mix_labels"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">labels</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.BaseMixTransform.get_indexes">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">get_indexes</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">get_indexes</span><span class="p">()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Gets a list of shuffled indexes for mosaic augmentation.</p>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>A list of shuffled indexes from the dataset.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">BaseMixTransform</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indexes</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">get_indexes</span><span class="p">()</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span>  <span class="c1"># [3, 18, 7, 2]</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>430</span>
<span>431</span>
<span>432</span>
<span>433</span>
<span>434</span>
<span>435</span>
<span>436</span>
<span>437</span>
<span>438</span>
<span>439</span>
<span>440</span>
<span>441</span>
<span>442</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Gets a list of shuffled indexes for mosaic augmentation.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (List[int]): A list of shuffled indexes from the dataset.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = BaseMixTransform(dataset)</span>
<span></span><span class="sd">        &gt;&gt;&gt; indexes = transform.get_indexes()</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(indexes)  # [3, 18, 7, 2]</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.Mosaic">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.Mosaic</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">Mosaic</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">imgsz</span><span class="o">=</span><span class="mi">640</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.BaseMixTransform" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-class"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-class-name"&gt;ultralytics.data.augment.BaseMixTransform&lt;/span&gt;'>BaseMixTransform</a></code></p>
<p>Mosaic augmentation for image datasets.</p>
<p>This class performs mosaic augmentation by combining multiple (4 or 9) images into a single mosaic image.
The augmentation is applied to a dataset with a given probability.</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Mosaic.dataset">dataset</span></code></td>
<td>
</td>
<td>
<div class="doc-md-description">
<p>The dataset on which the mosaic augmentation is applied.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Mosaic.imgsz">imgsz</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Image size (height and width) after mosaic pipeline of a single image.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Mosaic.p">p</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of applying the mosaic augmentation. Must be in the range 0-1.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Mosaic.n">n</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The grid size, either 4 (for 2x2) or 9 (for 3x3).</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Mosaic.border">border</span></code></td>
<td>
<code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>Border size for width and height.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.Mosaic.get_indexes" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;get_indexes&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.Mosaic.get_indexes&lt;/code&gt;)'>get_indexes</a></code></td>
<td>
<div class="doc-md-description">
<p>Returns a list of random indexes from the dataset.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Mosaic._mix_transform">_mix_transform</span></code></td>
<td>
<div class="doc-md-description">
<p>Applies mixup transformation to the input image and labels.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Mosaic._mosaic3">_mosaic3</span></code></td>
<td>
<div class="doc-md-description">
<p>Creates a 1x3 image mosaic.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Mosaic._mosaic4">_mosaic4</span></code></td>
<td>
<div class="doc-md-description">
<p>Creates a 2x2 image mosaic.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Mosaic._mosaic9">_mosaic9</span></code></td>
<td>
<div class="doc-md-description">
<p>Creates a 3x3 image mosaic.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Mosaic._update_labels">_update_labels</span></code></td>
<td>
<div class="doc-md-description">
<p>Updates labels with padding.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Mosaic._cat_labels">_cat_labels</span></code></td>
<td>
<div class="doc-md-description">
<p>Concatenates labels and clips mosaic border instances.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.augment</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mosaic</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">YourDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># Your image dataset</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mosaic_aug</span> <span class="o">=</span> <span class="n">Mosaic</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">imgsz</span><span class="o">=</span><span class="mi">640</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augmented_labels</span> <span class="o">=</span> <span class="n">mosaic_aug</span><span class="p">(</span><span class="n">original_labels</span><span class="p">)</span>
</code></pre></div>
<p>This class performs mosaic augmentation by combining multiple (4 or 9) images into a single mosaic image.
The augmentation is applied to a dataset with a given probability.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>dataset</code>
</td>
<td>
<code><span title="Any">Any</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The dataset on which the mosaic augmentation is applied.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>imgsz</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Image size (height and width) after mosaic pipeline of a single image.</p>
</div>
</td>
<td>
<code>640</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>p</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of applying the mosaic augmentation. Must be in the range 0-1.</p>
</div>
</td>
<td>
<code>1.0</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>n</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The grid size, either 4 (for 2x2) or 9 (for 3x3).</p>
</div>
</td>
<td>
<code>4</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.augment</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mosaic</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">YourDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mosaic_aug</span> <span class="o">=</span> <span class="n">Mosaic</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">imgsz</span><span class="o">=</span><span class="mi">640</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>520</span>
<span>521</span>
<span>522</span>
<span>523</span>
<span>524</span>
<span>525</span>
<span>526</span>
<span>527</span>
<span>528</span>
<span>529</span>
<span>530</span>
<span>531</span>
<span>532</span>
<span>533</span>
<span>534</span>
<span>535</span>
<span>536</span>
<span>537</span>
<span>538</span>
<span>539</span>
<span>540</span>
<span>541</span>
<span>542</span>
<span>543</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">imgsz</span><span class="o">=</span><span class="mi">640</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initializes the Mosaic augmentation object.</span>
<span></span>
<span></span><span class="sd">    This class performs mosaic augmentation by combining multiple (4 or 9) images into a single mosaic image.</span>
<span></span><span class="sd">    The augmentation is applied to a dataset with a given probability.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        dataset (Any): The dataset on which the mosaic augmentation is applied.</span>
<span></span><span class="sd">        imgsz (int): Image size (height and width) after mosaic pipeline of a single image.</span>
<span></span><span class="sd">        p (float): Probability of applying the mosaic augmentation. Must be in the range 0-1.</span>
<span></span><span class="sd">        n (int): The grid size, either 4 (for 2x2) or 9 (for 3x3).</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics.data.augment import Mosaic</span>
<span></span><span class="sd">        &gt;&gt;&gt; dataset = YourDataset(...)</span>
<span></span><span class="sd">        &gt;&gt;&gt; mosaic_aug = Mosaic(dataset, imgsz=640, p=0.5, n=4)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"The probability should be in range [0, 1], but got </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">."</span>
<span></span>    <span class="k">assert</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">},</span> <span class="s2">"grid must be equal to 4 or 9."</span>
<span></span>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">imgsz</span> <span class="o">=</span> <span class="n">imgsz</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">imgsz</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">imgsz</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># width, height</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.Mosaic.get_indexes">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">get_indexes</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">get_indexes</span><span class="p">(</span><span class="n">buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Returns a list of random indexes from the dataset for mosaic augmentation.</p>
<p>This method selects random image indexes either from a buffer or from the entire dataset, depending on
the 'buffer' parameter. It is used to choose images for creating mosaic augmentations.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>buffer</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, selects images from the dataset buffer. If False, selects from the entire
dataset.</p>
</div>
</td>
<td>
<code>True</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>A list of random image indexes. The length of the list is n-1, where n is the number
of images used in the mosaic (either 3 or 8, depending on whether n is 4 or 9).</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mosaic</span> <span class="o">=</span> <span class="n">Mosaic</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">imgsz</span><span class="o">=</span><span class="mi">640</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indexes</span> <span class="o">=</span> <span class="n">mosaic</span><span class="o">.</span><span class="n">get_indexes</span><span class="p">()</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">indexes</span><span class="p">))</span>  <span class="c1"># Output: 3</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>545</span>
<span>546</span>
<span>547</span>
<span>548</span>
<span>549</span>
<span>550</span>
<span>551</span>
<span>552</span>
<span>553</span>
<span>554</span>
<span>555</span>
<span>556</span>
<span>557</span>
<span>558</span>
<span>559</span>
<span>560</span>
<span>561</span>
<span>562</span>
<span>563</span>
<span>564</span>
<span>565</span>
<span>566</span>
<span>567</span>
<span>568</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Returns a list of random indexes from the dataset for mosaic augmentation.</span>
<span></span>
<span></span><span class="sd">    This method selects random image indexes either from a buffer or from the entire dataset, depending on</span>
<span></span><span class="sd">    the 'buffer' parameter. It is used to choose images for creating mosaic augmentations.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        buffer (bool): If True, selects images from the dataset buffer. If False, selects from the entire</span>
<span></span><span class="sd">            dataset.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (List[int]): A list of random image indexes. The length of the list is n-1, where n is the number</span>
<span></span><span class="sd">            of images used in the mosaic (either 3 or 8, depending on whether n is 4 or 9).</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; mosaic = Mosaic(dataset, imgsz=640, p=1.0, n=4)</span>
<span></span><span class="sd">        &gt;&gt;&gt; indexes = mosaic.get_indexes()</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(len(indexes))  # Output: 3</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="n">buffer</span><span class="p">:</span>  <span class="c1"># select images from buffer</span>
<span></span>        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">buffer</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># select any images</span>
<span></span>        <span class="k">return</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.MixUp">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.MixUp</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">MixUp</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">pre_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.BaseMixTransform" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-class"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-class-name"&gt;ultralytics.data.augment.BaseMixTransform&lt;/span&gt;'>BaseMixTransform</a></code></p>
<p>Applies MixUp augmentation to image datasets.</p>
<p>This class implements the MixUp augmentation technique as described in the paper <a href="https://arxiv.org/abs/1710.09412">mixup: Beyond Empirical Risk
Minimization</a>. MixUp combines two images and their labels using a random weight.</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.MixUp.dataset">dataset</span></code></td>
<td>
<code><span title="Any">Any</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The dataset to which MixUp augmentation will be applied.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.MixUp.pre_transform">pre_transform</span></code></td>
<td>
<code><span title="Callable">Callable</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>Optional transform to apply before MixUp.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.MixUp.p">p</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of applying MixUp augmentation.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.MixUp.get_indexes" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;get_indexes&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.MixUp.get_indexes&lt;/code&gt;)'>get_indexes</a></code></td>
<td>
<div class="doc-md-description">
<p>Returns a random index from the dataset.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.MixUp._mix_transform">_mix_transform</span></code></td>
<td>
<div class="doc-md-description">
<p>Applies MixUp augmentation to the input labels.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.augment</span><span class="w"> </span><span class="kn">import</span> <span class="n">MixUp</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">YourDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># Your image dataset</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mixup</span> <span class="o">=</span> <span class="n">MixUp</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augmented_labels</span> <span class="o">=</span> <span class="n">mixup</span><span class="p">(</span><span class="n">original_labels</span><span class="p">)</span>
</code></pre></div>
<p>MixUp is an image augmentation technique that combines two images by taking a weighted sum of their pixel
values and labels. This implementation is designed for use with the Ultralytics YOLO framework.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>dataset</code>
</td>
<td>
<code><span title="Any">Any</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The dataset to which MixUp augmentation will be applied.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>pre_transform</code>
</td>
<td>
<code><span title="Callable">Callable</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>Optional transform to apply to images before MixUp.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>p</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of applying MixUp augmentation to an image. Must be in the range [0, 1].</p>
</div>
</td>
<td>
<code>0.0</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">YOLODataset</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">YOLODataset</span><span class="p">(</span><span class="s2">"path/to/data.yaml"</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mixup</span> <span class="o">=</span> <span class="n">MixUp</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">pre_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>890</span>
<span>891</span>
<span>892</span>
<span>893</span>
<span>894</span>
<span>895</span>
<span>896</span>
<span>897</span>
<span>898</span>
<span>899</span>
<span>900</span>
<span>901</span>
<span>902</span>
<span>903</span>
<span>904</span>
<span>905</span>
<span>906</span>
<span>907</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">pre_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initializes the MixUp augmentation object.</span>
<span></span>
<span></span><span class="sd">    MixUp is an image augmentation technique that combines two images by taking a weighted sum of their pixel</span>
<span></span><span class="sd">    values and labels. This implementation is designed for use with the Ultralytics YOLO framework.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        dataset (Any): The dataset to which MixUp augmentation will be applied.</span>
<span></span><span class="sd">        pre_transform (Callable | None): Optional transform to apply to images before MixUp.</span>
<span></span><span class="sd">        p (float): Probability of applying MixUp augmentation to an image. Must be in the range [0, 1].</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics.data.dataset import YOLODataset</span>
<span></span><span class="sd">        &gt;&gt;&gt; dataset = YOLODataset("path/to/data.yaml")</span>
<span></span><span class="sd">        &gt;&gt;&gt; mixup = MixUp(dataset, pre_transform=None, p=0.5)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">pre_transform</span><span class="o">=</span><span class="n">pre_transform</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.MixUp.get_indexes">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">get_indexes</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">get_indexes</span><span class="p">()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Get a random index from the dataset.</p>
<p>This method returns a single random index from the dataset, which is used to select an image for MixUp
augmentation.</p>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A random integer index within the range of the dataset length.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mixup</span> <span class="o">=</span> <span class="n">MixUp</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">mixup</span><span class="o">.</span><span class="n">get_indexes</span><span class="p">()</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span></span><span class="go">42</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>909</span>
<span>910</span>
<span>911</span>
<span>912</span>
<span>913</span>
<span>914</span>
<span>915</span>
<span>916</span>
<span>917</span>
<span>918</span>
<span>919</span>
<span>920</span>
<span>921</span>
<span>922</span>
<span>923</span>
<span>924</span>
<span>925</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Get a random index from the dataset.</span>
<span></span>
<span></span><span class="sd">    This method returns a single random index from the dataset, which is used to select an image for MixUp</span>
<span></span><span class="sd">    augmentation.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (int): A random integer index within the range of the dataset length.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; mixup = MixUp(dataset)</span>
<span></span><span class="sd">        &gt;&gt;&gt; index = mixup.get_indexes()</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(index)</span>
<span></span><span class="sd">        42</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.RandomPerspective">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.RandomPerspective</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">RandomPerspective</span><span class="p">(</span>
<span></span>    <span class="n">degrees</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span></span>    <span class="n">translate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span></span>    <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span></span>    <span class="n">shear</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span></span>    <span class="n">perspective</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span></span>    <span class="n">border</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span></span>    <span class="n">pre_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Implements random perspective and affine transformations on images and corresponding annotations.</p>
<p>This class applies random rotations, translations, scaling, shearing, and perspective transformations
to images and their associated bounding boxes, segments, and keypoints. It can be used as part of an
augmentation pipeline for object detection and instance segmentation tasks.</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomPerspective.degrees">degrees</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Maximum absolute degree range for random rotations.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomPerspective.translate">translate</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Maximum translation as a fraction of the image size.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomPerspective.scale">scale</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Scaling factor range, e.g., scale=0.1 means 0.9-1.1.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomPerspective.shear">shear</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Maximum shear angle in degrees.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomPerspective.perspective">perspective</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Perspective distortion factor.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomPerspective.border">border</span></code></td>
<td>
<code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>Mosaic border size as (x, y).</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomPerspective.pre_transform">pre_transform</span></code></td>
<td>
<code><span title="Callable">Callable</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>Optional transform to apply before the random perspective.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.RandomPerspective.affine_transform" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;affine_transform&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.RandomPerspective.affine_transform&lt;/code&gt;)'>affine_transform</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies affine transformations to the input image.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.RandomPerspective.apply_bboxes" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;apply_bboxes&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.RandomPerspective.apply_bboxes&lt;/code&gt;)'>apply_bboxes</a></code></td>
<td>
<div class="doc-md-description">
<p>Transforms bounding boxes using the affine matrix.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.RandomPerspective.apply_segments" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;apply_segments&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.RandomPerspective.apply_segments&lt;/code&gt;)'>apply_segments</a></code></td>
<td>
<div class="doc-md-description">
<p>Transforms segments and generates new bounding boxes.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.RandomPerspective.apply_keypoints" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;apply_keypoints&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.RandomPerspective.apply_keypoints&lt;/code&gt;)'>apply_keypoints</a></code></td>
<td>
<div class="doc-md-description">
<p>Transforms keypoints using the affine matrix.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.RandomPerspective.__call__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__call__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.RandomPerspective.__call__&lt;/code&gt;)'>__call__</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies the random perspective transformation to images and annotations.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.RandomPerspective.box_candidates" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;box_candidates&lt;/span&gt;
  &lt;span class="doc doc-labels"&gt;
      &lt;small class="doc doc-label doc-label-staticmethod"&gt;&lt;code&gt;staticmethod&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.RandomPerspective.box_candidates&lt;/code&gt;)'>box_candidates</a></code></td>
<td>
<div class="doc-md-description">
<p>Filters transformed bounding boxes based on size and aspect ratio.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">RandomPerspective</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">shear</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"img"</span><span class="p">:</span> <span class="n">image</span><span class="p">,</span> <span class="s2">"cls"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="s2">"instances"</span><span class="p">:</span> <span class="n">Instances</span><span class="p">(</span><span class="o">...</span><span class="p">)}</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed_image</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed_instances</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]</span>
</code></pre></div>
<p>This class implements random perspective and affine transformations on images and corresponding bounding boxes,
segments, and keypoints. Transformations include rotation, translation, scaling, and shearing.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>degrees</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Degree range for random rotations.</p>
</div>
</td>
<td>
<code>0.0</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>translate</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Fraction of total width and height for random translation.</p>
</div>
</td>
<td>
<code>0.1</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>scale</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Scaling factor interval, e.g., a scale factor of 0.5 allows a resize between 50%-150%.</p>
</div>
</td>
<td>
<code>0.5</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>shear</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Shear intensity (angle in degrees).</p>
</div>
</td>
<td>
<code>0.0</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>perspective</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Perspective distortion factor.</p>
</div>
</td>
<td>
<code>0.0</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>border</code>
</td>
<td>
<code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>Tuple specifying mosaic border (top/bottom, left/right).</p>
</div>
</td>
<td>
<code>(0, 0)</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>pre_transform</code>
</td>
<td>
<code><span title="Callable">Callable</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>Function/transform to apply to the image before starting the random
transformation.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">RandomPerspective</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">shear</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>  <span class="c1"># Apply random perspective to labels</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span> 986</span>
<span> 987</span>
<span> 988</span>
<span> 989</span>
<span> 990</span>
<span> 991</span>
<span> 992</span>
<span> 993</span>
<span> 994</span>
<span> 995</span>
<span> 996</span>
<span> 997</span>
<span> 998</span>
<span> 999</span>
<span>1000</span>
<span>1001</span>
<span>1002</span>
<span>1003</span>
<span>1004</span>
<span>1005</span>
<span>1006</span>
<span>1007</span>
<span>1008</span>
<span>1009</span>
<span>1010</span>
<span>1011</span>
<span>1012</span>
<span>1013</span>
<span>1014</span>
<span>1015</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<span></span>    <span class="bp">self</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">shear</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">perspective</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">pre_transform</span><span class="o">=</span><span class="kc">None</span>
<span></span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initializes RandomPerspective object with transformation parameters.</span>
<span></span>
<span></span><span class="sd">    This class implements random perspective and affine transformations on images and corresponding bounding boxes,</span>
<span></span><span class="sd">    segments, and keypoints. Transformations include rotation, translation, scaling, and shearing.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        degrees (float): Degree range for random rotations.</span>
<span></span><span class="sd">        translate (float): Fraction of total width and height for random translation.</span>
<span></span><span class="sd">        scale (float): Scaling factor interval, e.g., a scale factor of 0.5 allows a resize between 50%-150%.</span>
<span></span><span class="sd">        shear (float): Shear intensity (angle in degrees).</span>
<span></span><span class="sd">        perspective (float): Perspective distortion factor.</span>
<span></span><span class="sd">        border (Tuple[int, int]): Tuple specifying mosaic border (top/bottom, left/right).</span>
<span></span><span class="sd">        pre_transform (Callable | None): Function/transform to apply to the image before starting the random</span>
<span></span><span class="sd">            transformation.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = RandomPerspective(degrees=10.0, translate=0.1, scale=0.5, shear=5.0)</span>
<span></span><span class="sd">        &gt;&gt;&gt; result = transform(labels)  # Apply random perspective to labels</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">degrees</span> <span class="o">=</span> <span class="n">degrees</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">translate</span> <span class="o">=</span> <span class="n">translate</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">perspective</span> <span class="o">=</span> <span class="n">perspective</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">border</span>  <span class="c1"># mosaic border</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">pre_transform</span> <span class="o">=</span> <span class="n">pre_transform</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.RandomPerspective.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">labels</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Applies random perspective and affine transformations to an image and its associated labels.</p>
<p>This method performs a series of transformations including rotation, translation, scaling, shearing,
and perspective distortion on the input image and adjusts the corresponding bounding boxes, segments,
and keypoints accordingly.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>labels</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A dictionary containing image data and annotations.
Must include:
    'img' (np.ndarray): The input image.
    'cls' (np.ndarray): Class labels.
    'instances' (Instances): Object instances with bounding boxes, segments, and keypoints.
May include:
    'mosaic_border' (Tuple[int, int]): Border size for mosaic augmentation.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Transformed labels dictionary containing:
- 'img' (np.ndarray): The transformed image.
- 'cls' (np.ndarray): Updated class labels.
- 'instances' (Instances): Updated object instances.
- 'resized_shape' (Tuple[int, int]): New image shape after transformation.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">RandomPerspective</span><span class="p">()</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span>
<span></span><span class="gp">... </span>    <span class="s2">"img"</span><span class="p">:</span> <span class="n">image</span><span class="p">,</span>
<span></span><span class="gp">... </span>    <span class="s2">"cls"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
<span></span><span class="gp">... </span>    <span class="s2">"instances"</span><span class="p">:</span> <span class="n">Instances</span><span class="p">(</span><span class="n">bboxes</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">]])),</span>
<span></span><span class="gp">... </span><span class="p">}</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">result</span><span class="p">[</span><span class="s2">"resized_shape"</span><span class="p">]</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1185</span>
<span>1186</span>
<span>1187</span>
<span>1188</span>
<span>1189</span>
<span>1190</span>
<span>1191</span>
<span>1192</span>
<span>1193</span>
<span>1194</span>
<span>1195</span>
<span>1196</span>
<span>1197</span>
<span>1198</span>
<span>1199</span>
<span>1200</span>
<span>1201</span>
<span>1202</span>
<span>1203</span>
<span>1204</span>
<span>1205</span>
<span>1206</span>
<span>1207</span>
<span>1208</span>
<span>1209</span>
<span>1210</span>
<span>1211</span>
<span>1212</span>
<span>1213</span>
<span>1214</span>
<span>1215</span>
<span>1216</span>
<span>1217</span>
<span>1218</span>
<span>1219</span>
<span>1220</span>
<span>1221</span>
<span>1222</span>
<span>1223</span>
<span>1224</span>
<span>1225</span>
<span>1226</span>
<span>1227</span>
<span>1228</span>
<span>1229</span>
<span>1230</span>
<span>1231</span>
<span>1232</span>
<span>1233</span>
<span>1234</span>
<span>1235</span>
<span>1236</span>
<span>1237</span>
<span>1238</span>
<span>1239</span>
<span>1240</span>
<span>1241</span>
<span>1242</span>
<span>1243</span>
<span>1244</span>
<span>1245</span>
<span>1246</span>
<span>1247</span>
<span>1248</span>
<span>1249</span>
<span>1250</span>
<span>1251</span>
<span>1252</span>
<span>1253</span>
<span>1254</span>
<span>1255</span>
<span>1256</span>
<span>1257</span>
<span>1258</span>
<span>1259</span>
<span>1260</span>
<span>1261</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Applies random perspective and affine transformations to an image and its associated labels.</span>
<span></span>
<span></span><span class="sd">    This method performs a series of transformations including rotation, translation, scaling, shearing,</span>
<span></span><span class="sd">    and perspective distortion on the input image and adjusts the corresponding bounding boxes, segments,</span>
<span></span><span class="sd">    and keypoints accordingly.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels (dict): A dictionary containing image data and annotations.</span>
<span></span><span class="sd">            Must include:</span>
<span></span><span class="sd">                'img' (np.ndarray): The input image.</span>
<span></span><span class="sd">                'cls' (np.ndarray): Class labels.</span>
<span></span><span class="sd">                'instances' (Instances): Object instances with bounding boxes, segments, and keypoints.</span>
<span></span><span class="sd">            May include:</span>
<span></span><span class="sd">                'mosaic_border' (Tuple[int, int]): Border size for mosaic augmentation.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): Transformed labels dictionary containing:</span>
<span></span><span class="sd">            - 'img' (np.ndarray): The transformed image.</span>
<span></span><span class="sd">            - 'cls' (np.ndarray): Updated class labels.</span>
<span></span><span class="sd">            - 'instances' (Instances): Updated object instances.</span>
<span></span><span class="sd">            - 'resized_shape' (Tuple[int, int]): New image shape after transformation.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = RandomPerspective()</span>
<span></span><span class="sd">        &gt;&gt;&gt; image = np.random.randint(0, 255, (640, 640, 3), dtype=np.uint8)</span>
<span></span><span class="sd">        &gt;&gt;&gt; labels = {</span>
<span></span><span class="sd">        ...     "img": image,</span>
<span></span><span class="sd">        ...     "cls": np.array([0, 1, 2]),</span>
<span></span><span class="sd">        ...     "instances": Instances(bboxes=np.array([[10, 10, 50, 50], [100, 100, 150, 150]])),</span>
<span></span><span class="sd">        ... }</span>
<span></span><span class="sd">        &gt;&gt;&gt; result = transform(labels)</span>
<span></span><span class="sd">        &gt;&gt;&gt; assert result["img"].shape[:2] == result["resized_shape"]</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_transform</span> <span class="ow">and</span> <span class="s2">"mosaic_border"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
<span></span>        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_transform</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span>    <span class="n">labels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"ratio_pad"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># do not need ratio pad</span>
<span></span>
<span></span>    <span class="n">img</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span>
<span></span>    <span class="bp">cls</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">]</span>
<span></span>    <span class="n">instances</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"instances"</span><span class="p">)</span>
<span></span>    <span class="c1"># Make sure the coord formats are right</span>
<span></span>    <span class="n">instances</span><span class="o">.</span><span class="n">convert_bbox</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">"xyxy"</span><span class="p">)</span>
<span></span>    <span class="n">instances</span><span class="o">.</span><span class="n">denormalize</span><span class="p">(</span><span class="o">*</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span></span>
<span></span>    <span class="n">border</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"mosaic_border"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">border</span><span class="p">)</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">border</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">border</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c1"># w, h</span>
<span></span>    <span class="c1"># M is affine matrix</span>
<span></span>    <span class="c1"># Scale for func:`box_candidates`</span>
<span></span>    <span class="n">img</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">affine_transform</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">border</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">bboxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_bboxes</span><span class="p">(</span><span class="n">instances</span><span class="o">.</span><span class="n">bboxes</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">segments</span> <span class="o">=</span> <span class="n">instances</span><span class="o">.</span><span class="n">segments</span>
<span></span>    <span class="n">keypoints</span> <span class="o">=</span> <span class="n">instances</span><span class="o">.</span><span class="n">keypoints</span>
<span></span>    <span class="c1"># Update bboxes if there are segments.</span>
<span></span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">):</span>
<span></span>        <span class="n">bboxes</span><span class="p">,</span> <span class="n">segments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_segments</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="n">keypoints</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="n">keypoints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_keypoints</span><span class="p">(</span><span class="n">keypoints</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span></span>    <span class="n">new_instances</span> <span class="o">=</span> <span class="n">Instances</span><span class="p">(</span><span class="n">bboxes</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">keypoints</span><span class="p">,</span> <span class="n">bbox_format</span><span class="o">=</span><span class="s2">"xyxy"</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span></span>    <span class="c1"># Clip</span>
<span></span>    <span class="n">new_instances</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Filter instances</span>
<span></span>    <span class="n">instances</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scale_w</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">scale_h</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">bbox_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>    <span class="c1"># Make the bboxes have the same scale with new_bboxes</span>
<span></span>    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">box_candidates</span><span class="p">(</span>
<span></span>        <span class="n">box1</span><span class="o">=</span><span class="n">instances</span><span class="o">.</span><span class="n">bboxes</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">box2</span><span class="o">=</span><span class="n">new_instances</span><span class="o">.</span><span class="n">bboxes</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">area_thr</span><span class="o">=</span><span class="mf">0.01</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span> <span class="k">else</span> <span class="mf">0.10</span>
<span></span>    <span class="p">)</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_instances</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span> <span class="o">=</span> <span class="n">img</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"resized_shape"</span><span class="p">]</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span></span>    <span class="k">return</span> <span class="n">labels</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.RandomPerspective.affine_transform">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">affine_transform</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">affine_transform</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">border</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Applies a sequence of affine transformations centered around the image center.</p>
<p>This function performs a series of geometric transformations on the input image, including
translation, perspective change, rotation, scaling, and shearing. The transformations are
applied in a specific order to maintain consistency.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>img</code>
</td>
<td>
<code><span title="numpy.ndarray">ndarray</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Input image to be transformed.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>border</code>
</td>
<td>
<code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>Border dimensions for the transformed image.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="typing.Tuple">Tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>, <span title="float">float</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>A tuple containing:
- np.ndarray: Transformed image.
- np.ndarray: 3x3 transformation matrix.
- float: Scale factor applied during the transformation.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">border</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed_img</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">affine_transform</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">border</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1017</span>
<span>1018</span>
<span>1019</span>
<span>1020</span>
<span>1021</span>
<span>1022</span>
<span>1023</span>
<span>1024</span>
<span>1025</span>
<span>1026</span>
<span>1027</span>
<span>1028</span>
<span>1029</span>
<span>1030</span>
<span>1031</span>
<span>1032</span>
<span>1033</span>
<span>1034</span>
<span>1035</span>
<span>1036</span>
<span>1037</span>
<span>1038</span>
<span>1039</span>
<span>1040</span>
<span>1041</span>
<span>1042</span>
<span>1043</span>
<span>1044</span>
<span>1045</span>
<span>1046</span>
<span>1047</span>
<span>1048</span>
<span>1049</span>
<span>1050</span>
<span>1051</span>
<span>1052</span>
<span>1053</span>
<span>1054</span>
<span>1055</span>
<span>1056</span>
<span>1057</span>
<span>1058</span>
<span>1059</span>
<span>1060</span>
<span>1061</span>
<span>1062</span>
<span>1063</span>
<span>1064</span>
<span>1065</span>
<span>1066</span>
<span>1067</span>
<span>1068</span>
<span>1069</span>
<span>1070</span>
<span>1071</span>
<span>1072</span>
<span>1073</span>
<span>1074</span>
<span>1075</span>
<span>1076</span>
<span>1077</span>
<span>1078</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">affine_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">border</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Applies a sequence of affine transformations centered around the image center.</span>
<span></span>
<span></span><span class="sd">    This function performs a series of geometric transformations on the input image, including</span>
<span></span><span class="sd">    translation, perspective change, rotation, scaling, and shearing. The transformations are</span>
<span></span><span class="sd">    applied in a specific order to maintain consistency.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        img (np.ndarray): Input image to be transformed.</span>
<span></span><span class="sd">        border (Tuple[int, int]): Border dimensions for the transformed image.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Tuple[np.ndarray, np.ndarray, float]): A tuple containing:</span>
<span></span><span class="sd">            - np.ndarray: Transformed image.</span>
<span></span><span class="sd">            - np.ndarray: 3x3 transformation matrix.</span>
<span></span><span class="sd">            - float: Scale factor applied during the transformation.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span></span><span class="sd">        &gt;&gt;&gt; img = np.random.rand(100, 100, 3)</span>
<span></span><span class="sd">        &gt;&gt;&gt; border = (10, 10)</span>
<span></span><span class="sd">        &gt;&gt;&gt; transformed_img, matrix, scale = affine_transform(img, border)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="c1"># Center</span>
<span></span>    <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># x translation (pixels)</span>
<span></span>    <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># y translation (pixels)</span>
<span></span>
<span></span>    <span class="c1"># Perspective</span>
<span></span>    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>    <span class="n">P</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">perspective</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">perspective</span><span class="p">)</span>  <span class="c1"># x perspective (about y)</span>
<span></span>    <span class="n">P</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">perspective</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">perspective</span><span class="p">)</span>  <span class="c1"># y perspective (about x)</span>
<span></span>
<span></span>    <span class="c1"># Rotation and Scale</span>
<span></span>    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>    <span class="n">a</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">degrees</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">degrees</span><span class="p">)</span>
<span></span>    <span class="c1"># a += random.choice([-180, -90, 0, 90])  # add 90deg rotations to small rotations</span>
<span></span>    <span class="n">s</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
<span></span>    <span class="c1"># s = 2 ** random.uniform(-scale, scale)</span>
<span></span>    <span class="n">R</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getRotationMatrix2D</span><span class="p">(</span><span class="n">angle</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Shear</span>
<span></span>    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>    <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>  <span class="c1"># x shear (deg)</span>
<span></span>    <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>  <span class="c1"># y shear (deg)</span>
<span></span>
<span></span>    <span class="c1"># Translation</span>
<span></span>    <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>    <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">translate</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">translate</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># x translation (pixels)</span>
<span></span>    <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">translate</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">translate</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># y translation (pixels)</span>
<span></span>
<span></span>    <span class="c1"># Combined rotation matrix</span>
<span></span>    <span class="n">M</span> <span class="o">=</span> <span class="n">T</span> <span class="o">@</span> <span class="n">S</span> <span class="o">@</span> <span class="n">R</span> <span class="o">@</span> <span class="n">P</span> <span class="o">@</span> <span class="n">C</span>  <span class="c1"># order of operations (right to left) is IMPORTANT</span>
<span></span>    <span class="c1"># Affine image</span>
<span></span>    <span class="k">if</span> <span class="p">(</span><span class="n">border</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">border</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">M</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>  <span class="c1"># image changed</span>
<span></span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">perspective</span><span class="p">:</span>
<span></span>            <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">warpPerspective</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">dsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">borderValue</span><span class="o">=</span><span class="p">(</span><span class="mi">114</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">114</span><span class="p">))</span>
<span></span>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># affine</span>
<span></span>            <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">warpAffine</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">M</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">borderValue</span><span class="o">=</span><span class="p">(</span><span class="mi">114</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">114</span><span class="p">))</span>
<span></span>    <span class="k">return</span> <span class="n">img</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">s</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.RandomPerspective.apply_bboxes">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">apply_bboxes</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">apply_bboxes</span><span class="p">(</span><span class="n">bboxes</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Apply affine transformation to bounding boxes.</p>
<p>This function applies an affine transformation to a set of bounding boxes using the provided
transformation matrix.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>bboxes</code>
</td>
<td>
<code><span title="torch.Tensor">Tensor</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Bounding boxes in xyxy format with shape (N, 4), where N is the number
of bounding boxes.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>M</code>
</td>
<td>
<code><span title="torch.Tensor">Tensor</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Affine transformation matrix with shape (3, 3).</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="torch.Tensor">Tensor</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Transformed bounding boxes in xyxy format with shape (N, 4).</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bboxes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">]])</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed_bboxes</span> <span class="o">=</span> <span class="n">apply_bboxes</span><span class="p">(</span><span class="n">bboxes</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1080</span>
<span>1081</span>
<span>1082</span>
<span>1083</span>
<span>1084</span>
<span>1085</span>
<span>1086</span>
<span>1087</span>
<span>1088</span>
<span>1089</span>
<span>1090</span>
<span>1091</span>
<span>1092</span>
<span>1093</span>
<span>1094</span>
<span>1095</span>
<span>1096</span>
<span>1097</span>
<span>1098</span>
<span>1099</span>
<span>1100</span>
<span>1101</span>
<span>1102</span>
<span>1103</span>
<span>1104</span>
<span>1105</span>
<span>1106</span>
<span>1107</span>
<span>1108</span>
<span>1109</span>
<span>1110</span>
<span>1111</span>
<span>1112</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">apply_bboxes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bboxes</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Apply affine transformation to bounding boxes.</span>
<span></span>
<span></span><span class="sd">    This function applies an affine transformation to a set of bounding boxes using the provided</span>
<span></span><span class="sd">    transformation matrix.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        bboxes (torch.Tensor): Bounding boxes in xyxy format with shape (N, 4), where N is the number</span>
<span></span><span class="sd">            of bounding boxes.</span>
<span></span><span class="sd">        M (torch.Tensor): Affine transformation matrix with shape (3, 3).</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor): Transformed bounding boxes in xyxy format with shape (N, 4).</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; bboxes = torch.tensor([[10, 10, 20, 20], [30, 30, 40, 40]])</span>
<span></span><span class="sd">        &gt;&gt;&gt; M = torch.eye(3)</span>
<span></span><span class="sd">        &gt;&gt;&gt; transformed_bboxes = apply_bboxes(bboxes, M)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bboxes</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>        <span class="k">return</span> <span class="n">bboxes</span>
<span></span>
<span></span>    <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">bboxes</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span></span>    <span class="n">xy</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">bboxes</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># x1y1, x2y2, x1y2, x2y1</span>
<span></span>    <span class="n">xy</span> <span class="o">=</span> <span class="n">xy</span> <span class="o">@</span> <span class="n">M</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># transform</span>
<span></span>    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">xy</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">perspective</span> <span class="k">else</span> <span class="n">xy</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># perspective rescale or affine</span>
<span></span>
<span></span>    <span class="c1"># Create new boxes</span>
<span></span>    <span class="n">x</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span></span>    <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span>
<span></span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">bboxes</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.RandomPerspective.apply_keypoints">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">apply_keypoints</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">apply_keypoints</span><span class="p">(</span><span class="n">keypoints</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Applies affine transformation to keypoints.</p>
<p>This method transforms the input keypoints using the provided affine transformation matrix. It handles
perspective rescaling if necessary and updates the visibility of keypoints that fall outside the image
boundaries after transformation.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>keypoints</code>
</td>
<td>
<code><span title="numpy.ndarray">ndarray</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Array of keypoints with shape (N, 17, 3), where N is the number of instances,
17 is the number of keypoints per instance, and 3 represents (x, y, visibility).</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>M</code>
</td>
<td>
<code><span title="numpy.ndarray">ndarray</span></code>
</td>
<td>
<div class="doc-md-description">
<p>3x3 affine transformation matrix.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="numpy.ndarray">ndarray</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Transformed keypoints array with the same shape as input (N, 17, 3).</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random_perspective</span> <span class="o">=</span> <span class="n">RandomPerspective</span><span class="p">()</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">keypoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 5 instances, 17 keypoints each</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Identity transformation</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed_keypoints</span> <span class="o">=</span> <span class="n">random_perspective</span><span class="o">.</span><span class="n">apply_keypoints</span><span class="p">(</span><span class="n">keypoints</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1151</span>
<span>1152</span>
<span>1153</span>
<span>1154</span>
<span>1155</span>
<span>1156</span>
<span>1157</span>
<span>1158</span>
<span>1159</span>
<span>1160</span>
<span>1161</span>
<span>1162</span>
<span>1163</span>
<span>1164</span>
<span>1165</span>
<span>1166</span>
<span>1167</span>
<span>1168</span>
<span>1169</span>
<span>1170</span>
<span>1171</span>
<span>1172</span>
<span>1173</span>
<span>1174</span>
<span>1175</span>
<span>1176</span>
<span>1177</span>
<span>1178</span>
<span>1179</span>
<span>1180</span>
<span>1181</span>
<span>1182</span>
<span>1183</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">apply_keypoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keypoints</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Applies affine transformation to keypoints.</span>
<span></span>
<span></span><span class="sd">    This method transforms the input keypoints using the provided affine transformation matrix. It handles</span>
<span></span><span class="sd">    perspective rescaling if necessary and updates the visibility of keypoints that fall outside the image</span>
<span></span><span class="sd">    boundaries after transformation.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        keypoints (np.ndarray): Array of keypoints with shape (N, 17, 3), where N is the number of instances,</span>
<span></span><span class="sd">            17 is the number of keypoints per instance, and 3 represents (x, y, visibility).</span>
<span></span><span class="sd">        M (np.ndarray): 3x3 affine transformation matrix.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (np.ndarray): Transformed keypoints array with the same shape as input (N, 17, 3).</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; random_perspective = RandomPerspective()</span>
<span></span><span class="sd">        &gt;&gt;&gt; keypoints = np.random.rand(5, 17, 3)  # 5 instances, 17 keypoints each</span>
<span></span><span class="sd">        &gt;&gt;&gt; M = np.eye(3)  # Identity transformation</span>
<span></span><span class="sd">        &gt;&gt;&gt; transformed_keypoints = random_perspective.apply_keypoints(keypoints, M)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">n</span><span class="p">,</span> <span class="n">nkpt</span> <span class="o">=</span> <span class="n">keypoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span></span>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>        <span class="k">return</span> <span class="n">keypoints</span>
<span></span>    <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span> <span class="o">*</span> <span class="n">nkpt</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">keypoints</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span></span>    <span class="n">visible</span> <span class="o">=</span> <span class="n">keypoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">nkpt</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="n">xy</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">keypoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">nkpt</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span></span>    <span class="n">xy</span> <span class="o">=</span> <span class="n">xy</span> <span class="o">@</span> <span class="n">M</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># transform</span>
<span></span>    <span class="n">xy</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># perspective rescale or affine</span>
<span></span>    <span class="n">out_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">xy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">xy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span></span>    <span class="n">visible</span><span class="p">[</span><span class="n">out_mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span></span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">xy</span><span class="p">,</span> <span class="n">visible</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nkpt</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.RandomPerspective.apply_segments">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">apply_segments</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">apply_segments</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Apply affine transformations to segments and generate new bounding boxes.</p>
<p>This function applies affine transformations to input segments and generates new bounding boxes based on
the transformed segments. It clips the transformed segments to fit within the new bounding boxes.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>segments</code>
</td>
<td>
<code><span title="numpy.ndarray">ndarray</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Input segments with shape (N, M, 2), where N is the number of segments and M is the
number of points in each segment.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>M</code>
</td>
<td>
<code><span title="numpy.ndarray">ndarray</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Affine transformation matrix with shape (3, 3).</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="typing.Tuple">Tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>A tuple containing:
- New bounding boxes with shape (N, 4) in xyxy format.
- Transformed and clipped segments with shape (N, M, 2).</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">segments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># 10 segments with 500 points each</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Identity transformation matrix</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new_bboxes</span><span class="p">,</span> <span class="n">new_segments</span> <span class="o">=</span> <span class="n">apply_segments</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1114</span>
<span>1115</span>
<span>1116</span>
<span>1117</span>
<span>1118</span>
<span>1119</span>
<span>1120</span>
<span>1121</span>
<span>1122</span>
<span>1123</span>
<span>1124</span>
<span>1125</span>
<span>1126</span>
<span>1127</span>
<span>1128</span>
<span>1129</span>
<span>1130</span>
<span>1131</span>
<span>1132</span>
<span>1133</span>
<span>1134</span>
<span>1135</span>
<span>1136</span>
<span>1137</span>
<span>1138</span>
<span>1139</span>
<span>1140</span>
<span>1141</span>
<span>1142</span>
<span>1143</span>
<span>1144</span>
<span>1145</span>
<span>1146</span>
<span>1147</span>
<span>1148</span>
<span>1149</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">apply_segments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Apply affine transformations to segments and generate new bounding boxes.</span>
<span></span>
<span></span><span class="sd">    This function applies affine transformations to input segments and generates new bounding boxes based on</span>
<span></span><span class="sd">    the transformed segments. It clips the transformed segments to fit within the new bounding boxes.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        segments (np.ndarray): Input segments with shape (N, M, 2), where N is the number of segments and M is the</span>
<span></span><span class="sd">            number of points in each segment.</span>
<span></span><span class="sd">        M (np.ndarray): Affine transformation matrix with shape (3, 3).</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Tuple[np.ndarray, np.ndarray]): A tuple containing:</span>
<span></span><span class="sd">            - New bounding boxes with shape (N, 4) in xyxy format.</span>
<span></span><span class="sd">            - Transformed and clipped segments with shape (N, M, 2).</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; segments = np.random.rand(10, 500, 2)  # 10 segments with 500 points each</span>
<span></span><span class="sd">        &gt;&gt;&gt; M = np.eye(3)  # Identity transformation matrix</span>
<span></span><span class="sd">        &gt;&gt;&gt; new_bboxes, new_segments = apply_segments(segments, M)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">n</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="n">segments</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span></span>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>        <span class="k">return</span> <span class="p">[],</span> <span class="n">segments</span>
<span></span>
<span></span>    <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span> <span class="o">*</span> <span class="n">num</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">segments</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span></span>    <span class="n">segments</span> <span class="o">=</span> <span class="n">segments</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span></span>    <span class="n">xy</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">segments</span>
<span></span>    <span class="n">xy</span> <span class="o">=</span> <span class="n">xy</span> <span class="o">@</span> <span class="n">M</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># transform</span>
<span></span>    <span class="n">xy</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">xy</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span></span>    <span class="n">segments</span> <span class="o">=</span> <span class="n">xy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span></span>    <span class="n">bboxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">segment2box</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span></span>    <span class="n">segments</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">segments</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">bboxes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">bboxes</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span></span>    <span class="n">segments</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">segments</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">bboxes</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">bboxes</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
<span></span>    <span class="k">return</span> <span class="n">bboxes</span><span class="p">,</span> <span class="n">segments</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.RandomPerspective.box_candidates">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">box_candidates</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">box_candidates</span><span class="p">(</span><span class="n">box1</span><span class="p">,</span> <span class="n">box2</span><span class="p">,</span> <span class="n">wh_thr</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ar_thr</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">area_thr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-16</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Compute candidate boxes for further processing based on size and aspect ratio criteria.</p>
<p>This method compares boxes before and after augmentation to determine if they meet specified
thresholds for width, height, aspect ratio, and area. It's used to filter out boxes that have
been overly distorted or reduced by the augmentation process.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>box1</code>
</td>
<td>
<code><span title="numpy.ndarray">ndarray</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Original boxes before augmentation, shape (4, N) where n is the
number of boxes. Format is [x1, y1, x2, y2] in absolute coordinates.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>box2</code>
</td>
<td>
<code><span title="numpy.ndarray">ndarray</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Augmented boxes after transformation, shape (4, N). Format is
[x1, y1, x2, y2] in absolute coordinates.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>wh_thr</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Width and height threshold in pixels. Boxes smaller than this in either
dimension are rejected.</p>
</div>
</td>
<td>
<code>2</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>ar_thr</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Aspect ratio threshold. Boxes with an aspect ratio greater than this
value are rejected.</p>
</div>
</td>
<td>
<code>100</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>area_thr</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Area ratio threshold. Boxes with an area ratio (new/old) less than
this value are rejected.</p>
</div>
</td>
<td>
<code>0.1</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>eps</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Small epsilon value to prevent division by zero.</p>
</div>
</td>
<td>
<code>1e-16</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="numpy.ndarray">ndarray</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Boolean array of shape (n) indicating which boxes are candidates.
True values correspond to boxes that meet all criteria.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random_perspective</span> <span class="o">=</span> <span class="n">RandomPerspective</span><span class="p">()</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">box1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">box2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">45</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">candidates</span> <span class="o">=</span> <span class="n">random_perspective</span><span class="o">.</span><span class="n">box_candidates</span><span class="p">(</span><span class="n">box1</span><span class="p">,</span> <span class="n">box2</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
<span></span><span class="go">[True True]</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1263</span>
<span>1264</span>
<span>1265</span>
<span>1266</span>
<span>1267</span>
<span>1268</span>
<span>1269</span>
<span>1270</span>
<span>1271</span>
<span>1272</span>
<span>1273</span>
<span>1274</span>
<span>1275</span>
<span>1276</span>
<span>1277</span>
<span>1278</span>
<span>1279</span>
<span>1280</span>
<span>1281</span>
<span>1282</span>
<span>1283</span>
<span>1284</span>
<span>1285</span>
<span>1286</span>
<span>1287</span>
<span>1288</span>
<span>1289</span>
<span>1290</span>
<span>1291</span>
<span>1292</span>
<span>1293</span>
<span>1294</span>
<span>1295</span>
<span>1296</span>
<span>1297</span>
<span>1298</span>
<span>1299</span>
<span>1300</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="nd">@staticmethod</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">box_candidates</span><span class="p">(</span><span class="n">box1</span><span class="p">,</span> <span class="n">box2</span><span class="p">,</span> <span class="n">wh_thr</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ar_thr</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">area_thr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-16</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Compute candidate boxes for further processing based on size and aspect ratio criteria.</span>
<span></span>
<span></span><span class="sd">    This method compares boxes before and after augmentation to determine if they meet specified</span>
<span></span><span class="sd">    thresholds for width, height, aspect ratio, and area. It's used to filter out boxes that have</span>
<span></span><span class="sd">    been overly distorted or reduced by the augmentation process.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        box1 (numpy.ndarray): Original boxes before augmentation, shape (4, N) where n is the</span>
<span></span><span class="sd">            number of boxes. Format is [x1, y1, x2, y2] in absolute coordinates.</span>
<span></span><span class="sd">        box2 (numpy.ndarray): Augmented boxes after transformation, shape (4, N). Format is</span>
<span></span><span class="sd">            [x1, y1, x2, y2] in absolute coordinates.</span>
<span></span><span class="sd">        wh_thr (float): Width and height threshold in pixels. Boxes smaller than this in either</span>
<span></span><span class="sd">            dimension are rejected.</span>
<span></span><span class="sd">        ar_thr (float): Aspect ratio threshold. Boxes with an aspect ratio greater than this</span>
<span></span><span class="sd">            value are rejected.</span>
<span></span><span class="sd">        area_thr (float): Area ratio threshold. Boxes with an area ratio (new/old) less than</span>
<span></span><span class="sd">            this value are rejected.</span>
<span></span><span class="sd">        eps (float): Small epsilon value to prevent division by zero.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (numpy.ndarray): Boolean array of shape (n) indicating which boxes are candidates.</span>
<span></span><span class="sd">            True values correspond to boxes that meet all criteria.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; random_perspective = RandomPerspective()</span>
<span></span><span class="sd">        &gt;&gt;&gt; box1 = np.array([[0, 0, 100, 100], [0, 0, 50, 50]]).T</span>
<span></span><span class="sd">        &gt;&gt;&gt; box2 = np.array([[10, 10, 90, 90], [5, 5, 45, 45]]).T</span>
<span></span><span class="sd">        &gt;&gt;&gt; candidates = random_perspective.box_candidates(box1, box2)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(candidates)</span>
<span></span><span class="sd">        [True True]</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">w1</span><span class="p">,</span> <span class="n">h1</span> <span class="o">=</span> <span class="n">box1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">box1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">box1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">box1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span></span>    <span class="n">w2</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">box2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">box2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">box2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">box2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span></span>    <span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">w2</span> <span class="o">/</span> <span class="p">(</span><span class="n">h2</span> <span class="o">+</span> <span class="n">eps</span><span class="p">),</span> <span class="n">h2</span> <span class="o">/</span> <span class="p">(</span><span class="n">w2</span> <span class="o">+</span> <span class="n">eps</span><span class="p">))</span>  <span class="c1"># aspect ratio</span>
<span></span>    <span class="k">return</span> <span class="p">(</span><span class="n">w2</span> <span class="o">&gt;</span> <span class="n">wh_thr</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">h2</span> <span class="o">&gt;</span> <span class="n">wh_thr</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">w2</span> <span class="o">*</span> <span class="n">h2</span> <span class="o">/</span> <span class="p">(</span><span class="n">w1</span> <span class="o">*</span> <span class="n">h1</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">area_thr</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ar</span> <span class="o">&lt;</span> <span class="n">ar_thr</span><span class="p">)</span>  <span class="c1"># candidates</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.RandomHSV">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.RandomHSV</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">RandomHSV</span><span class="p">(</span><span class="n">hgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">sgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Randomly adjusts the Hue, Saturation, and Value (HSV) channels of an image.</p>
<p>This class applies random HSV augmentation to images within predefined limits set by hgain, sgain, and vgain.</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomHSV.hgain">hgain</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Maximum variation for hue. Range is typically [0, 1].</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomHSV.sgain">sgain</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Maximum variation for saturation. Range is typically [0, 1].</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomHSV.vgain">vgain</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Maximum variation for value. Range is typically [0, 1].</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.RandomHSV.__call__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__call__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.RandomHSV.__call__&lt;/code&gt;)'>__call__</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies random HSV augmentation to an image.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.augment</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomHSV</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augmenter</span> <span class="o">=</span> <span class="n">RandomHSV</span><span class="p">(</span><span class="n">hgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">sgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"img"</span><span class="p">:</span> <span class="n">image</span><span class="p">}</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augmenter</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augmented_image</span> <span class="o">=</span> <span class="n">augmented_labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span>
</code></pre></div>
<p>This class applies random adjustments to the HSV channels of an image within specified limits.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>hgain</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Maximum variation for hue. Should be in the range [0, 1].</p>
</div>
</td>
<td>
<code>0.5</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>sgain</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Maximum variation for saturation. Should be in the range [0, 1].</p>
</div>
</td>
<td>
<code>0.5</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>vgain</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Maximum variation for value. Should be in the range [0, 1].</p>
</div>
</td>
<td>
<code>0.5</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsv_aug</span> <span class="o">=</span> <span class="n">RandomHSV</span><span class="p">(</span><span class="n">hgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">sgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsv_aug</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1327</span>
<span>1328</span>
<span>1329</span>
<span>1330</span>
<span>1331</span>
<span>1332</span>
<span>1333</span>
<span>1334</span>
<span>1335</span>
<span>1336</span>
<span>1337</span>
<span>1338</span>
<span>1339</span>
<span>1340</span>
<span>1341</span>
<span>1342</span>
<span>1343</span>
<span>1344</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">sgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initializes the RandomHSV object for random HSV (Hue, Saturation, Value) augmentation.</span>
<span></span>
<span></span><span class="sd">    This class applies random adjustments to the HSV channels of an image within specified limits.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        hgain (float): Maximum variation for hue. Should be in the range [0, 1].</span>
<span></span><span class="sd">        sgain (float): Maximum variation for saturation. Should be in the range [0, 1].</span>
<span></span><span class="sd">        vgain (float): Maximum variation for value. Should be in the range [0, 1].</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; hsv_aug = RandomHSV(hgain=0.5, sgain=0.5, vgain=0.5)</span>
<span></span><span class="sd">        &gt;&gt;&gt; hsv_aug(image)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">hgain</span> <span class="o">=</span> <span class="n">hgain</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">sgain</span> <span class="o">=</span> <span class="n">sgain</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">vgain</span> <span class="o">=</span> <span class="n">vgain</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.RandomHSV.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">labels</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Applies random HSV augmentation to an image within predefined limits.</p>
<p>This method modifies the input image by randomly adjusting its Hue, Saturation, and Value (HSV) channels.
The adjustments are made within the limits set by hgain, sgain, and vgain during initialization.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>labels</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A dictionary containing image data and metadata. Must include an 'img' key with
the image as a numpy array.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>None</code>
</td>
<td>
<div class="doc-md-description">
<p>The function modifies the input 'labels' dictionary in-place, updating the 'img' key
with the HSV-augmented image.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsv_augmenter</span> <span class="o">=</span> <span class="n">RandomHSV</span><span class="p">(</span><span class="n">hgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">sgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vgain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"img"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)}</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsv_augmenter</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augmented_img</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1346</span>
<span>1347</span>
<span>1348</span>
<span>1349</span>
<span>1350</span>
<span>1351</span>
<span>1352</span>
<span>1353</span>
<span>1354</span>
<span>1355</span>
<span>1356</span>
<span>1357</span>
<span>1358</span>
<span>1359</span>
<span>1360</span>
<span>1361</span>
<span>1362</span>
<span>1363</span>
<span>1364</span>
<span>1365</span>
<span>1366</span>
<span>1367</span>
<span>1368</span>
<span>1369</span>
<span>1370</span>
<span>1371</span>
<span>1372</span>
<span>1373</span>
<span>1374</span>
<span>1375</span>
<span>1376</span>
<span>1377</span>
<span>1378</span>
<span>1379</span>
<span>1380</span>
<span>1381</span>
<span>1382</span>
<span>1383</span>
<span>1384</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Applies random HSV augmentation to an image within predefined limits.</span>
<span></span>
<span></span><span class="sd">    This method modifies the input image by randomly adjusting its Hue, Saturation, and Value (HSV) channels.</span>
<span></span><span class="sd">    The adjustments are made within the limits set by hgain, sgain, and vgain during initialization.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels (dict): A dictionary containing image data and metadata. Must include an 'img' key with</span>
<span></span><span class="sd">            the image as a numpy array.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (None): The function modifies the input 'labels' dictionary in-place, updating the 'img' key</span>
<span></span><span class="sd">            with the HSV-augmented image.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; hsv_augmenter = RandomHSV(hgain=0.5, sgain=0.5, vgain=0.5)</span>
<span></span><span class="sd">        &gt;&gt;&gt; labels = {"img": np.random.randint(0, 255, (100, 100, 3), dtype=np.uint8)}</span>
<span></span><span class="sd">        &gt;&gt;&gt; hsv_augmenter(labels)</span>
<span></span><span class="sd">        &gt;&gt;&gt; augmented_img = labels["img"]</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">img</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span>
<span></span>    <span class="k">if</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># only apply to RGB images</span>
<span></span>        <span class="k">return</span> <span class="n">labels</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hgain</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">sgain</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">vgain</span><span class="p">:</span>
<span></span>        <span class="n">dtype</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">dtype</span>  <span class="c1"># uint8</span>
<span></span>
<span></span>        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">hgain</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sgain</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vgain</span><span class="p">]</span>  <span class="c1"># random gains</span>
<span></span>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span></span>        <span class="c1"># lut_hue = ((x * (r[0] + 1)) % 180).astype(dtype)   # original hue implementation from ultralytics&lt;=8.3.78</span>
<span></span>        <span class="n">lut_hue</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">180</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<span></span>        <span class="n">lut_sat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<span></span>        <span class="n">lut_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<span></span>        <span class="n">lut_sat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># prevent pure white changing color, introduced in 8.3.79</span>
<span></span>
<span></span>        <span class="n">hue</span><span class="p">,</span> <span class="n">sat</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2HSV</span><span class="p">))</span>
<span></span>        <span class="n">im_hsv</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">cv2</span><span class="o">.</span><span class="n">LUT</span><span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">lut_hue</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">LUT</span><span class="p">(</span><span class="n">sat</span><span class="p">,</span> <span class="n">lut_sat</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">LUT</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">lut_val</span><span class="p">)))</span>
<span></span>        <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">im_hsv</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_HSV2BGR</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="n">img</span><span class="p">)</span>  <span class="c1"># no return needed</span>
<span></span>    <span class="k">return</span> <span class="n">labels</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.RandomFlip">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.RandomFlip</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">RandomFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">'horizontal'</span><span class="p">,</span> <span class="n">flip_idx</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Applies a random horizontal or vertical flip to an image with a given probability.</p>
<p>This class performs random image flipping and updates corresponding instance annotations such as
bounding boxes and keypoints.</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomFlip.p">p</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of applying the flip. Must be between 0 and 1.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomFlip.direction">direction</span></code></td>
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Direction of flip, either 'horizontal' or 'vertical'.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomFlip.flip_idx">flip_idx</span></code></td>
<td>
<code><span title="array">array</span> - <span title="like">like</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Index mapping for flipping keypoints, if applicable.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.RandomFlip.__call__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__call__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.RandomFlip.__call__&lt;/code&gt;)'>__call__</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies the random flip transformation to an image and its annotations.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">RandomFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="p">({</span><span class="s2">"img"</span><span class="p">:</span> <span class="n">image</span><span class="p">,</span> <span class="s2">"instances"</span><span class="p">:</span> <span class="n">instances</span><span class="p">})</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flipped_image</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flipped_instances</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]</span>
</code></pre></div>
<p>This class applies a random horizontal or vertical flip to an image with a given probability.
It also updates any instances (bounding boxes, keypoints, etc.) accordingly.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>p</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The probability of applying the flip. Must be between 0 and 1.</p>
</div>
</td>
<td>
<code>0.5</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>direction</code>
</td>
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The direction to apply the flip. Must be 'horizontal' or 'vertical'.</p>
</div>
</td>
<td>
<code>'horizontal'</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>flip_idx</code>
</td>
<td>
<code><span title="typing.List">List</span>[<span title="int">int</span>] | None</code>
</td>
<td>
<div class="doc-md-description">
<p>Index mapping for flipping keypoints, if any.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Raises:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="AssertionError">AssertionError</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If direction is not 'horizontal' or 'vertical', or if p is not between 0 and 1.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flip</span> <span class="o">=</span> <span class="n">RandomFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flip_with_idx</span> <span class="o">=</span> <span class="n">RandomFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">"vertical"</span><span class="p">,</span> <span class="n">flip_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1409</span>
<span>1410</span>
<span>1411</span>
<span>1412</span>
<span>1413</span>
<span>1414</span>
<span>1415</span>
<span>1416</span>
<span>1417</span>
<span>1418</span>
<span>1419</span>
<span>1420</span>
<span>1421</span>
<span>1422</span>
<span>1423</span>
<span>1424</span>
<span>1425</span>
<span>1426</span>
<span>1427</span>
<span>1428</span>
<span>1429</span>
<span>1430</span>
<span>1431</span>
<span>1432</span>
<span>1433</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span> <span class="n">flip_idx</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initializes the RandomFlip class with probability and direction.</span>
<span></span>
<span></span><span class="sd">    This class applies a random horizontal or vertical flip to an image with a given probability.</span>
<span></span><span class="sd">    It also updates any instances (bounding boxes, keypoints, etc.) accordingly.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        p (float): The probability of applying the flip. Must be between 0 and 1.</span>
<span></span><span class="sd">        direction (str): The direction to apply the flip. Must be 'horizontal' or 'vertical'.</span>
<span></span><span class="sd">        flip_idx (List[int] | None): Index mapping for flipping keypoints, if any.</span>
<span></span>
<span></span><span class="sd">    Raises:</span>
<span></span><span class="sd">        AssertionError: If direction is not 'horizontal' or 'vertical', or if p is not between 0 and 1.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; flip = RandomFlip(p=0.5, direction="horizontal")</span>
<span></span><span class="sd">        &gt;&gt;&gt; flip_with_idx = RandomFlip(p=0.7, direction="vertical", flip_idx=[1, 0, 3, 2, 5, 4])</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">assert</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"horizontal"</span><span class="p">,</span> <span class="s2">"vertical"</span><span class="p">},</span> <span class="sa">f</span><span class="s2">"Support direction `horizontal` or `vertical`, got </span><span class="si">{</span><span class="n">direction</span><span class="si">}</span><span class="s2">"</span>
<span></span>    <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"The probability should be in range [0, 1], but got </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">."</span>
<span></span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">p</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">flip_idx</span> <span class="o">=</span> <span class="n">flip_idx</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.RandomFlip.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">labels</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Applies random flip to an image and updates any instances like bounding boxes or keypoints accordingly.</p>
<p>This method randomly flips the input image either horizontally or vertically based on the initialized
probability and direction. It also updates the corresponding instances (bounding boxes, keypoints) to
match the flipped image.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>labels</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A dictionary containing the following keys:
'img' (numpy.ndarray): The image to be flipped.
'instances' (ultralytics.utils.instance.Instances): An object containing bounding boxes and
    optionally keypoints.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The same dictionary with the flipped image and updated instances:
'img' (numpy.ndarray): The flipped image.
'instances' (ultralytics.utils.instance.Instances): Updated instances matching the flipped image.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"img"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s2">"instances"</span><span class="p">:</span> <span class="n">Instances</span><span class="p">(</span><span class="o">...</span><span class="p">)}</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random_flip</span> <span class="o">=</span> <span class="n">RandomFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flipped_labels</span> <span class="o">=</span> <span class="n">random_flip</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1435</span>
<span>1436</span>
<span>1437</span>
<span>1438</span>
<span>1439</span>
<span>1440</span>
<span>1441</span>
<span>1442</span>
<span>1443</span>
<span>1444</span>
<span>1445</span>
<span>1446</span>
<span>1447</span>
<span>1448</span>
<span>1449</span>
<span>1450</span>
<span>1451</span>
<span>1452</span>
<span>1453</span>
<span>1454</span>
<span>1455</span>
<span>1456</span>
<span>1457</span>
<span>1458</span>
<span>1459</span>
<span>1460</span>
<span>1461</span>
<span>1462</span>
<span>1463</span>
<span>1464</span>
<span>1465</span>
<span>1466</span>
<span>1467</span>
<span>1468</span>
<span>1469</span>
<span>1470</span>
<span>1471</span>
<span>1472</span>
<span>1473</span>
<span>1474</span>
<span>1475</span>
<span>1476</span>
<span>1477</span>
<span>1478</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Applies random flip to an image and updates any instances like bounding boxes or keypoints accordingly.</span>
<span></span>
<span></span><span class="sd">    This method randomly flips the input image either horizontally or vertically based on the initialized</span>
<span></span><span class="sd">    probability and direction. It also updates the corresponding instances (bounding boxes, keypoints) to</span>
<span></span><span class="sd">    match the flipped image.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels (dict): A dictionary containing the following keys:</span>
<span></span><span class="sd">            'img' (numpy.ndarray): The image to be flipped.</span>
<span></span><span class="sd">            'instances' (ultralytics.utils.instance.Instances): An object containing bounding boxes and</span>
<span></span><span class="sd">                optionally keypoints.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): The same dictionary with the flipped image and updated instances:</span>
<span></span><span class="sd">            'img' (numpy.ndarray): The flipped image.</span>
<span></span><span class="sd">            'instances' (ultralytics.utils.instance.Instances): Updated instances matching the flipped image.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; labels = {"img": np.random.rand(640, 640, 3), "instances": Instances(...)}</span>
<span></span><span class="sd">        &gt;&gt;&gt; random_flip = RandomFlip(p=0.5, direction="horizontal")</span>
<span></span><span class="sd">        &gt;&gt;&gt; flipped_labels = random_flip(labels)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">img</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span>
<span></span>    <span class="n">instances</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"instances"</span><span class="p">)</span>
<span></span>    <span class="n">instances</span><span class="o">.</span><span class="n">convert_bbox</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">"xywh"</span><span class="p">)</span>
<span></span>    <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span></span>    <span class="n">h</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">instances</span><span class="o">.</span><span class="n">normalized</span> <span class="k">else</span> <span class="n">h</span>
<span></span>    <span class="n">w</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">instances</span><span class="o">.</span><span class="n">normalized</span> <span class="k">else</span> <span class="n">w</span>
<span></span>
<span></span>    <span class="c1"># Flip up-down</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s2">"vertical"</span> <span class="ow">and</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
<span></span>        <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span></span>        <span class="n">instances</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s2">"horizontal"</span> <span class="ow">and</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
<span></span>        <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span></span>        <span class="n">instances</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span></span>        <span class="c1"># For keypoints</span>
<span></span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flip_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">instances</span><span class="o">.</span><span class="n">keypoints</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>            <span class="n">instances</span><span class="o">.</span><span class="n">keypoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">instances</span><span class="o">.</span><span class="n">keypoints</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">flip_idx</span><span class="p">,</span> <span class="p">:])</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]</span> <span class="o">=</span> <span class="n">instances</span>
<span></span>    <span class="k">return</span> <span class="n">labels</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.LetterBox">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.LetterBox</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">LetterBox</span><span class="p">(</span>
<span></span>    <span class="n">new_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">),</span>
<span></span>    <span class="n">auto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">scale_fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">scaleup</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">stride</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
<span></span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Resize image and padding for detection, instance segmentation, pose.</p>
<p>This class resizes and pads images to a specified shape while preserving aspect ratio. It also updates
corresponding labels and bounding boxes.</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.LetterBox.new_shape">new_shape</span></code></td>
<td>
<code><span title="tuple">tuple</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Target shape (height, width) for resizing.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.LetterBox.auto">auto</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to use minimum rectangle.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.LetterBox.scale_fill">scale_fill</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to stretch the image to new_shape.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.LetterBox.scaleup">scaleup</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to allow scaling up. If False, only scale down.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.LetterBox.stride">stride</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Stride for rounding padding.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.LetterBox.center">center</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to center the image or align to top-left.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.LetterBox.__call__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__call__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.LetterBox.__call__&lt;/code&gt;)'>__call__</a></code></td>
<td>
<div class="doc-md-description">
<p>Resize and pad image, update labels and bounding boxes.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">LetterBox</span><span class="p">(</span><span class="n">new_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">))</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">resized_img</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">updated_instances</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]</span>
</code></pre></div>
<p>This class is designed to resize and pad images for object detection, instance segmentation, and pose estimation
tasks. It supports various resizing modes including auto-sizing, scale-fill, and letterboxing.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>new_shape</code>
</td>
<td>
<code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>Target size (height, width) for the resized image.</p>
</div>
</td>
<td>
<code>(640, 640)</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>auto</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, use minimum rectangle to resize. If False, use new_shape directly.</p>
</div>
</td>
<td>
<code>False</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>scale_fill</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, stretch the image to new_shape without padding.</p>
</div>
</td>
<td>
<code>False</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>scaleup</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, allow scaling up. If False, only scale down.</p>
</div>
</td>
<td>
<code>True</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>center</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, center the placed image. If False, place image in top-left corner.</p>
</div>
</td>
<td>
<code>True</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>stride</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Stride of the model (e.g., 32 for YOLOv5).</p>
</div>
</td>
<td>
<code>32</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.LetterBox.__init__.new_shape">new_shape</span></code></td>
<td>
<code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>Target size for the resized image.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.LetterBox.__init__.auto">auto</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Flag for using minimum rectangle resizing.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.LetterBox.__init__.scale_fill">scale_fill</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Flag for stretching image without padding.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.LetterBox.__init__.scaleup">scaleup</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Flag for allowing upscaling.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.LetterBox.__init__.stride">stride</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Stride value for ensuring image size is divisible by stride.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">letterbox</span> <span class="o">=</span> <span class="n">LetterBox</span><span class="p">(</span><span class="n">new_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">),</span> <span class="n">auto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scale_fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scaleup</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">resized_img</span> <span class="o">=</span> <span class="n">letterbox</span><span class="p">(</span><span class="n">original_img</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1506</span>
<span>1507</span>
<span>1508</span>
<span>1509</span>
<span>1510</span>
<span>1511</span>
<span>1512</span>
<span>1513</span>
<span>1514</span>
<span>1515</span>
<span>1516</span>
<span>1517</span>
<span>1518</span>
<span>1519</span>
<span>1520</span>
<span>1521</span>
<span>1522</span>
<span>1523</span>
<span>1524</span>
<span>1525</span>
<span>1526</span>
<span>1527</span>
<span>1528</span>
<span>1529</span>
<span>1530</span>
<span>1531</span>
<span>1532</span>
<span>1533</span>
<span>1534</span>
<span>1535</span>
<span>1536</span>
<span>1537</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">),</span> <span class="n">auto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scale_fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scaleup</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">32</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initialize LetterBox object for resizing and padding images.</span>
<span></span>
<span></span><span class="sd">    This class is designed to resize and pad images for object detection, instance segmentation, and pose estimation</span>
<span></span><span class="sd">    tasks. It supports various resizing modes including auto-sizing, scale-fill, and letterboxing.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        new_shape (Tuple[int, int]): Target size (height, width) for the resized image.</span>
<span></span><span class="sd">        auto (bool): If True, use minimum rectangle to resize. If False, use new_shape directly.</span>
<span></span><span class="sd">        scale_fill (bool): If True, stretch the image to new_shape without padding.</span>
<span></span><span class="sd">        scaleup (bool): If True, allow scaling up. If False, only scale down.</span>
<span></span><span class="sd">        center (bool): If True, center the placed image. If False, place image in top-left corner.</span>
<span></span><span class="sd">        stride (int): Stride of the model (e.g., 32 for YOLOv5).</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        new_shape (Tuple[int, int]): Target size for the resized image.</span>
<span></span><span class="sd">        auto (bool): Flag for using minimum rectangle resizing.</span>
<span></span><span class="sd">        scale_fill (bool): Flag for stretching image without padding.</span>
<span></span><span class="sd">        scaleup (bool): Flag for allowing upscaling.</span>
<span></span><span class="sd">        stride (int): Stride value for ensuring image size is divisible by stride.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; letterbox = LetterBox(new_shape=(640, 640), auto=False, scale_fill=False, scaleup=True, stride=32)</span>
<span></span><span class="sd">        &gt;&gt;&gt; resized_img = letterbox(original_img)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">new_shape</span> <span class="o">=</span> <span class="n">new_shape</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">auto</span> <span class="o">=</span> <span class="n">auto</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">scale_fill</span> <span class="o">=</span> <span class="n">scale_fill</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">scaleup</span> <span class="o">=</span> <span class="n">scaleup</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">stride</span> <span class="o">=</span> <span class="n">stride</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>  <span class="c1"># Put the image in the middle or top-left</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.LetterBox.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Resizes and pads an image for object detection, instance segmentation, or pose estimation tasks.</p>
<p>This method applies letterboxing to the input image, which involves resizing the image while maintaining its
aspect ratio and adding padding to fit the new shape. It also updates any associated labels accordingly.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>labels</code>
</td>
<td>
<code><span title="Dict">Dict</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>A dictionary containing image data and associated labels, or empty dict if None.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>image</code>
</td>
<td>
<code><span title="numpy.ndarray">ndarray</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>The input image as a numpy array. If None, the image is taken from 'labels'.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="Dict">Dict</span> | <span title="typing.Tuple">Tuple</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If 'labels' is provided, returns an updated dictionary with the resized and padded image,
updated labels, and additional metadata. If 'labels' is empty, returns a tuple containing the resized
and padded image, and a tuple of (ratio, (left_pad, top_pad)).</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">letterbox</span> <span class="o">=</span> <span class="n">LetterBox</span><span class="p">(</span><span class="n">new_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">))</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">letterbox</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s2">"img"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">480</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="s2">"instances"</span><span class="p">:</span> <span class="n">Instances</span><span class="p">(</span><span class="o">...</span><span class="p">)})</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">resized_img</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">updated_instances</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1539</span>
<span>1540</span>
<span>1541</span>
<span>1542</span>
<span>1543</span>
<span>1544</span>
<span>1545</span>
<span>1546</span>
<span>1547</span>
<span>1548</span>
<span>1549</span>
<span>1550</span>
<span>1551</span>
<span>1552</span>
<span>1553</span>
<span>1554</span>
<span>1555</span>
<span>1556</span>
<span>1557</span>
<span>1558</span>
<span>1559</span>
<span>1560</span>
<span>1561</span>
<span>1562</span>
<span>1563</span>
<span>1564</span>
<span>1565</span>
<span>1566</span>
<span>1567</span>
<span>1568</span>
<span>1569</span>
<span>1570</span>
<span>1571</span>
<span>1572</span>
<span>1573</span>
<span>1574</span>
<span>1575</span>
<span>1576</span>
<span>1577</span>
<span>1578</span>
<span>1579</span>
<span>1580</span>
<span>1581</span>
<span>1582</span>
<span>1583</span>
<span>1584</span>
<span>1585</span>
<span>1586</span>
<span>1587</span>
<span>1588</span>
<span>1589</span>
<span>1590</span>
<span>1591</span>
<span>1592</span>
<span>1593</span>
<span>1594</span>
<span>1595</span>
<span>1596</span>
<span>1597</span>
<span>1598</span>
<span>1599</span>
<span>1600</span>
<span>1601</span>
<span>1602</span>
<span>1603</span>
<span>1604</span>
<span>1605</span>
<span>1606</span>
<span>1607</span>
<span>1608</span>
<span>1609</span>
<span>1610</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Resizes and pads an image for object detection, instance segmentation, or pose estimation tasks.</span>
<span></span>
<span></span><span class="sd">    This method applies letterboxing to the input image, which involves resizing the image while maintaining its</span>
<span></span><span class="sd">    aspect ratio and adding padding to fit the new shape. It also updates any associated labels accordingly.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels (Dict | None): A dictionary containing image data and associated labels, or empty dict if None.</span>
<span></span><span class="sd">        image (np.ndarray | None): The input image as a numpy array. If None, the image is taken from 'labels'.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Dict | Tuple): If 'labels' is provided, returns an updated dictionary with the resized and padded image,</span>
<span></span><span class="sd">            updated labels, and additional metadata. If 'labels' is empty, returns a tuple containing the resized</span>
<span></span><span class="sd">            and padded image, and a tuple of (ratio, (left_pad, top_pad)).</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; letterbox = LetterBox(new_shape=(640, 640))</span>
<span></span><span class="sd">        &gt;&gt;&gt; result = letterbox(labels={"img": np.zeros((480, 640, 3)), "instances": Instances(...)})</span>
<span></span><span class="sd">        &gt;&gt;&gt; resized_img = result["img"]</span>
<span></span><span class="sd">        &gt;&gt;&gt; updated_instances = result["instances"]</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="n">labels</span> <span class="o">=</span> <span class="p">{}</span>
<span></span>    <span class="n">img</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"img"</span><span class="p">)</span> <span class="k">if</span> <span class="n">image</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">image</span>
<span></span>    <span class="n">shape</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># current shape [height, width]</span>
<span></span>    <span class="n">new_shape</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"rect_shape"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_shape</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_shape</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<span></span>        <span class="n">new_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">new_shape</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Scale ratio (new / old)</span>
<span></span>    <span class="n">r</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">new_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">new_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaleup</span><span class="p">:</span>  <span class="c1"># only scale down, do not scale up (for better val mAP)</span>
<span></span>        <span class="n">r</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Compute padding</span>
<span></span>    <span class="n">ratio</span> <span class="o">=</span> <span class="n">r</span><span class="p">,</span> <span class="n">r</span>  <span class="c1"># width, height ratios</span>
<span></span>    <span class="n">new_unpad</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">r</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">r</span><span class="p">))</span>
<span></span>    <span class="n">dw</span><span class="p">,</span> <span class="n">dh</span> <span class="o">=</span> <span class="n">new_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">new_unpad</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">new_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">new_unpad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># wh padding</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto</span><span class="p">:</span>  <span class="c1"># minimum rectangle</span>
<span></span>        <span class="n">dw</span><span class="p">,</span> <span class="n">dh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stride</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">dh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stride</span><span class="p">)</span>  <span class="c1"># wh padding</span>
<span></span>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_fill</span><span class="p">:</span>  <span class="c1"># stretch</span>
<span></span>        <span class="n">dw</span><span class="p">,</span> <span class="n">dh</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span></span>        <span class="n">new_unpad</span> <span class="o">=</span> <span class="p">(</span><span class="n">new_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">new_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span></span>        <span class="n">ratio</span> <span class="o">=</span> <span class="n">new_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">new_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># width, height ratios</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">:</span>
<span></span>        <span class="n">dw</span> <span class="o">/=</span> <span class="mi">2</span>  <span class="c1"># divide padding into 2 sides</span>
<span></span>        <span class="n">dh</span> <span class="o">/=</span> <span class="mi">2</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="n">shape</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">new_unpad</span><span class="p">:</span>  <span class="c1"># resize</span>
<span></span>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">new_unpad</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">INTER_LINEAR</span><span class="p">)</span>
<span></span>    <span class="n">top</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dh</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">))</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dh</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">))</span>
<span></span>    <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dw</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">))</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dw</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">))</span>
<span></span>    <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span>
<span></span>    <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<span></span>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">copyMakeBorder</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_CONSTANT</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">114</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">114</span><span class="p">))</span>
<span></span>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># multispectral</span>
<span></span>        <span class="n">pad_img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">h</span> <span class="o">+</span> <span class="n">top</span> <span class="o">+</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">w</span> <span class="o">+</span> <span class="n">left</span> <span class="o">+</span> <span class="n">right</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">114</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span></span>        <span class="n">pad_img</span><span class="p">[</span><span class="n">top</span> <span class="p">:</span> <span class="n">top</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">left</span> <span class="p">:</span> <span class="n">left</span> <span class="o">+</span> <span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">img</span>
<span></span>        <span class="n">img</span> <span class="o">=</span> <span class="n">pad_img</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="n">labels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"ratio_pad"</span><span class="p">):</span>
<span></span>        <span class="n">labels</span><span class="p">[</span><span class="s2">"ratio_pad"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="s2">"ratio_pad"</span><span class="p">],</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">))</span>  <span class="c1"># for evaluation</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
<span></span>        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_labels</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">)</span>
<span></span>        <span class="n">labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span> <span class="o">=</span> <span class="n">img</span>
<span></span>        <span class="n">labels</span><span class="p">[</span><span class="s2">"resized_shape"</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_shape</span>
<span></span>        <span class="k">return</span> <span class="n">labels</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="k">return</span> <span class="n">img</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.CopyPaste">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.CopyPaste</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">CopyPaste</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pre_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'flip'</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.BaseMixTransform" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-class"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-class-name"&gt;ultralytics.data.augment.BaseMixTransform&lt;/span&gt;'>BaseMixTransform</a></code></p>
<p>CopyPaste class for applying Copy-Paste augmentation to image datasets.</p>
<p>This class implements the Copy-Paste augmentation technique as described in the paper "Simple Copy-Paste is a Strong
Data Augmentation Method for Instance Segmentation" (<a href="https://arxiv.org/abs/2012.07177">https://arxiv.org/abs/2012.07177</a>). It combines objects from
different images to create new training samples.</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.CopyPaste.dataset">dataset</span></code></td>
<td>
<code><span title="Any">Any</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The dataset to which Copy-Paste augmentation will be applied.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.CopyPaste.pre_transform">pre_transform</span></code></td>
<td>
<code><span title="Callable">Callable</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>Optional transform to apply before Copy-Paste.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.CopyPaste.p">p</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of applying Copy-Paste augmentation.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.CopyPaste.get_indexes" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;get_indexes&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.CopyPaste.get_indexes&lt;/code&gt;)'>get_indexes</a></code></td>
<td>
<div class="doc-md-description">
<p>Returns a random index from the dataset.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.CopyPaste._mix_transform">_mix_transform</span></code></td>
<td>
<div class="doc-md-description">
<p>Applies Copy-Paste augmentation to the input labels.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.CopyPaste.__call__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__call__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.CopyPaste.__call__&lt;/code&gt;)'>__call__</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies the Copy-Paste transformation to images and annotations.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.augment</span><span class="w"> </span><span class="kn">import</span> <span class="n">CopyPaste</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">YourDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># Your image dataset</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">copypaste</span> <span class="o">=</span> <span class="n">CopyPaste</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augmented_labels</span> <span class="o">=</span> <span class="n">copypaste</span><span class="p">(</span><span class="n">original_labels</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1668</span>
<span>1669</span>
<span>1670</span>
<span>1671</span>
<span>1672</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pre_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"flip"</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Initializes CopyPaste object with dataset, pre_transform, and probability of applying MixUp."""</span>
<span></span>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">pre_transform</span><span class="o">=</span><span class="n">pre_transform</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span></span>    <span class="k">assert</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"flip"</span><span class="p">,</span> <span class="s2">"mixup"</span><span class="p">},</span> <span class="sa">f</span><span class="s2">"Expected `mode` to be `flip` or `mixup`, but got </span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">."</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.CopyPaste.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">labels</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Applies Copy-Paste augmentation to an image and its labels.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1683</span>
<span>1684</span>
<span>1685</span>
<span>1686</span>
<span>1687</span>
<span>1688</span>
<span>1689</span>
<span>1690</span>
<span>1691</span>
<span>1692</span>
<span>1693</span>
<span>1694</span>
<span>1695</span>
<span>1696</span>
<span>1697</span>
<span>1698</span>
<span>1699</span>
<span>1700</span>
<span>1701</span>
<span>1702</span>
<span>1703</span>
<span>1704</span>
<span>1705</span>
<span>1706</span>
<span>1707</span>
<span>1708</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Applies Copy-Paste augmentation to an image and its labels."""</span>
<span></span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]</span><span class="o">.</span><span class="n">segments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>        <span class="k">return</span> <span class="n">labels</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">"flip"</span><span class="p">:</span>
<span></span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Get index of one or three other images</span>
<span></span>    <span class="n">indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_indexes</span><span class="p">()</span>
<span></span>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indexes</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<span></span>        <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">indexes</span><span class="p">]</span>
<span></span>
<span></span>    <span class="c1"># Get images information will be used for Mosaic or MixUp</span>
<span></span>    <span class="n">mix_labels</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_image_and_label</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">]</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_transform</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mix_labels</span><span class="p">):</span>
<span></span>            <span class="n">mix_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"mix_labels"</span><span class="p">]</span> <span class="o">=</span> <span class="n">mix_labels</span>
<span></span>
<span></span>    <span class="c1"># Update cls and texts</span>
<span></span>    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_label_text</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span>    <span class="c1"># Mosaic or MixUp</span>
<span></span>    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mix_transform</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span>    <span class="n">labels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"mix_labels"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">labels</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.CopyPaste.get_indexes">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">get_indexes</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">get_indexes</span><span class="p">()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Returns a list of random indexes from the dataset for CopyPaste augmentation.</p>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1674</span>
<span>1675</span>
<span>1676</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Returns a list of random indexes from the dataset for CopyPaste augmentation."""</span>
<span></span>    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.Albumentations">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.Albumentations</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">Albumentations</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Albumentations transformations for image augmentation.</p>
<p>This class applies various image transformations using the Albumentations library. It includes operations such as
Blur, Median Blur, conversion to grayscale, Contrast Limited Adaptive Histogram Equalization (CLAHE), random changes
in brightness and contrast, RandomGamma, and image quality reduction through compression.</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Albumentations.p">p</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of applying the transformations.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Albumentations.transform">transform</span></code></td>
<td>
<code><span title="albumentations.Compose">Compose</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Composed Albumentations transforms.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Albumentations.contains_spatial">contains_spatial</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Indicates if the transforms include spatial operations.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.Albumentations.__call__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__call__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.Albumentations.__call__&lt;/code&gt;)'>__call__</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies the Albumentations transformations to the input labels.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">Albumentations</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augmented_labels</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>The Albumentations package must be installed to use this class.</li>
<li>If the package is not installed or an error occurs during initialization, the transform will be set to None.</li>
<li>Spatial transforms are handled differently and require special processing for bounding boxes.</li>
</ul>
</details>
<p>This class applies various image augmentations using the Albumentations library, including Blur, Median Blur,
conversion to grayscale, Contrast Limited Adaptive Histogram Equalization, random changes of brightness and
contrast, RandomGamma, and image quality reduction through compression.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>p</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of applying the augmentations. Must be between 0 and 1.</p>
</div>
</td>
<td>
<code>1.0</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Albumentations.__init__.p">p</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of applying the augmentations.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Albumentations.__init__.transform">transform</span></code></td>
<td>
<code><span title="albumentations.Compose">Compose</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Composed Albumentations transforms.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Albumentations.__init__.contains_spatial">contains_spatial</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Indicates if the transforms include spatial transformations.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Raises:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="ImportError">ImportError</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If the Albumentations package is not installed.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code><span title="Exception">Exception</span></code>
</td>
<td>
<div class="doc-md-description">
<p>For any other errors during initialization.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">Albumentations</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augmented</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">bboxes</span><span class="o">=</span><span class="n">bboxes</span><span class="p">,</span> <span class="n">class_labels</span><span class="o">=</span><span class="n">classes</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augmented_image</span> <span class="o">=</span> <span class="n">augmented</span><span class="p">[</span><span class="s2">"image"</span><span class="p">]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augmented_bboxes</span> <span class="o">=</span> <span class="n">augmented</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>Requires Albumentations version 1.0.3 or higher.</li>
<li>Spatial transforms are handled differently to ensure bbox compatibility.</li>
<li>Some transforms are applied with very low probability (0.01) by default.</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1770</span>
<span>1771</span>
<span>1772</span>
<span>1773</span>
<span>1774</span>
<span>1775</span>
<span>1776</span>
<span>1777</span>
<span>1778</span>
<span>1779</span>
<span>1780</span>
<span>1781</span>
<span>1782</span>
<span>1783</span>
<span>1784</span>
<span>1785</span>
<span>1786</span>
<span>1787</span>
<span>1788</span>
<span>1789</span>
<span>1790</span>
<span>1791</span>
<span>1792</span>
<span>1793</span>
<span>1794</span>
<span>1795</span>
<span>1796</span>
<span>1797</span>
<span>1798</span>
<span>1799</span>
<span>1800</span>
<span>1801</span>
<span>1802</span>
<span>1803</span>
<span>1804</span>
<span>1805</span>
<span>1806</span>
<span>1807</span>
<span>1808</span>
<span>1809</span>
<span>1810</span>
<span>1811</span>
<span>1812</span>
<span>1813</span>
<span>1814</span>
<span>1815</span>
<span>1816</span>
<span>1817</span>
<span>1818</span>
<span>1819</span>
<span>1820</span>
<span>1821</span>
<span>1822</span>
<span>1823</span>
<span>1824</span>
<span>1825</span>
<span>1826</span>
<span>1827</span>
<span>1828</span>
<span>1829</span>
<span>1830</span>
<span>1831</span>
<span>1832</span>
<span>1833</span>
<span>1834</span>
<span>1835</span>
<span>1836</span>
<span>1837</span>
<span>1838</span>
<span>1839</span>
<span>1840</span>
<span>1841</span>
<span>1842</span>
<span>1843</span>
<span>1844</span>
<span>1845</span>
<span>1846</span>
<span>1847</span>
<span>1848</span>
<span>1849</span>
<span>1850</span>
<span>1851</span>
<span>1852</span>
<span>1853</span>
<span>1854</span>
<span>1855</span>
<span>1856</span>
<span>1857</span>
<span>1858</span>
<span>1859</span>
<span>1860</span>
<span>1861</span>
<span>1862</span>
<span>1863</span>
<span>1864</span>
<span>1865</span>
<span>1866</span>
<span>1867</span>
<span>1868</span>
<span>1869</span>
<span>1870</span>
<span>1871</span>
<span>1872</span>
<span>1873</span>
<span>1874</span>
<span>1875</span>
<span>1876</span>
<span>1877</span>
<span>1878</span>
<span>1879</span>
<span>1880</span>
<span>1881</span>
<span>1882</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initialize the Albumentations transform object for YOLO bbox formatted parameters.</span>
<span></span>
<span></span><span class="sd">    This class applies various image augmentations using the Albumentations library, including Blur, Median Blur,</span>
<span></span><span class="sd">    conversion to grayscale, Contrast Limited Adaptive Histogram Equalization, random changes of brightness and</span>
<span></span><span class="sd">    contrast, RandomGamma, and image quality reduction through compression.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        p (float): Probability of applying the augmentations. Must be between 0 and 1.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        p (float): Probability of applying the augmentations.</span>
<span></span><span class="sd">        transform (albumentations.Compose): Composed Albumentations transforms.</span>
<span></span><span class="sd">        contains_spatial (bool): Indicates if the transforms include spatial transformations.</span>
<span></span>
<span></span><span class="sd">    Raises:</span>
<span></span><span class="sd">        ImportError: If the Albumentations package is not installed.</span>
<span></span><span class="sd">        Exception: For any other errors during initialization.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = Albumentations(p=0.5)</span>
<span></span><span class="sd">        &gt;&gt;&gt; augmented = transform(image=image, bboxes=bboxes, class_labels=classes)</span>
<span></span><span class="sd">        &gt;&gt;&gt; augmented_image = augmented["image"]</span>
<span></span><span class="sd">        &gt;&gt;&gt; augmented_bboxes = augmented["bboxes"]</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        - Requires Albumentations version 1.0.3 or higher.</span>
<span></span><span class="sd">        - Spatial transforms are handled differently to ensure bbox compatibility.</span>
<span></span><span class="sd">        - Some transforms are applied with very low probability (0.01) by default.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">p</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="kc">None</span>
<span></span>    <span class="n">prefix</span> <span class="o">=</span> <span class="n">colorstr</span><span class="p">(</span><span class="s2">"albumentations: "</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">try</span><span class="p">:</span>
<span></span>        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span></span>
<span></span>        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">"NO_ALBUMENTATIONS_UPDATE"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"1"</span>  <span class="c1"># suppress Albumentations upgrade message</span>
<span></span>        <span class="kn">import</span><span class="w"> </span><span class="nn">albumentations</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">A</span>
<span></span>
<span></span>        <span class="n">check_version</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span> <span class="s2">"1.0.3"</span><span class="p">,</span> <span class="n">hard</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># version requirement</span>
<span></span>
<span></span>        <span class="c1"># List of possible spatial transforms</span>
<span></span>        <span class="n">spatial_transforms</span> <span class="o">=</span> <span class="p">{</span>
<span></span>            <span class="s2">"Affine"</span><span class="p">,</span>
<span></span>            <span class="s2">"BBoxSafeRandomCrop"</span><span class="p">,</span>
<span></span>            <span class="s2">"CenterCrop"</span><span class="p">,</span>
<span></span>            <span class="s2">"CoarseDropout"</span><span class="p">,</span>
<span></span>            <span class="s2">"Crop"</span><span class="p">,</span>
<span></span>            <span class="s2">"CropAndPad"</span><span class="p">,</span>
<span></span>            <span class="s2">"CropNonEmptyMaskIfExists"</span><span class="p">,</span>
<span></span>            <span class="s2">"D4"</span><span class="p">,</span>
<span></span>            <span class="s2">"ElasticTransform"</span><span class="p">,</span>
<span></span>            <span class="s2">"Flip"</span><span class="p">,</span>
<span></span>            <span class="s2">"GridDistortion"</span><span class="p">,</span>
<span></span>            <span class="s2">"GridDropout"</span><span class="p">,</span>
<span></span>            <span class="s2">"HorizontalFlip"</span><span class="p">,</span>
<span></span>            <span class="s2">"Lambda"</span><span class="p">,</span>
<span></span>            <span class="s2">"LongestMaxSize"</span><span class="p">,</span>
<span></span>            <span class="s2">"MaskDropout"</span><span class="p">,</span>
<span></span>            <span class="s2">"MixUp"</span><span class="p">,</span>
<span></span>            <span class="s2">"Morphological"</span><span class="p">,</span>
<span></span>            <span class="s2">"NoOp"</span><span class="p">,</span>
<span></span>            <span class="s2">"OpticalDistortion"</span><span class="p">,</span>
<span></span>            <span class="s2">"PadIfNeeded"</span><span class="p">,</span>
<span></span>            <span class="s2">"Perspective"</span><span class="p">,</span>
<span></span>            <span class="s2">"PiecewiseAffine"</span><span class="p">,</span>
<span></span>            <span class="s2">"PixelDropout"</span><span class="p">,</span>
<span></span>            <span class="s2">"RandomCrop"</span><span class="p">,</span>
<span></span>            <span class="s2">"RandomCropFromBorders"</span><span class="p">,</span>
<span></span>            <span class="s2">"RandomGridShuffle"</span><span class="p">,</span>
<span></span>            <span class="s2">"RandomResizedCrop"</span><span class="p">,</span>
<span></span>            <span class="s2">"RandomRotate90"</span><span class="p">,</span>
<span></span>            <span class="s2">"RandomScale"</span><span class="p">,</span>
<span></span>            <span class="s2">"RandomSizedBBoxSafeCrop"</span><span class="p">,</span>
<span></span>            <span class="s2">"RandomSizedCrop"</span><span class="p">,</span>
<span></span>            <span class="s2">"Resize"</span><span class="p">,</span>
<span></span>            <span class="s2">"Rotate"</span><span class="p">,</span>
<span></span>            <span class="s2">"SafeRotate"</span><span class="p">,</span>
<span></span>            <span class="s2">"ShiftScaleRotate"</span><span class="p">,</span>
<span></span>            <span class="s2">"SmallestMaxSize"</span><span class="p">,</span>
<span></span>            <span class="s2">"Transpose"</span><span class="p">,</span>
<span></span>            <span class="s2">"VerticalFlip"</span><span class="p">,</span>
<span></span>            <span class="s2">"XYMasking"</span><span class="p">,</span>
<span></span>        <span class="p">}</span>  <span class="c1"># from https://albumentations.ai/docs/getting_started/transforms_and_targets/#spatial-level-transforms</span>
<span></span>
<span></span>        <span class="c1"># Transforms</span>
<span></span>        <span class="n">T</span> <span class="o">=</span> <span class="p">[</span>
<span></span>            <span class="n">A</span><span class="o">.</span><span class="n">Blur</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span>
<span></span>            <span class="n">A</span><span class="o">.</span><span class="n">MedianBlur</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span>
<span></span>            <span class="n">A</span><span class="o">.</span><span class="n">ToGray</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span>
<span></span>            <span class="n">A</span><span class="o">.</span><span class="n">CLAHE</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span>
<span></span>            <span class="n">A</span><span class="o">.</span><span class="n">RandomBrightnessContrast</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<span></span>            <span class="n">A</span><span class="o">.</span><span class="n">RandomGamma</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<span></span>            <span class="n">A</span><span class="o">.</span><span class="n">ImageCompression</span><span class="p">(</span><span class="n">quality_range</span><span class="o">=</span><span class="p">(</span><span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<span></span>        <span class="p">]</span>
<span></span>
<span></span>        <span class="c1"># Compose transforms</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">contains_spatial</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">transform</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="n">spatial_transforms</span> <span class="k">for</span> <span class="n">transform</span> <span class="ow">in</span> <span class="n">T</span><span class="p">)</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="p">(</span>
<span></span>            <span class="n">A</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">bbox_params</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">BboxParams</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">"yolo"</span><span class="p">,</span> <span class="n">label_fields</span><span class="o">=</span><span class="p">[</span><span class="s2">"class_labels"</span><span class="p">]))</span>
<span></span>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains_spatial</span>
<span></span>            <span class="k">else</span> <span class="n">A</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span></span>        <span class="p">)</span>
<span></span>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="s2">"set_random_seed"</span><span class="p">):</span>
<span></span>            <span class="c1"># Required for deterministic transforms in albumentations&gt;=1.4.21</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">set_random_seed</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">initial_seed</span><span class="p">())</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">", "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">"</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"always_apply=False, "</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">T</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">p</span><span class="p">))</span>
<span></span>    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>  <span class="c1"># package not installed, skip</span>
<span></span>        <span class="k">pass</span>
<span></span>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.Albumentations.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">labels</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Applies Albumentations transformations to input labels.</p>
<p>This method applies a series of image augmentations using the Albumentations library. It can perform both
spatial and non-spatial transformations on the input image and its corresponding labels.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>labels</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A dictionary containing image data and annotations. Expected keys are:
- 'img': numpy.ndarray representing the image
- 'cls': numpy.ndarray of class labels
- 'instances': object containing bounding boxes and other instance information</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The input dictionary with augmented image and updated annotations.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">Albumentations</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span>
<span></span><span class="gp">... </span>    <span class="s2">"img"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span></span><span class="gp">... </span>    <span class="s2">"cls"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
<span></span><span class="gp">... </span>    <span class="s2">"instances"</span><span class="p">:</span> <span class="n">Instances</span><span class="p">(</span><span class="n">bboxes</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]])),</span>
<span></span><span class="gp">... </span><span class="p">}</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augmented</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">augmented</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>The method applies transformations with probability self.p.</li>
<li>Spatial transforms update bounding boxes, while non-spatial transforms only modify the image.</li>
<li>Requires the Albumentations library to be installed.</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1884</span>
<span>1885</span>
<span>1886</span>
<span>1887</span>
<span>1888</span>
<span>1889</span>
<span>1890</span>
<span>1891</span>
<span>1892</span>
<span>1893</span>
<span>1894</span>
<span>1895</span>
<span>1896</span>
<span>1897</span>
<span>1898</span>
<span>1899</span>
<span>1900</span>
<span>1901</span>
<span>1902</span>
<span>1903</span>
<span>1904</span>
<span>1905</span>
<span>1906</span>
<span>1907</span>
<span>1908</span>
<span>1909</span>
<span>1910</span>
<span>1911</span>
<span>1912</span>
<span>1913</span>
<span>1914</span>
<span>1915</span>
<span>1916</span>
<span>1917</span>
<span>1918</span>
<span>1919</span>
<span>1920</span>
<span>1921</span>
<span>1922</span>
<span>1923</span>
<span>1924</span>
<span>1925</span>
<span>1926</span>
<span>1927</span>
<span>1928</span>
<span>1929</span>
<span>1930</span>
<span>1931</span>
<span>1932</span>
<span>1933</span>
<span>1934</span>
<span>1935</span>
<span>1936</span>
<span>1937</span>
<span>1938</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Applies Albumentations transformations to input labels.</span>
<span></span>
<span></span><span class="sd">    This method applies a series of image augmentations using the Albumentations library. It can perform both</span>
<span></span><span class="sd">    spatial and non-spatial transformations on the input image and its corresponding labels.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels (dict): A dictionary containing image data and annotations. Expected keys are:</span>
<span></span><span class="sd">            - 'img': numpy.ndarray representing the image</span>
<span></span><span class="sd">            - 'cls': numpy.ndarray of class labels</span>
<span></span><span class="sd">            - 'instances': object containing bounding boxes and other instance information</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): The input dictionary with augmented image and updated annotations.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = Albumentations(p=0.5)</span>
<span></span><span class="sd">        &gt;&gt;&gt; labels = {</span>
<span></span><span class="sd">        ...     "img": np.random.rand(640, 640, 3),</span>
<span></span><span class="sd">        ...     "cls": np.array([0, 1]),</span>
<span></span><span class="sd">        ...     "instances": Instances(bboxes=np.array([[0, 0, 1, 1], [0.5, 0.5, 0.8, 0.8]])),</span>
<span></span><span class="sd">        ... }</span>
<span></span><span class="sd">        &gt;&gt;&gt; augmented = transform(labels)</span>
<span></span><span class="sd">        &gt;&gt;&gt; assert augmented["img"].shape == (640, 640, 3)</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        - The method applies transformations with probability self.p.</span>
<span></span><span class="sd">        - Spatial transforms update bounding boxes, while non-spatial transforms only modify the image.</span>
<span></span><span class="sd">        - Requires the Albumentations library to be installed.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
<span></span>        <span class="k">return</span> <span class="n">labels</span>
<span></span>
<span></span>    <span class="n">im</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span>
<span></span>    <span class="k">if</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># Only apply Albumentation on 3-channel images</span>
<span></span>        <span class="k">return</span> <span class="n">labels</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains_spatial</span><span class="p">:</span>
<span></span>        <span class="bp">cls</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">]</span>
<span></span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span></span>            <span class="n">labels</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]</span><span class="o">.</span><span class="n">convert_bbox</span><span class="p">(</span><span class="s2">"xywh"</span><span class="p">)</span>
<span></span>            <span class="n">labels</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="o">*</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span></span>            <span class="n">bboxes</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]</span><span class="o">.</span><span class="n">bboxes</span>
<span></span>            <span class="c1"># TODO: add supports of segments and keypoints</span>
<span></span>            <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">im</span><span class="p">,</span> <span class="n">bboxes</span><span class="o">=</span><span class="n">bboxes</span><span class="p">,</span> <span class="n">class_labels</span><span class="o">=</span><span class="bp">cls</span><span class="p">)</span>  <span class="c1"># transformed</span>
<span></span>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="s2">"class_labels"</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># skip update if no bbox in new im</span>
<span></span>                <span class="n">labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span><span class="p">[</span><span class="s2">"image"</span><span class="p">]</span>
<span></span>                <span class="n">labels</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="s2">"class_labels"</span><span class="p">])</span>
<span></span>                <span class="n">bboxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>            <span class="n">labels</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">bboxes</span><span class="o">=</span><span class="n">bboxes</span><span class="p">)</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="n">labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">])[</span><span class="s2">"image"</span><span class="p">]</span>  <span class="c1"># transformed</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="n">labels</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.Format">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.Format</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">Format</span><span class="p">(</span>
<span></span>    <span class="n">bbox_format</span><span class="o">=</span><span class="s2">"xywh"</span><span class="p">,</span>
<span></span>    <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">return_mask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">return_keypoint</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">return_obb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">mask_ratio</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span></span>    <span class="n">mask_overlap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">batch_idx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">bgr</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span></span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>A class for formatting image annotations for object detection, instance segmentation, and pose estimation tasks.</p>
<p>This class standardizes image and instance annotations to be used by the <code>collate_fn</code> in PyTorch DataLoader.</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.bbox_format">bbox_format</span></code></td>
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Format for bounding boxes. Options are 'xywh' or 'xyxy'.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.normalize">normalize</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to normalize bounding boxes.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.return_mask">return_mask</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to return instance masks for segmentation.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.return_keypoint">return_keypoint</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to return keypoints for pose estimation.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.return_obb">return_obb</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to return oriented bounding boxes.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.mask_ratio">mask_ratio</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Downsample ratio for masks.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.mask_overlap">mask_overlap</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to overlap masks.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.batch_idx">batch_idx</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to keep batch indexes.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.bgr">bgr</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The probability to return BGR images.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.Format.__call__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__call__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.Format.__call__&lt;/code&gt;)'>__call__</a></code></td>
<td>
<div class="doc-md-description">
<p>Formats labels dictionary with image, classes, bounding boxes, and optionally masks and keypoints.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format._format_img">_format_img</span></code></td>
<td>
<div class="doc-md-description">
<p>Converts image from Numpy array to PyTorch tensor.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format._format_segments">_format_segments</span></code></td>
<td>
<div class="doc-md-description">
<p>Converts polygon points to bitmap masks.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">formatter</span> <span class="o">=</span> <span class="n">Format</span><span class="p">(</span><span class="n">bbox_format</span><span class="o">=</span><span class="s2">"xywh"</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">formatted_labels</span> <span class="o">=</span> <span class="n">formatter</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">formatted_labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bboxes</span> <span class="o">=</span> <span class="n">formatted_labels</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">masks</span> <span class="o">=</span> <span class="n">formatted_labels</span><span class="p">[</span><span class="s2">"masks"</span><span class="p">]</span>
</code></pre></div>
<p>This class standardizes image and instance annotations for object detection, instance segmentation, and pose
estimation tasks, preparing them for use in PyTorch DataLoader's <code>collate_fn</code>.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>bbox_format</code>
</td>
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Format for bounding boxes. Options are 'xywh', 'xyxy', etc.</p>
</div>
</td>
<td>
<code>'xywh'</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>normalize</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to normalize bounding boxes to [0,1].</p>
</div>
</td>
<td>
<code>True</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>return_mask</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, returns instance masks for segmentation tasks.</p>
</div>
</td>
<td>
<code>False</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>return_keypoint</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, returns keypoints for pose estimation tasks.</p>
</div>
</td>
<td>
<code>False</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>return_obb</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, returns oriented bounding boxes.</p>
</div>
</td>
<td>
<code>False</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>mask_ratio</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Downsample ratio for masks.</p>
</div>
</td>
<td>
<code>4</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>mask_overlap</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, allows mask overlap.</p>
</div>
</td>
<td>
<code>True</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>batch_idx</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, keeps batch indexes.</p>
</div>
</td>
<td>
<code>True</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>bgr</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of returning BGR images instead of RGB.</p>
</div>
</td>
<td>
<code>0.0</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.__init__.bbox_format">bbox_format</span></code></td>
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Format for bounding boxes.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.__init__.normalize">normalize</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether bounding boxes are normalized.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.__init__.return_mask">return_mask</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to return instance masks.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.__init__.return_keypoint">return_keypoint</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to return keypoints.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.__init__.return_obb">return_obb</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to return oriented bounding boxes.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.__init__.mask_ratio">mask_ratio</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Downsample ratio for masks.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.__init__.mask_overlap">mask_overlap</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether masks can overlap.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.__init__.batch_idx">batch_idx</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to keep batch indexes.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.Format.__init__.bgr">bgr</span></code></td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The probability to return BGR images.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">format</span> <span class="o">=</span> <span class="n">Format</span><span class="p">(</span><span class="n">bbox_format</span><span class="o">=</span><span class="s2">"xyxy"</span><span class="p">,</span> <span class="n">return_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_keypoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">format</span><span class="o">.</span><span class="n">bbox_format</span><span class="p">)</span>
<span></span><span class="go">xyxy</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>1971</span>
<span>1972</span>
<span>1973</span>
<span>1974</span>
<span>1975</span>
<span>1976</span>
<span>1977</span>
<span>1978</span>
<span>1979</span>
<span>1980</span>
<span>1981</span>
<span>1982</span>
<span>1983</span>
<span>1984</span>
<span>1985</span>
<span>1986</span>
<span>1987</span>
<span>1988</span>
<span>1989</span>
<span>1990</span>
<span>1991</span>
<span>1992</span>
<span>1993</span>
<span>1994</span>
<span>1995</span>
<span>1996</span>
<span>1997</span>
<span>1998</span>
<span>1999</span>
<span>2000</span>
<span>2001</span>
<span>2002</span>
<span>2003</span>
<span>2004</span>
<span>2005</span>
<span>2006</span>
<span>2007</span>
<span>2008</span>
<span>2009</span>
<span>2010</span>
<span>2011</span>
<span>2012</span>
<span>2013</span>
<span>2014</span>
<span>2015</span>
<span>2016</span>
<span>2017</span>
<span>2018</span>
<span>2019</span>
<span>2020</span>
<span>2021</span>
<span>2022</span>
<span>2023</span>
<span>2024</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<span></span>    <span class="bp">self</span><span class="p">,</span>
<span></span>    <span class="n">bbox_format</span><span class="o">=</span><span class="s2">"xywh"</span><span class="p">,</span>
<span></span>    <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">return_mask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">return_keypoint</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">return_obb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">mask_ratio</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span></span>    <span class="n">mask_overlap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">batch_idx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">bgr</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span></span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initializes the Format class with given parameters for image and instance annotation formatting.</span>
<span></span>
<span></span><span class="sd">    This class standardizes image and instance annotations for object detection, instance segmentation, and pose</span>
<span></span><span class="sd">    estimation tasks, preparing them for use in PyTorch DataLoader's `collate_fn`.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        bbox_format (str): Format for bounding boxes. Options are 'xywh', 'xyxy', etc.</span>
<span></span><span class="sd">        normalize (bool): Whether to normalize bounding boxes to [0,1].</span>
<span></span><span class="sd">        return_mask (bool): If True, returns instance masks for segmentation tasks.</span>
<span></span><span class="sd">        return_keypoint (bool): If True, returns keypoints for pose estimation tasks.</span>
<span></span><span class="sd">        return_obb (bool): If True, returns oriented bounding boxes.</span>
<span></span><span class="sd">        mask_ratio (int): Downsample ratio for masks.</span>
<span></span><span class="sd">        mask_overlap (bool): If True, allows mask overlap.</span>
<span></span><span class="sd">        batch_idx (bool): If True, keeps batch indexes.</span>
<span></span><span class="sd">        bgr (float): Probability of returning BGR images instead of RGB.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        bbox_format (str): Format for bounding boxes.</span>
<span></span><span class="sd">        normalize (bool): Whether bounding boxes are normalized.</span>
<span></span><span class="sd">        return_mask (bool): Whether to return instance masks.</span>
<span></span><span class="sd">        return_keypoint (bool): Whether to return keypoints.</span>
<span></span><span class="sd">        return_obb (bool): Whether to return oriented bounding boxes.</span>
<span></span><span class="sd">        mask_ratio (int): Downsample ratio for masks.</span>
<span></span><span class="sd">        mask_overlap (bool): Whether masks can overlap.</span>
<span></span><span class="sd">        batch_idx (bool): Whether to keep batch indexes.</span>
<span></span><span class="sd">        bgr (float): The probability to return BGR images.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; format = Format(bbox_format="xyxy", return_mask=True, return_keypoint=False)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(format.bbox_format)</span>
<span></span><span class="sd">        xyxy</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">bbox_format</span> <span class="o">=</span> <span class="n">bbox_format</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="n">normalize</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">return_mask</span> <span class="o">=</span> <span class="n">return_mask</span>  <span class="c1"># set False when training detection only</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">return_keypoint</span> <span class="o">=</span> <span class="n">return_keypoint</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">return_obb</span> <span class="o">=</span> <span class="n">return_obb</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">mask_ratio</span> <span class="o">=</span> <span class="n">mask_ratio</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">mask_overlap</span> <span class="o">=</span> <span class="n">mask_overlap</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">batch_idx</span> <span class="o">=</span> <span class="n">batch_idx</span>  <span class="c1"># keep the batch indexes</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">bgr</span> <span class="o">=</span> <span class="n">bgr</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.Format.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">labels</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Formats image annotations for object detection, instance segmentation, and pose estimation tasks.</p>
<p>This method standardizes the image and instance annotations to be used by the <code>collate_fn</code> in PyTorch
DataLoader. It processes the input labels dictionary, converting annotations to the specified format and
applying normalization if required.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>labels</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A dictionary containing image and annotation data with the following keys:
- 'img': The input image as a numpy array.
- 'cls': Class labels for instances.
- 'instances': An Instances object containing bounding boxes, segments, and keypoints.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A dictionary with formatted data, including:
- 'img': Formatted image tensor.
- 'cls': Class label's tensor.
- 'bboxes': Bounding boxes tensor in the specified format.
- 'masks': Instance masks tensor (if return_mask is True).
- 'keypoints': Keypoints tensor (if return_keypoint is True).
- 'batch_idx': Batch index tensor (if batch_idx is True).</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">formatter</span> <span class="o">=</span> <span class="n">Format</span><span class="p">(</span><span class="n">bbox_format</span><span class="o">=</span><span class="s2">"xywh"</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"img"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s2">"cls"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="s2">"instances"</span><span class="p">:</span> <span class="n">Instances</span><span class="p">(</span><span class="o">...</span><span class="p">)}</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">formatted_labels</span> <span class="o">=</span> <span class="n">formatter</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">formatted_labels</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2026</span>
<span>2027</span>
<span>2028</span>
<span>2029</span>
<span>2030</span>
<span>2031</span>
<span>2032</span>
<span>2033</span>
<span>2034</span>
<span>2035</span>
<span>2036</span>
<span>2037</span>
<span>2038</span>
<span>2039</span>
<span>2040</span>
<span>2041</span>
<span>2042</span>
<span>2043</span>
<span>2044</span>
<span>2045</span>
<span>2046</span>
<span>2047</span>
<span>2048</span>
<span>2049</span>
<span>2050</span>
<span>2051</span>
<span>2052</span>
<span>2053</span>
<span>2054</span>
<span>2055</span>
<span>2056</span>
<span>2057</span>
<span>2058</span>
<span>2059</span>
<span>2060</span>
<span>2061</span>
<span>2062</span>
<span>2063</span>
<span>2064</span>
<span>2065</span>
<span>2066</span>
<span>2067</span>
<span>2068</span>
<span>2069</span>
<span>2070</span>
<span>2071</span>
<span>2072</span>
<span>2073</span>
<span>2074</span>
<span>2075</span>
<span>2076</span>
<span>2077</span>
<span>2078</span>
<span>2079</span>
<span>2080</span>
<span>2081</span>
<span>2082</span>
<span>2083</span>
<span>2084</span>
<span>2085</span>
<span>2086</span>
<span>2087</span>
<span>2088</span>
<span>2089</span>
<span>2090</span>
<span>2091</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Formats image annotations for object detection, instance segmentation, and pose estimation tasks.</span>
<span></span>
<span></span><span class="sd">    This method standardizes the image and instance annotations to be used by the `collate_fn` in PyTorch</span>
<span></span><span class="sd">    DataLoader. It processes the input labels dictionary, converting annotations to the specified format and</span>
<span></span><span class="sd">    applying normalization if required.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels (dict): A dictionary containing image and annotation data with the following keys:</span>
<span></span><span class="sd">            - 'img': The input image as a numpy array.</span>
<span></span><span class="sd">            - 'cls': Class labels for instances.</span>
<span></span><span class="sd">            - 'instances': An Instances object containing bounding boxes, segments, and keypoints.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): A dictionary with formatted data, including:</span>
<span></span><span class="sd">            - 'img': Formatted image tensor.</span>
<span></span><span class="sd">            - 'cls': Class label's tensor.</span>
<span></span><span class="sd">            - 'bboxes': Bounding boxes tensor in the specified format.</span>
<span></span><span class="sd">            - 'masks': Instance masks tensor (if return_mask is True).</span>
<span></span><span class="sd">            - 'keypoints': Keypoints tensor (if return_keypoint is True).</span>
<span></span><span class="sd">            - 'batch_idx': Batch index tensor (if batch_idx is True).</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; formatter = Format(bbox_format="xywh", normalize=True, return_mask=True)</span>
<span></span><span class="sd">        &gt;&gt;&gt; labels = {"img": np.random.rand(640, 640, 3), "cls": np.array([0, 1]), "instances": Instances(...)}</span>
<span></span><span class="sd">        &gt;&gt;&gt; formatted_labels = formatter(labels)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(formatted_labels.keys())</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">img</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"img"</span><span class="p">)</span>
<span></span>    <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span></span>    <span class="bp">cls</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"cls"</span><span class="p">)</span>
<span></span>    <span class="n">instances</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"instances"</span><span class="p">)</span>
<span></span>    <span class="n">instances</span><span class="o">.</span><span class="n">convert_bbox</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_format</span><span class="p">)</span>
<span></span>    <span class="n">instances</span><span class="o">.</span><span class="n">denormalize</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span></span>    <span class="n">nl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_mask</span><span class="p">:</span>
<span></span>        <span class="k">if</span> <span class="n">nl</span><span class="p">:</span>
<span></span>            <span class="n">masks</span><span class="p">,</span> <span class="n">instances</span><span class="p">,</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_segments</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span></span>            <span class="n">masks</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">masks</span><span class="p">)</span>
<span></span>        <span class="k">else</span><span class="p">:</span>
<span></span>            <span class="n">masks</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
<span></span>                <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_overlap</span> <span class="k">else</span> <span class="n">nl</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_ratio</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_ratio</span>
<span></span>            <span class="p">)</span>
<span></span>        <span class="n">labels</span><span class="p">[</span><span class="s2">"masks"</span><span class="p">]</span> <span class="o">=</span> <span class="n">masks</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_img</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="k">if</span> <span class="n">nl</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nl</span><span class="p">)</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">instances</span><span class="o">.</span><span class="n">bboxes</span><span class="p">)</span> <span class="k">if</span> <span class="n">nl</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nl</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_keypoint</span><span class="p">:</span>
<span></span>        <span class="n">labels</span><span class="p">[</span><span class="s2">"keypoints"</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">instances</span><span class="o">.</span><span class="n">keypoints</span><span class="p">)</span>
<span></span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">:</span>
<span></span>            <span class="n">labels</span><span class="p">[</span><span class="s2">"keypoints"</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">w</span>
<span></span>            <span class="n">labels</span><span class="p">[</span><span class="s2">"keypoints"</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">h</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_obb</span><span class="p">:</span>
<span></span>        <span class="n">labels</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<span></span>            <span class="n">xyxyxyxy2xywhr</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">instances</span><span class="o">.</span><span class="n">segments</span><span class="p">))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="o">.</span><span class="n">segments</span><span class="p">)</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span></span>        <span class="p">)</span>
<span></span>    <span class="c1"># NOTE: need to normalize obb in xywhr format for width-height consistency</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">:</span>
<span></span>        <span class="n">labels</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">][:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span> <span class="o">/=</span> <span class="n">w</span>
<span></span>        <span class="n">labels</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">][:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span> <span class="o">/=</span> <span class="n">h</span>
<span></span>    <span class="c1"># Then we can use collate_fn</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_idx</span><span class="p">:</span>
<span></span>        <span class="n">labels</span><span class="p">[</span><span class="s2">"batch_idx"</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nl</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">labels</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.LoadVisualPrompt">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.LoadVisualPrompt</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">LoadVisualPrompt</span><span class="p">(</span><span class="n">scale_factor</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Creates visual prompts from bounding boxes or masks for model input.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>scale_factor</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Factor to scale the input image dimensions.</p>
</div>
</td>
<td>
<code>1 / 8</code>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2159</span>
<span>2160</span>
<span>2161</span>
<span>2162</span>
<span>2163</span>
<span>2164</span>
<span>2165</span>
<span>2166</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initialize the LoadVisualPrompt with a scale factor.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        scale_factor (float): Factor to scale the input image dimensions.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="n">scale_factor</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.LoadVisualPrompt.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">labels</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Process labels to create visual prompts.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>labels</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Dictionary containing image data and annotations.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Updated labels with visual prompts added.</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2186</span>
<span>2187</span>
<span>2188</span>
<span>2189</span>
<span>2190</span>
<span>2191</span>
<span>2192</span>
<span>2193</span>
<span>2194</span>
<span>2195</span>
<span>2196</span>
<span>2197</span>
<span>2198</span>
<span>2199</span>
<span>2200</span>
<span>2201</span>
<span>2202</span>
<span>2203</span>
<span>2204</span>
<span>2205</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Process labels to create visual prompts.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels (dict): Dictionary containing image data and annotations.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): Updated labels with visual prompts added.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">imgsz</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"img"</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span></span>    <span class="n">bboxes</span><span class="p">,</span> <span class="n">masks</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<span></span>    <span class="k">if</span> <span class="s2">"bboxes"</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
<span></span>        <span class="n">bboxes</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]</span>
<span></span>        <span class="n">bboxes</span> <span class="o">=</span> <span class="n">xywh2xyxy</span><span class="p">(</span><span class="n">bboxes</span><span class="p">)</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">imgsz</span><span class="p">)[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>  <span class="c1"># denormalize boxes</span>
<span></span>
<span></span>    <span class="bp">cls</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span></span>    <span class="n">visuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visuals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">imgsz</span><span class="p">,</span> <span class="n">bboxes</span><span class="o">=</span><span class="n">bboxes</span><span class="p">,</span> <span class="n">masks</span><span class="o">=</span><span class="n">masks</span><span class="p">)</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"visuals"</span><span class="p">]</span> <span class="o">=</span> <span class="n">visuals</span>
<span></span>    <span class="k">return</span> <span class="n">labels</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.LoadVisualPrompt.get_visuals">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">get_visuals</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">get_visuals</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">bboxes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">masks</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Generate visual masks based on bounding boxes or masks.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>category</code>
</td>
<td>
<code><span title="int">int</span> | <span title="numpy.ndarray">ndarray</span> | <span title="torch.Tensor">Tensor</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The category labels for the objects.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>shape</code>
</td>
<td>
<code><span title="tuple">tuple</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The shape of the image (height, width).</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>bboxes</code>
</td>
<td>
<code><span title="numpy.ndarray">ndarray</span> | <span title="torch.Tensor">Tensor</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Bounding boxes for the objects, xyxy format. Defaults to None.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>masks</code>
</td>
<td>
<code><span title="numpy.ndarray">ndarray</span> | <span title="torch.Tensor">Tensor</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Masks for the objects. Defaults to None.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="torch.Tensor">Tensor</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A tensor containing the visual masks for each category.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Raises:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="ValueError">ValueError</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If neither bboxes nor masks are provided.</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2207</span>
<span>2208</span>
<span>2209</span>
<span>2210</span>
<span>2211</span>
<span>2212</span>
<span>2213</span>
<span>2214</span>
<span>2215</span>
<span>2216</span>
<span>2217</span>
<span>2218</span>
<span>2219</span>
<span>2220</span>
<span>2221</span>
<span>2222</span>
<span>2223</span>
<span>2224</span>
<span>2225</span>
<span>2226</span>
<span>2227</span>
<span>2228</span>
<span>2229</span>
<span>2230</span>
<span>2231</span>
<span>2232</span>
<span>2233</span>
<span>2234</span>
<span>2235</span>
<span>2236</span>
<span>2237</span>
<span>2238</span>
<span>2239</span>
<span>2240</span>
<span>2241</span>
<span>2242</span>
<span>2243</span>
<span>2244</span>
<span>2245</span>
<span>2246</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_visuals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">bboxes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">masks</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Generate visual masks based on bounding boxes or masks.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        category (int | np.ndarray | torch.Tensor): The category labels for the objects.</span>
<span></span><span class="sd">        shape (tuple): The shape of the image (height, width).</span>
<span></span><span class="sd">        bboxes (np.ndarray | torch.Tensor, optional): Bounding boxes for the objects, xyxy format. Defaults to None.</span>
<span></span><span class="sd">        masks (np.ndarray | torch.Tensor, optional): Masks for the objects. Defaults to None.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor): A tensor containing the visual masks for each category.</span>
<span></span>
<span></span><span class="sd">    Raises:</span>
<span></span><span class="sd">        ValueError: If neither bboxes nor masks are provided.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">masksz</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span><span class="p">))</span>
<span></span>    <span class="k">if</span> <span class="n">bboxes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bboxes</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span></span>            <span class="n">bboxes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">bboxes</span><span class="p">)</span>
<span></span>        <span class="n">bboxes</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span>
<span></span>        <span class="n">masks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_mask</span><span class="p">(</span><span class="n">bboxes</span><span class="p">,</span> <span class="o">*</span><span class="n">masksz</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<span></span>    <span class="k">elif</span> <span class="n">masks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">masks</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span></span>            <span class="n">masks</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">masks</span><span class="p">)</span>  <span class="c1"># (N, H, W)</span>
<span></span>        <span class="n">masks</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">masks</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">masksz</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"nearest"</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"LoadVisualPrompt must have bboxes or masks in the label"</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<span></span>        <span class="n">category</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span></span>    <span class="n">cls_unique</span><span class="p">,</span> <span class="n">inverse_indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="nb">sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>    <span class="c1"># NOTE: `cls` indices from RandomLoadText should be continuous.</span>
<span></span>    <span class="c1"># if len(cls_unique):</span>
<span></span>    <span class="c1">#     assert len(cls_unique) == cls_unique[-1] + 1, (</span>
<span></span>    <span class="c1">#         f"Expected a continuous range of class indices, but got {cls_unique}"</span>
<span></span>    <span class="c1">#     )</span>
<span></span>    <span class="n">visuals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cls_unique</span><span class="p">),</span> <span class="o">*</span><span class="n">masksz</span><span class="p">)</span>
<span></span>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">mask</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">inverse_indices</span><span class="p">,</span> <span class="n">masks</span><span class="p">):</span>
<span></span>        <span class="n">visuals</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">visuals</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">mask</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">visuals</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.LoadVisualPrompt.make_mask">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">make_mask</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">make_mask</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Create binary masks from bounding boxes.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>boxes</code>
</td>
<td>
<code><span title="torch.Tensor">Tensor</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Bounding boxes in xyxy format, shape: (N, 4).</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>h</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Height of the mask.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>w</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Width of the mask.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="torch.Tensor">Tensor</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Binary masks with shape (N, h, w).</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2168</span>
<span>2169</span>
<span>2170</span>
<span>2171</span>
<span>2172</span>
<span>2173</span>
<span>2174</span>
<span>2175</span>
<span>2176</span>
<span>2177</span>
<span>2178</span>
<span>2179</span>
<span>2180</span>
<span>2181</span>
<span>2182</span>
<span>2183</span>
<span>2184</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">make_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Create binary masks from bounding boxes.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        boxes (torch.Tensor): Bounding boxes in xyxy format, shape: (N, 4).</span>
<span></span><span class="sd">        h (int): Height of the mask.</span>
<span></span><span class="sd">        w (int): Width of the mask.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor): Binary masks with shape (N, h, w).</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">boxes</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">],</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># x1 shape(n,1,1)</span>
<span></span>    <span class="n">r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">w</span><span class="p">)[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># rows shape(1,1,w)</span>
<span></span>    <span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">h</span><span class="p">)[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">]</span>  <span class="c1"># cols shape(1,h,1)</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="p">(</span><span class="n">r</span> <span class="o">&gt;=</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;=</span> <span class="n">y1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">y2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.RandomLoadText">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.RandomLoadText</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">RandomLoadText</span><span class="p">(</span>
<span></span>    <span class="n">prompt_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"</span><span class="si">{}</span><span class="s2">"</span><span class="p">,</span>
<span></span>    <span class="n">neg_samples</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
<span></span>    <span class="n">max_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span>
<span></span>    <span class="n">padding</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">padding_value</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">""</span><span class="p">],</span>
<span></span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Randomly samples positive and negative texts and updates class indices accordingly.</p>
<p>This class is responsible for sampling texts from a given set of class texts, including both positive
(present in the image) and negative (not present in the image) samples. It updates the class indices
to reflect the sampled texts and can optionally pad the text list to a fixed length.</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomLoadText.prompt_format">prompt_format</span></code></td>
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Format string for text prompts.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomLoadText.neg_samples">neg_samples</span></code></td>
<td>
<code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>Range for randomly sampling negative texts.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomLoadText.max_samples">max_samples</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Maximum number of different text samples in one image.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomLoadText.padding">padding</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to pad texts to max_samples.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomLoadText.padding_value">padding_value</span></code></td>
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The text used for padding when padding is True.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.RandomLoadText.__call__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__call__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.RandomLoadText.__call__&lt;/code&gt;)'>__call__</a></code></td>
<td>
<div class="doc-md-description">
<p>Processes the input labels and returns updated classes and texts.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">RandomLoadText</span><span class="p">(</span><span class="n">prompt_format</span><span class="o">=</span><span class="s2">"Object: </span><span class="si">{}</span><span class="s2">"</span><span class="p">,</span> <span class="n">neg_samples</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">max_samples</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"cls"</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">"texts"</span><span class="p">:</span> <span class="p">[[</span><span class="s2">"cat"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"dog"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"bird"</span><span class="p">]],</span> <span class="s2">"instances"</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="p">]}</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">updated_labels</span> <span class="o">=</span> <span class="n">loader</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">updated_labels</span><span class="p">[</span><span class="s2">"texts"</span><span class="p">])</span>
<span></span><span class="go">['Object: cat', 'Object: dog', 'Object: bird', 'Object: elephant', 'Object: car']</span>
</code></pre></div>
<p>This class is designed to randomly sample positive texts and negative texts, and update the class
indices accordingly to the number of samples. It can be used for text-based object detection tasks.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>prompt_format</code>
</td>
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Format string for the prompt. Default is '{}'. The format string should
contain a single pair of curly braces {} where the text will be inserted.</p>
</div>
</td>
<td>
<code>'{}'</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>neg_samples</code>
</td>
<td>
<code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>A range to randomly sample negative texts. The first integer
specifies the minimum number of negative samples, and the second integer specifies the
maximum. Default is (80, 80).</p>
</div>
</td>
<td>
<code>(80, 80)</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>max_samples</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The maximum number of different text samples in one image. Default is 80.</p>
</div>
</td>
<td>
<code>80</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>padding</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to pad texts to max_samples. If True, the number of texts will always
be equal to max_samples. Default is False.</p>
</div>
</td>
<td>
<code>False</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>padding_value</code>
</td>
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The padding text to use when padding is True. Default is an empty string.</p>
</div>
</td>
<td>
<code>['']</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomLoadText.__init__.prompt_format">prompt_format</span></code></td>
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The format string for the prompt.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomLoadText.__init__.neg_samples">neg_samples</span></code></td>
<td>
<code><span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>The range for sampling negative texts.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomLoadText.__init__.max_samples">max_samples</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The maximum number of text samples.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomLoadText.__init__.padding">padding</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether padding is enabled.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.RandomLoadText.__init__.padding_value">padding_value</span></code></td>
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The value used for padding.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random_load_text</span> <span class="o">=</span> <span class="n">RandomLoadText</span><span class="p">(</span><span class="n">prompt_format</span><span class="o">=</span><span class="s2">"Object: </span><span class="si">{}</span><span class="s2">"</span><span class="p">,</span> <span class="n">neg_samples</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">max_samples</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random_load_text</span><span class="o">.</span><span class="n">prompt_format</span>
<span></span><span class="go">'Object: {}'</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random_load_text</span><span class="o">.</span><span class="n">neg_samples</span>
<span></span><span class="go">(50, 100)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random_load_text</span><span class="o">.</span><span class="n">max_samples</span>
<span></span><span class="go">120</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2275</span>
<span>2276</span>
<span>2277</span>
<span>2278</span>
<span>2279</span>
<span>2280</span>
<span>2281</span>
<span>2282</span>
<span>2283</span>
<span>2284</span>
<span>2285</span>
<span>2286</span>
<span>2287</span>
<span>2288</span>
<span>2289</span>
<span>2290</span>
<span>2291</span>
<span>2292</span>
<span>2293</span>
<span>2294</span>
<span>2295</span>
<span>2296</span>
<span>2297</span>
<span>2298</span>
<span>2299</span>
<span>2300</span>
<span>2301</span>
<span>2302</span>
<span>2303</span>
<span>2304</span>
<span>2305</span>
<span>2306</span>
<span>2307</span>
<span>2308</span>
<span>2309</span>
<span>2310</span>
<span>2311</span>
<span>2312</span>
<span>2313</span>
<span>2314</span>
<span>2315</span>
<span>2316</span>
<span>2317</span>
<span>2318</span>
<span>2319</span>
<span>2320</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<span></span>    <span class="bp">self</span><span class="p">,</span>
<span></span>    <span class="n">prompt_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"</span><span class="si">{}</span><span class="s2">"</span><span class="p">,</span>
<span></span>    <span class="n">neg_samples</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
<span></span>    <span class="n">max_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span>
<span></span>    <span class="n">padding</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">padding_value</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">""</span><span class="p">],</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initializes the RandomLoadText class for randomly sampling positive and negative texts.</span>
<span></span>
<span></span><span class="sd">    This class is designed to randomly sample positive texts and negative texts, and update the class</span>
<span></span><span class="sd">    indices accordingly to the number of samples. It can be used for text-based object detection tasks.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        prompt_format (str): Format string for the prompt. Default is '{}'. The format string should</span>
<span></span><span class="sd">            contain a single pair of curly braces {} where the text will be inserted.</span>
<span></span><span class="sd">        neg_samples (Tuple[int, int]): A range to randomly sample negative texts. The first integer</span>
<span></span><span class="sd">            specifies the minimum number of negative samples, and the second integer specifies the</span>
<span></span><span class="sd">            maximum. Default is (80, 80).</span>
<span></span><span class="sd">        max_samples (int): The maximum number of different text samples in one image. Default is 80.</span>
<span></span><span class="sd">        padding (bool): Whether to pad texts to max_samples. If True, the number of texts will always</span>
<span></span><span class="sd">            be equal to max_samples. Default is False.</span>
<span></span><span class="sd">        padding_value (str): The padding text to use when padding is True. Default is an empty string.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        prompt_format (str): The format string for the prompt.</span>
<span></span><span class="sd">        neg_samples (Tuple[int, int]): The range for sampling negative texts.</span>
<span></span><span class="sd">        max_samples (int): The maximum number of text samples.</span>
<span></span><span class="sd">        padding (bool): Whether padding is enabled.</span>
<span></span><span class="sd">        padding_value (str): The value used for padding.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; random_load_text = RandomLoadText(prompt_format="Object: {}", neg_samples=(50, 100), max_samples=120)</span>
<span></span><span class="sd">        &gt;&gt;&gt; random_load_text.prompt_format</span>
<span></span><span class="sd">        'Object: {}'</span>
<span></span><span class="sd">        &gt;&gt;&gt; random_load_text.neg_samples</span>
<span></span><span class="sd">        (50, 100)</span>
<span></span><span class="sd">        &gt;&gt;&gt; random_load_text.max_samples</span>
<span></span><span class="sd">        120</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">prompt_format</span> <span class="o">=</span> <span class="n">prompt_format</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">neg_samples</span> <span class="o">=</span> <span class="n">neg_samples</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">max_samples</span> <span class="o">=</span> <span class="n">max_samples</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">padding_value</span> <span class="o">=</span> <span class="n">padding_value</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.RandomLoadText.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">labels</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Randomly samples positive and negative texts and updates class indices accordingly.</p>
<p>This method samples positive texts based on the existing class labels in the image, and randomly
selects negative texts from the remaining classes. It then updates the class indices to match the
new sampled text order.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>labels</code>
</td>
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A dictionary containing image labels and metadata. Must include 'texts' and 'cls' keys.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="dict">dict</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Updated labels dictionary with new 'cls' and 'texts' entries.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">RandomLoadText</span><span class="p">(</span><span class="n">prompt_format</span><span class="o">=</span><span class="s2">"A photo of </span><span class="si">{}</span><span class="s2">"</span><span class="p">,</span> <span class="n">neg_samples</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">max_samples</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"cls"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]),</span> <span class="s2">"texts"</span><span class="p">:</span> <span class="p">[[</span><span class="s2">"dog"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"cat"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"bird"</span><span class="p">]]}</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">updated_labels</span> <span class="o">=</span> <span class="n">loader</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2322</span>
<span>2323</span>
<span>2324</span>
<span>2325</span>
<span>2326</span>
<span>2327</span>
<span>2328</span>
<span>2329</span>
<span>2330</span>
<span>2331</span>
<span>2332</span>
<span>2333</span>
<span>2334</span>
<span>2335</span>
<span>2336</span>
<span>2337</span>
<span>2338</span>
<span>2339</span>
<span>2340</span>
<span>2341</span>
<span>2342</span>
<span>2343</span>
<span>2344</span>
<span>2345</span>
<span>2346</span>
<span>2347</span>
<span>2348</span>
<span>2349</span>
<span>2350</span>
<span>2351</span>
<span>2352</span>
<span>2353</span>
<span>2354</span>
<span>2355</span>
<span>2356</span>
<span>2357</span>
<span>2358</span>
<span>2359</span>
<span>2360</span>
<span>2361</span>
<span>2362</span>
<span>2363</span>
<span>2364</span>
<span>2365</span>
<span>2366</span>
<span>2367</span>
<span>2368</span>
<span>2369</span>
<span>2370</span>
<span>2371</span>
<span>2372</span>
<span>2373</span>
<span>2374</span>
<span>2375</span>
<span>2376</span>
<span>2377</span>
<span>2378</span>
<span>2379</span>
<span>2380</span>
<span>2381</span>
<span>2382</span>
<span>2383</span>
<span>2384</span>
<span>2385</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Randomly samples positive and negative texts and updates class indices accordingly.</span>
<span></span>
<span></span><span class="sd">    This method samples positive texts based on the existing class labels in the image, and randomly</span>
<span></span><span class="sd">    selects negative texts from the remaining classes. It then updates the class indices to match the</span>
<span></span><span class="sd">    new sampled text order.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels (dict): A dictionary containing image labels and metadata. Must include 'texts' and 'cls' keys.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): Updated labels dictionary with new 'cls' and 'texts' entries.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; loader = RandomLoadText(prompt_format="A photo of {}", neg_samples=(5, 10), max_samples=20)</span>
<span></span><span class="sd">        &gt;&gt;&gt; labels = {"cls": np.array([[0], [1], [2]]), "texts": [["dog"], ["cat"], ["bird"]]}</span>
<span></span><span class="sd">        &gt;&gt;&gt; updated_labels = loader(labels)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">assert</span> <span class="s2">"texts"</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">,</span> <span class="s2">"No texts found in labels."</span>
<span></span>    <span class="n">class_texts</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"texts"</span><span class="p">]</span>
<span></span>    <span class="n">num_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_texts</span><span class="p">)</span>
<span></span>    <span class="bp">cls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"cls"</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span></span>    <span class="n">pos_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_samples</span><span class="p">:</span>
<span></span>        <span class="n">pos_labels</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">pos_labels</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_samples</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">neg_samples</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_samples</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos_labels</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">neg_samples</span><span class="p">))</span>
<span></span>    <span class="n">neg_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_classes</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pos_labels</span><span class="p">]</span>
<span></span>    <span class="n">neg_labels</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">neg_labels</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">neg_samples</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">sampled_labels</span> <span class="o">=</span> <span class="n">pos_labels</span> <span class="o">+</span> <span class="n">neg_labels</span>
<span></span>    <span class="c1"># Randomness</span>
<span></span>    <span class="c1"># random.shuffle(sampled_labels)</span>
<span></span>
<span></span>    <span class="n">label2ids</span> <span class="o">=</span> <span class="p">{</span><span class="n">label</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sampled_labels</span><span class="p">)}</span>
<span></span>    <span class="n">valid_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span></span>    <span class="n">new_cls</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()):</span>
<span></span>        <span class="k">if</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">label2ids</span><span class="p">:</span>
<span></span>            <span class="k">continue</span>
<span></span>        <span class="n">valid_idx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span></span>        <span class="n">new_cls</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">label2ids</span><span class="p">[</span><span class="n">label</span><span class="p">]])</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">][</span><span class="n">valid_idx</span><span class="p">]</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_cls</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Randomly select one prompt when there's more than one prompts</span>
<span></span>    <span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">sampled_labels</span><span class="p">:</span>
<span></span>        <span class="n">prompts</span> <span class="o">=</span> <span class="n">class_texts</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
<span></span>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">prompts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span></span>        <span class="n">prompt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prompts</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prompts</span><span class="p">))])</span>
<span></span>        <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">:</span>
<span></span>        <span class="n">valid_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos_labels</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">neg_labels</span><span class="p">)</span>
<span></span>        <span class="n">num_padding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_samples</span> <span class="o">-</span> <span class="n">valid_labels</span>
<span></span>        <span class="k">if</span> <span class="n">num_padding</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span></span>            <span class="n">texts</span> <span class="o">+=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">padding_value</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">num_padding</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_samples</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"texts"</span><span class="p">]</span> <span class="o">=</span> <span class="n">texts</span>
<span></span>    <span class="k">return</span> <span class="n">labels</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.ClassifyLetterBox">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.ClassifyLetterBox</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">ClassifyLetterBox</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">),</span> <span class="n">auto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>A class for resizing and padding images for classification tasks.</p>
<p>This class is designed to be part of a transformation pipeline, e.g., T.Compose([LetterBox(size), ToTensor()]).
It resizes and pads images to a specified size while maintaining the original aspect ratio.</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.ClassifyLetterBox.h">h</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Target height of the image.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.ClassifyLetterBox.w">w</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Target width of the image.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.ClassifyLetterBox.auto">auto</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, automatically calculates the short side using stride.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.ClassifyLetterBox.stride">stride</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The stride value, used when 'auto' is True.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.ClassifyLetterBox.__call__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__call__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.ClassifyLetterBox.__call__&lt;/code&gt;)'>__call__</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies the letterbox transformation to an input image.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">ClassifyLetterBox</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">),</span> <span class="n">auto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span></span><span class="go">(640, 640, 3)</span>
</code></pre></div>
<p>This class is designed to be part of a transformation pipeline for image classification tasks. It resizes and
pads images to a specified size while maintaining the original aspect ratio.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>size</code>
</td>
<td>
<code><span title="int">int</span> | <span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>Target size for the letterboxed image. If an int, a square image of
(size, size) is created. If a tuple, it should be (height, width).</p>
</div>
</td>
<td>
<code>(640, 640)</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>auto</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, automatically calculates the short side based on stride. Default is False.</p>
</div>
</td>
<td>
<code>False</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>stride</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The stride value, used when 'auto' is True. Default is 32.</p>
</div>
</td>
<td>
<code>32</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.ClassifyLetterBox.__init__.h">h</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Target height of the letterboxed image.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.ClassifyLetterBox.__init__.w">w</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Target width of the letterboxed image.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.ClassifyLetterBox.__init__.auto">auto</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Flag indicating whether to automatically calculate short side.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.ClassifyLetterBox.__init__.stride">stride</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Stride value for automatic short side calculation.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">ClassifyLetterBox</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">224</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span></span><span class="go">(224, 224, 3)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2635</span>
<span>2636</span>
<span>2637</span>
<span>2638</span>
<span>2639</span>
<span>2640</span>
<span>2641</span>
<span>2642</span>
<span>2643</span>
<span>2644</span>
<span>2645</span>
<span>2646</span>
<span>2647</span>
<span>2648</span>
<span>2649</span>
<span>2650</span>
<span>2651</span>
<span>2652</span>
<span>2653</span>
<span>2654</span>
<span>2655</span>
<span>2656</span>
<span>2657</span>
<span>2658</span>
<span>2659</span>
<span>2660</span>
<span>2661</span>
<span>2662</span>
<span>2663</span>
<span>2664</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">),</span> <span class="n">auto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">32</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initializes the ClassifyLetterBox object for image preprocessing.</span>
<span></span>
<span></span><span class="sd">    This class is designed to be part of a transformation pipeline for image classification tasks. It resizes and</span>
<span></span><span class="sd">    pads images to a specified size while maintaining the original aspect ratio.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        size (int | Tuple[int, int]): Target size for the letterboxed image. If an int, a square image of</span>
<span></span><span class="sd">            (size, size) is created. If a tuple, it should be (height, width).</span>
<span></span><span class="sd">        auto (bool): If True, automatically calculates the short side based on stride. Default is False.</span>
<span></span><span class="sd">        stride (int): The stride value, used when 'auto' is True. Default is 32.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        h (int): Target height of the letterboxed image.</span>
<span></span><span class="sd">        w (int): Target width of the letterboxed image.</span>
<span></span><span class="sd">        auto (bool): Flag indicating whether to automatically calculate short side.</span>
<span></span><span class="sd">        stride (int): Stride value for automatic short side calculation.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = ClassifyLetterBox(size=224)</span>
<span></span><span class="sd">        &gt;&gt;&gt; img = np.random.randint(0, 255, (480, 640, 3), dtype=np.uint8)</span>
<span></span><span class="sd">        &gt;&gt;&gt; result = transform(img)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(result.shape)</span>
<span></span><span class="sd">        (224, 224, 3)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">size</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">auto</span> <span class="o">=</span> <span class="n">auto</span>  <span class="c1"># pass max size integer, automatically solve for short side using stride</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">stride</span> <span class="o">=</span> <span class="n">stride</span>  <span class="c1"># used with auto</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.ClassifyLetterBox.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">im</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Resizes and pads an image using the letterbox method.</p>
<p>This method resizes the input image to fit within the specified dimensions while maintaining its aspect ratio,
then pads the resized image to match the target size.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>im</code>
</td>
<td>
<code><span title="numpy.ndarray">ndarray</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Input image as a numpy array with shape (H, W, C).</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="numpy.ndarray">ndarray</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Resized and padded image as a numpy array with shape (hs, ws, 3), where hs and ws are
the target height and width respectively.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">letterbox</span> <span class="o">=</span> <span class="n">ClassifyLetterBox</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">))</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">720</span><span class="p">,</span> <span class="mi">1280</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">resized_image</span> <span class="o">=</span> <span class="n">letterbox</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">resized_image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span></span><span class="go">(640, 640, 3)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2666</span>
<span>2667</span>
<span>2668</span>
<span>2669</span>
<span>2670</span>
<span>2671</span>
<span>2672</span>
<span>2673</span>
<span>2674</span>
<span>2675</span>
<span>2676</span>
<span>2677</span>
<span>2678</span>
<span>2679</span>
<span>2680</span>
<span>2681</span>
<span>2682</span>
<span>2683</span>
<span>2684</span>
<span>2685</span>
<span>2686</span>
<span>2687</span>
<span>2688</span>
<span>2689</span>
<span>2690</span>
<span>2691</span>
<span>2692</span>
<span>2693</span>
<span>2694</span>
<span>2695</span>
<span>2696</span>
<span>2697</span>
<span>2698</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">im</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Resizes and pads an image using the letterbox method.</span>
<span></span>
<span></span><span class="sd">    This method resizes the input image to fit within the specified dimensions while maintaining its aspect ratio,</span>
<span></span><span class="sd">    then pads the resized image to match the target size.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        im (numpy.ndarray): Input image as a numpy array with shape (H, W, C).</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (numpy.ndarray): Resized and padded image as a numpy array with shape (hs, ws, 3), where hs and ws are</span>
<span></span><span class="sd">            the target height and width respectively.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; letterbox = ClassifyLetterBox(size=(640, 640))</span>
<span></span><span class="sd">        &gt;&gt;&gt; image = np.random.randint(0, 255, (720, 1280, 3), dtype=np.uint8)</span>
<span></span><span class="sd">        &gt;&gt;&gt; resized_image = letterbox(image)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(resized_image.shape)</span>
<span></span><span class="sd">        (640, 640, 3)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">imh</span><span class="p">,</span> <span class="n">imw</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span></span>    <span class="n">r</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="n">imh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="n">imw</span><span class="p">)</span>  <span class="c1"># ratio of new/old dimensions</span>
<span></span>    <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">imh</span> <span class="o">*</span> <span class="n">r</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">imw</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span>  <span class="c1"># resized image dimensions</span>
<span></span>
<span></span>    <span class="c1"># Calculate padding dimensions</span>
<span></span>    <span class="n">hs</span><span class="p">,</span> <span class="n">ws</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stride</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">stride</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto</span> <span class="k">else</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">)</span>
<span></span>    <span class="n">top</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">hs</span> <span class="o">-</span> <span class="n">h</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">),</span> <span class="nb">round</span><span class="p">((</span><span class="n">ws</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Create padded image</span>
<span></span>    <span class="n">im_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">hs</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">114</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">im</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span></span>    <span class="n">im_out</span><span class="p">[</span><span class="n">top</span> <span class="p">:</span> <span class="n">top</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">left</span> <span class="p">:</span> <span class="n">left</span> <span class="o">+</span> <span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">INTER_LINEAR</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">im_out</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.CenterCrop">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.CenterCrop</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">CenterCrop</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">640</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Applies center cropping to images for classification tasks.</p>
<p>This class performs center cropping on input images, resizing them to a specified size while maintaining the aspect
ratio. It is designed to be part of a transformation pipeline, e.g., T.Compose([CenterCrop(size), ToTensor()]).</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.CenterCrop.h">h</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Target height of the cropped image.</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.CenterCrop.w">w</span></code></td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Target width of the cropped image.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.CenterCrop.__call__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__call__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.CenterCrop.__call__&lt;/code&gt;)'>__call__</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies the center crop transformation to an input image.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">CenterCrop</span><span class="p">(</span><span class="mi">640</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">1080</span><span class="p">,</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_image</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cropped_image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span></span><span class="go">(640, 640, 3)</span>
</code></pre></div>
<p>This class is designed to be part of a transformation pipeline, e.g., T.Compose([CenterCrop(size), ToTensor()]).
It performs a center crop on input images to a specified size.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>size</code>
</td>
<td>
<code><span title="int">int</span> | <span title="typing.Tuple">Tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
</td>
<td>
<div class="doc-md-description">
<p>The desired output size of the crop. If size is an int, a square crop
(size, size) is made. If size is a sequence like (h, w), it is used as the output size.</p>
</div>
</td>
<td>
<code>640</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>None</code>
</td>
<td>
<div class="doc-md-description">
<p>This method initializes the object and does not return anything.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">CenterCrop</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_img</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cropped_img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span></span><span class="go">(224, 224, 3)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2724</span>
<span>2725</span>
<span>2726</span>
<span>2727</span>
<span>2728</span>
<span>2729</span>
<span>2730</span>
<span>2731</span>
<span>2732</span>
<span>2733</span>
<span>2734</span>
<span>2735</span>
<span>2736</span>
<span>2737</span>
<span>2738</span>
<span>2739</span>
<span>2740</span>
<span>2741</span>
<span>2742</span>
<span>2743</span>
<span>2744</span>
<span>2745</span>
<span>2746</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">640</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initializes the CenterCrop object for image preprocessing.</span>
<span></span>
<span></span><span class="sd">    This class is designed to be part of a transformation pipeline, e.g., T.Compose([CenterCrop(size), ToTensor()]).</span>
<span></span><span class="sd">    It performs a center crop on input images to a specified size.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        size (int | Tuple[int, int]): The desired output size of the crop. If size is an int, a square crop</span>
<span></span><span class="sd">            (size, size) is made. If size is a sequence like (h, w), it is used as the output size.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (None): This method initializes the object and does not return anything.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = CenterCrop(224)</span>
<span></span><span class="sd">        &gt;&gt;&gt; img = np.random.rand(300, 300, 3)</span>
<span></span><span class="sd">        &gt;&gt;&gt; cropped_img = transform(img)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(cropped_img.shape)</span>
<span></span><span class="sd">        (224, 224, 3)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">size</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.CenterCrop.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">im</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Applies center cropping to an input image.</p>
<p>This method resizes and crops the center of the image using a letterbox method. It maintains the aspect
ratio of the original image while fitting it into the specified dimensions.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>im</code>
</td>
<td>
<code><span title="numpy.ndarray">ndarray</span> | <span title="PIL.Image.Image">Image</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The input image as a numpy array of shape (H, W, C) or a
PIL Image object.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="numpy.ndarray">ndarray</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The center-cropped and resized image as a numpy array of shape (self.h, self.w, C).</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">CenterCrop</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">224</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_image</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">cropped_image</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2748</span>
<span>2749</span>
<span>2750</span>
<span>2751</span>
<span>2752</span>
<span>2753</span>
<span>2754</span>
<span>2755</span>
<span>2756</span>
<span>2757</span>
<span>2758</span>
<span>2759</span>
<span>2760</span>
<span>2761</span>
<span>2762</span>
<span>2763</span>
<span>2764</span>
<span>2765</span>
<span>2766</span>
<span>2767</span>
<span>2768</span>
<span>2769</span>
<span>2770</span>
<span>2771</span>
<span>2772</span>
<span>2773</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">im</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Applies center cropping to an input image.</span>
<span></span>
<span></span><span class="sd">    This method resizes and crops the center of the image using a letterbox method. It maintains the aspect</span>
<span></span><span class="sd">    ratio of the original image while fitting it into the specified dimensions.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        im (numpy.ndarray | PIL.Image.Image): The input image as a numpy array of shape (H, W, C) or a</span>
<span></span><span class="sd">            PIL Image object.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (numpy.ndarray): The center-cropped and resized image as a numpy array of shape (self.h, self.w, C).</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = CenterCrop(size=224)</span>
<span></span><span class="sd">        &gt;&gt;&gt; image = np.random.randint(0, 255, (640, 480, 3), dtype=np.uint8)</span>
<span></span><span class="sd">        &gt;&gt;&gt; cropped_image = transform(image)</span>
<span></span><span class="sd">        &gt;&gt;&gt; assert cropped_image.shape == (224, 224, 3)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">):</span>  <span class="c1"># convert from PIL to numpy array if required</span>
<span></span>        <span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span></span>    <span class="n">imh</span><span class="p">,</span> <span class="n">imw</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span></span>    <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">imh</span><span class="p">,</span> <span class="n">imw</span><span class="p">)</span>  <span class="c1"># min dimension</span>
<span></span>    <span class="n">top</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="p">(</span><span class="n">imh</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">imw</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<span></span>    <span class="k">return</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">im</span><span class="p">[</span><span class="n">top</span> <span class="p">:</span> <span class="n">top</span> <span class="o">+</span> <span class="n">m</span><span class="p">,</span> <span class="n">left</span> <span class="p">:</span> <span class="n">left</span> <span class="o">+</span> <span class="n">m</span><span class="p">],</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">),</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">INTER_LINEAR</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ultralytics.data.augment.ToTensor">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">ultralytics.data.augment.ToTensor</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">ToTensor</span><span class="p">(</span><span class="n">half</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Converts an image from a numpy array to a PyTorch tensor.</p>
<p>This class is designed to be part of a transformation pipeline, e.g., T.Compose([LetterBox(size), ToTensor()]).</p>
<p><span class="doc-section-title">Attributes:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><span title="ultralytics.data.augment.ToTensor.half">half</span></code></td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, converts the image to half precision (float16).</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Methods:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.ToTensor.__call__" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-method"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-function-name"&gt;__call__&lt;/span&gt; (&lt;code&gt;ultralytics.data.augment.ToTensor.__call__&lt;/code&gt;)'>__call__</a></code></td>
<td>
<div class="doc-md-description">
<p>Applies the tensor conversion to an input image.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">ToTensor</span><span class="p">(</span><span class="n">half</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_img</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tensor_img</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">tensor_img</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span></span><span class="go">torch.Size([3, 640, 640]) torch.float16</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<p>The input image is expected to be in BGR format with shape (H, W, C).
The output tensor will be in RGB format with shape (C, H, W), normalized to [0, 1].</p>
</details>
<p>This class is designed to be used as part of a transformation pipeline for image preprocessing in the
Ultralytics YOLO framework. It converts numpy arrays or PIL Images to PyTorch tensors, with an option
for half-precision (float16) conversion.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>half</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, converts the tensor to half precision (float16). Default is False.</p>
</div>
</td>
<td>
<code>False</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">ToTensor</span><span class="p">(</span><span class="n">half</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_img</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tensor_img</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span></span><span class="go">torch.float16</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2801</span>
<span>2802</span>
<span>2803</span>
<span>2804</span>
<span>2805</span>
<span>2806</span>
<span>2807</span>
<span>2808</span>
<span>2809</span>
<span>2810</span>
<span>2811</span>
<span>2812</span>
<span>2813</span>
<span>2814</span>
<span>2815</span>
<span>2816</span>
<span>2817</span>
<span>2818</span>
<span>2819</span>
<span>2820</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">half</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Initializes the ToTensor object for converting images to PyTorch tensors.</span>
<span></span>
<span></span><span class="sd">    This class is designed to be used as part of a transformation pipeline for image preprocessing in the</span>
<span></span><span class="sd">    Ultralytics YOLO framework. It converts numpy arrays or PIL Images to PyTorch tensors, with an option</span>
<span></span><span class="sd">    for half-precision (float16) conversion.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        half (bool): If True, converts the tensor to half precision (float16). Default is False.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = ToTensor(half=True)</span>
<span></span><span class="sd">        &gt;&gt;&gt; img = np.random.rand(640, 640, 3)</span>
<span></span><span class="sd">        &gt;&gt;&gt; tensor_img = transform(img)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(tensor_img.dtype)</span>
<span></span><span class="sd">        torch.float16</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">half</span> <span class="o">=</span> <span class="n">half</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ultralytics.data.augment.ToTensor.__call__">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">__call__</span>
</h3>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="fm">__call__</span><span class="p">(</span><span class="nf">im</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Transforms an image from a numpy array to a PyTorch tensor.</p>
<p>This method converts the input image from a numpy array to a PyTorch tensor, applying optional
half-precision conversion and normalization. The image is transposed from HWC to CHW format and
the color channels are reversed from BGR to RGB.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>im</code>
</td>
<td>
<code><span title="numpy.ndarray">ndarray</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Input image as a numpy array with shape (H, W, C) in BGR order.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="torch.Tensor">Tensor</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The transformed image as a PyTorch tensor in float32 or float16, normalized
to [0, 1] with shape (C, H, W) in RGB order.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">ToTensor</span><span class="p">(</span><span class="n">half</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_img</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tensor_img</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">tensor_img</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span></span><span class="go">torch.Size([3, 640, 640]) torch.float16</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2822</span>
<span>2823</span>
<span>2824</span>
<span>2825</span>
<span>2826</span>
<span>2827</span>
<span>2828</span>
<span>2829</span>
<span>2830</span>
<span>2831</span>
<span>2832</span>
<span>2833</span>
<span>2834</span>
<span>2835</span>
<span>2836</span>
<span>2837</span>
<span>2838</span>
<span>2839</span>
<span>2840</span>
<span>2841</span>
<span>2842</span>
<span>2843</span>
<span>2844</span>
<span>2845</span>
<span>2846</span>
<span>2847</span>
<span>2848</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">im</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Transforms an image from a numpy array to a PyTorch tensor.</span>
<span></span>
<span></span><span class="sd">    This method converts the input image from a numpy array to a PyTorch tensor, applying optional</span>
<span></span><span class="sd">    half-precision conversion and normalization. The image is transposed from HWC to CHW format and</span>
<span></span><span class="sd">    the color channels are reversed from BGR to RGB.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        im (numpy.ndarray): Input image as a numpy array with shape (H, W, C) in BGR order.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor): The transformed image as a PyTorch tensor in float32 or float16, normalized</span>
<span></span><span class="sd">            to [0, 1] with shape (C, H, W) in RGB order.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transform = ToTensor(half=True)</span>
<span></span><span class="sd">        &gt;&gt;&gt; img = np.random.randint(0, 255, (640, 640, 3), dtype=np.uint8)</span>
<span></span><span class="sd">        &gt;&gt;&gt; tensor_img = transform(img)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(tensor_img.shape, tensor_img.dtype)</span>
<span></span><span class="sd">        torch.Size([3, 640, 640]) torch.float16</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># HWC to CHW -&gt; BGR to RGB -&gt; contiguous</span>
<span></span>    <span class="n">im</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>  <span class="c1"># to torch</span>
<span></span>    <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">half</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">half</span> <span class="k">else</span> <span class="n">im</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>  <span class="c1"># uint8 to fp16/32</span>
<span></span>    <span class="n">im</span> <span class="o">/=</span> <span class="mf">255.0</span>  <span class="c1"># 0-255 to 0.0-1.0</span>
<span></span>    <span class="k">return</span> <span class="n">im</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.data.augment.v8_transforms">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.data.augment.v8_transforms</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">v8_transforms</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">imgsz</span><span class="p">,</span> <span class="n">hyp</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Applies a series of image transformations for training.</p>
<p>This function creates a composition of image augmentation techniques to prepare images for YOLO training.
It includes operations such as mosaic, copy-paste, random perspective, mixup, and various color adjustments.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>dataset</code>
</td>
<td>
<code><span title="Dataset">Dataset</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The dataset object containing image data and annotations.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>imgsz</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The target image size for resizing.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>hyp</code>
</td>
<td>
<code><span title="Namespace">Namespace</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A dictionary of hyperparameters controlling various aspects of the transformations.</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>stretch</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>If True, applies stretching to the image. If False, uses LetterBox resizing.</p>
</div>
</td>
<td>
<code>False</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><a class="autorefs autorefs-internal" href="#ultralytics.data.augment.Compose" title='&lt;code class="doc-symbol doc-symbol-heading doc-symbol-class"&gt;&lt;/code&gt;            &lt;span class="doc doc-object-name doc-class-name"&gt;ultralytics.data.augment.Compose&lt;/span&gt;'>Compose</a></code>
</td>
<td>
<div class="doc-md-description">
<p>A composition of image transformations to be applied to the dataset.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">YOLODataset</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">IterableSimpleNamespace</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">YOLODataset</span><span class="p">(</span><span class="n">img_path</span><span class="o">=</span><span class="s2">"path/to/images"</span><span class="p">,</span> <span class="n">imgsz</span><span class="o">=</span><span class="mi">640</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hyp</span> <span class="o">=</span> <span class="n">IterableSimpleNamespace</span><span class="p">(</span><span class="n">mosaic</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">copy_paste</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transforms</span> <span class="o">=</span> <span class="n">v8_transforms</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">imgsz</span><span class="o">=</span><span class="mi">640</span><span class="p">,</span> <span class="n">hyp</span><span class="o">=</span><span class="n">hyp</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augmented_data</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2388</span>
<span>2389</span>
<span>2390</span>
<span>2391</span>
<span>2392</span>
<span>2393</span>
<span>2394</span>
<span>2395</span>
<span>2396</span>
<span>2397</span>
<span>2398</span>
<span>2399</span>
<span>2400</span>
<span>2401</span>
<span>2402</span>
<span>2403</span>
<span>2404</span>
<span>2405</span>
<span>2406</span>
<span>2407</span>
<span>2408</span>
<span>2409</span>
<span>2410</span>
<span>2411</span>
<span>2412</span>
<span>2413</span>
<span>2414</span>
<span>2415</span>
<span>2416</span>
<span>2417</span>
<span>2418</span>
<span>2419</span>
<span>2420</span>
<span>2421</span>
<span>2422</span>
<span>2423</span>
<span>2424</span>
<span>2425</span>
<span>2426</span>
<span>2427</span>
<span>2428</span>
<span>2429</span>
<span>2430</span>
<span>2431</span>
<span>2432</span>
<span>2433</span>
<span>2434</span>
<span>2435</span>
<span>2436</span>
<span>2437</span>
<span>2438</span>
<span>2439</span>
<span>2440</span>
<span>2441</span>
<span>2442</span>
<span>2443</span>
<span>2444</span>
<span>2445</span>
<span>2446</span>
<span>2447</span>
<span>2448</span>
<span>2449</span>
<span>2450</span>
<span>2451</span>
<span>2452</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">v8_transforms</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">imgsz</span><span class="p">,</span> <span class="n">hyp</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Applies a series of image transformations for training.</span>
<span></span>
<span></span><span class="sd">    This function creates a composition of image augmentation techniques to prepare images for YOLO training.</span>
<span></span><span class="sd">    It includes operations such as mosaic, copy-paste, random perspective, mixup, and various color adjustments.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        dataset (Dataset): The dataset object containing image data and annotations.</span>
<span></span><span class="sd">        imgsz (int): The target image size for resizing.</span>
<span></span><span class="sd">        hyp (Namespace): A dictionary of hyperparameters controlling various aspects of the transformations.</span>
<span></span><span class="sd">        stretch (bool): If True, applies stretching to the image. If False, uses LetterBox resizing.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Compose): A composition of image transformations to be applied to the dataset.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics.data.dataset import YOLODataset</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics.utils import IterableSimpleNamespace</span>
<span></span><span class="sd">        &gt;&gt;&gt; dataset = YOLODataset(img_path="path/to/images", imgsz=640)</span>
<span></span><span class="sd">        &gt;&gt;&gt; hyp = IterableSimpleNamespace(mosaic=1.0, copy_paste=0.5, degrees=10.0, translate=0.2, scale=0.9)</span>
<span></span><span class="sd">        &gt;&gt;&gt; transforms = v8_transforms(dataset, imgsz=640, hyp=hyp)</span>
<span></span><span class="sd">        &gt;&gt;&gt; augmented_data = transforms(dataset[0])</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">mosaic</span> <span class="o">=</span> <span class="n">Mosaic</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">imgsz</span><span class="o">=</span><span class="n">imgsz</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">mosaic</span><span class="p">)</span>
<span></span>    <span class="n">affine</span> <span class="o">=</span> <span class="n">RandomPerspective</span><span class="p">(</span>
<span></span>        <span class="n">degrees</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">degrees</span><span class="p">,</span>
<span></span>        <span class="n">translate</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">translate</span><span class="p">,</span>
<span></span>        <span class="n">scale</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span>
<span></span>        <span class="n">shear</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">shear</span><span class="p">,</span>
<span></span>        <span class="n">perspective</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">perspective</span><span class="p">,</span>
<span></span>        <span class="n">pre_transform</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">stretch</span> <span class="k">else</span> <span class="n">LetterBox</span><span class="p">(</span><span class="n">new_shape</span><span class="o">=</span><span class="p">(</span><span class="n">imgsz</span><span class="p">,</span> <span class="n">imgsz</span><span class="p">)),</span>
<span></span>    <span class="p">)</span>
<span></span>
<span></span>    <span class="n">pre_transform</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">([</span><span class="n">mosaic</span><span class="p">,</span> <span class="n">affine</span><span class="p">])</span>
<span></span>    <span class="k">if</span> <span class="n">hyp</span><span class="o">.</span><span class="n">copy_paste_mode</span> <span class="o">==</span> <span class="s2">"flip"</span><span class="p">:</span>
<span></span>        <span class="n">pre_transform</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">CopyPaste</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">copy_paste</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">copy_paste_mode</span><span class="p">))</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="n">pre_transform</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<span></span>            <span class="n">CopyPaste</span><span class="p">(</span>
<span></span>                <span class="n">dataset</span><span class="p">,</span>
<span></span>                <span class="n">pre_transform</span><span class="o">=</span><span class="n">Compose</span><span class="p">([</span><span class="n">Mosaic</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">imgsz</span><span class="o">=</span><span class="n">imgsz</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">mosaic</span><span class="p">),</span> <span class="n">affine</span><span class="p">]),</span>
<span></span>                <span class="n">p</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">copy_paste</span><span class="p">,</span>
<span></span>                <span class="n">mode</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">copy_paste_mode</span><span class="p">,</span>
<span></span>            <span class="p">)</span>
<span></span>        <span class="p">)</span>
<span></span>    <span class="n">flip_idx</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"flip_idx"</span><span class="p">,</span> <span class="p">[])</span>  <span class="c1"># for keypoints augmentation</span>
<span></span>    <span class="k">if</span> <span class="n">dataset</span><span class="o">.</span><span class="n">use_keypoints</span><span class="p">:</span>
<span></span>        <span class="n">kpt_shape</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"kpt_shape"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span></span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">flip_idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">hyp</span><span class="o">.</span><span class="n">fliplr</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
<span></span>            <span class="n">hyp</span><span class="o">.</span><span class="n">fliplr</span> <span class="o">=</span> <span class="mf">0.0</span>
<span></span>            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">"No 'flip_idx' array defined in data.yaml, setting augmentation 'fliplr=0.0'"</span><span class="p">)</span>
<span></span>        <span class="k">elif</span> <span class="n">flip_idx</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flip_idx</span><span class="p">)</span> <span class="o">!=</span> <span class="n">kpt_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<span></span>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"data.yaml flip_idx=</span><span class="si">{</span><span class="n">flip_idx</span><span class="si">}</span><span class="s2"> length must be equal to kpt_shape[0]=</span><span class="si">{</span><span class="n">kpt_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="n">Compose</span><span class="p">(</span>
<span></span>        <span class="p">[</span>
<span></span>            <span class="n">pre_transform</span><span class="p">,</span>
<span></span>            <span class="n">MixUp</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">pre_transform</span><span class="o">=</span><span class="n">pre_transform</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">mixup</span><span class="p">),</span>
<span></span>            <span class="n">Albumentations</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
<span></span>            <span class="n">RandomHSV</span><span class="p">(</span><span class="n">hgain</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">hsv_h</span><span class="p">,</span> <span class="n">sgain</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">hsv_s</span><span class="p">,</span> <span class="n">vgain</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">hsv_v</span><span class="p">),</span>
<span></span>            <span class="n">RandomFlip</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">"vertical"</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">flipud</span><span class="p">),</span>
<span></span>            <span class="n">RandomFlip</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">fliplr</span><span class="p">,</span> <span class="n">flip_idx</span><span class="o">=</span><span class="n">flip_idx</span><span class="p">),</span>
<span></span>        <span class="p">]</span>
<span></span>    <span class="p">)</span>  <span class="c1"># transforms</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.data.augment.classify_transforms">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.data.augment.classify_transforms</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">classify_transforms</span><span class="p">(</span>
<span></span>    <span class="n">size</span><span class="o">=</span><span class="mi">224</span><span class="p">,</span>
<span></span>    <span class="n">mean</span><span class="o">=</span><span class="n">DEFAULT_MEAN</span><span class="p">,</span>
<span></span>    <span class="n">std</span><span class="o">=</span><span class="n">DEFAULT_STD</span><span class="p">,</span>
<span></span>    <span class="n">interpolation</span><span class="o">=</span><span class="s2">"BILINEAR"</span><span class="p">,</span>
<span></span>    <span class="n">crop_fraction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Creates a composition of image transforms for classification tasks.</p>
<p>This function generates a sequence of torchvision transforms suitable for preprocessing images
for classification models during evaluation or inference. The transforms include resizing,
center cropping, conversion to tensor, and normalization.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>size</code>
</td>
<td>
<code><span title="int">int</span> | <span title="tuple">tuple</span></code>
</td>
<td>
<div class="doc-md-description">
<p>The target size for the transformed image. If an int, it defines the shortest edge. If a
tuple, it defines (height, width).</p>
</div>
</td>
<td>
<code>224</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>mean</code>
</td>
<td>
<code><span title="tuple">tuple</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Mean values for each RGB channel used in normalization.</p>
</div>
</td>
<td>
<code><span title="ultralytics.data.augment.DEFAULT_MEAN">DEFAULT_MEAN</span></code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>std</code>
</td>
<td>
<code><span title="tuple">tuple</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Standard deviation values for each RGB channel used in normalization.</p>
</div>
</td>
<td>
<code><span title="ultralytics.data.augment.DEFAULT_STD">DEFAULT_STD</span></code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>interpolation</code>
</td>
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Interpolation method of either 'NEAREST', 'BILINEAR' or 'BICUBIC'.</p>
</div>
</td>
<td>
<code>'BILINEAR'</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>crop_fraction</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Deprecated, will be removed in a future version.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="torchvision.transforms.Compose">Compose</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A composition of torchvision transforms.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transforms</span> <span class="o">=</span> <span class="n">classify_transforms</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">224</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed_img</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2456</span>
<span>2457</span>
<span>2458</span>
<span>2459</span>
<span>2460</span>
<span>2461</span>
<span>2462</span>
<span>2463</span>
<span>2464</span>
<span>2465</span>
<span>2466</span>
<span>2467</span>
<span>2468</span>
<span>2469</span>
<span>2470</span>
<span>2471</span>
<span>2472</span>
<span>2473</span>
<span>2474</span>
<span>2475</span>
<span>2476</span>
<span>2477</span>
<span>2478</span>
<span>2479</span>
<span>2480</span>
<span>2481</span>
<span>2482</span>
<span>2483</span>
<span>2484</span>
<span>2485</span>
<span>2486</span>
<span>2487</span>
<span>2488</span>
<span>2489</span>
<span>2490</span>
<span>2491</span>
<span>2492</span>
<span>2493</span>
<span>2494</span>
<span>2495</span>
<span>2496</span>
<span>2497</span>
<span>2498</span>
<span>2499</span>
<span>2500</span>
<span>2501</span>
<span>2502</span>
<span>2503</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">classify_transforms</span><span class="p">(</span>
<span></span>    <span class="n">size</span><span class="o">=</span><span class="mi">224</span><span class="p">,</span>
<span></span>    <span class="n">mean</span><span class="o">=</span><span class="n">DEFAULT_MEAN</span><span class="p">,</span>
<span></span>    <span class="n">std</span><span class="o">=</span><span class="n">DEFAULT_STD</span><span class="p">,</span>
<span></span>    <span class="n">interpolation</span><span class="o">=</span><span class="s2">"BILINEAR"</span><span class="p">,</span>
<span></span>    <span class="n">crop_fraction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Creates a composition of image transforms for classification tasks.</span>
<span></span>
<span></span><span class="sd">    This function generates a sequence of torchvision transforms suitable for preprocessing images</span>
<span></span><span class="sd">    for classification models during evaluation or inference. The transforms include resizing,</span>
<span></span><span class="sd">    center cropping, conversion to tensor, and normalization.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        size (int | tuple): The target size for the transformed image. If an int, it defines the shortest edge. If a</span>
<span></span><span class="sd">            tuple, it defines (height, width).</span>
<span></span><span class="sd">        mean (tuple): Mean values for each RGB channel used in normalization.</span>
<span></span><span class="sd">        std (tuple): Standard deviation values for each RGB channel used in normalization.</span>
<span></span><span class="sd">        interpolation (str): Interpolation method of either 'NEAREST', 'BILINEAR' or 'BICUBIC'.</span>
<span></span><span class="sd">        crop_fraction (float): Deprecated, will be removed in a future version.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torchvision.transforms.Compose): A composition of torchvision transforms.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transforms = classify_transforms(size=224)</span>
<span></span><span class="sd">        &gt;&gt;&gt; img = Image.open("path/to/image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; transformed_img = transforms(img)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="kn">import</span><span class="w"> </span><span class="nn">torchvision.transforms</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">T</span>  <span class="c1"># scope for faster 'import ultralytics'</span>
<span></span>
<span></span>    <span class="n">scale_size</span> <span class="o">=</span> <span class="n">size</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="n">crop_fraction</span><span class="p">:</span>
<span></span>        <span class="k">raise</span> <span class="ne">DeprecationWarning</span><span class="p">(</span>
<span></span>            <span class="s2">"'crop_fraction' arg of classify_transforms is deprecated, will be removed in a future version."</span>
<span></span>        <span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Aspect ratio is preserved, crops center within image, no borders are added, image is lost</span>
<span></span>    <span class="k">if</span> <span class="n">scale_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">scale_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<span></span>        <span class="c1"># Simple case, use torchvision built-in Resize with the shortest edge mode (scalar size arg)</span>
<span></span>        <span class="n">tfl</span> <span class="o">=</span> <span class="p">[</span><span class="n">T</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="n">scale_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">InterpolationMode</span><span class="p">,</span> <span class="n">interpolation</span><span class="p">))]</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="c1"># Resize the shortest edge to matching target dim for non-square target</span>
<span></span>        <span class="n">tfl</span> <span class="o">=</span> <span class="p">[</span><span class="n">T</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="n">scale_size</span><span class="p">)]</span>
<span></span>    <span class="n">tfl</span> <span class="o">+=</span> <span class="p">[</span><span class="n">T</span><span class="o">.</span><span class="n">CenterCrop</span><span class="p">(</span><span class="n">size</span><span class="p">),</span> <span class="n">T</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">T</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">mean</span><span class="p">),</span> <span class="n">std</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">std</span><span class="p">))]</span>
<span></span>    <span class="k">return</span> <span class="n">T</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span><span class="n">tfl</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/><hr/><br/></p>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="ultralytics.data.augment.classify_augmentations">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code> <span class="doc doc-object-name doc-function-name">ultralytics.data.augment.classify_augmentations</span>
</h2>
<div class="doc-signature highlight"><pre><span></span><code><span></span><span class="nf">classify_augmentations</span><span class="p">(</span>
<span></span>    <span class="n">size</span><span class="o">=</span><span class="mi">224</span><span class="p">,</span>
<span></span>    <span class="n">mean</span><span class="o">=</span><span class="n">DEFAULT_MEAN</span><span class="p">,</span>
<span></span>    <span class="n">std</span><span class="o">=</span><span class="n">DEFAULT_STD</span><span class="p">,</span>
<span></span>    <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">ratio</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">hflip</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span></span>    <span class="n">vflip</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span></span>    <span class="n">auto_augment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">hsv_h</span><span class="o">=</span><span class="mf">0.015</span><span class="p">,</span>
<span></span>    <span class="n">hsv_s</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
<span></span>    <span class="n">hsv_v</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
<span></span>    <span class="n">force_color_jitter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">erasing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span></span>    <span class="n">interpolation</span><span class="o">=</span><span class="s2">"BILINEAR"</span><span class="p">,</span>
<span></span><span class="p">)</span>
</code></pre></div>
<div class="doc doc-contents first">
<p>Creates a composition of image augmentation transforms for classification tasks.</p>
<p>This function generates a set of image transformations suitable for training classification models. It includes
options for resizing, flipping, color jittering, auto augmentation, and random erasing.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code>size</code>
</td>
<td>
<code><span title="int">int</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Target size for the image after transformations.</p>
</div>
</td>
<td>
<code>224</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>mean</code>
</td>
<td>
<code><span title="tuple">tuple</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Mean values for normalization, one per channel.</p>
</div>
</td>
<td>
<code><span title="ultralytics.data.augment.DEFAULT_MEAN">DEFAULT_MEAN</span></code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>std</code>
</td>
<td>
<code><span title="tuple">tuple</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Standard deviation values for normalization, one per channel.</p>
</div>
</td>
<td>
<code><span title="ultralytics.data.augment.DEFAULT_STD">DEFAULT_STD</span></code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>scale</code>
</td>
<td>
<code><span title="tuple">tuple</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>Range of size of the origin size cropped.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>ratio</code>
</td>
<td>
<code><span title="tuple">tuple</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>Range of aspect ratio of the origin aspect ratio cropped.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>hflip</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of horizontal flip.</p>
</div>
</td>
<td>
<code>0.5</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>vflip</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of vertical flip.</p>
</div>
</td>
<td>
<code>0.0</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>auto_augment</code>
</td>
<td>
<code><span title="str">str</span> | None</code>
</td>
<td>
<div class="doc-md-description">
<p>Auto augmentation policy. Can be 'randaugment', 'augmix', 'autoaugment' or None.</p>
</div>
</td>
<td>
<code>None</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>hsv_h</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Image HSV-Hue augmentation factor.</p>
</div>
</td>
<td>
<code>0.015</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>hsv_s</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Image HSV-Saturation augmentation factor.</p>
</div>
</td>
<td>
<code>0.4</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>hsv_v</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Image HSV-Value augmentation factor.</p>
</div>
</td>
<td>
<code>0.4</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>force_color_jitter</code>
</td>
<td>
<code><span title="bool">bool</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Whether to apply color jitter even if auto augment is enabled.</p>
</div>
</td>
<td>
<code>False</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>erasing</code>
</td>
<td>
<code><span title="float">float</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Probability of random erasing.</p>
</div>
</td>
<td>
<code>0.0</code>
</td>
</tr>
<tr class="doc-section-item">
<td>
<code>interpolation</code>
</td>
<td>
<code><span title="str">str</span></code>
</td>
<td>
<div class="doc-md-description">
<p>Interpolation method of either 'NEAREST', 'BILINEAR' or 'BICUBIC'.</p>
</div>
</td>
<td>
<code>'BILINEAR'</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td>
<code><span title="torchvision.transforms.Compose">Compose</span></code>
</td>
<td>
<div class="doc-md-description">
<p>A composition of image augmentation transforms.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight"><pre><span></span><code><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transforms</span> <span class="o">=</span> <span class="n">classify_augmentations</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">224</span><span class="p">,</span> <span class="n">auto_augment</span><span class="o">=</span><span class="s2">"randaugment"</span><span class="p">)</span>
<span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augmented_image</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">(</span><span class="n">original_image</span><span class="p">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>ultralytics/data/augment.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span>2507</span>
<span>2508</span>
<span>2509</span>
<span>2510</span>
<span>2511</span>
<span>2512</span>
<span>2513</span>
<span>2514</span>
<span>2515</span>
<span>2516</span>
<span>2517</span>
<span>2518</span>
<span>2519</span>
<span>2520</span>
<span>2521</span>
<span>2522</span>
<span>2523</span>
<span>2524</span>
<span>2525</span>
<span>2526</span>
<span>2527</span>
<span>2528</span>
<span>2529</span>
<span>2530</span>
<span>2531</span>
<span>2532</span>
<span>2533</span>
<span>2534</span>
<span>2535</span>
<span>2536</span>
<span>2537</span>
<span>2538</span>
<span>2539</span>
<span>2540</span>
<span>2541</span>
<span>2542</span>
<span>2543</span>
<span>2544</span>
<span>2545</span>
<span>2546</span>
<span>2547</span>
<span>2548</span>
<span>2549</span>
<span>2550</span>
<span>2551</span>
<span>2552</span>
<span>2553</span>
<span>2554</span>
<span>2555</span>
<span>2556</span>
<span>2557</span>
<span>2558</span>
<span>2559</span>
<span>2560</span>
<span>2561</span>
<span>2562</span>
<span>2563</span>
<span>2564</span>
<span>2565</span>
<span>2566</span>
<span>2567</span>
<span>2568</span>
<span>2569</span>
<span>2570</span>
<span>2571</span>
<span>2572</span>
<span>2573</span>
<span>2574</span>
<span>2575</span>
<span>2576</span>
<span>2577</span>
<span>2578</span>
<span>2579</span>
<span>2580</span>
<span>2581</span>
<span>2582</span>
<span>2583</span>
<span>2584</span>
<span>2585</span>
<span>2586</span>
<span>2587</span>
<span>2588</span>
<span>2589</span>
<span>2590</span>
<span>2591</span>
<span>2592</span>
<span>2593</span>
<span>2594</span>
<span>2595</span>
<span>2596</span>
<span>2597</span>
<span>2598</span>
<span>2599</span>
<span>2600</span>
<span>2601</span>
<span>2602</span>
<span>2603</span>
<span>2604</span>
<span>2605</span>
<span>2606</span>
<span>2607</span></pre></div></td><td class="code"><div><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">classify_augmentations</span><span class="p">(</span>
<span></span>    <span class="n">size</span><span class="o">=</span><span class="mi">224</span><span class="p">,</span>
<span></span>    <span class="n">mean</span><span class="o">=</span><span class="n">DEFAULT_MEAN</span><span class="p">,</span>
<span></span>    <span class="n">std</span><span class="o">=</span><span class="n">DEFAULT_STD</span><span class="p">,</span>
<span></span>    <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">ratio</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">hflip</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span></span>    <span class="n">vflip</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span></span>    <span class="n">auto_augment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">hsv_h</span><span class="o">=</span><span class="mf">0.015</span><span class="p">,</span>  <span class="c1"># image HSV-Hue augmentation (fraction)</span>
<span></span>    <span class="n">hsv_s</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>  <span class="c1"># image HSV-Saturation augmentation (fraction)</span>
<span></span>    <span class="n">hsv_v</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>  <span class="c1"># image HSV-Value augmentation (fraction)</span>
<span></span>    <span class="n">force_color_jitter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">erasing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span></span>    <span class="n">interpolation</span><span class="o">=</span><span class="s2">"BILINEAR"</span><span class="p">,</span>
<span></span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""</span>
<span></span><span class="sd">    Creates a composition of image augmentation transforms for classification tasks.</span>
<span></span>
<span></span><span class="sd">    This function generates a set of image transformations suitable for training classification models. It includes</span>
<span></span><span class="sd">    options for resizing, flipping, color jittering, auto augmentation, and random erasing.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        size (int): Target size for the image after transformations.</span>
<span></span><span class="sd">        mean (tuple): Mean values for normalization, one per channel.</span>
<span></span><span class="sd">        std (tuple): Standard deviation values for normalization, one per channel.</span>
<span></span><span class="sd">        scale (tuple | None): Range of size of the origin size cropped.</span>
<span></span><span class="sd">        ratio (tuple | None): Range of aspect ratio of the origin aspect ratio cropped.</span>
<span></span><span class="sd">        hflip (float): Probability of horizontal flip.</span>
<span></span><span class="sd">        vflip (float): Probability of vertical flip.</span>
<span></span><span class="sd">        auto_augment (str | None): Auto augmentation policy. Can be 'randaugment', 'augmix', 'autoaugment' or None.</span>
<span></span><span class="sd">        hsv_h (float): Image HSV-Hue augmentation factor.</span>
<span></span><span class="sd">        hsv_s (float): Image HSV-Saturation augmentation factor.</span>
<span></span><span class="sd">        hsv_v (float): Image HSV-Value augmentation factor.</span>
<span></span><span class="sd">        force_color_jitter (bool): Whether to apply color jitter even if auto augment is enabled.</span>
<span></span><span class="sd">        erasing (float): Probability of random erasing.</span>
<span></span><span class="sd">        interpolation (str): Interpolation method of either 'NEAREST', 'BILINEAR' or 'BICUBIC'.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torchvision.transforms.Compose): A composition of image augmentation transforms.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; transforms = classify_augmentations(size=224, auto_augment="randaugment")</span>
<span></span><span class="sd">        &gt;&gt;&gt; augmented_image = transforms(original_image)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="c1"># Transforms to apply if Albumentations not installed</span>
<span></span>    <span class="kn">import</span><span class="w"> </span><span class="nn">torchvision.transforms</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">T</span>  <span class="c1"># scope for faster 'import ultralytics'</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<span></span>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"classify_transforms() size </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2"> must be integer, not (list, tuple)"</span><span class="p">)</span>
<span></span>    <span class="n">scale</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">scale</span> <span class="ow">or</span> <span class="p">(</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>  <span class="c1"># default imagenet scale range</span>
<span></span>    <span class="n">ratio</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ratio</span> <span class="ow">or</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">))</span>  <span class="c1"># default imagenet ratio range</span>
<span></span>    <span class="n">interpolation</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">InterpolationMode</span><span class="p">,</span> <span class="n">interpolation</span><span class="p">)</span>
<span></span>    <span class="n">primary_tfl</span> <span class="o">=</span> <span class="p">[</span><span class="n">T</span><span class="o">.</span><span class="n">RandomResizedCrop</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="n">ratio</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">)]</span>
<span></span>    <span class="k">if</span> <span class="n">hflip</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
<span></span>        <span class="n">primary_tfl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">RandomHorizontalFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">hflip</span><span class="p">))</span>
<span></span>    <span class="k">if</span> <span class="n">vflip</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
<span></span>        <span class="n">primary_tfl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">RandomVerticalFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">vflip</span><span class="p">))</span>
<span></span>
<span></span>    <span class="n">secondary_tfl</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>    <span class="n">disable_color_jitter</span> <span class="o">=</span> <span class="kc">False</span>
<span></span>    <span class="k">if</span> <span class="n">auto_augment</span><span class="p">:</span>
<span></span>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">auto_augment</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"Provided argument should be string, but got type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">auto_augment</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
<span></span>        <span class="c1"># color jitter is typically disabled if AA/RA on,</span>
<span></span>        <span class="c1"># this allows override without breaking old hparm cfgs</span>
<span></span>        <span class="n">disable_color_jitter</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">force_color_jitter</span>
<span></span>
<span></span>        <span class="k">if</span> <span class="n">auto_augment</span> <span class="o">==</span> <span class="s2">"randaugment"</span><span class="p">:</span>
<span></span>            <span class="k">if</span> <span class="n">TORCHVISION_0_11</span><span class="p">:</span>
<span></span>                <span class="n">secondary_tfl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">RandAugment</span><span class="p">(</span><span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">))</span>
<span></span>            <span class="k">else</span><span class="p">:</span>
<span></span>                <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">'"auto_augment=randaugment" requires torchvision &gt;= 0.11.0. Disabling it.'</span><span class="p">)</span>
<span></span>
<span></span>        <span class="k">elif</span> <span class="n">auto_augment</span> <span class="o">==</span> <span class="s2">"augmix"</span><span class="p">:</span>
<span></span>            <span class="k">if</span> <span class="n">TORCHVISION_0_13</span><span class="p">:</span>
<span></span>                <span class="n">secondary_tfl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">AugMix</span><span class="p">(</span><span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">))</span>
<span></span>            <span class="k">else</span><span class="p">:</span>
<span></span>                <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">'"auto_augment=augmix" requires torchvision &gt;= 0.13.0. Disabling it.'</span><span class="p">)</span>
<span></span>
<span></span>        <span class="k">elif</span> <span class="n">auto_augment</span> <span class="o">==</span> <span class="s2">"autoaugment"</span><span class="p">:</span>
<span></span>            <span class="k">if</span> <span class="n">TORCHVISION_0_10</span><span class="p">:</span>
<span></span>                <span class="n">secondary_tfl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">AutoAugment</span><span class="p">(</span><span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">))</span>
<span></span>            <span class="k">else</span><span class="p">:</span>
<span></span>                <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">'"auto_augment=autoaugment" requires torchvision &gt;= 0.10.0. Disabling it.'</span><span class="p">)</span>
<span></span>
<span></span>        <span class="k">else</span><span class="p">:</span>
<span></span>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span></span>                <span class="sa">f</span><span class="s1">'Invalid auto_augment policy: </span><span class="si">{</span><span class="n">auto_augment</span><span class="si">}</span><span class="s1">. Should be one of "randaugment", '</span>
<span></span>                <span class="sa">f</span><span class="s1">'"augmix", "autoaugment" or None'</span>
<span></span>            <span class="p">)</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">disable_color_jitter</span><span class="p">:</span>
<span></span>        <span class="n">secondary_tfl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">ColorJitter</span><span class="p">(</span><span class="n">brightness</span><span class="o">=</span><span class="n">hsv_v</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="n">hsv_v</span><span class="p">,</span> <span class="n">saturation</span><span class="o">=</span><span class="n">hsv_s</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">hsv_h</span><span class="p">))</span>
<span></span>
<span></span>    <span class="n">final_tfl</span> <span class="o">=</span> <span class="p">[</span>
<span></span>        <span class="n">T</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
<span></span>        <span class="n">T</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">mean</span><span class="p">),</span> <span class="n">std</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">std</span><span class="p">)),</span>
<span></span>        <span class="n">T</span><span class="o">.</span><span class="n">RandomErasing</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">erasing</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span></span>    <span class="p">]</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="n">T</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span><span class="n">primary_tfl</span> <span class="o">+</span> <span class="n">secondary_tfl</span> <span class="o">+</span> <span class="n">final_tfl</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div><p><br/><br/></p>
<div class="git-info">
<div class="dates-container">
<span class="date-item" title="This page was first created on November 12, 2023">
<span class="hover-item">📅</span> Created 1 year ago
    </span>
<span class="date-item" title="This page was last updated on March 31, 2025">
<span class="hover-item">✏️</span> Updated 22 days ago
    </span>
</div>
<div class="authors-container">
<a class="author-link" href="https://github.com/RizwanMunawar" title="RizwanMunawar (1 change)">
<img alt="RizwanMunawar" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62513924?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/jk4e" title="jk4e (1 change)">
<img alt="jk4e" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/116908874?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/glenn-jocher" title="glenn-jocher (7 changes)">
<img alt="glenn-jocher" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/26833433?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/Burhan-Q" title="Burhan-Q (1 change)">
<img alt="Burhan-Q" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62214284?v=4&amp;s=96"/>
</a>
<a class="author-link" href="https://github.com/Laughing-q" title="Laughing-q (1 change)">
<img alt="Laughing-q" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/61612323?v=4&amp;s=96"/>
</a>
</div></div><div class="share-buttons">
<button class="share-button hover-item" onclick="window.open('https://twitter.com/intent/tweet?url=https://docs.ultralytics.com/reference/data/augment', 'TwitterShare', 'width=550,height=680,menubar=no,toolbar=no'); return false;">
<i class="fa-brands fa-x-twitter"></i> Tweet
    </button>
<button class="share-button hover-item linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?url=https://docs.ultralytics.com/reference/data/augment', 'LinkedinShare', 'width=550,height=730,menubar=no,toolbar=no'); return false;">
<i class="fa-brands fa-linkedin-in"></i> Share
    </button>
</div>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: annotator" class="md-footer__link md-footer__link--prev" href="../annotator/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                annotator
              </div>
</div>
</a>
<a aria-label="Next: base" class="md-footer__link md-footer__link--next" href="../base/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                base
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
<a href="https://www.ultralytics.com/" target="_blank">© 2025 Ultralytics Inc.</a> All rights reserved.
    </div>
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/ultralytics" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
<a class="md-social__link" href="https://www.linkedin.com/company/ultralytics/" rel="noopener" target="_blank" title="www.linkedin.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"></path></svg>
</a>
<a class="md-social__link" href="https://x.com/ultralytics" rel="noopener" target="_blank" title="x.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"></path></svg>
</a>
<a class="md-social__link" href="https://youtube.com/ultralytics?sub_confirmation=1" rel="noopener" target="_blank" title="youtube.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"></path></svg>
</a>
<a class="md-social__link" href="https://hub.docker.com/r/ultralytics/ultralytics/" rel="noopener" target="_blank" title="hub.docker.com">
<svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"></path></svg>
</a>
<a class="md-social__link" href="https://pypi.org/project/ultralytics/" rel="noopener" target="_blank" title="pypi.org">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"></path></svg>
</a>
<a class="md-social__link" href="https://discord.com/invite/ultralytics" rel="noopener" target="_blank" title="discord.com">
<svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"></path></svg>
</a>
<a class="md-social__link" href="https://reddit.com/r/ultralytics" rel="noopener" target="_blank" title="reddit.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5"></path></svg>
</a>
<a class="md-social__link" href="https://weixin.qq.com/r/mp/LxckPDfEgWr_rXNf90I9" rel="noopener" target="_blank" title="weixin.qq.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.action.edit", "content.code.annotate", "content.code.copy", "content.tooltips", "search.highlight", "search.share", "search.suggest", "toc.follow", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.prune", "navigation.footer", "navigation.tracking", "navigation.instant", "navigation.instant.progress", "navigation.indexes", "navigation.sections", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
<script src="../../../javascript/extra.js"></script>
<script src="../../../javascript/giscus.js"></script>
<script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
<script src="../../../javascript/tablesort.js"></script>
</body>
</html>