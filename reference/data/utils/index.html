 <!DOCTYPE html><html class="no-js" lang="en"><head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Explore in-depth reference for utility functions in Ultralytics data module. Learn about image verification, dataset handling, and more." name="description"/><meta content="Ultralytics" name="author"/><link href="https://docs.ultralytics.com/reference/data/utils/" rel="canonical"/><link href="../split_dota/" rel="prev"/><link href="../../engine/exporter/" rel="next"/><link href="/" hreflang="en" rel="alternate"/><link href="/zh/" hreflang="zh" rel="alternate"/><link href="/ko/" hreflang="ko" rel="alternate"/><link href="/ja/" hreflang="ja" rel="alternate"/><link href="/ru/" hreflang="ru" rel="alternate"/><link href="/de/" hreflang="de" rel="alternate"/><link href="/fr/" hreflang="fr" rel="alternate"/><link href="/es/" hreflang="es" rel="alternate"/><link href="/pt/" hreflang="pt" rel="alternate"/><link href="/it/" hreflang="it" rel="alternate"/><link href="/tr/" hreflang="tr" rel="alternate"/><link href="/vi/" hreflang="vi" rel="alternate"/><link href="/ar/" hreflang="ar" rel="alternate"/><link href="https://raw.githubusercontent.com/ultralytics/assets/refs/heads/main/logo/favicon-yolo.png" rel="icon"/><meta content="zensical-0.0.17" name="generator"/><title>Reference for ultralytics/data/utils.py - Ultralytics YOLO Docs</title><link href="../../../assets/stylesheets/modern/main.d4922b3c.min.css" rel="stylesheet"/><link href="../../../assets/stylesheets/modern/palette.dfe2e883.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,500,500i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link href="../../../stylesheets/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)),0),__md_get=(e,t=localStorage,a=__md_scope)=>JSON.parse(t.getItem(a.pathname+"."+e)),__md_set=(e,t,a=localStorage,_=__md_scope)=>{try{a.setItem(_.pathname+"."+e,JSON.stringify(t))}catch(e){}},document.documentElement.setAttribute("data-platform",navigator.platform)</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2M5EHKC0BH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2M5EHKC0BH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2M5EHKC0BH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
<style data-doc-kind="true">.doc-kind{display:inline-flex;align-items:center;gap:0.25em;padding:0.21em 0.59em;border-radius:999px;font-weight:700;font-size:0.81em;letter-spacing:0.06em;text-transform:uppercase;line-height:1;color:var(--doc-kind-color,#f8fafc);background:var(--doc-kind-bg,rgba(255,255,255,0.12));}.doc-kind-class{--doc-kind-color:#039dfc;--doc-kind-bg:rgba(3,157,252,0.22);}.doc-kind-function{--doc-kind-color:#fc9803;--doc-kind-bg:rgba(252,152,3,0.22);}.doc-kind-method{--doc-kind-color:#ef5eff;--doc-kind-bg:rgba(239,94,255,0.22);}.doc-kind-property{--doc-kind-color:#02e835;--doc-kind-bg:rgba(2,232,53,0.22);}</style><meta content="Reference for ultralytics/data/utils.py" name="title"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"/><meta content="website" property="og:type"/><meta content="https://docs.ultralytics.com/reference/data/utils/" property="og:url"/><meta content="Reference for ultralytics/data/utils.py" property="og:title"/><meta content="" property="og:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="og:image"/><meta content="summary_large_image" property="twitter:card"/><meta content="https://docs.ultralytics.com/reference/data/utils/" property="twitter:url"/><meta content="Reference for ultralytics/data/utils.py" property="twitter:title"/><meta content="" property="twitter:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="twitter:image"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "headline": "Reference for ultralytics/data/utils.py", "image": ["https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png"], "datePublished": "2023-11-12 02:49:37 +0100", "dateModified": "2025-11-23 19:53:50 +0100", "author": [{"@type": "Organization", "name": "Ultralytics", "url": "https://ultralytics.com/"}], "abstract": ""}</script></head><body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr"><input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/><input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/><label class="md-overlay" for="__drawer"></label><div data-md-component="skip"><a class="md-skip" href="#reference-for-ultralyticsdatautilspy"> Skip to content </a></div><div data-md-component="announce"><aside class="md-banner"><div class="md-banner__inner md-grid md-typeset"><a class="banner-wrapper" href="https://docs.ultralytics.com/models/yolo26"><div class="banner-content-wrapper"><img alt="Ultralytics YOLO26" height="40" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/6967372a0d67914985d322e7_Ultralytics%20YOLO26%201.svg"/><p>Built End-to-End. Built for the Edge.</p></div></a></div></aside></div><header class="md-header md-header--shadow md-header--lifted" data-md-component="header"><nav aria-label="Header" class="md-header__inner md-grid"><a aria-label="Ultralytics YOLO Docs" class="md-header__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs"><img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/></a><label class="md-header__button md-icon" for="__drawer"><svg class="lucide lucide-menu" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 5h16M4 12h16M4 19h16"></path></svg></label><div class="md-header__title" data-md-component="header-title"><div class="md-header__ellipsis"><div class="md-header__topic"><span class="md-ellipsis"> Ultralytics YOLO Docs </span></div><div class="md-header__topic" data-md-component="header-topic"><span class="md-ellipsis"> Reference for ultralytics/data/utils.py </span></div></div></div><form class="md-header__option" data-md-component="palette"><input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg></label><input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to system preference"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label><input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label></form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<div class="md-header__option"><div class="md-select"><button aria-label="Select language" class="md-header__button md-icon"><svg class="lucide lucide-languages" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m5 8 6 6M4 14l6-6 2-3M2 5h12M7 2h1M22 22l-5-10-5 10M14 18h6"></path></svg></button><div class="md-select__inner"><ul class="md-select__list"><li class="md-select__item"><a class="md-select__link" href="/" hreflang="en"> ğŸ‡¬ğŸ‡§ English </a></li><li class="md-select__item"><a class="md-select__link" href="/zh/" hreflang="zh"> ğŸ‡¨ğŸ‡³ ç®€ä½“ä¸­æ–‡ </a></li><li class="md-select__item"><a class="md-select__link" href="/ko/" hreflang="ko"> ğŸ‡°ğŸ‡· í•œêµ­ì–´ </a></li><li class="md-select__item"><a class="md-select__link" href="/ja/" hreflang="ja"> ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª </a></li><li class="md-select__item"><a class="md-select__link" href="/ru/" hreflang="ru"> ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹ </a></li><li class="md-select__item"><a class="md-select__link" href="/de/" hreflang="de"> ğŸ‡©ğŸ‡ª Deutsch </a></li><li class="md-select__item"><a class="md-select__link" href="/fr/" hreflang="fr"> ğŸ‡«ğŸ‡· FranÃ§ais </a></li><li class="md-select__item"><a class="md-select__link" href="/es/" hreflang="es"> ğŸ‡ªğŸ‡¸ EspaÃ±ol </a></li><li class="md-select__item"><a class="md-select__link" href="/pt/" hreflang="pt"> ğŸ‡µğŸ‡¹ PortuguÃªs </a></li><li class="md-select__item"><a class="md-select__link" href="/it/" hreflang="it"> ğŸ‡®ğŸ‡¹ Italiano </a></li><li class="md-select__item"><a class="md-select__link" href="/tr/" hreflang="tr"> ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e </a></li><li class="md-select__item"><a class="md-select__link" href="/vi/" hreflang="vi"> ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t </a></li><li class="md-select__item"><a class="md-select__link" href="/ar/" hreflang="ar"> ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© </a></li></ul></div></div></div><div class="md-header__source"><a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository"><div class="md-source__icon md-icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></div><div class="md-source__repository"> ultralytics/ultralytics </div></a></div></nav><nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"><div class="md-grid"><ul class="md-tabs__list"><li class="md-tabs__item"><a class="md-tabs__link" href="../../.."> Home </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../quickstart/"> Quickstart </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../modes/"> Modes </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../tasks/"> Tasks </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../models/"> Models </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../datasets/"> Datasets </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../solutions/"> Solutions </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../guides/"> Guides </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../integrations/"> Integrations </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../platform/"> Platform </a></li><li class="md-tabs__item md-tabs__item--active"><a class="md-tabs__link" href="../../__init__/"> Reference </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../help/"> Help </a></li></ul></div></nav></header><div class="md-container" data-md-component="container"><main class="md-main" data-md-component="main"><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0"><label class="md-nav__title" for="__drawer"><a aria-label="Ultralytics YOLO Docs" class="md-nav__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs"><img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/></a> Ultralytics YOLO Docs </label><div class="md-nav__source"><a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository"><div class="md-source__icon md-icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></div><div class="md-source__repository"> ultralytics/ultralytics </div></a></div><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../.."><span class="md-ellipsis"> Home </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../quickstart/"><span class="md-ellipsis"> Quickstart </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../modes/"><span class="md-ellipsis"> Modes </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../tasks/"><span class="md-ellipsis"> Tasks </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../models/"><span class="md-ellipsis"> Models </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../datasets/"><span class="md-ellipsis"> Datasets </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../solutions/"><span class="md-ellipsis"> Solutions </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../guides/"><span class="md-ellipsis"> Guides </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../integrations/"><span class="md-ellipsis"> Integrations </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../platform/"><span class="md-ellipsis"> Platform </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input checked="" class="md-nav__toggle md-toggle" id="__nav_11" type="checkbox"/><label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex=""><span class="md-ellipsis"> Reference </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="true" aria-labelledby="__nav_11_label" class="md-nav" data-md-level="1"><label class="md-nav__title" for="__nav_11"><span class="md-nav__icon md-icon"></span> Reference </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_2" type="checkbox"/><label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex=""><span class="md-ellipsis"> cfg </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_2_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_2"><span class="md-nav__icon md-icon"></span> cfg </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../cfg/__init__/"><span class="md-ellipsis"> __init__ </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input checked="" class="md-nav__toggle md-toggle" id="__nav_11_3" type="checkbox"/><label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex=""><span class="md-ellipsis"> data </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="true" aria-labelledby="__nav_11_3_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_3"><span class="md-nav__icon md-icon"></span> data </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../annotator/"><span class="md-ellipsis"> annotator </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../augment/"><span class="md-ellipsis"> augment </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../base/"><span class="md-ellipsis"> base </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../build/"><span class="md-ellipsis"> build </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../converter/"><span class="md-ellipsis"> converter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../dataset/"><span class="md-ellipsis"> dataset </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../loaders/"><span class="md-ellipsis"> loaders </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../split/"><span class="md-ellipsis"> split </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../split_dota/"><span class="md-ellipsis"> split_dota </span></a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/><label class="md-nav__link md-nav__link--active" for="__toc"><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></label><a class="md-nav__link md-nav__link--active" href="./"><span class="md-ellipsis"> utils </span></a><nav aria-label="On this page" class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc"><span class="md-nav__icon md-icon"></span> On this page </label><ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.HUBDatasetStats"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> HUBDatasetStats</span></a><nav aria-label="Class ultralytics.data.utils.HUBDatasetStats" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.HUBDatasetStats._hub_ops"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> _hub_ops</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.HUBDatasetStats._unzip"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> _unzip</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.HUBDatasetStats.get_json"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> get_json</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.HUBDatasetStats.process_images"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> process_images</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.img2label_paths"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> img2label_paths</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.check_file_speeds"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> check_file_speeds</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.get_hash"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> get_hash</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.exif_size"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> exif_size</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.verify_image"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> verify_image</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.verify_image_label"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> verify_image_label</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.visualize_image_annotations"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> visualize_image_annotations</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.polygon2mask"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> polygon2mask</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.polygons2masks"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> polygons2masks</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.polygons2masks_overlap"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> polygons2masks_overlap</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.find_dataset_yaml"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> find_dataset_yaml</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.check_det_dataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> check_det_dataset</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.check_cls_dataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> check_cls_dataset</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.compress_one_image"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> compress_one_image</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.load_dataset_cache_file"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> load_dataset_cache_file</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.save_dataset_cache_file"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> save_dataset_cache_file</span></a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_4" type="checkbox"/><label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex=""><span class="md-ellipsis"> engine </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_4_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_4"><span class="md-nav__icon md-icon"></span> engine </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../engine/exporter/"><span class="md-ellipsis"> exporter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/model/"><span class="md-ellipsis"> model </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/predictor/"><span class="md-ellipsis"> predictor </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/results/"><span class="md-ellipsis"> results </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/trainer/"><span class="md-ellipsis"> trainer </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/tuner/"><span class="md-ellipsis"> tuner </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/validator/"><span class="md-ellipsis"> validator </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_5" type="checkbox"/><label class="md-nav__link" for="__nav_11_5" id="__nav_11_5_label" tabindex=""><span class="md-ellipsis"> hub </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_5_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_5"><span class="md-nav__icon md-icon"></span> hub </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../hub/__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/auth/"><span class="md-ellipsis"> auth </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../hub/google/__init__/"><span class="md-ellipsis"> google </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/session/"><span class="md-ellipsis"> session </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/utils/"><span class="md-ellipsis"> utils </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_6" type="checkbox"/><label class="md-nav__link" for="__nav_11_6" id="__nav_11_6_label" tabindex=""><span class="md-ellipsis"> models </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_6_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_6"><span class="md-nav__icon md-icon"></span> models </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/fastsam/model/"><span class="md-ellipsis"> fastsam </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/nas/model/"><span class="md-ellipsis"> nas </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/rtdetr/model/"><span class="md-ellipsis"> rtdetr </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/sam/amg/"><span class="md-ellipsis"> sam </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/utils/loss/"><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/yolo/classify/predict/"><span class="md-ellipsis"> yolo </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_7" type="checkbox"/><label class="md-nav__link" for="__nav_11_7" id="__nav_11_7_label" tabindex=""><span class="md-ellipsis"> nn </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_7_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_7"><span class="md-nav__icon md-icon"></span> nn </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../nn/autobackend/"><span class="md-ellipsis"> autobackend </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../nn/modules/activation/"><span class="md-ellipsis"> modules </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../nn/tasks/"><span class="md-ellipsis"> tasks </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../nn/text_model/"><span class="md-ellipsis"> text_model </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_8" type="checkbox"/><label class="md-nav__link" for="__nav_11_8" id="__nav_11_8_label" tabindex=""><span class="md-ellipsis"> optim </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_8_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_8"><span class="md-nav__icon md-icon"></span> optim </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../optim/muon/"><span class="md-ellipsis"> muon </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_9" type="checkbox"/><label class="md-nav__link" for="__nav_11_9" id="__nav_11_9_label" tabindex=""><span class="md-ellipsis"> solutions </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_9_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_9"><span class="md-nav__icon md-icon"></span> solutions </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/ai_gym/"><span class="md-ellipsis"> ai_gym </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/analytics/"><span class="md-ellipsis"> analytics </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/config/"><span class="md-ellipsis"> config </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/distance_calculation/"><span class="md-ellipsis"> distance_calculation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/heatmap/"><span class="md-ellipsis"> heatmap </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/instance_segmentation/"><span class="md-ellipsis"> instance_segmentation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_blurrer/"><span class="md-ellipsis"> object_blurrer </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_counter/"><span class="md-ellipsis"> object_counter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_cropper/"><span class="md-ellipsis"> object_cropper </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/parking_management/"><span class="md-ellipsis"> parking_management </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/queue_management/"><span class="md-ellipsis"> queue_management </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/region_counter/"><span class="md-ellipsis"> region_counter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/security_alarm/"><span class="md-ellipsis"> security_alarm </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/similarity_search/"><span class="md-ellipsis"> similarity_search </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/solutions/"><span class="md-ellipsis"> solutions </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/speed_estimation/"><span class="md-ellipsis"> speed_estimation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/streamlit_inference/"><span class="md-ellipsis"> streamlit_inference </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/trackzone/"><span class="md-ellipsis"> trackzone </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/vision_eye/"><span class="md-ellipsis"> vision_eye </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_10" type="checkbox"/><label class="md-nav__link" for="__nav_11_10" id="__nav_11_10_label" tabindex=""><span class="md-ellipsis"> trackers </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_10_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_10"><span class="md-nav__icon md-icon"></span> trackers </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/basetrack/"><span class="md-ellipsis"> basetrack </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/bot_sort/"><span class="md-ellipsis"> bot_sort </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/byte_tracker/"><span class="md-ellipsis"> byte_tracker </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/track/"><span class="md-ellipsis"> track </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../trackers/utils/gmc/"><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_11" type="checkbox"/><label class="md-nav__link" for="__nav_11_11" id="__nav_11_11_label" tabindex=""><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_11_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_11"><span class="md-nav__icon md-icon"></span> utils </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../utils/__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/autobatch/"><span class="md-ellipsis"> autobatch </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/autodevice/"><span class="md-ellipsis"> autodevice </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/benchmarks/"><span class="md-ellipsis"> benchmarks </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../utils/callbacks/base/"><span class="md-ellipsis"> callbacks </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/checks/"><span class="md-ellipsis"> checks </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/cpu/"><span class="md-ellipsis"> cpu </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/dist/"><span class="md-ellipsis"> dist </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/downloads/"><span class="md-ellipsis"> downloads </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/errors/"><span class="md-ellipsis"> errors </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/events/"><span class="md-ellipsis"> events </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../utils/export/engine/"><span class="md-ellipsis"> export </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/files/"><span class="md-ellipsis"> files </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/git/"><span class="md-ellipsis"> git </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/instance/"><span class="md-ellipsis"> instance </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/logger/"><span class="md-ellipsis"> logger </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/loss/"><span class="md-ellipsis"> loss </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/metrics/"><span class="md-ellipsis"> metrics </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/nms/"><span class="md-ellipsis"> nms </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/ops/"><span class="md-ellipsis"> ops </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/patches/"><span class="md-ellipsis"> patches </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/plotting/"><span class="md-ellipsis"> plotting </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/tal/"><span class="md-ellipsis"> tal </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/torch_utils/"><span class="md-ellipsis"> torch_utils </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/tqdm/"><span class="md-ellipsis"> tqdm </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/triton/"><span class="md-ellipsis"> triton </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/tuner/"><span class="md-ellipsis"> tuner </span></a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../help/"><span class="md-ellipsis"> Help </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav aria-label="On this page" class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc"><span class="md-nav__icon md-icon"></span> On this page </label><ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.HUBDatasetStats"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> HUBDatasetStats</span></a><nav aria-label="Class ultralytics.data.utils.HUBDatasetStats" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.HUBDatasetStats._hub_ops"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> _hub_ops</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.HUBDatasetStats._unzip"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> _unzip</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.HUBDatasetStats.get_json"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> get_json</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.HUBDatasetStats.process_images"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> process_images</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.img2label_paths"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> img2label_paths</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.check_file_speeds"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> check_file_speeds</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.get_hash"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> get_hash</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.exif_size"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> exif_size</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.verify_image"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> verify_image</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.verify_image_label"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> verify_image_label</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.visualize_image_annotations"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> visualize_image_annotations</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.polygon2mask"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> polygon2mask</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.polygons2masks"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> polygons2masks</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.polygons2masks_overlap"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> polygons2masks_overlap</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.find_dataset_yaml"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> find_dataset_yaml</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.check_det_dataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> check_det_dataset</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.check_cls_dataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> check_cls_dataset</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.compress_one_image"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> compress_one_image</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.load_dataset_cache_file"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> load_dataset_cache_file</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.utils.save_dataset_cache_file"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> save_dataset_cache_file</span></a></li></ul></nav></div></div></div><div class="md-content" data-md-component="content"><article class="md-content__inner md-typeset"><a class="md-content__button md-icon" href="https://github.com/ultralytics/ultralytics/tree/main/docs/en/reference/data/utils.md" rel="edit" title="Edit this page"><svg class="lucide lucide-file-pen" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v9.34"></path><path d="M14 2v5a1 1 0 0 0 1 1h5M10.378 12.622a1 1 0 0 1 3 3.003L8.36 20.637a2 2 0 0 1-.854.506l-2.867.837a.5.5 0 0 1-.62-.62l.836-2.869a2 2 0 0 1 .506-.853z"></path></svg></a><h1 id="reference-for-ultralyticsdatautilspy">Reference for <code>ultralytics/data/utils.py</code></h1><div class="admonition success"><p class="admonition-title">Improvements</p><p>This page is sourced from <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py">https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py</a>. Have an improvement or example to add? Open a <a href="https://docs.ultralytics.com/help/contributing/">Pull Request</a> â€” thank you! ğŸ™</p></div><p><br/></p><div class="admonition abstract"><p class="admonition-title">Summary</p><div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="classes" name="__tabbed_1" type="radio"/><input id="methods" name="__tabbed_1" type="radio"/><input id="functions" name="__tabbed_1" type="radio"/><div class="tabbed-labels"><label for="classes"><span class="doc-kind doc-kind-class">Classes</span></label><label for="methods"><span class="doc-kind doc-kind-method">Methods</span></label><label for="functions"><span class="doc-kind doc-kind-function">Functions</span></label></div><div class="tabbed-content"><div class="tabbed-block"><ul><li><a href="#ultralytics.data.utils.HUBDatasetStats"><code>HUBDatasetStats</code></a></li></ul></div><div class="tabbed-block"><ul><li><a href="#ultralytics.data.utils.HUBDatasetStats._unzip"><code>HUBDatasetStats._unzip</code></a></li><li><a href="#ultralytics.data.utils.HUBDatasetStats._hub_ops"><code>HUBDatasetStats._hub_ops</code></a></li><li><a href="#ultralytics.data.utils.HUBDatasetStats.get_json"><code>HUBDatasetStats.get_json</code></a></li><li><a href="#ultralytics.data.utils.HUBDatasetStats.process_images"><code>HUBDatasetStats.process_images</code></a></li></ul></div><div class="tabbed-block"><ul><li><a href="#ultralytics.data.utils.img2label_paths"><code>img2label_paths</code></a></li><li><a href="#ultralytics.data.utils.check_file_speeds"><code>check_file_speeds</code></a></li><li><a href="#ultralytics.data.utils.get_hash"><code>get_hash</code></a></li><li><a href="#ultralytics.data.utils.exif_size"><code>exif_size</code></a></li><li><a href="#ultralytics.data.utils.verify_image"><code>verify_image</code></a></li><li><a href="#ultralytics.data.utils.verify_image_label"><code>verify_image_label</code></a></li><li><a href="#ultralytics.data.utils.visualize_image_annotations"><code>visualize_image_annotations</code></a></li><li><a href="#ultralytics.data.utils.polygon2mask"><code>polygon2mask</code></a></li><li><a href="#ultralytics.data.utils.polygons2masks"><code>polygons2masks</code></a></li><li><a href="#ultralytics.data.utils.polygons2masks_overlap"><code>polygons2masks_overlap</code></a></li><li><a href="#ultralytics.data.utils.find_dataset_yaml"><code>find_dataset_yaml</code></a></li><li><a href="#ultralytics.data.utils.check_det_dataset"><code>check_det_dataset</code></a></li><li><a href="#ultralytics.data.utils.check_cls_dataset"><code>check_cls_dataset</code></a></li><li><a href="#ultralytics.data.utils.compress_one_image"><code>compress_one_image</code></a></li><li><a href="#ultralytics.data.utils.load_dataset_cache_file"><code>load_dataset_cache_file</code></a></li><li><a href="#ultralytics.data.utils.save_dataset_cache_file"><code>save_dataset_cache_file</code></a></li></ul></div></div></div></div><h2 id="ultralytics.data.utils.HUBDatasetStats"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.data.utils.HUBDatasetStats</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">HUBDatasetStats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"coco8.yaml"</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"detect"</span><span class="p">,</span> <span class="n">autodownload</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</code></pre></div><p>A class for generating HUB dataset JSON and <code>-hub</code> dataset directory.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>path</code></td><td><code>str</code></td><td>Path to data.yaml or data.zip (with data.yaml inside data.zip).</td><td><code>"coco8.yaml"</code></td></tr><tr><td><code>task</code></td><td><code>str</code></td><td>Dataset task. Options are 'detect', 'segment', 'pose', 'classify'.</td><td><code>"detect"</code></td></tr><tr><td><code>autodownload</code></td><td><code>bool</code></td><td>Attempt to download dataset if not found locally.</td><td><code>False</code></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>task</code></td><td><code>str</code></td><td>Dataset task type.</td></tr><tr><td><code>hub_dir</code></td><td><code>Path</code></td><td>Directory path for HUB dataset files.</td></tr><tr><td><code>im_dir</code></td><td><code>Path</code></td><td>Directory path for compressed images.</td></tr><tr><td><code>stats</code></td><td><code>dict</code></td><td>Statistics dictionary containing dataset information.</td></tr><tr><td><code>data</code></td><td><code>dict</code></td><td>Dataset configuration data.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.data.utils.HUBDatasetStats._hub_ops"><code>_hub_ops</code></a></td><td>Save a compressed image for HUB previews.</td></tr><tr><td><a href="#ultralytics.data.utils.HUBDatasetStats._unzip"><code>_unzip</code></a></td><td>Unzip data.zip.</td></tr><tr><td><a href="#ultralytics.data.utils.HUBDatasetStats.get_json"><code>get_json</code></a></td><td>Return dataset JSON for Ultralytics HUB.</td></tr><tr><td><a href="#ultralytics.data.utils.HUBDatasetStats.process_images"><code>process_images</code></a></td><td>Compress images for Ultralytics HUB.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">HUBDatasetStats</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">stats</span> <span class="o">=</span> <span class="n">HUBDatasetStats</span><span class="p">(</span><span class="s2">"path/to/coco8.zip"</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">"detect"</span><span class="p">)</span>  <span class="c1"># detect dataset</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">stats</span> <span class="o">=</span> <span class="n">HUBDatasetStats</span><span class="p">(</span><span class="s2">"path/to/coco8-seg.zip"</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">"segment"</span><span class="p">)</span>  <span class="c1"># segment dataset</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">stats</span> <span class="o">=</span> <span class="n">HUBDatasetStats</span><span class="p">(</span><span class="s2">"path/to/coco8-pose.zip"</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">"pose"</span><span class="p">)</span>  <span class="c1"># pose dataset</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">stats</span> <span class="o">=</span> <span class="n">HUBDatasetStats</span><span class="p">(</span><span class="s2">"path/to/dota8.zip"</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">"obb"</span><span class="p">)</span>  <span class="c1"># OBB dataset</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">stats</span> <span class="o">=</span> <span class="n">HUBDatasetStats</span><span class="p">(</span><span class="s2">"path/to/imagenet10.zip"</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">"classify"</span><span class="p">)</span>  <span class="c1"># classification dataset</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">stats</span><span class="o">.</span><span class="n">get_json</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">stats</span><span class="o">.</span><span class="n">process_images</span><span class="p">()</span>
</code></pre></div><div class="admonition note"><p class="admonition-title">Notes</p><p>Download *.zip files from <a href="https://github.com/ultralytics/hub/tree/main/example_datasets">https://github.com/ultralytics/hub/tree/main/example_datasets</a>
i.e. <a href="https://github.com/ultralytics/hub/raw/main/example_datasets/coco8.zip">https://github.com/ultralytics/hub/raw/main/example_datasets/coco8.zip</a> for coco8.zip.</p></div><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L576-L739"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">HUBDatasetStats</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""A class for generating HUB dataset JSON and `-hub` dataset directory.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        path (str): Path to data.yaml or data.zip (with data.yaml inside data.zip).</span>
<span></span><span class="sd">        task (str): Dataset task. Options are 'detect', 'segment', 'pose', 'classify'.</span>
<span></span><span class="sd">        autodownload (bool): Attempt to download dataset if not found locally.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        task (str): Dataset task type.</span>
<span></span><span class="sd">        hub_dir (Path): Directory path for HUB dataset files.</span>
<span></span><span class="sd">        im_dir (Path): Directory path for compressed images.</span>
<span></span><span class="sd">        stats (dict): Statistics dictionary containing dataset information.</span>
<span></span><span class="sd">        data (dict): Dataset configuration data.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        get_json: Return dataset JSON for Ultralytics HUB.</span>
<span></span><span class="sd">        process_images: Compress images for Ultralytics HUB.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics.data.utils import HUBDatasetStats</span>
<span></span><span class="sd">        &gt;&gt;&gt; stats = HUBDatasetStats("path/to/coco8.zip", task="detect")  # detect dataset</span>
<span></span><span class="sd">        &gt;&gt;&gt; stats = HUBDatasetStats("path/to/coco8-seg.zip", task="segment")  # segment dataset</span>
<span></span><span class="sd">        &gt;&gt;&gt; stats = HUBDatasetStats("path/to/coco8-pose.zip", task="pose")  # pose dataset</span>
<span></span><span class="sd">        &gt;&gt;&gt; stats = HUBDatasetStats("path/to/dota8.zip", task="obb")  # OBB dataset</span>
<span></span><span class="sd">        &gt;&gt;&gt; stats = HUBDatasetStats("path/to/imagenet10.zip", task="classify")  # classification dataset</span>
<span></span><span class="sd">        &gt;&gt;&gt; stats.get_json(save=True)</span>
<span></span><span class="sd">        &gt;&gt;&gt; stats.process_images()</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        Download *.zip files from https://github.com/ultralytics/hub/tree/main/example_datasets</span>
<span></span><span class="sd">        i.e. https://github.com/ultralytics/hub/raw/main/example_datasets/coco8.zip for coco8.zip.</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"coco8.yaml"</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"detect"</span><span class="p">,</span> <span class="n">autodownload</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize class."""</span>
<span></span>        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Starting HUB dataset checks for </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">...."</span><span class="p">)</span>
<span></span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="n">task</span>  <span class="c1"># detect, segment, pose, classify, obb</span>
<span></span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">==</span> <span class="s2">"classify"</span><span class="p">:</span>
<span></span>            <span class="n">unzip_dir</span> <span class="o">=</span> <span class="n">unzip_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span></span>            <span class="n">data</span> <span class="o">=</span> <span class="n">check_cls_dataset</span><span class="p">(</span><span class="n">unzip_dir</span><span class="p">)</span>
<span></span>            <span class="n">data</span><span class="p">[</span><span class="s2">"path"</span><span class="p">]</span> <span class="o">=</span> <span class="n">unzip_dir</span>
<span></span>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># detect, segment, pose, obb</span>
<span></span>            <span class="n">_</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">,</span> <span class="n">yaml_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unzip</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
<span></span>            <span class="k">try</span><span class="p">:</span>
<span></span>                <span class="c1"># Load YAML with checks</span>
<span></span>                <span class="n">data</span> <span class="o">=</span> <span class="n">YAML</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">yaml_path</span><span class="p">)</span>
<span></span>                <span class="n">data</span><span class="p">[</span><span class="s2">"path"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">""</span>  <span class="c1"># strip path since YAML should be in dataset root for all HUB datasets</span>
<span></span>                <span class="n">YAML</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">yaml_path</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span></span>                <span class="n">data</span> <span class="o">=</span> <span class="n">check_det_dataset</span><span class="p">(</span><span class="n">yaml_path</span><span class="p">,</span> <span class="n">autodownload</span><span class="p">)</span>  <span class="c1"># dict</span>
<span></span>                <span class="n">data</span><span class="p">[</span><span class="s2">"path"</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_dir</span>  <span class="c1"># YAML path should be set to '' (relative) or parent (absolute)</span>
<span></span>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span></span>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">"error/HUB/dataset_stats/init"</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
<span></span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">hub_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">'path'</span><span class="p">]</span><span class="si">}</span><span class="s2">-hub"</span><span class="p">)</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">im_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hub_dir</span> <span class="o">/</span> <span class="s2">"images"</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"nc"</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">"names"</span><span class="p">]),</span> <span class="s2">"names"</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">"names"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())}</span>  <span class="c1"># statistics dictionary</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.utils.HUBDatasetStats._hub_ops"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.utils.HUBDatasetStats._hub_ops</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_hub_ops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div><p>Save a compressed image for HUB previews.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>f</code></td><td><code>str</code></td><td></td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L648-L650"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_hub_ops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Save a compressed image for HUB previews."""</span>
<span></span>    <span class="n">compress_one_image</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">im_dir</span> <span class="o">/</span> <span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># save to dataset-hub</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.utils.HUBDatasetStats._unzip"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.utils.HUBDatasetStats._unzip</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_unzip</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]</span>
</code></pre></div><p>Unzip data.zip.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>path</code></td><td><code>Path</code></td><td></td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L638-L646"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@staticmethod</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">_unzip</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Unzip data.zip."""</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".zip"</span><span class="p">):</span>  <span class="c1"># path is data.yaml</span>
<span></span>        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">path</span>
<span></span>    <span class="n">unzip_dir</span> <span class="o">=</span> <span class="n">unzip_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
<span></span>    <span class="k">assert</span> <span class="n">unzip_dir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">(),</span> <span class="p">(</span>
<span></span>        <span class="sa">f</span><span class="s2">"Error unzipping </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">unzip_dir</span><span class="si">}</span><span class="s2"> not found. path/to/abc.zip MUST unzip to path/to/abc/"</span>
<span></span>    <span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">unzip_dir</span><span class="p">),</span> <span class="n">find_dataset_yaml</span><span class="p">(</span><span class="n">unzip_dir</span><span class="p">)</span>  <span class="c1"># zipped, data_dir, yaml_path</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.utils.HUBDatasetStats.get_json"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.utils.HUBDatasetStats.get_json</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div><p>Return dataset JSON for Ultralytics HUB.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>save</code></td><td><code>bool</code></td><td></td><td><code>False</code></td></tr><tr><td><code>verbose</code></td><td><code>bool</code></td><td></td><td><code>False</code></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L652-L724"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return dataset JSON for Ultralytics HUB."""</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="nf">_round</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
<span></span><span class="w">        </span><span class="sd">"""Update labels to integer class and 4 decimal place floats."""</span>
<span></span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">==</span> <span class="s2">"detect"</span><span class="p">:</span>
<span></span>            <span class="n">coordinates</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]</span>
<span></span>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"segment"</span><span class="p">,</span> <span class="s2">"obb"</span><span class="p">}:</span>  <span class="c1"># Segment and OBB use segments. OBB segments are normalized xyxyxyxy</span>
<span></span>            <span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"segments"</span><span class="p">]]</span>
<span></span>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">==</span> <span class="s2">"pose"</span><span class="p">:</span>
<span></span>            <span class="n">n</span><span class="p">,</span> <span class="n">nk</span><span class="p">,</span> <span class="n">nd</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"keypoints"</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span></span>            <span class="n">coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">labels</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="s2">"keypoints"</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nk</span> <span class="o">*</span> <span class="n">nd</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>
<span></span>        <span class="k">else</span><span class="p">:</span>
<span></span>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Undefined dataset task=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="si">}</span><span class="s2">."</span><span class="p">)</span>
<span></span>        <span class="n">zipped</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">],</span> <span class="n">coordinates</span><span class="p">)</span>
<span></span>        <span class="k">return</span> <span class="p">[[</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="o">*</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">points</span><span class="p">)]</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">points</span> <span class="ow">in</span> <span class="n">zipped</span><span class="p">]</span>
<span></span>
<span></span>    <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="s2">"train"</span><span class="p">,</span> <span class="s2">"val"</span><span class="p">,</span> <span class="s2">"test"</span><span class="p">:</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="n">split</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># predefine</span>
<span></span>        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">split</span><span class="p">)</span>
<span></span>
<span></span>        <span class="c1"># Check split</span>
<span></span>        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># no split</span>
<span></span>            <span class="k">continue</span>
<span></span>        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">"*.*"</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">suffix</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">IMG_FORMATS</span><span class="p">]</span>  <span class="c1"># image files in split</span>
<span></span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">files</span><span class="p">:</span>  <span class="c1"># no images</span>
<span></span>            <span class="k">continue</span>
<span></span>
<span></span>        <span class="c1"># Get dataset statistics</span>
<span></span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">==</span> <span class="s2">"classify"</span><span class="p">:</span>
<span></span>            <span class="kn">from</span><span class="w"> </span><span class="nn">torchvision.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImageFolder</span>  <span class="c1"># scope for faster 'import ultralytics'</span>
<span></span>
<span></span>            <span class="n">dataset</span> <span class="o">=</span> <span class="n">ImageFolder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">split</span><span class="p">])</span>
<span></span>
<span></span>            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">classes</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span></span>            <span class="k">for</span> <span class="n">im</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">imgs</span><span class="p">:</span>
<span></span>                <span class="n">x</span><span class="p">[</span><span class="n">im</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
<span></span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="n">split</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span></span>                <span class="s2">"instance_stats"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"total"</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="s2">"per_class"</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">tolist</span><span class="p">()},</span>
<span></span>                <span class="s2">"image_stats"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"total"</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="s2">"unlabelled"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"per_class"</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">tolist</span><span class="p">()},</span>
<span></span>                <span class="s2">"labels"</span><span class="p">:</span> <span class="p">[{</span><span class="n">Path</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">v</span><span class="p">}</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">imgs</span><span class="p">],</span>
<span></span>            <span class="p">}</span>
<span></span>        <span class="k">else</span><span class="p">:</span>
<span></span>            <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">YOLODataset</span>
<span></span>
<span></span>            <span class="n">dataset</span> <span class="o">=</span> <span class="n">YOLODataset</span><span class="p">(</span><span class="n">img_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">split</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">)</span>
<span></span>            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<span></span>                <span class="p">[</span>
<span></span>                    <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">minlength</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">"nc"</span><span class="p">])</span>
<span></span>                    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">TQDM</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">"Statistics"</span><span class="p">)</span>
<span></span>                <span class="p">]</span>
<span></span>            <span class="p">)</span>  <span class="c1"># shape(128x80)</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="n">split</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span></span>                <span class="s2">"instance_stats"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"total"</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()),</span> <span class="s2">"per_class"</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()},</span>
<span></span>                <span class="s2">"image_stats"</span><span class="p">:</span> <span class="p">{</span>
<span></span>                    <span class="s2">"total"</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span>
<span></span>                    <span class="s2">"unlabelled"</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()),</span>
<span></span>                    <span class="s2">"per_class"</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
<span></span>                <span class="p">},</span>
<span></span>                <span class="s2">"labels"</span><span class="p">:</span> <span class="p">[{</span><span class="n">Path</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">_round</span><span class="p">(</span><span class="n">v</span><span class="p">)}</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">im_files</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">labels</span><span class="p">)],</span>
<span></span>            <span class="p">}</span>
<span></span>
<span></span>    <span class="c1"># Save, print and return</span>
<span></span>    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">hub_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># makes dataset-hub/</span>
<span></span>        <span class="n">stats_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hub_dir</span> <span class="o">/</span> <span class="s2">"stats.json"</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Saving </span><span class="si">{</span><span class="n">stats_path</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="si">}</span><span class="s2">..."</span><span class="p">)</span>
<span></span>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">stats_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span></span>            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>  <span class="c1"># save stats.json</span>
<span></span>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.utils.HUBDatasetStats.process_images"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.utils.HUBDatasetStats.process_images</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process_images</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span>
</code></pre></div><p>Compress images for Ultralytics HUB.</p><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L726-L739"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process_images</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Compress images for Ultralytics HUB."""</span>
<span></span>    <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">YOLODataset</span>  <span class="c1"># ClassificationDataset</span>
<span></span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">im_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># makes dataset-hub/images/</span>
<span></span>    <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="s2">"train"</span><span class="p">,</span> <span class="s2">"val"</span><span class="p">,</span> <span class="s2">"test"</span><span class="p">:</span>
<span></span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">split</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span></span>            <span class="k">continue</span>
<span></span>        <span class="n">dataset</span> <span class="o">=</span> <span class="n">YOLODataset</span><span class="p">(</span><span class="n">img_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">split</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span></span>        <span class="k">with</span> <span class="n">ThreadPool</span><span class="p">(</span><span class="n">NUM_THREADS</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
<span></span>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">TQDM</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">imap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hub_ops</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">im_files</span><span class="p">),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">split</span><span class="si">}</span><span class="s2"> images"</span><span class="p">):</span>
<span></span>                <span class="k">pass</span>
<span></span>    <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Done. All images saved to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">im_dir</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">im_dir</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.img2label_paths"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.img2label_paths</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">img2label_paths</span><span class="p">(</span><span class="n">img_paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div><p>Convert image paths to label paths by replacing 'images' with 'labels' and extension with '.txt'.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>img_paths</code></td><td><code>list[str]</code></td><td></td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L45-L48"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">img2label_paths</span><span class="p">(</span><span class="n">img_paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Convert image paths to label paths by replacing 'images' with 'labels' and extension with '.txt'."""</span>
<span></span>    <span class="n">sa</span><span class="p">,</span> <span class="n">sb</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">images</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">labels</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s2">"</span>  <span class="c1"># /images/, /labels/ substrings</span>
<span></span>    <span class="k">return</span> <span class="p">[</span><span class="n">sb</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">"."</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">".txt"</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">img_paths</span><span class="p">]</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.check_file_speeds"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.check_file_speeds</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_file_speeds</span><span class="p">(</span>
<span></span>    <span class="n">files</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">threshold_ms</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">threshold_mb</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">max_files</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">""</span>
<span></span><span class="p">)</span>
</code></pre></div><p>Check dataset file access speed and provide performance feedback.</p><p>This function tests the access speed of dataset files by measuring ping (stat call) time and read speed. It samples up to 5 files from the provided list and warns if access times exceed the threshold.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>files</code></td><td><code>list[str]</code></td><td>List of file paths to check for access speed.</td><td><em>required</em></td></tr><tr><td><code>threshold_ms</code></td><td><code>float, optional</code></td><td>Threshold in milliseconds for ping time warnings.</td><td><code>10</code></td></tr><tr><td><code>threshold_mb</code></td><td><code>float, optional</code></td><td>Threshold in megabytes per second for read speed warnings.</td><td><code>50</code></td></tr><tr><td><code>max_files</code></td><td><code>int, optional</code></td><td>The maximum number of files to check.</td><td><code>5</code></td></tr><tr><td><code>prefix</code></td><td><code>str, optional</code></td><td>Prefix string to add to log messages.</td><td><code>""</code></td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">image_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">"dataset/images"</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">"*.jpg"</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">check_file_speeds</span><span class="p">(</span><span class="n">image_files</span><span class="p">,</span> <span class="n">threshold_ms</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L51-L125"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_file_speeds</span><span class="p">(</span>
<span></span>    <span class="n">files</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">threshold_ms</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">threshold_mb</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">max_files</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">""</span>
<span></span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Check dataset file access speed and provide performance feedback.</span>
<span></span>
<span></span><span class="sd">    This function tests the access speed of dataset files by measuring ping (stat call) time and read speed. It samples</span>
<span></span><span class="sd">    up to 5 files from the provided list and warns if access times exceed the threshold.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        files (list[str]): List of file paths to check for access speed.</span>
<span></span><span class="sd">        threshold_ms (float, optional): Threshold in milliseconds for ping time warnings.</span>
<span></span><span class="sd">        threshold_mb (float, optional): Threshold in megabytes per second for read speed warnings.</span>
<span></span><span class="sd">        max_files (int, optional): The maximum number of files to check.</span>
<span></span><span class="sd">        prefix (str, optional): Prefix string to add to log messages.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<span></span><span class="sd">        &gt;&gt;&gt; image_files = list(Path("dataset/images").glob("*.jpg"))</span>
<span></span><span class="sd">        &gt;&gt;&gt; check_file_speeds(image_files, threshold_ms=15)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">files</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">Image speed checks: No files to check"</span><span class="p">)</span>
<span></span>        <span class="k">return</span>
<span></span>
<span></span>    <span class="c1"># Sample files (max 5)</span>
<span></span>    <span class="n">files</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_files</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)))</span>
<span></span>
<span></span>    <span class="c1"># Test ping (stat time)</span>
<span></span>    <span class="n">ping_times</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>    <span class="n">file_sizes</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>    <span class="n">read_speeds</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>
<span></span>    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<span></span>        <span class="k">try</span><span class="p">:</span>
<span></span>            <span class="c1"># Measure ping (stat call)</span>
<span></span>            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span></span>            <span class="n">file_size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">st_size</span>
<span></span>            <span class="n">ping_times</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># ms</span>
<span></span>            <span class="n">file_sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_size</span><span class="p">)</span>
<span></span>
<span></span>            <span class="c1"># Measure read speed</span>
<span></span>            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span></span>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">"rb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_obj</span><span class="p">:</span>
<span></span>                <span class="n">_</span> <span class="o">=</span> <span class="n">file_obj</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span></span>            <span class="n">read_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
<span></span>            <span class="k">if</span> <span class="n">read_time</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Avoid division by zero</span>
<span></span>                <span class="n">read_speeds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_size</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="o">/</span> <span class="n">read_time</span><span class="p">)</span>  <span class="c1"># MB/s</span>
<span></span>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span></span>            <span class="k">pass</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">ping_times</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">Image speed checks: failed to access files"</span><span class="p">)</span>
<span></span>        <span class="k">return</span>
<span></span>
<span></span>    <span class="c1"># Calculate stats with uncertainties</span>
<span></span>    <span class="n">avg_ping</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ping_times</span><span class="p">)</span>
<span></span>    <span class="n">std_ping</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ping_times</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ping_times</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>
<span></span>    <span class="n">size_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">", size: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">file_sizes</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> KB"</span>
<span></span>    <span class="n">ping_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"ping: </span><span class="si">{</span><span class="n">avg_ping</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">Â±</span><span class="si">{</span><span class="n">std_ping</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> ms"</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="n">read_speeds</span><span class="p">:</span>
<span></span>        <span class="n">avg_speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">read_speeds</span><span class="p">)</span>
<span></span>        <span class="n">std_speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">read_speeds</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">read_speeds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>
<span></span>        <span class="n">speed_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">", read: </span><span class="si">{</span><span class="n">avg_speed</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">Â±</span><span class="si">{</span><span class="n">std_speed</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB/s"</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="n">speed_msg</span> <span class="o">=</span> <span class="s2">""</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="n">avg_ping</span> <span class="o">&lt;</span> <span class="n">threshold_ms</span> <span class="ow">or</span> <span class="n">avg_speed</span> <span class="o">&lt;</span> <span class="n">threshold_mb</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">Fast image access âœ… (</span><span class="si">{</span><span class="n">ping_msg</span><span class="si">}{</span><span class="n">speed_msg</span><span class="si">}{</span><span class="n">size_msg</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<span></span>            <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">Slow image access detected (</span><span class="si">{</span><span class="n">ping_msg</span><span class="si">}{</span><span class="n">speed_msg</span><span class="si">}{</span><span class="n">size_msg</span><span class="si">}</span><span class="s2">). "</span>
<span></span>            <span class="sa">f</span><span class="s2">"Use local storage instead of remote/mounted storage for better performance. "</span>
<span></span>            <span class="sa">f</span><span class="s2">"See https://docs.ultralytics.com/guides/model-training-tips/"</span>
<span></span>        <span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.get_hash"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.get_hash</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_hash</span><span class="p">(</span><span class="n">paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div><p>Return a single hash value of a list of paths (files or dirs).</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>paths</code></td><td><code>list[str]</code></td><td></td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L128-L138"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_hash</span><span class="p">(</span><span class="n">paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a single hash value of a list of paths (files or dirs)."""</span>
<span></span>    <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
<span></span>    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
<span></span>        <span class="k">try</span><span class="p">:</span>
<span></span>            <span class="n">size</span> <span class="o">+=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">st_size</span>
<span></span>        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
<span></span>            <span class="k">continue</span>
<span></span>    <span class="n">h</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="s2">"hashlib"</span><span class="p">)</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>  <span class="c1"># hash sizes</span>
<span></span>    <span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>  <span class="c1"># hash paths</span>
<span></span>    <span class="k">return</span> <span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>  <span class="c1"># return hash</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.exif_size"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.exif_size</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">exif_size</span><span class="p">(</span><span class="n">img</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</code></pre></div><p>Return exif-corrected PIL size.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>img</code></td><td><code>Image.Image</code></td><td></td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L141-L152"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">exif_size</span><span class="p">(</span><span class="n">img</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return exif-corrected PIL size."""</span>
<span></span>    <span class="n">s</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">size</span>  <span class="c1"># (width, height)</span>
<span></span>    <span class="k">if</span> <span class="n">img</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="s2">"JPEG"</span><span class="p">:</span>  <span class="c1"># only support JPEG images</span>
<span></span>        <span class="k">try</span><span class="p">:</span>
<span></span>            <span class="k">if</span> <span class="n">exif</span> <span class="o">:=</span> <span class="n">img</span><span class="o">.</span><span class="n">getexif</span><span class="p">():</span>
<span></span>                <span class="n">rotation</span> <span class="o">=</span> <span class="n">exif</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">274</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># the EXIF key for the orientation tag is 274</span>
<span></span>                <span class="k">if</span> <span class="n">rotation</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">}:</span>  <span class="c1"># rotation 270 or 90</span>
<span></span>                    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span></span>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span></span>            <span class="k">pass</span>
<span></span>    <span class="k">return</span> <span class="n">s</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.verify_image"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.verify_image</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">verify_image</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span>
</code></pre></div><p>Verify one image.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>args</code></td><td><code>tuple</code></td><td></td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L155-L177"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">verify_image</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Verify one image."""</span>
<span></span>    <span class="p">(</span><span class="n">im_file</span><span class="p">,</span> <span class="bp">cls</span><span class="p">),</span> <span class="n">prefix</span> <span class="o">=</span> <span class="n">args</span>
<span></span>    <span class="c1"># Number (found, corrupt), message</span>
<span></span>    <span class="n">nf</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">""</span>
<span></span>    <span class="k">try</span><span class="p">:</span>
<span></span>        <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">im_file</span><span class="p">)</span>
<span></span>        <span class="n">im</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>  <span class="c1"># PIL verify</span>
<span></span>        <span class="n">shape</span> <span class="o">=</span> <span class="n">exif_size</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>  <span class="c1"># image size</span>
<span></span>        <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># hw</span>
<span></span>        <span class="k">assert</span> <span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"image size </span><span class="si">{</span><span class="n">shape</span><span class="si">}</span><span class="s2"> &lt;10 pixels"</span>
<span></span>        <span class="k">assert</span> <span class="n">im</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">IMG_FORMATS</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Invalid image format </span><span class="si">{</span><span class="n">im</span><span class="o">.</span><span class="n">format</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">FORMATS_HELP_MSG</span><span class="si">}</span><span class="s2">"</span>
<span></span>        <span class="k">if</span> <span class="n">im</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"jpg"</span><span class="p">,</span> <span class="s2">"jpeg"</span><span class="p">}:</span>
<span></span>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">im_file</span><span class="p">,</span> <span class="s2">"rb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span></span>                <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span></span>                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">!=</span> <span class="sa">b</span><span class="s2">"</span><span class="se">\xff\xd9</span><span class="s2">"</span><span class="p">:</span>  <span class="c1"># corrupt JPEG</span>
<span></span>                    <span class="n">ImageOps</span><span class="o">.</span><span class="n">exif_transpose</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">im_file</span><span class="p">))</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">im_file</span><span class="p">,</span> <span class="s2">"JPEG"</span><span class="p">,</span> <span class="n">subsampling</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span></span>                    <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">im_file</span><span class="si">}</span><span class="s2">: corrupt JPEG restored and saved"</span>
<span></span>        <span class="n">nf</span> <span class="o">=</span> <span class="mi">1</span>
<span></span>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span></span>        <span class="n">nc</span> <span class="o">=</span> <span class="mi">1</span>
<span></span>        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">im_file</span><span class="si">}</span><span class="s2">: ignoring corrupt image/label: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span>
<span></span>    <span class="k">return</span> <span class="p">(</span><span class="n">im_file</span><span class="p">,</span> <span class="bp">cls</span><span class="p">),</span> <span class="n">nf</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">msg</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.verify_image_label"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.verify_image_label</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">verify_image_label</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span>
</code></pre></div><p>Verify one image-label pair.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>args</code></td><td><code>tuple</code></td><td></td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L180-L249"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">verify_image_label</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Verify one image-label pair."""</span>
<span></span>    <span class="n">im_file</span><span class="p">,</span> <span class="n">lb_file</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">keypoint</span><span class="p">,</span> <span class="n">num_cls</span><span class="p">,</span> <span class="n">nkpt</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">single_cls</span> <span class="o">=</span> <span class="n">args</span>
<span></span>    <span class="c1"># Number (missing, found, empty, corrupt), message, segments, keypoints</span>
<span></span>    <span class="n">nm</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">ne</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">keypoints</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="p">[],</span> <span class="kc">None</span>
<span></span>    <span class="k">try</span><span class="p">:</span>
<span></span>        <span class="c1"># Verify images</span>
<span></span>        <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">im_file</span><span class="p">)</span>
<span></span>        <span class="n">im</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>  <span class="c1"># PIL verify</span>
<span></span>        <span class="n">shape</span> <span class="o">=</span> <span class="n">exif_size</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>  <span class="c1"># image size</span>
<span></span>        <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># hw</span>
<span></span>        <span class="k">assert</span> <span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"image size </span><span class="si">{</span><span class="n">shape</span><span class="si">}</span><span class="s2"> &lt;10 pixels"</span>
<span></span>        <span class="k">assert</span> <span class="n">im</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">IMG_FORMATS</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"invalid image format </span><span class="si">{</span><span class="n">im</span><span class="o">.</span><span class="n">format</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">FORMATS_HELP_MSG</span><span class="si">}</span><span class="s2">"</span>
<span></span>        <span class="k">if</span> <span class="n">im</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"jpg"</span><span class="p">,</span> <span class="s2">"jpeg"</span><span class="p">}:</span>
<span></span>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">im_file</span><span class="p">,</span> <span class="s2">"rb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span></span>                <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span></span>                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">!=</span> <span class="sa">b</span><span class="s2">"</span><span class="se">\xff\xd9</span><span class="s2">"</span><span class="p">:</span>  <span class="c1"># corrupt JPEG</span>
<span></span>                    <span class="n">ImageOps</span><span class="o">.</span><span class="n">exif_transpose</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">im_file</span><span class="p">))</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">im_file</span><span class="p">,</span> <span class="s2">"JPEG"</span><span class="p">,</span> <span class="n">subsampling</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span></span>                    <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">im_file</span><span class="si">}</span><span class="s2">: corrupt JPEG restored and saved"</span>
<span></span>
<span></span>        <span class="c1"># Verify labels</span>
<span></span>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">lb_file</span><span class="p">):</span>
<span></span>            <span class="n">nf</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># label found</span>
<span></span>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">lb_file</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span></span>                <span class="n">lb</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
<span></span>                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">6</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lb</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">keypoint</span><span class="p">):</span>  <span class="c1"># is segment</span>
<span></span>                    <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lb</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>                    <span class="n">segments</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lb</span><span class="p">]</span>  <span class="c1"># (cls, xy1...)</span>
<span></span>                    <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">classes</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">segments2boxes</span><span class="p">(</span><span class="n">segments</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># (cls, xywh)</span>
<span></span>                <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>            <span class="k">if</span> <span class="n">nl</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lb</span><span class="p">):</span>
<span></span>                <span class="k">if</span> <span class="n">keypoint</span><span class="p">:</span>
<span></span>                    <span class="k">assert</span> <span class="n">lb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="n">nkpt</span> <span class="o">*</span> <span class="n">ndim</span><span class="p">),</span> <span class="sa">f</span><span class="s2">"labels require </span><span class="si">{</span><span class="p">(</span><span class="mi">5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nkpt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ndim</span><span class="p">)</span><span class="si">}</span><span class="s2"> columns each"</span>
<span></span>                    <span class="n">points</span> <span class="o">=</span> <span class="n">lb</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span></span>                <span class="k">else</span><span class="p">:</span>
<span></span>                    <span class="k">assert</span> <span class="n">lb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"labels require 5 columns, </span><span class="si">{</span><span class="n">lb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columns detected"</span>
<span></span>                    <span class="n">points</span> <span class="o">=</span> <span class="n">lb</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
<span></span>                <span class="c1"># Coordinate points check with 1% tolerance</span>
<span></span>                <span class="k">assert</span> <span class="n">points</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mf">1.01</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"non-normalized or out of bounds coordinates </span><span class="si">{</span><span class="n">points</span><span class="p">[</span><span class="n">points</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1.01</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
<span></span>                <span class="k">assert</span> <span class="n">lb</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"negative class labels or coordinate </span><span class="si">{</span><span class="n">lb</span><span class="p">[</span><span class="n">lb</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">-</span><span class="mf">0.01</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
<span></span>
<span></span>                <span class="c1"># All labels</span>
<span></span>                <span class="n">max_cls</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">single_cls</span> <span class="k">else</span> <span class="n">lb</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>  <span class="c1"># max label count</span>
<span></span>                <span class="k">assert</span> <span class="n">max_cls</span> <span class="o">&lt;</span> <span class="n">num_cls</span><span class="p">,</span> <span class="p">(</span>
<span></span>                    <span class="sa">f</span><span class="s2">"Label class </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">max_cls</span><span class="p">)</span><span class="si">}</span><span class="s2"> exceeds dataset class count </span><span class="si">{</span><span class="n">num_cls</span><span class="si">}</span><span class="s2">. "</span>
<span></span>                    <span class="sa">f</span><span class="s2">"Possible class labels are 0-</span><span class="si">{</span><span class="n">num_cls</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">"</span>
<span></span>                <span class="p">)</span>
<span></span>                <span class="n">_</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">nl</span><span class="p">:</span>  <span class="c1"># duplicate row check</span>
<span></span>                    <span class="n">lb</span> <span class="o">=</span> <span class="n">lb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># remove duplicates</span>
<span></span>                    <span class="k">if</span> <span class="n">segments</span><span class="p">:</span>
<span></span>                        <span class="n">segments</span> <span class="o">=</span> <span class="p">[</span><span class="n">segments</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
<span></span>                    <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">im_file</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">nl</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s2"> duplicate labels removed"</span>
<span></span>            <span class="k">else</span><span class="p">:</span>
<span></span>                <span class="n">ne</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># label empty</span>
<span></span>                <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="n">nkpt</span> <span class="o">*</span> <span class="n">ndim</span><span class="p">)</span> <span class="k">if</span> <span class="n">keypoint</span> <span class="k">else</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>        <span class="k">else</span><span class="p">:</span>
<span></span>            <span class="n">nm</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># label missing</span>
<span></span>            <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="n">nkpt</span> <span class="o">*</span> <span class="n">ndim</span><span class="p">)</span> <span class="k">if</span> <span class="n">keypoint</span> <span class="k">else</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>        <span class="k">if</span> <span class="n">keypoint</span><span class="p">:</span>
<span></span>            <span class="n">keypoints</span> <span class="o">=</span> <span class="n">lb</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nkpt</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span>
<span></span>            <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span></span>                <span class="n">kpt_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">keypoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">keypoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>                <span class="n">keypoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">keypoints</span><span class="p">,</span> <span class="n">kpt_mask</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># (nl, nkpt, 3)</span>
<span></span>        <span class="n">lb</span> <span class="o">=</span> <span class="n">lb</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span></span>        <span class="k">return</span> <span class="n">im_file</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">keypoints</span><span class="p">,</span> <span class="n">nm</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">ne</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">msg</span>
<span></span>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span></span>        <span class="n">nc</span> <span class="o">=</span> <span class="mi">1</span>
<span></span>        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">im_file</span><span class="si">}</span><span class="s2">: ignoring corrupt image/label: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span>
<span></span>        <span class="k">return</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">nm</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">ne</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">msg</span><span class="p">]</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.visualize_image_annotations"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.visualize_image_annotations</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">visualize_image_annotations</span><span class="p">(</span><span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">txt_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">label_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span>
</code></pre></div><p>Visualize YOLO annotations (bounding boxes and class labels) on an image.</p><p>This function reads an image and its corresponding annotation file in YOLO format, then draws bounding boxes around detected objects and labels them with their respective class names. The bounding box colors are assigned based on the class ID, and the text color is dynamically adjusted for readability, depending on the background color's luminance.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>image_path</code></td><td><code>str</code></td><td>Path to the image file to annotate. The file must be readable by PIL.</td><td><em>required</em></td></tr><tr><td><code>txt_path</code></td><td><code>str</code></td><td>Path to the annotation file in YOLO format, which should contain one line per object.</td><td><em>required</em></td></tr><tr><td><code>label_map</code></td><td><code>dict[int, str]</code></td><td>A dictionary that maps class IDs (integers) to class labels (strings).</td><td><em>required</em></td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">label_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">"cat"</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">"dog"</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">"bird"</span><span class="p">}</span>  <span class="c1"># Should include all annotated classes</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">visualize_image_annotations</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">,</span> <span class="s2">"path/to/annotations.txt"</span><span class="p">,</span> <span class="n">label_map</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L252-L292"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">visualize_image_annotations</span><span class="p">(</span><span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">txt_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">label_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
<span></span><span class="w">    </span><span class="sd">"""Visualize YOLO annotations (bounding boxes and class labels) on an image.</span>
<span></span>
<span></span><span class="sd">    This function reads an image and its corresponding annotation file in YOLO format, then draws bounding boxes around</span>
<span></span><span class="sd">    detected objects and labels them with their respective class names. The bounding box colors are assigned based on</span>
<span></span><span class="sd">    the class ID, and the text color is dynamically adjusted for readability, depending on the background color's</span>
<span></span><span class="sd">    luminance.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        image_path (str): Path to the image file to annotate. The file must be readable by PIL.</span>
<span></span><span class="sd">        txt_path (str): Path to the annotation file in YOLO format, which should contain one line per object.</span>
<span></span><span class="sd">        label_map (dict[int, str]): A dictionary that maps class IDs (integers) to class labels (strings).</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; label_map = {0: "cat", 1: "dog", 2: "bird"}  # Should include all annotated classes</span>
<span></span><span class="sd">        &gt;&gt;&gt; visualize_image_annotations("path/to/image.jpg", "path/to/annotations.txt", label_map)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span></span>
<span></span>    <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.utils.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">colors</span>
<span></span>
<span></span>    <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_path</span><span class="p">))</span>
<span></span>    <span class="n">img_height</span><span class="p">,</span> <span class="n">img_width</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span></span>    <span class="n">annotations</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">txt_path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<span></span>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
<span></span>            <span class="n">class_id</span><span class="p">,</span> <span class="n">x_center</span><span class="p">,</span> <span class="n">y_center</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span></span>            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_center</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">img_width</span>
<span></span>            <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_center</span> <span class="o">-</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">img_height</span>
<span></span>            <span class="n">w</span> <span class="o">=</span> <span class="n">width</span> <span class="o">*</span> <span class="n">img_width</span>
<span></span>            <span class="n">h</span> <span class="o">=</span> <span class="n">height</span> <span class="o">*</span> <span class="n">img_height</span>
<span></span>            <span class="n">annotations</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">class_id</span><span class="p">)))</span>
<span></span>    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Plot the image and annotations</span>
<span></span>    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">:</span>
<span></span>        <span class="n">color</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">c</span> <span class="o">/</span> <span class="mi">255</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>  <span class="c1"># Get and normalize an RGB color for Matplotlib</span>
<span></span>        <span class="n">rect</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">"none"</span><span class="p">)</span>  <span class="c1"># Create a rectangle</span>
<span></span>        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
<span></span>        <span class="n">luminance</span> <span class="o">=</span> <span class="mf">0.2126</span> <span class="o">*</span> <span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.7152</span> <span class="o">*</span> <span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.0722</span> <span class="o">*</span> <span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># Formula for luminance</span>
<span></span>        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="n">label_map</span><span class="p">[</span><span class="n">label</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">"white"</span> <span class="k">if</span> <span class="n">luminance</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="s2">"black"</span><span class="p">,</span> <span class="n">backgroundcolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span></span>    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span></span>    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.polygon2mask"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.polygon2mask</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">polygon2mask</span><span class="p">(</span>
<span></span>    <span class="n">imgsz</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">polygons</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">color</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">downsample_ratio</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Convert a list of polygons to a binary mask of the specified image size.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>imgsz</code></td><td><code>tuple[int, int]</code></td><td>The size of the image as (height, width).</td><td><em>required</em></td></tr><tr><td><code>polygons</code></td><td><code>list[np.ndarray]</code></td><td>A list of polygons. Each polygon is an array with shape (N, M), where N is the<br/> number of polygons, and M is the number of points such that M % 2 = 0.</td><td><em>required</em></td></tr><tr><td><code>color</code></td><td><code>int, optional</code></td><td>The color value to fill in the polygons on the mask.</td><td><code>1</code></td></tr><tr><td><code>downsample_ratio</code></td><td><code>int, optional</code></td><td>Factor by which to downsample the mask.</td><td><code>1</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>np.ndarray</code></td><td>A binary mask of the specified image size with the polygons filled in.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L295-L316"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">polygon2mask</span><span class="p">(</span>
<span></span>    <span class="n">imgsz</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">polygons</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">color</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">downsample_ratio</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Convert a list of polygons to a binary mask of the specified image size.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        imgsz (tuple[int, int]): The size of the image as (height, width).</span>
<span></span><span class="sd">        polygons (list[np.ndarray]): A list of polygons. Each polygon is an array with shape (N, M), where N is the</span>
<span></span><span class="sd">            number of polygons, and M is the number of points such that M % 2 = 0.</span>
<span></span><span class="sd">        color (int, optional): The color value to fill in the polygons on the mask.</span>
<span></span><span class="sd">        downsample_ratio (int, optional): Factor by which to downsample the mask.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (np.ndarray): A binary mask of the specified image size with the polygons filled in.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">imgsz</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span></span>    <span class="n">polygons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">polygons</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span></span>    <span class="n">polygons</span> <span class="o">=</span> <span class="n">polygons</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">polygons</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span></span>    <span class="n">cv2</span><span class="o">.</span><span class="n">fillPoly</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">polygons</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span></span>    <span class="n">nh</span><span class="p">,</span> <span class="n">nw</span> <span class="o">=</span> <span class="p">(</span><span class="n">imgsz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">downsample_ratio</span><span class="p">,</span> <span class="n">imgsz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">downsample_ratio</span><span class="p">)</span>
<span></span>    <span class="c1"># Note: fillPoly first then resize is trying to keep the same loss calculation method when mask-ratio=1</span>
<span></span>    <span class="k">return</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="p">(</span><span class="n">nw</span><span class="p">,</span> <span class="n">nh</span><span class="p">))</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.polygons2masks"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.polygons2masks</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">polygons2masks</span><span class="p">(</span>
<span></span>    <span class="n">imgsz</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">polygons</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">color</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">downsample_ratio</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Convert a list of polygons to a set of binary masks of the specified image size.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>imgsz</code></td><td><code>tuple[int, int]</code></td><td>The size of the image as (height, width).</td><td><em>required</em></td></tr><tr><td><code>polygons</code></td><td><code>list[np.ndarray]</code></td><td>A list of polygons. Each polygon is an array with shape (N, M), where N is the<br/> number of polygons, and M is the number of points such that M % 2 = 0.</td><td><em>required</em></td></tr><tr><td><code>color</code></td><td><code>int</code></td><td>The color value to fill in the polygons on the masks.</td><td><em>required</em></td></tr><tr><td><code>downsample_ratio</code></td><td><code>int, optional</code></td><td>Factor by which to downsample each mask.</td><td><code>1</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>np.ndarray</code></td><td>A set of binary masks of the specified image size with the polygons filled in.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L319-L334"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">polygons2masks</span><span class="p">(</span>
<span></span>    <span class="n">imgsz</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">polygons</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">color</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">downsample_ratio</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Convert a list of polygons to a set of binary masks of the specified image size.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        imgsz (tuple[int, int]): The size of the image as (height, width).</span>
<span></span><span class="sd">        polygons (list[np.ndarray]): A list of polygons. Each polygon is an array with shape (N, M), where N is the</span>
<span></span><span class="sd">            number of polygons, and M is the number of points such that M % 2 = 0.</span>
<span></span><span class="sd">        color (int): The color value to fill in the polygons on the masks.</span>
<span></span><span class="sd">        downsample_ratio (int, optional): Factor by which to downsample each mask.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (np.ndarray): A set of binary masks of the specified image size with the polygons filled in.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">polygon2mask</span><span class="p">(</span><span class="n">imgsz</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">color</span><span class="p">,</span> <span class="n">downsample_ratio</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">polygons</span><span class="p">])</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.polygons2masks_overlap"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.polygons2masks_overlap</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">polygons2masks_overlap</span><span class="p">(</span>
<span></span>    <span class="n">imgsz</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">segments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">downsample_ratio</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div><p>Return a (640, 640) overlap mask.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>imgsz</code></td><td><code>tuple[int, int]</code></td><td></td><td><em>required</em></td></tr><tr><td><code>segments</code></td><td><code>list[np.ndarray]</code></td><td></td><td><em>required</em></td></tr><tr><td><code>downsample_ratio</code></td><td><code>int</code></td><td></td><td><code>1</code></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L337-L363"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">polygons2masks_overlap</span><span class="p">(</span>
<span></span>    <span class="n">imgsz</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">segments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">downsample_ratio</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a (640, 640) overlap mask."""</span>
<span></span>    <span class="n">masks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
<span></span>        <span class="p">(</span><span class="n">imgsz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">downsample_ratio</span><span class="p">,</span> <span class="n">imgsz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">downsample_ratio</span><span class="p">),</span>
<span></span>        <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span>
<span></span>    <span class="p">)</span>
<span></span>    <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>    <span class="n">ms</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>    <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">:</span>
<span></span>        <span class="n">mask</span> <span class="o">=</span> <span class="n">polygon2mask</span><span class="p">(</span>
<span></span>            <span class="n">imgsz</span><span class="p">,</span>
<span></span>            <span class="p">[</span><span class="n">segment</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
<span></span>            <span class="n">downsample_ratio</span><span class="o">=</span><span class="n">downsample_ratio</span><span class="p">,</span>
<span></span>            <span class="n">color</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span></span>        <span class="p">)</span>
<span></span>        <span class="n">ms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">masks</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
<span></span>        <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span></span>    <span class="n">areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">areas</span><span class="p">)</span>
<span></span>    <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">areas</span><span class="p">)</span>
<span></span>    <span class="n">ms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ms</span><span class="p">)[</span><span class="n">index</span><span class="p">]</span>
<span></span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)):</span>
<span></span>        <span class="n">mask</span> <span class="o">=</span> <span class="n">ms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span></span>        <span class="n">masks</span> <span class="o">=</span> <span class="n">masks</span> <span class="o">+</span> <span class="n">mask</span>
<span></span>        <span class="n">masks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">masks</span><span class="p">,</span> <span class="n">a_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">masks</span><span class="p">,</span> <span class="n">index</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.find_dataset_yaml"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.find_dataset_yaml</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">find_dataset_yaml</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span>
</code></pre></div><p>Find and return the YAML file associated with a Detect, Segment or Pose dataset.</p><p>This function searches for a YAML file at the root level of the provided directory first, and if not found, it performs a recursive search. It prefers YAML files that have the same stem as the provided path.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>path</code></td><td><code>Path</code></td><td>The directory path to search for the YAML file.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Path</code></td><td>The path of the found YAML file.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L366-L383"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">find_dataset_yaml</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Find and return the YAML file associated with a Detect, Segment or Pose dataset.</span>
<span></span>
<span></span><span class="sd">    This function searches for a YAML file at the root level of the provided directory first, and if not found, it</span>
<span></span><span class="sd">    performs a recursive search. It prefers YAML files that have the same stem as the provided path.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        path (Path): The directory path to search for the YAML file.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Path): The path of the found YAML file.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">"*.yaml"</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">list</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">"*.yaml"</span><span class="p">))</span>  <span class="c1"># try root level first and then recursive</span>
<span></span>    <span class="k">assert</span> <span class="n">files</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"No YAML file found in '</span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="si">}</span><span class="s2">'"</span>
<span></span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span></span>        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">stem</span> <span class="o">==</span> <span class="n">path</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span>  <span class="c1"># prefer *.yaml files that match</span>
<span></span>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Expected 1 YAML file in '</span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="si">}</span><span class="s2">', but found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="si">{</span><span class="n">files</span><span class="si">}</span><span class="s2">"</span>
<span></span>    <span class="k">return</span> <span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.check_det_dataset"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.check_det_dataset</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_det_dataset</span><span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">autodownload</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div><p>Download, verify, and/or unzip a dataset if not found locally.</p><p>This function checks the availability of a specified dataset, and if not found, it has the option to download and unzip the dataset. It then reads and parses the accompanying YAML data, ensuring key requirements are met and also resolves paths related to the dataset.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>dataset</code></td><td><code>str</code></td><td>Path to the dataset or dataset descriptor (like a YAML file).</td><td><em>required</em></td></tr><tr><td><code>autodownload</code></td><td><code>bool, optional</code></td><td>Whether to automatically download the dataset if not found.</td><td><code>True</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>dict[str, Any]</code></td><td>Parsed dataset information and paths.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L386-L477"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_det_dataset</span><span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">autodownload</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Download, verify, and/or unzip a dataset if not found locally.</span>
<span></span>
<span></span><span class="sd">    This function checks the availability of a specified dataset, and if not found, it has the option to download and</span>
<span></span><span class="sd">    unzip the dataset. It then reads and parses the accompanying YAML data, ensuring key requirements are met and also</span>
<span></span><span class="sd">    resolves paths related to the dataset.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        dataset (str): Path to the dataset or dataset descriptor (like a YAML file).</span>
<span></span><span class="sd">        autodownload (bool, optional): Whether to automatically download the dataset if not found.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict[str, Any]): Parsed dataset information and paths.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">file</span> <span class="o">=</span> <span class="n">check_file</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Download (optional)</span>
<span></span>    <span class="n">extract_dir</span> <span class="o">=</span> <span class="s2">""</span>
<span></span>    <span class="k">if</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">is_zipfile</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_tarfile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
<span></span>        <span class="n">new_dir</span> <span class="o">=</span> <span class="n">safe_download</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="n">DATASETS_DIR</span><span class="p">,</span> <span class="n">unzip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span></span>        <span class="n">file</span> <span class="o">=</span> <span class="n">find_dataset_yaml</span><span class="p">(</span><span class="n">DATASETS_DIR</span> <span class="o">/</span> <span class="n">new_dir</span><span class="p">)</span>
<span></span>        <span class="n">extract_dir</span><span class="p">,</span> <span class="n">autodownload</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="kc">False</span>
<span></span>
<span></span>    <span class="c1"># Read YAML</span>
<span></span>    <span class="n">data</span> <span class="o">=</span> <span class="n">YAML</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">append_filename</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># dictionary</span>
<span></span>
<span></span>    <span class="c1"># Checks</span>
<span></span>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="s2">"train"</span><span class="p">,</span> <span class="s2">"val"</span><span class="p">:</span>
<span></span>        <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<span></span>            <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">"val"</span> <span class="ow">or</span> <span class="s2">"validation"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<span></span>                <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span>
<span></span>                    <span class="n">emojis</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> '</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:' key missing âŒ.</span><span class="se">\n</span><span class="s2">'train' and 'val' are required in all data YAMLs."</span><span class="p">)</span>
<span></span>                <span class="p">)</span>
<span></span>            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">"renaming data YAML 'validation' key to 'val' to match YOLO format."</span><span class="p">)</span>
<span></span>            <span class="n">data</span><span class="p">[</span><span class="s2">"val"</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"validation"</span><span class="p">)</span>  <span class="c1"># replace 'validation' key with 'val' key</span>
<span></span>    <span class="k">if</span> <span class="s2">"names"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="s2">"nc"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<span></span>        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="n">emojis</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> key missing âŒ.</span><span class="se">\n</span><span class="s2"> either 'names' or 'nc' are required in all data YAMLs."</span><span class="p">))</span>
<span></span>    <span class="k">if</span> <span class="s2">"names"</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="s2">"nc"</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">"names"</span><span class="p">])</span> <span class="o">!=</span> <span class="n">data</span><span class="p">[</span><span class="s2">"nc"</span><span class="p">]:</span>
<span></span>        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="n">emojis</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> 'names' length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'names'</span><span class="p">])</span><span class="si">}</span><span class="s2"> and 'nc: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">'nc'</span><span class="p">]</span><span class="si">}</span><span class="s2">' must match."</span><span class="p">))</span>
<span></span>    <span class="k">if</span> <span class="s2">"names"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<span></span>        <span class="n">data</span><span class="p">[</span><span class="s2">"names"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">"class_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">"nc"</span><span class="p">])]</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="n">data</span><span class="p">[</span><span class="s2">"nc"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">"names"</span><span class="p">])</span>
<span></span>
<span></span>    <span class="n">data</span><span class="p">[</span><span class="s2">"names"</span><span class="p">]</span> <span class="o">=</span> <span class="n">check_class_names</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">"names"</span><span class="p">])</span>
<span></span>    <span class="n">data</span><span class="p">[</span><span class="s2">"channels"</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"channels"</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># get image channels, default to 3</span>
<span></span>
<span></span>    <span class="c1"># Resolve paths</span>
<span></span>    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">extract_dir</span> <span class="ow">or</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"path"</span><span class="p">)</span> <span class="ow">or</span> <span class="n">Path</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"yaml_file"</span><span class="p">,</span> <span class="s2">""</span><span class="p">))</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>  <span class="c1"># dataset root</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">():</span>
<span></span>        <span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">DATASETS_DIR</span> <span class="o">/</span> <span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>  <span class="c1"># path relative to DATASETS_DIR</span>
<span></span>
<span></span>    <span class="c1"># Set paths</span>
<span></span>    <span class="n">data</span><span class="p">[</span><span class="s2">"path"</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>  <span class="c1"># download scripts</span>
<span></span>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="s2">"train"</span><span class="p">,</span> <span class="s2">"val"</span><span class="p">,</span> <span class="s2">"test"</span><span class="p">,</span> <span class="s2">"minival"</span><span class="p">:</span>
<span></span>        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>  <span class="c1"># prepend path</span>
<span></span>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
<span></span>                <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
<span></span>                <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">"../"</span><span class="p">):</span>
<span></span>                    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">:])</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
<span></span>                <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span></span>            <span class="k">else</span><span class="p">:</span>
<span></span>                <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">((</span><span class="n">path</span> <span class="o">/</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">())</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
<span></span>
<span></span>    <span class="c1"># Parse YAML</span>
<span></span>    <span class="n">val</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">"val"</span><span class="p">,</span> <span class="s2">"download"</span><span class="p">))</span>
<span></span>    <span class="k">if</span> <span class="n">val</span><span class="p">:</span>
<span></span>        <span class="n">val</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">val</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">val</span><span class="p">])]</span>  <span class="c1"># val path</span>
<span></span>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">val</span><span class="p">):</span>
<span></span>            <span class="n">name</span> <span class="o">=</span> <span class="n">clean_url</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>  <span class="c1"># dataset name with URL auth stripped</span>
<span></span>            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
<span></span>            <span class="n">m</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"Dataset '</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">' images not found, missing path '</span><span class="si">{</span><span class="nb">next</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">exists</span><span class="p">())</span><span class="si">}</span><span class="s2">'"</span>
<span></span>            <span class="k">if</span> <span class="n">s</span> <span class="ow">and</span> <span class="n">autodownload</span><span class="p">:</span>
<span></span>                <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span></span>            <span class="k">else</span><span class="p">:</span>
<span></span>                <span class="n">m</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Note dataset download directory is '</span><span class="si">{</span><span class="n">DATASETS_DIR</span><span class="si">}</span><span class="s2">'. You can update this in '</span><span class="si">{</span><span class="n">SETTINGS_FILE</span><span class="si">}</span><span class="s2">'"</span>
<span></span>                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span></span>            <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span></span>            <span class="n">r</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># success</span>
<span></span>            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">"http"</span><span class="p">)</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".zip"</span><span class="p">):</span>  <span class="c1"># URL</span>
<span></span>                <span class="n">safe_download</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="n">DATASETS_DIR</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>            <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">"bash "</span><span class="p">):</span>  <span class="c1"># bash script</span>
<span></span>                <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Running </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2"> ..."</span><span class="p">)</span>
<span></span>                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># python script</span>
<span></span>                <span class="n">exec</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">{</span><span class="s2">"yaml"</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
<span></span>            <span class="n">dt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"(</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">s)"</span>
<span></span>            <span class="n">s</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"success âœ… </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s2">, saved to </span><span class="si">{</span><span class="n">colorstr</span><span class="p">(</span><span class="s1">'bold'</span><span class="p">,</span><span class="w"> </span><span class="n">DATASETS_DIR</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span> <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">}</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">"failure </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s2"> âŒ"</span>
<span></span>            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Dataset download </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span></span>    <span class="n">check_font</span><span class="p">(</span><span class="s2">"Arial.ttf"</span> <span class="k">if</span> <span class="n">is_ascii</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">"names"</span><span class="p">])</span> <span class="k">else</span> <span class="s2">"Arial.Unicode.ttf"</span><span class="p">)</span>  <span class="c1"># download fonts</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="n">data</span>  <span class="c1"># dictionary</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.check_cls_dataset"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.check_cls_dataset</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_cls_dataset</span><span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="n">split</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">""</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div><p>Check a classification dataset such as Imagenet.</p><p>This function accepts a <code>dataset</code> name and attempts to retrieve the corresponding dataset information. If the dataset is not found locally, it attempts to download the dataset from the internet and save it locally.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>dataset</code></td><td><code>str | Path</code></td><td>The name of the dataset.</td><td><em>required</em></td></tr><tr><td><code>split</code></td><td><code>str, optional</code></td><td>The split of the dataset. Either 'val', 'test', or ''.</td><td><code>""</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>dict[str, Any]</code></td><td>A dictionary containing the following keys:</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L480-L573"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_cls_dataset</span><span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="n">split</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">""</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Check a classification dataset such as Imagenet.</span>
<span></span>
<span></span><span class="sd">    This function accepts a `dataset` name and attempts to retrieve the corresponding dataset information. If the</span>
<span></span><span class="sd">    dataset is not found locally, it attempts to download the dataset from the internet and save it locally.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        dataset (str | Path): The name of the dataset.</span>
<span></span><span class="sd">        split (str, optional): The split of the dataset. Either 'val', 'test', or ''.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict[str, Any]): A dictionary containing the following keys:</span>
<span></span>
<span></span><span class="sd">            - 'train' (Path): The directory path containing the training set of the dataset.</span>
<span></span><span class="sd">            - 'val' (Path): The directory path containing the validation set of the dataset.</span>
<span></span><span class="sd">            - 'test' (Path): The directory path containing the test set of the dataset.</span>
<span></span><span class="sd">            - 'nc' (int): The number of classes in the dataset.</span>
<span></span><span class="sd">            - 'names' (dict[int, str]): A dictionary of class names in the dataset.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="c1"># Download (optional if dataset=https://file.zip is passed directly)</span>
<span></span>    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">"http:/"</span><span class="p">,</span> <span class="s2">"https:/"</span><span class="p">)):</span>
<span></span>        <span class="n">dataset</span> <span class="o">=</span> <span class="n">safe_download</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="n">DATASETS_DIR</span><span class="p">,</span> <span class="n">unzip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span></span>    <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">".zip"</span><span class="p">,</span> <span class="s2">".tar"</span><span class="p">,</span> <span class="s2">".gz"</span><span class="p">)):</span>
<span></span>        <span class="n">file</span> <span class="o">=</span> <span class="n">check_file</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span></span>        <span class="n">dataset</span> <span class="o">=</span> <span class="n">safe_download</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="n">DATASETS_DIR</span><span class="p">,</span> <span class="n">unzip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">dataset</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span></span>    <span class="n">data_dir</span> <span class="o">=</span> <span class="p">(</span><span class="n">dataset</span> <span class="k">if</span> <span class="n">dataset</span><span class="o">.</span><span class="n">is_dir</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span><span class="n">DATASETS_DIR</span> <span class="o">/</span> <span class="n">dataset</span><span class="p">))</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
<span></span>        <span class="k">if</span> <span class="n">data_dir</span><span class="o">.</span><span class="n">suffix</span> <span class="o">!=</span> <span class="s2">""</span><span class="p">:</span>
<span></span>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span></span>                <span class="sa">f</span><span class="s1">'Classification datasets must be a directory (data="path/to/dir") not a file (data="</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s1">"), '</span>
<span></span>                <span class="s2">"See https://docs.ultralytics.com/datasets/classify/"</span>
<span></span>            <span class="p">)</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Dataset not found, missing path </span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">, attempting download..."</span><span class="p">)</span>
<span></span>        <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span></span>        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">==</span> <span class="s2">"imagenet"</span><span class="p">:</span>
<span></span>            <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">"bash"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ROOT</span> <span class="o">/</span> <span class="s2">"data/scripts/get_imagenet.sh"</span><span class="p">)],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>        <span class="k">else</span><span class="p">:</span>
<span></span>            <span class="n">download</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">ASSETS_URL</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">.zip"</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="n">data_dir</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Dataset download success âœ… (</span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">t</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">s), saved to </span><span class="si">{</span><span class="n">colorstr</span><span class="p">(</span><span class="s1">'bold'</span><span class="p">,</span><span class="w"> </span><span class="n">data_dir</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span></span>    <span class="n">train_set</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">"train"</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">train_set</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Dataset 'split=train' not found at </span><span class="si">{</span><span class="n">train_set</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>        <span class="k">if</span> <span class="n">image_files</span> <span class="o">:=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dir</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">"*.jpg"</span><span class="p">))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dir</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">"*.png"</span><span class="p">)):</span>
<span></span>            <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">split_classify_dataset</span>
<span></span>
<span></span>            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">image_files</span><span class="p">)</span><span class="si">}</span><span class="s2"> images in subdirectories. Attempting to split..."</span><span class="p">)</span>
<span></span>            <span class="n">data_dir</span> <span class="o">=</span> <span class="n">split_classify_dataset</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">train_ratio</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span></span>            <span class="n">train_set</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">"train"</span>
<span></span>        <span class="k">else</span><span class="p">:</span>
<span></span>            <span class="n">LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">"No images found in </span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2"> or its subdirectories."</span><span class="p">)</span>
<span></span>    <span class="n">val_set</span> <span class="o">=</span> <span class="p">(</span>
<span></span>        <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">"val"</span>
<span></span>        <span class="k">if</span> <span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s2">"val"</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span></span>        <span class="k">else</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">"validation"</span>
<span></span>        <span class="k">if</span> <span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s2">"validation"</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span></span>        <span class="k">else</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">"valid"</span>
<span></span>        <span class="k">if</span> <span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s2">"valid"</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span></span>        <span class="k">else</span> <span class="kc">None</span>
<span></span>    <span class="p">)</span>  <span class="c1"># data/test or data/val</span>
<span></span>    <span class="n">test_set</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s2">"test"</span> <span class="k">if</span> <span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s2">"test"</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># data/val or data/test</span>
<span></span>    <span class="k">if</span> <span class="n">split</span> <span class="o">==</span> <span class="s2">"val"</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">val_set</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">"Dataset 'split=val' not found, using 'split=test' instead."</span><span class="p">)</span>
<span></span>        <span class="n">val_set</span> <span class="o">=</span> <span class="n">test_set</span>
<span></span>    <span class="k">elif</span> <span class="n">split</span> <span class="o">==</span> <span class="s2">"test"</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">test_set</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">"Dataset 'split=test' not found, using 'split=val' instead."</span><span class="p">)</span>
<span></span>        <span class="n">test_set</span> <span class="o">=</span> <span class="n">val_set</span>
<span></span>
<span></span>    <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s2">"train"</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">"*"</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_dir</span><span class="p">()])</span>  <span class="c1"># number of classes</span>
<span></span>    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data_dir</span> <span class="o">/</span> <span class="s2">"train"</span><span class="p">)</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_dir</span><span class="p">()]</span>  <span class="c1"># class names list</span>
<span></span>    <span class="n">names</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">names</span><span class="p">)))</span>
<span></span>
<span></span>    <span class="c1"># Print to console</span>
<span></span>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"train"</span><span class="p">:</span> <span class="n">train_set</span><span class="p">,</span> <span class="s2">"val"</span><span class="p">:</span> <span class="n">val_set</span><span class="p">,</span> <span class="s2">"test"</span><span class="p">:</span> <span class="n">test_set</span><span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span></span>        <span class="n">prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">colorstr</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">:'</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">..."</span>
<span></span>        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span></span>            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
<span></span>        <span class="k">else</span><span class="p">:</span>
<span></span>            <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">"*.*"</span><span class="p">)</span> <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">suffix</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">IMG_FORMATS</span><span class="p">]</span>
<span></span>            <span class="n">nf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>  <span class="c1"># number of files</span>
<span></span>            <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">({</span><span class="n">file</span><span class="o">.</span><span class="n">parent</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">})</span>  <span class="c1"># number of directories</span>
<span></span>            <span class="k">if</span> <span class="n">nf</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">"train"</span><span class="p">:</span>
<span></span>                    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2"> '</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:' no training images found"</span><span class="p">)</span>
<span></span>                <span class="k">else</span><span class="p">:</span>
<span></span>                    <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2"> found </span><span class="si">{</span><span class="n">nf</span><span class="si">}</span><span class="s2"> images in </span><span class="si">{</span><span class="n">nd</span><span class="si">}</span><span class="s2"> classes (no images found)"</span><span class="p">)</span>
<span></span>            <span class="k">elif</span> <span class="n">nd</span> <span class="o">!=</span> <span class="n">nc</span><span class="p">:</span>
<span></span>                <span class="n">LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2"> found </span><span class="si">{</span><span class="n">nf</span><span class="si">}</span><span class="s2"> images in </span><span class="si">{</span><span class="n">nd</span><span class="si">}</span><span class="s2"> classes (requires </span><span class="si">{</span><span class="n">nc</span><span class="si">}</span><span class="s2"> classes, not </span><span class="si">{</span><span class="n">nd</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
<span></span>            <span class="k">else</span><span class="p">:</span>
<span></span>                <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2"> found </span><span class="si">{</span><span class="n">nf</span><span class="si">}</span><span class="s2"> images in </span><span class="si">{</span><span class="n">nd</span><span class="si">}</span><span class="s2"> classes âœ… "</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="p">{</span><span class="s2">"train"</span><span class="p">:</span> <span class="n">train_set</span><span class="p">,</span> <span class="s2">"val"</span><span class="p">:</span> <span class="n">val_set</span><span class="p">,</span> <span class="s2">"test"</span><span class="p">:</span> <span class="n">test_set</span><span class="p">,</span> <span class="s2">"nc"</span><span class="p">:</span> <span class="n">nc</span><span class="p">,</span> <span class="s2">"names"</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span> <span class="s2">"channels"</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.compress_one_image"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.compress_one_image</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compress_one_image</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">f_new</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1920</span><span class="p">,</span> <span class="n">quality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
</code></pre></div><p>Compress a single image file to reduced size while preserving its aspect ratio and quality using either the</p><p>Python Imaging Library (PIL) or OpenCV library. If the input image is smaller than the maximum dimension, it will not be resized.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>f</code></td><td><code>str</code></td><td>The path to the input image file.</td><td><em>required</em></td></tr><tr><td><code>f_new</code></td><td><code>str, optional</code></td><td>The path to the output image file. If not specified, the input file will be overwritten.</td><td><code>None</code></td></tr><tr><td><code>max_dim</code></td><td><code>int, optional</code></td><td>The maximum dimension (width or height) of the output image.</td><td><code>1920</code></td></tr><tr><td><code>quality</code></td><td><code>int, optional</code></td><td>The image compression quality as a percentage.</td><td><code>50</code></td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">compress_one_image</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"path/to/dataset"</span><span class="p">)</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">"*.jpg"</span><span class="p">):</span>
<span></span><span class="o">&gt;&gt;&gt;</span>    <span class="n">compress_one_image</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L742-L775"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compress_one_image</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">f_new</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1920</span><span class="p">,</span> <span class="n">quality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Compress a single image file to reduced size while preserving its aspect ratio and quality using either the</span>
<span></span><span class="sd">    Python Imaging Library (PIL) or OpenCV library. If the input image is smaller than the maximum dimension, it</span>
<span></span><span class="sd">    will not be resized.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        f (str): The path to the input image file.</span>
<span></span><span class="sd">        f_new (str, optional): The path to the output image file. If not specified, the input file will be overwritten.</span>
<span></span><span class="sd">        max_dim (int, optional): The maximum dimension (width or height) of the output image.</span>
<span></span><span class="sd">        quality (int, optional): The image compression quality as a percentage.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics.data.utils import compress_one_image</span>
<span></span><span class="sd">        &gt;&gt;&gt; for f in Path("path/to/dataset").rglob("*.jpg"):</span>
<span></span><span class="sd">        &gt;&gt;&gt;    compress_one_image(f)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">try</span><span class="p">:</span>  <span class="c1"># use PIL</span>
<span></span>        <span class="n">Image</span><span class="o">.</span><span class="n">MAX_IMAGE_PIXELS</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Fix DecompressionBombError, allow optimization of image &gt; ~178.9 million pixels</span>
<span></span>        <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span></span>        <span class="k">if</span> <span class="n">im</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"RGBA"</span><span class="p">,</span> <span class="s2">"LA"</span><span class="p">}:</span>  <span class="c1"># Convert to RGB if needed (for JPEG)</span>
<span></span>            <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">"RGB"</span><span class="p">)</span>
<span></span>        <span class="n">r</span> <span class="o">=</span> <span class="n">max_dim</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>  <span class="c1"># ratio</span>
<span></span>        <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>  <span class="c1"># image too large</span>
<span></span>            <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">r</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">r</span><span class="p">)))</span>
<span></span>        <span class="n">im</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">f_new</span> <span class="ow">or</span> <span class="n">f</span><span class="p">,</span> <span class="s2">"JPEG"</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="n">quality</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># save</span>
<span></span>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># use OpenCV</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"HUB ops PIL failure </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>        <span class="n">im</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span></span>        <span class="n">im_height</span><span class="p">,</span> <span class="n">im_width</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span></span>        <span class="n">r</span> <span class="o">=</span> <span class="n">max_dim</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">im_height</span><span class="p">,</span> <span class="n">im_width</span><span class="p">)</span>  <span class="c1"># ratio</span>
<span></span>        <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>  <span class="c1"># image too large</span>
<span></span>            <span class="n">im</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">im_width</span> <span class="o">*</span> <span class="n">r</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">im_height</span> <span class="o">*</span> <span class="n">r</span><span class="p">)),</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">INTER_AREA</span><span class="p">)</span>
<span></span>        <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f_new</span> <span class="ow">or</span> <span class="n">f</span><span class="p">),</span> <span class="n">im</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.load_dataset_cache_file"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.load_dataset_cache_file</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">load_dataset_cache_file</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div><p>Load an Ultralytics *.cache dictionary from path.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>path</code></td><td><code>Path</code></td><td></td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L778-L785"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">load_dataset_cache_file</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Load an Ultralytics *.cache dictionary from path."""</span>
<span></span>    <span class="kn">import</span><span class="w"> </span><span class="nn">gc</span>
<span></span>
<span></span>    <span class="n">gc</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>  <span class="c1"># reduce pickle load time https://github.com/ultralytics/ultralytics/pull/1585</span>
<span></span>    <span class="n">cache</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>  <span class="c1"># load dict</span>
<span></span>    <span class="n">gc</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
<span></span>    <span class="k">return</span> <span class="n">cache</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.utils.save_dataset_cache_file"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.utils.save_dataset_cache_file</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">save_dataset_cache_file</span><span class="p">(</span><span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div><p>Save an Ultralytics dataset *.cache dictionary x to path.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>prefix</code></td><td><code>str</code></td><td></td><td><em>required</em></td></tr><tr><td><code>path</code></td><td><code>Path</code></td><td></td><td><em>required</em></td></tr><tr><td><code>x</code></td><td><code>dict</code></td><td></td><td><em>required</em></td></tr><tr><td><code>version</code></td><td><code>str</code></td><td></td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/utils.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/utils.py#L788-L798"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">save_dataset_cache_file</span><span class="p">(</span><span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Save an Ultralytics dataset *.cache dictionary x to path."""</span>
<span></span>    <span class="n">x</span><span class="p">[</span><span class="s2">"version"</span><span class="p">]</span> <span class="o">=</span> <span class="n">version</span>  <span class="c1"># add cache version</span>
<span></span>    <span class="k">if</span> <span class="n">is_dir_writeable</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
<span></span>        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<span></span>            <span class="n">path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>  <span class="c1"># remove *.cache file if exists</span>
<span></span>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="s2">"wb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>  <span class="c1"># context manager here fixes windows async np.save bug</span>
<span></span>            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">New cache created: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">Cache directory </span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="si">}</span><span class="s2"> is not writable, cache not saved."</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/></p><br/><br/><div class="git-info"><div class="dates-container"><span class="date-item" title="This page was first created on November 12, 2023"><span class="hover-item">ğŸ“…</span> Created 2 years ago </span><span class="date-item" title="This page was last updated on November 23, 2025"><span class="hover-item">âœï¸</span> Updated 2 months ago </span></div><div class="authors-container"><a class="author-link" href="https://github.com/glenn-jocher" title="glenn-jocher (10 changes)"><img alt="glenn-jocher" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/26833433?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/RizwanMunawar" title="RizwanMunawar (1 change)"><img alt="RizwanMunawar" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62513924?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/jk4e" title="jk4e (1 change)"><img alt="jk4e" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/116908874?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/Burhan-Q" title="Burhan-Q (1 change)"><img alt="Burhan-Q" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62214284?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/Laughing-q" title="Laughing-q (1 change)"><img alt="Laughing-q" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/61612323?v=4&amp;s=96"/></a></div></div><div class="share-buttons"><button class="share-button hover-item" onclick="window.open('https://twitter.com/intent/tweet?url=https%3A%2F%2Fdocs.ultralytics.com%2Freference%2Fdata%2Futils%2F', 'TwitterShare', 'width=550,height=680,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-x-twitter"></i> Tweet </button><button class="share-button hover-item linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fdocs.ultralytics.com%2Freference%2Fdata%2Futils%2F', 'LinkedinShare', 'width=550,height=730,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-linkedin-in"></i> Share </button></div><br/></article></div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div><button class="md-top md-icon" data-md-component="top" hidden="" type="button"><svg class="lucide lucide-circle-arrow-up" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10"></circle><path d="m16 12-4-4-4 4M12 16V8"></path></svg> Back to top
</button></main><footer class="md-footer"><nav aria-label="Footer" class="md-footer__inner md-grid"><a aria-label="Previous: split_dota" class="md-footer__link md-footer__link--prev" href="../split_dota/"><div class="md-footer__button md-icon"><svg class="lucide lucide-arrow-left" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12 19-7-7 7-7M19 12H5"></path></svg></div><div class="md-footer__title"><span class="md-footer__direction"> Previous </span><div class="md-ellipsis"> split_dota </div></div></a><a aria-label="Next: exporter" class="md-footer__link md-footer__link--next" href="../../engine/exporter/"><div class="md-footer__title"><span class="md-footer__direction"> Next </span><div class="md-ellipsis"> exporter </div></div><div class="md-footer__button md-icon"><svg class="lucide lucide-arrow-right" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 12h14M12 5l7 7-7 7"></path></svg></div></a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-copyright"><div class="md-copyright__highlight"><a href="https://www.ultralytics.com/" target="_blank">Â© 2026 Ultralytics Inc.</a> All rights reserved. </div> Made with <a href="https://zensical.org/" rel="noopener" target="_blank"> Zensical </a></div><div class="md-social"><a class="md-social__link" href="https://github.com/ultralytics" rel="noopener" target="_blank" title="github.com"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://www.linkedin.com/company/ultralytics/" rel="noopener" target="_blank" title="www.linkedin.com"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://x.com/ultralytics" rel="noopener" target="_blank" title="x.com"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://youtube.com/ultralytics?sub_confirmation=1" rel="noopener" target="_blank" title="youtube.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://hub.docker.com/r/ultralytics/ultralytics/" rel="noopener" target="_blank" title="hub.docker.com"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://pypi.org/project/ultralytics/" rel="noopener" target="_blank" title="pypi.org"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://discord.com/invite/ultralytics" rel="noopener" target="_blank" title="discord.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://reddit.com/r/ultralytics" rel="noopener" target="_blank" title="reddit.com"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://weixin.qq.com/r/mp/LxckPDfEgWr_rXNf90I9" rel="noopener" target="_blank" title="weixin.qq.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6" fill="currentColor"></path></svg></a></div></div></div></footer></div><div class="md-dialog" data-md-component="dialog"><div class="md-dialog__inner md-typeset"></div></div><div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"annotate":null,"base":"../../..","features":["content.action.edit","content.code.annotate","content.code.copy","content.tooltips","toc.follow","navigation.top","navigation.tabs","navigation.tabs.sticky","navigation.prune","navigation.footer","navigation.tracking","navigation.instant","navigation.instant.progress","navigation.indexes","navigation.sections","content.tabs.link"],"search":"../../../assets/javascripts/workers/search.e2d2d235.min.js","tags":null,"translations":{"clipboard.copied":"Copied to clipboard","clipboard.copy":"Copy to clipboard","search.result.more.one":"1 more on this page","search.result.more.other":"# more on this page","search.result.none":"No matching documents","search.result.one":"1 matching document","search.result.other":"# matching documents","search.result.placeholder":"Type to start searching","search.result.term.missing":"Missing","select.version":"Select version"},"version":null}</script>
<script src="../../../assets/javascripts/bundle.8ffeb9c9.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/ultralytics/llm@v0.1.8/js/chat.min.js"></script>
<script src="https://unpkg.com/tablesort@5.6.0/dist/tablesort.min.js"></script>
<script src="../../../javascript/extra.js"></script>
<script src="../../../javascript/giscus.js"></script>
<script src="../../../javascript/tablesort.js"></script>
</body></html>