 <!DOCTYPE html><html class="no-js" lang="en"><head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Explore comprehensive data conversion tools for YOLO models including COCO, DOTA, and YOLO bbox2segment converters." name="description"/><meta content="Ultralytics" name="author"/><link href="https://docs.ultralytics.com/reference/data/converter/" rel="canonical"/><link href="../build/" rel="prev"/><link href="../dataset/" rel="next"/><link href="/" hreflang="en" rel="alternate"/><link href="/zh/" hreflang="zh" rel="alternate"/><link href="/ko/" hreflang="ko" rel="alternate"/><link href="/ja/" hreflang="ja" rel="alternate"/><link href="/ru/" hreflang="ru" rel="alternate"/><link href="/de/" hreflang="de" rel="alternate"/><link href="/fr/" hreflang="fr" rel="alternate"/><link href="/es/" hreflang="es" rel="alternate"/><link href="/pt/" hreflang="pt" rel="alternate"/><link href="/it/" hreflang="it" rel="alternate"/><link href="/tr/" hreflang="tr" rel="alternate"/><link href="/vi/" hreflang="vi" rel="alternate"/><link href="/ar/" hreflang="ar" rel="alternate"/><link href="https://raw.githubusercontent.com/ultralytics/assets/refs/heads/main/logo/favicon-yolo.png" rel="icon"/><meta content="zensical-0.0.17" name="generator"/><title>Reference for ultralytics/data/converter.py - Ultralytics YOLO Docs</title><link href="../../../assets/stylesheets/modern/main.d4922b3c.min.css" rel="stylesheet"/><link href="../../../assets/stylesheets/modern/palette.dfe2e883.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,500,500i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link href="../../../stylesheets/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)),0),__md_get=(e,t=localStorage,a=__md_scope)=>JSON.parse(t.getItem(a.pathname+"."+e)),__md_set=(e,t,a=localStorage,_=__md_scope)=>{try{a.setItem(_.pathname+"."+e,JSON.stringify(t))}catch(e){}},document.documentElement.setAttribute("data-platform",navigator.platform)</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2M5EHKC0BH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2M5EHKC0BH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2M5EHKC0BH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
<style data-doc-kind="true">.doc-kind{display:inline-flex;align-items:center;gap:0.25em;padding:0.21em 0.59em;border-radius:999px;font-weight:700;font-size:0.81em;letter-spacing:0.06em;text-transform:uppercase;line-height:1;color:var(--doc-kind-color,#f8fafc);background:var(--doc-kind-bg,rgba(255,255,255,0.12));}.doc-kind-class{--doc-kind-color:#039dfc;--doc-kind-bg:rgba(3,157,252,0.22);}.doc-kind-function{--doc-kind-color:#fc9803;--doc-kind-bg:rgba(252,152,3,0.22);}.doc-kind-method{--doc-kind-color:#ef5eff;--doc-kind-bg:rgba(239,94,255,0.22);}.doc-kind-property{--doc-kind-color:#02e835;--doc-kind-bg:rgba(2,232,53,0.22);}</style><meta content="Reference for ultralytics/data/converter.py" name="title"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"/><meta content="website" property="og:type"/><meta content="https://docs.ultralytics.com/reference/data/converter/" property="og:url"/><meta content="Reference for ultralytics/data/converter.py" property="og:title"/><meta content="" property="og:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="og:image"/><meta content="summary_large_image" property="twitter:card"/><meta content="https://docs.ultralytics.com/reference/data/converter/" property="twitter:url"/><meta content="Reference for ultralytics/data/converter.py" property="twitter:title"/><meta content="" property="twitter:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="twitter:image"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "headline": "Reference for ultralytics/data/converter.py", "image": ["https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png"], "datePublished": "2023-11-12 02:49:37 +0100", "dateModified": "2025-11-23 19:53:50 +0100", "author": [{"@type": "Organization", "name": "Ultralytics", "url": "https://ultralytics.com/"}], "abstract": ""}</script></head><body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr"><input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/><input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/><label class="md-overlay" for="__drawer"></label><div data-md-component="skip"><a class="md-skip" href="#reference-for-ultralyticsdataconverterpy"> Skip to content </a></div><div data-md-component="announce"><aside class="md-banner"><div class="md-banner__inner md-grid md-typeset"><a class="banner-wrapper" href="https://docs.ultralytics.com/models/yolo26"><div class="banner-content-wrapper"><img alt="Ultralytics YOLO26" height="40" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/6967372a0d67914985d322e7_Ultralytics%20YOLO26%201.svg"/><p>Built End-to-End. Built for the Edge.</p></div></a></div></aside></div><header class="md-header md-header--shadow md-header--lifted" data-md-component="header"><nav aria-label="Header" class="md-header__inner md-grid"><a aria-label="Ultralytics YOLO Docs" class="md-header__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs"><img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/></a><label class="md-header__button md-icon" for="__drawer"><svg class="lucide lucide-menu" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 5h16M4 12h16M4 19h16"></path></svg></label><div class="md-header__title" data-md-component="header-title"><div class="md-header__ellipsis"><div class="md-header__topic"><span class="md-ellipsis"> Ultralytics YOLO Docs </span></div><div class="md-header__topic" data-md-component="header-topic"><span class="md-ellipsis"> Reference for ultralytics/data/converter.py </span></div></div></div><form class="md-header__option" data-md-component="palette"><input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg></label><input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to system preference"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label><input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label></form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<div class="md-header__option"><div class="md-select"><button aria-label="Select language" class="md-header__button md-icon"><svg class="lucide lucide-languages" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m5 8 6 6M4 14l6-6 2-3M2 5h12M7 2h1M22 22l-5-10-5 10M14 18h6"></path></svg></button><div class="md-select__inner"><ul class="md-select__list"><li class="md-select__item"><a class="md-select__link" href="/" hreflang="en"> ğŸ‡¬ğŸ‡§ English </a></li><li class="md-select__item"><a class="md-select__link" href="/zh/" hreflang="zh"> ğŸ‡¨ğŸ‡³ ç®€ä½“ä¸­æ–‡ </a></li><li class="md-select__item"><a class="md-select__link" href="/ko/" hreflang="ko"> ğŸ‡°ğŸ‡· í•œêµ­ì–´ </a></li><li class="md-select__item"><a class="md-select__link" href="/ja/" hreflang="ja"> ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª </a></li><li class="md-select__item"><a class="md-select__link" href="/ru/" hreflang="ru"> ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹ </a></li><li class="md-select__item"><a class="md-select__link" href="/de/" hreflang="de"> ğŸ‡©ğŸ‡ª Deutsch </a></li><li class="md-select__item"><a class="md-select__link" href="/fr/" hreflang="fr"> ğŸ‡«ğŸ‡· FranÃ§ais </a></li><li class="md-select__item"><a class="md-select__link" href="/es/" hreflang="es"> ğŸ‡ªğŸ‡¸ EspaÃ±ol </a></li><li class="md-select__item"><a class="md-select__link" href="/pt/" hreflang="pt"> ğŸ‡µğŸ‡¹ PortuguÃªs </a></li><li class="md-select__item"><a class="md-select__link" href="/it/" hreflang="it"> ğŸ‡®ğŸ‡¹ Italiano </a></li><li class="md-select__item"><a class="md-select__link" href="/tr/" hreflang="tr"> ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e </a></li><li class="md-select__item"><a class="md-select__link" href="/vi/" hreflang="vi"> ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t </a></li><li class="md-select__item"><a class="md-select__link" href="/ar/" hreflang="ar"> ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© </a></li></ul></div></div></div><div class="md-header__source"><a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository"><div class="md-source__icon md-icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></div><div class="md-source__repository"> ultralytics/ultralytics </div></a></div></nav><nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"><div class="md-grid"><ul class="md-tabs__list"><li class="md-tabs__item"><a class="md-tabs__link" href="../../.."> Home </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../quickstart/"> Quickstart </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../modes/"> Modes </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../tasks/"> Tasks </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../models/"> Models </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../datasets/"> Datasets </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../solutions/"> Solutions </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../guides/"> Guides </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../integrations/"> Integrations </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../platform/"> Platform </a></li><li class="md-tabs__item md-tabs__item--active"><a class="md-tabs__link" href="../../__init__/"> Reference </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../help/"> Help </a></li></ul></div></nav></header><div class="md-container" data-md-component="container"><main class="md-main" data-md-component="main"><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0"><label class="md-nav__title" for="__drawer"><a aria-label="Ultralytics YOLO Docs" class="md-nav__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs"><img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/></a> Ultralytics YOLO Docs </label><div class="md-nav__source"><a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository"><div class="md-source__icon md-icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></div><div class="md-source__repository"> ultralytics/ultralytics </div></a></div><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../.."><span class="md-ellipsis"> Home </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../quickstart/"><span class="md-ellipsis"> Quickstart </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../modes/"><span class="md-ellipsis"> Modes </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../tasks/"><span class="md-ellipsis"> Tasks </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../models/"><span class="md-ellipsis"> Models </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../datasets/"><span class="md-ellipsis"> Datasets </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../solutions/"><span class="md-ellipsis"> Solutions </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../guides/"><span class="md-ellipsis"> Guides </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../integrations/"><span class="md-ellipsis"> Integrations </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../platform/"><span class="md-ellipsis"> Platform </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input checked="" class="md-nav__toggle md-toggle" id="__nav_11" type="checkbox"/><label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex=""><span class="md-ellipsis"> Reference </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="true" aria-labelledby="__nav_11_label" class="md-nav" data-md-level="1"><label class="md-nav__title" for="__nav_11"><span class="md-nav__icon md-icon"></span> Reference </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_2" type="checkbox"/><label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex=""><span class="md-ellipsis"> cfg </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_2_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_2"><span class="md-nav__icon md-icon"></span> cfg </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../cfg/__init__/"><span class="md-ellipsis"> __init__ </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input checked="" class="md-nav__toggle md-toggle" id="__nav_11_3" type="checkbox"/><label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex=""><span class="md-ellipsis"> data </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="true" aria-labelledby="__nav_11_3_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_3"><span class="md-nav__icon md-icon"></span> data </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../annotator/"><span class="md-ellipsis"> annotator </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../augment/"><span class="md-ellipsis"> augment </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../base/"><span class="md-ellipsis"> base </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../build/"><span class="md-ellipsis"> build </span></a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/><label class="md-nav__link md-nav__link--active" for="__toc"><span class="md-ellipsis"> converter </span><span class="md-nav__icon md-icon"></span></label><a class="md-nav__link md-nav__link--active" href="./"><span class="md-ellipsis"> converter </span></a><nav aria-label="On this page" class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc"><span class="md-nav__icon md-icon"></span> On this page </label><ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.coco91_to_coco80_class"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> coco91_to_coco80_class</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.coco80_to_coco91_class"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> coco80_to_coco91_class</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.convert_coco"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> convert_coco</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.convert_segment_masks_to_yolo_seg"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> convert_segment_masks_to_yolo_seg</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.convert_dota_to_yolo_obb"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> convert_dota_to_yolo_obb</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.min_index"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> min_index</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.merge_multi_segment"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> merge_multi_segment</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.yolo_bbox2segment"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> yolo_bbox2segment</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.create_synthetic_coco_dataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> create_synthetic_coco_dataset</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.convert_to_multispectral"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> convert_to_multispectral</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.convert_ndjson_to_yolo"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> convert_ndjson_to_yolo</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="../dataset/"><span class="md-ellipsis"> dataset </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../loaders/"><span class="md-ellipsis"> loaders </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../split/"><span class="md-ellipsis"> split </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../split_dota/"><span class="md-ellipsis"> split_dota </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../utils/"><span class="md-ellipsis"> utils </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_4" type="checkbox"/><label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex=""><span class="md-ellipsis"> engine </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_4_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_4"><span class="md-nav__icon md-icon"></span> engine </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../engine/exporter/"><span class="md-ellipsis"> exporter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/model/"><span class="md-ellipsis"> model </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/predictor/"><span class="md-ellipsis"> predictor </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/results/"><span class="md-ellipsis"> results </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/trainer/"><span class="md-ellipsis"> trainer </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/tuner/"><span class="md-ellipsis"> tuner </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/validator/"><span class="md-ellipsis"> validator </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_5" type="checkbox"/><label class="md-nav__link" for="__nav_11_5" id="__nav_11_5_label" tabindex=""><span class="md-ellipsis"> hub </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_5_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_5"><span class="md-nav__icon md-icon"></span> hub </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../hub/__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/auth/"><span class="md-ellipsis"> auth </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../hub/google/__init__/"><span class="md-ellipsis"> google </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/session/"><span class="md-ellipsis"> session </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/utils/"><span class="md-ellipsis"> utils </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_6" type="checkbox"/><label class="md-nav__link" for="__nav_11_6" id="__nav_11_6_label" tabindex=""><span class="md-ellipsis"> models </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_6_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_6"><span class="md-nav__icon md-icon"></span> models </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/fastsam/model/"><span class="md-ellipsis"> fastsam </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/nas/model/"><span class="md-ellipsis"> nas </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/rtdetr/model/"><span class="md-ellipsis"> rtdetr </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/sam/amg/"><span class="md-ellipsis"> sam </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/utils/loss/"><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/yolo/classify/predict/"><span class="md-ellipsis"> yolo </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_7" type="checkbox"/><label class="md-nav__link" for="__nav_11_7" id="__nav_11_7_label" tabindex=""><span class="md-ellipsis"> nn </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_7_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_7"><span class="md-nav__icon md-icon"></span> nn </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../nn/autobackend/"><span class="md-ellipsis"> autobackend </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../nn/modules/activation/"><span class="md-ellipsis"> modules </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../nn/tasks/"><span class="md-ellipsis"> tasks </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../nn/text_model/"><span class="md-ellipsis"> text_model </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_8" type="checkbox"/><label class="md-nav__link" for="__nav_11_8" id="__nav_11_8_label" tabindex=""><span class="md-ellipsis"> optim </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_8_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_8"><span class="md-nav__icon md-icon"></span> optim </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../optim/muon/"><span class="md-ellipsis"> muon </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_9" type="checkbox"/><label class="md-nav__link" for="__nav_11_9" id="__nav_11_9_label" tabindex=""><span class="md-ellipsis"> solutions </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_9_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_9"><span class="md-nav__icon md-icon"></span> solutions </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/ai_gym/"><span class="md-ellipsis"> ai_gym </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/analytics/"><span class="md-ellipsis"> analytics </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/config/"><span class="md-ellipsis"> config </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/distance_calculation/"><span class="md-ellipsis"> distance_calculation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/heatmap/"><span class="md-ellipsis"> heatmap </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/instance_segmentation/"><span class="md-ellipsis"> instance_segmentation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_blurrer/"><span class="md-ellipsis"> object_blurrer </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_counter/"><span class="md-ellipsis"> object_counter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_cropper/"><span class="md-ellipsis"> object_cropper </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/parking_management/"><span class="md-ellipsis"> parking_management </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/queue_management/"><span class="md-ellipsis"> queue_management </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/region_counter/"><span class="md-ellipsis"> region_counter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/security_alarm/"><span class="md-ellipsis"> security_alarm </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/similarity_search/"><span class="md-ellipsis"> similarity_search </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/solutions/"><span class="md-ellipsis"> solutions </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/speed_estimation/"><span class="md-ellipsis"> speed_estimation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/streamlit_inference/"><span class="md-ellipsis"> streamlit_inference </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/trackzone/"><span class="md-ellipsis"> trackzone </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/vision_eye/"><span class="md-ellipsis"> vision_eye </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_10" type="checkbox"/><label class="md-nav__link" for="__nav_11_10" id="__nav_11_10_label" tabindex=""><span class="md-ellipsis"> trackers </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_10_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_10"><span class="md-nav__icon md-icon"></span> trackers </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/basetrack/"><span class="md-ellipsis"> basetrack </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/bot_sort/"><span class="md-ellipsis"> bot_sort </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/byte_tracker/"><span class="md-ellipsis"> byte_tracker </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/track/"><span class="md-ellipsis"> track </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../trackers/utils/gmc/"><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_11" type="checkbox"/><label class="md-nav__link" for="__nav_11_11" id="__nav_11_11_label" tabindex=""><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_11_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_11"><span class="md-nav__icon md-icon"></span> utils </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../utils/__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/autobatch/"><span class="md-ellipsis"> autobatch </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/autodevice/"><span class="md-ellipsis"> autodevice </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/benchmarks/"><span class="md-ellipsis"> benchmarks </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../utils/callbacks/base/"><span class="md-ellipsis"> callbacks </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/checks/"><span class="md-ellipsis"> checks </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/cpu/"><span class="md-ellipsis"> cpu </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/dist/"><span class="md-ellipsis"> dist </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/downloads/"><span class="md-ellipsis"> downloads </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/errors/"><span class="md-ellipsis"> errors </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/events/"><span class="md-ellipsis"> events </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../utils/export/engine/"><span class="md-ellipsis"> export </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/files/"><span class="md-ellipsis"> files </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/git/"><span class="md-ellipsis"> git </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/instance/"><span class="md-ellipsis"> instance </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/logger/"><span class="md-ellipsis"> logger </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/loss/"><span class="md-ellipsis"> loss </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/metrics/"><span class="md-ellipsis"> metrics </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/nms/"><span class="md-ellipsis"> nms </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/ops/"><span class="md-ellipsis"> ops </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/patches/"><span class="md-ellipsis"> patches </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/plotting/"><span class="md-ellipsis"> plotting </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/tal/"><span class="md-ellipsis"> tal </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/torch_utils/"><span class="md-ellipsis"> torch_utils </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/tqdm/"><span class="md-ellipsis"> tqdm </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/triton/"><span class="md-ellipsis"> triton </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/tuner/"><span class="md-ellipsis"> tuner </span></a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../help/"><span class="md-ellipsis"> Help </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav aria-label="On this page" class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc"><span class="md-nav__icon md-icon"></span> On this page </label><ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.coco91_to_coco80_class"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> coco91_to_coco80_class</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.coco80_to_coco91_class"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> coco80_to_coco91_class</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.convert_coco"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> convert_coco</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.convert_segment_masks_to_yolo_seg"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> convert_segment_masks_to_yolo_seg</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.convert_dota_to_yolo_obb"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> convert_dota_to_yolo_obb</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.min_index"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> min_index</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.merge_multi_segment"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> merge_multi_segment</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.yolo_bbox2segment"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> yolo_bbox2segment</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.create_synthetic_coco_dataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> create_synthetic_coco_dataset</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.convert_to_multispectral"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> convert_to_multispectral</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.converter.convert_ndjson_to_yolo"><span class="md-ellipsis"><span class="doc-kind doc-kind-function">function</span> convert_ndjson_to_yolo</span></a></li></ul></nav></div></div></div><div class="md-content" data-md-component="content"><article class="md-content__inner md-typeset"><a class="md-content__button md-icon" href="https://github.com/ultralytics/ultralytics/tree/main/docs/en/reference/data/converter.md" rel="edit" title="Edit this page"><svg class="lucide lucide-file-pen" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v9.34"></path><path d="M14 2v5a1 1 0 0 0 1 1h5M10.378 12.622a1 1 0 0 1 3 3.003L8.36 20.637a2 2 0 0 1-.854.506l-2.867.837a.5.5 0 0 1-.62-.62l.836-2.869a2 2 0 0 1 .506-.853z"></path></svg></a><h1 id="reference-for-ultralyticsdataconverterpy">Reference for <code>ultralytics/data/converter.py</code></h1><div class="admonition success"><p class="admonition-title">Improvements</p><p>This page is sourced from <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/converter.py">https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/converter.py</a>. Have an improvement or example to add? Open a <a href="https://docs.ultralytics.com/help/contributing/">Pull Request</a> â€” thank you! ğŸ™</p></div><p><br/></p><div class="admonition abstract"><p class="admonition-title">Summary</p><div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="functions" name="__tabbed_1" type="radio"/><div class="tabbed-labels"><label for="functions"><span class="doc-kind doc-kind-function">Functions</span></label></div><div class="tabbed-content"><div class="tabbed-block"><ul><li><a href="#ultralytics.data.converter.coco91_to_coco80_class"><code>coco91_to_coco80_class</code></a></li><li><a href="#ultralytics.data.converter.coco80_to_coco91_class"><code>coco80_to_coco91_class</code></a></li><li><a href="#ultralytics.data.converter.convert_coco"><code>convert_coco</code></a></li><li><a href="#ultralytics.data.converter.convert_segment_masks_to_yolo_seg"><code>convert_segment_masks_to_yolo_seg</code></a></li><li><a href="#ultralytics.data.converter.convert_dota_to_yolo_obb"><code>convert_dota_to_yolo_obb</code></a></li><li><a href="#ultralytics.data.converter.min_index"><code>min_index</code></a></li><li><a href="#ultralytics.data.converter.merge_multi_segment"><code>merge_multi_segment</code></a></li><li><a href="#ultralytics.data.converter.yolo_bbox2segment"><code>yolo_bbox2segment</code></a></li><li><a href="#ultralytics.data.converter.create_synthetic_coco_dataset"><code>create_synthetic_coco_dataset</code></a></li><li><a href="#ultralytics.data.converter.convert_to_multispectral"><code>convert_to_multispectral</code></a></li><li><a href="#ultralytics.data.converter.convert_ndjson_to_yolo"><code>convert_ndjson_to_yolo</code></a></li></ul></div></div></div></div><h2 id="ultralytics.data.converter.coco91_to_coco80_class"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.converter.coco91_to_coco80_class</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">coco91_to_coco80_class</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</code></pre></div><p>Convert 91-index COCO class IDs to 80-index COCO class IDs.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list[int]</code></td><td>A list of 91 class IDs where the index represents the 80-index class ID and the value is the</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/converter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/converter.py#L23-L122"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">coco91_to_coco80_class</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Convert 91-index COCO class IDs to 80-index COCO class IDs.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list[int]): A list of 91 class IDs where the index represents the 80-index class ID and the value is the</span>
<span></span><span class="sd">            corresponding 91-index class ID.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="p">[</span>
<span></span>        <span class="mi">0</span><span class="p">,</span>
<span></span>        <span class="mi">1</span><span class="p">,</span>
<span></span>        <span class="mi">2</span><span class="p">,</span>
<span></span>        <span class="mi">3</span><span class="p">,</span>
<span></span>        <span class="mi">4</span><span class="p">,</span>
<span></span>        <span class="mi">5</span><span class="p">,</span>
<span></span>        <span class="mi">6</span><span class="p">,</span>
<span></span>        <span class="mi">7</span><span class="p">,</span>
<span></span>        <span class="mi">8</span><span class="p">,</span>
<span></span>        <span class="mi">9</span><span class="p">,</span>
<span></span>        <span class="mi">10</span><span class="p">,</span>
<span></span>        <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="mi">11</span><span class="p">,</span>
<span></span>        <span class="mi">12</span><span class="p">,</span>
<span></span>        <span class="mi">13</span><span class="p">,</span>
<span></span>        <span class="mi">14</span><span class="p">,</span>
<span></span>        <span class="mi">15</span><span class="p">,</span>
<span></span>        <span class="mi">16</span><span class="p">,</span>
<span></span>        <span class="mi">17</span><span class="p">,</span>
<span></span>        <span class="mi">18</span><span class="p">,</span>
<span></span>        <span class="mi">19</span><span class="p">,</span>
<span></span>        <span class="mi">20</span><span class="p">,</span>
<span></span>        <span class="mi">21</span><span class="p">,</span>
<span></span>        <span class="mi">22</span><span class="p">,</span>
<span></span>        <span class="mi">23</span><span class="p">,</span>
<span></span>        <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="mi">24</span><span class="p">,</span>
<span></span>        <span class="mi">25</span><span class="p">,</span>
<span></span>        <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="mi">26</span><span class="p">,</span>
<span></span>        <span class="mi">27</span><span class="p">,</span>
<span></span>        <span class="mi">28</span><span class="p">,</span>
<span></span>        <span class="mi">29</span><span class="p">,</span>
<span></span>        <span class="mi">30</span><span class="p">,</span>
<span></span>        <span class="mi">31</span><span class="p">,</span>
<span></span>        <span class="mi">32</span><span class="p">,</span>
<span></span>        <span class="mi">33</span><span class="p">,</span>
<span></span>        <span class="mi">34</span><span class="p">,</span>
<span></span>        <span class="mi">35</span><span class="p">,</span>
<span></span>        <span class="mi">36</span><span class="p">,</span>
<span></span>        <span class="mi">37</span><span class="p">,</span>
<span></span>        <span class="mi">38</span><span class="p">,</span>
<span></span>        <span class="mi">39</span><span class="p">,</span>
<span></span>        <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="mi">40</span><span class="p">,</span>
<span></span>        <span class="mi">41</span><span class="p">,</span>
<span></span>        <span class="mi">42</span><span class="p">,</span>
<span></span>        <span class="mi">43</span><span class="p">,</span>
<span></span>        <span class="mi">44</span><span class="p">,</span>
<span></span>        <span class="mi">45</span><span class="p">,</span>
<span></span>        <span class="mi">46</span><span class="p">,</span>
<span></span>        <span class="mi">47</span><span class="p">,</span>
<span></span>        <span class="mi">48</span><span class="p">,</span>
<span></span>        <span class="mi">49</span><span class="p">,</span>
<span></span>        <span class="mi">50</span><span class="p">,</span>
<span></span>        <span class="mi">51</span><span class="p">,</span>
<span></span>        <span class="mi">52</span><span class="p">,</span>
<span></span>        <span class="mi">53</span><span class="p">,</span>
<span></span>        <span class="mi">54</span><span class="p">,</span>
<span></span>        <span class="mi">55</span><span class="p">,</span>
<span></span>        <span class="mi">56</span><span class="p">,</span>
<span></span>        <span class="mi">57</span><span class="p">,</span>
<span></span>        <span class="mi">58</span><span class="p">,</span>
<span></span>        <span class="mi">59</span><span class="p">,</span>
<span></span>        <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="mi">60</span><span class="p">,</span>
<span></span>        <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="mi">61</span><span class="p">,</span>
<span></span>        <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="mi">62</span><span class="p">,</span>
<span></span>        <span class="mi">63</span><span class="p">,</span>
<span></span>        <span class="mi">64</span><span class="p">,</span>
<span></span>        <span class="mi">65</span><span class="p">,</span>
<span></span>        <span class="mi">66</span><span class="p">,</span>
<span></span>        <span class="mi">67</span><span class="p">,</span>
<span></span>        <span class="mi">68</span><span class="p">,</span>
<span></span>        <span class="mi">69</span><span class="p">,</span>
<span></span>        <span class="mi">70</span><span class="p">,</span>
<span></span>        <span class="mi">71</span><span class="p">,</span>
<span></span>        <span class="mi">72</span><span class="p">,</span>
<span></span>        <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="mi">73</span><span class="p">,</span>
<span></span>        <span class="mi">74</span><span class="p">,</span>
<span></span>        <span class="mi">75</span><span class="p">,</span>
<span></span>        <span class="mi">76</span><span class="p">,</span>
<span></span>        <span class="mi">77</span><span class="p">,</span>
<span></span>        <span class="mi">78</span><span class="p">,</span>
<span></span>        <span class="mi">79</span><span class="p">,</span>
<span></span>        <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="p">]</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.converter.coco80_to_coco91_class"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.converter.coco80_to_coco91_class</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">coco80_to_coco91_class</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</code></pre></div><p>Convert 80-index (val2014) to 91-index (paper).</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list[int]</code></td><td>A list of 80 class IDs where each value is the corresponding 91-index class ID.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span></span>    <span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">"data/coco.names"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">"str"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span></span>    <span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">"data/coco_paper.names"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">"str"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">Convert</span> <span class="n">the</span> <span class="n">darknet</span> <span class="n">to</span> <span class="n">COCO</span> <span class="nb">format</span>
<span></span>    <span class="o">&gt;&gt;&gt;</span> <span class="n">x1</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">80</span><span class="p">)]</span>
<span></span>
<span></span>    <span class="n">Convert</span> <span class="n">the</span> <span class="n">COCO</span> <span class="n">to</span> <span class="n">darknet</span> <span class="nb">format</span>
<span></span>    <span class="o">&gt;&gt;&gt;</span> <span class="n">x2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">a</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">91</span><span class="p">)]</span>
<span></span>
<span></span><span class="n">References</span><span class="p">:</span>
<span></span>    <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">tech</span><span class="o">.</span><span class="n">amikelive</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="mi">718</span><span class="o">/</span><span class="n">what</span><span class="o">-</span><span class="nb">object</span><span class="o">-</span><span class="n">categories</span><span class="o">-</span><span class="n">labels</span><span class="o">-</span><span class="n">are</span><span class="o">-</span><span class="ow">in</span><span class="o">-</span><span class="n">coco</span><span class="o">-</span><span class="n">dataset</span><span class="o">/</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/data/converter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/converter.py#L125-L226"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">coco80_to_coco91_class</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sa">r</span><span class="sd">"""Convert 80-index (val2014) to 91-index (paper).</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list[int]): A list of 80 class IDs where each value is the corresponding 91-index class ID.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span></span><span class="sd">        &gt;&gt;&gt; a = np.loadtxt("data/coco.names", dtype="str", delimiter="\n")</span>
<span></span><span class="sd">        &gt;&gt;&gt; b = np.loadtxt("data/coco_paper.names", dtype="str", delimiter="\n")</span>
<span></span>
<span></span><span class="sd">        Convert the darknet to COCO format</span>
<span></span><span class="sd">        &gt;&gt;&gt; x1 = [list(a[i] == b).index(True) + 1 for i in range(80)]</span>
<span></span>
<span></span><span class="sd">        Convert the COCO to darknet format</span>
<span></span><span class="sd">        &gt;&gt;&gt; x2 = [list(b[i] == a).index(True) if any(b[i] == a) else None for i in range(91)]</span>
<span></span>
<span></span><span class="sd">    References:</span>
<span></span><span class="sd">        https://tech.amikelive.com/node-718/what-object-categories-labels-are-in-coco-dataset/</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="p">[</span>
<span></span>        <span class="mi">1</span><span class="p">,</span>
<span></span>        <span class="mi">2</span><span class="p">,</span>
<span></span>        <span class="mi">3</span><span class="p">,</span>
<span></span>        <span class="mi">4</span><span class="p">,</span>
<span></span>        <span class="mi">5</span><span class="p">,</span>
<span></span>        <span class="mi">6</span><span class="p">,</span>
<span></span>        <span class="mi">7</span><span class="p">,</span>
<span></span>        <span class="mi">8</span><span class="p">,</span>
<span></span>        <span class="mi">9</span><span class="p">,</span>
<span></span>        <span class="mi">10</span><span class="p">,</span>
<span></span>        <span class="mi">11</span><span class="p">,</span>
<span></span>        <span class="mi">13</span><span class="p">,</span>
<span></span>        <span class="mi">14</span><span class="p">,</span>
<span></span>        <span class="mi">15</span><span class="p">,</span>
<span></span>        <span class="mi">16</span><span class="p">,</span>
<span></span>        <span class="mi">17</span><span class="p">,</span>
<span></span>        <span class="mi">18</span><span class="p">,</span>
<span></span>        <span class="mi">19</span><span class="p">,</span>
<span></span>        <span class="mi">20</span><span class="p">,</span>
<span></span>        <span class="mi">21</span><span class="p">,</span>
<span></span>        <span class="mi">22</span><span class="p">,</span>
<span></span>        <span class="mi">23</span><span class="p">,</span>
<span></span>        <span class="mi">24</span><span class="p">,</span>
<span></span>        <span class="mi">25</span><span class="p">,</span>
<span></span>        <span class="mi">27</span><span class="p">,</span>
<span></span>        <span class="mi">28</span><span class="p">,</span>
<span></span>        <span class="mi">31</span><span class="p">,</span>
<span></span>        <span class="mi">32</span><span class="p">,</span>
<span></span>        <span class="mi">33</span><span class="p">,</span>
<span></span>        <span class="mi">34</span><span class="p">,</span>
<span></span>        <span class="mi">35</span><span class="p">,</span>
<span></span>        <span class="mi">36</span><span class="p">,</span>
<span></span>        <span class="mi">37</span><span class="p">,</span>
<span></span>        <span class="mi">38</span><span class="p">,</span>
<span></span>        <span class="mi">39</span><span class="p">,</span>
<span></span>        <span class="mi">40</span><span class="p">,</span>
<span></span>        <span class="mi">41</span><span class="p">,</span>
<span></span>        <span class="mi">42</span><span class="p">,</span>
<span></span>        <span class="mi">43</span><span class="p">,</span>
<span></span>        <span class="mi">44</span><span class="p">,</span>
<span></span>        <span class="mi">46</span><span class="p">,</span>
<span></span>        <span class="mi">47</span><span class="p">,</span>
<span></span>        <span class="mi">48</span><span class="p">,</span>
<span></span>        <span class="mi">49</span><span class="p">,</span>
<span></span>        <span class="mi">50</span><span class="p">,</span>
<span></span>        <span class="mi">51</span><span class="p">,</span>
<span></span>        <span class="mi">52</span><span class="p">,</span>
<span></span>        <span class="mi">53</span><span class="p">,</span>
<span></span>        <span class="mi">54</span><span class="p">,</span>
<span></span>        <span class="mi">55</span><span class="p">,</span>
<span></span>        <span class="mi">56</span><span class="p">,</span>
<span></span>        <span class="mi">57</span><span class="p">,</span>
<span></span>        <span class="mi">58</span><span class="p">,</span>
<span></span>        <span class="mi">59</span><span class="p">,</span>
<span></span>        <span class="mi">60</span><span class="p">,</span>
<span></span>        <span class="mi">61</span><span class="p">,</span>
<span></span>        <span class="mi">62</span><span class="p">,</span>
<span></span>        <span class="mi">63</span><span class="p">,</span>
<span></span>        <span class="mi">64</span><span class="p">,</span>
<span></span>        <span class="mi">65</span><span class="p">,</span>
<span></span>        <span class="mi">67</span><span class="p">,</span>
<span></span>        <span class="mi">70</span><span class="p">,</span>
<span></span>        <span class="mi">72</span><span class="p">,</span>
<span></span>        <span class="mi">73</span><span class="p">,</span>
<span></span>        <span class="mi">74</span><span class="p">,</span>
<span></span>        <span class="mi">75</span><span class="p">,</span>
<span></span>        <span class="mi">76</span><span class="p">,</span>
<span></span>        <span class="mi">77</span><span class="p">,</span>
<span></span>        <span class="mi">78</span><span class="p">,</span>
<span></span>        <span class="mi">79</span><span class="p">,</span>
<span></span>        <span class="mi">80</span><span class="p">,</span>
<span></span>        <span class="mi">81</span><span class="p">,</span>
<span></span>        <span class="mi">82</span><span class="p">,</span>
<span></span>        <span class="mi">84</span><span class="p">,</span>
<span></span>        <span class="mi">85</span><span class="p">,</span>
<span></span>        <span class="mi">86</span><span class="p">,</span>
<span></span>        <span class="mi">87</span><span class="p">,</span>
<span></span>        <span class="mi">88</span><span class="p">,</span>
<span></span>        <span class="mi">89</span><span class="p">,</span>
<span></span>        <span class="mi">90</span><span class="p">,</span>
<span></span>    <span class="p">]</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.converter.convert_coco"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.converter.convert_coco</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">convert_coco</span><span class="p">(</span>
<span></span>    <span class="n">labels_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"../coco/annotations/"</span><span class="p">,</span>
<span></span>    <span class="n">save_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"coco_converted/"</span><span class="p">,</span>
<span></span>    <span class="n">use_segments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">use_keypoints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">cls91to80</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">lvis</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span><span class="p">)</span>
</code></pre></div><p>Convert COCO dataset annotations to a YOLO annotation format suitable for training YOLO models.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>labels_dir</code></td><td><code>str, optional</code></td><td>Path to directory containing COCO dataset annotation files.</td><td><code>"../coco/annotations/"</code></td></tr><tr><td><code>save_dir</code></td><td><code>str, optional</code></td><td>Path to directory to save results to.</td><td><code>"coco_converted/"</code></td></tr><tr><td><code>use_segments</code></td><td><code>bool, optional</code></td><td>Whether to include segmentation masks in the output.</td><td><code>False</code></td></tr><tr><td><code>use_keypoints</code></td><td><code>bool, optional</code></td><td>Whether to include keypoint annotations in the output.</td><td><code>False</code></td></tr><tr><td><code>cls91to80</code></td><td><code>bool, optional</code></td><td>Whether to map 91 COCO class IDs to the corresponding 80 COCO class IDs.</td><td><code>True</code></td></tr><tr><td><code>lvis</code></td><td><code>bool, optional</code></td><td>Whether to convert data in lvis dataset way.</td><td><code>False</code></td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.converter</span><span class="w"> </span><span class="kn">import</span> <span class="n">convert_coco</span>
<span></span>
<span></span><span class="n">Convert</span> <span class="n">COCO</span> <span class="n">annotations</span> <span class="n">to</span> <span class="n">YOLO</span> <span class="nb">format</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">convert_coco</span><span class="p">(</span><span class="s2">"coco/annotations/"</span><span class="p">,</span> <span class="n">use_segments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_keypoints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cls91to80</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span></span>
<span></span><span class="n">Convert</span> <span class="n">LVIS</span> <span class="n">annotations</span> <span class="n">to</span> <span class="n">YOLO</span> <span class="nb">format</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">convert_coco</span><span class="p">(</span><span class="s2">"lvis/annotations/"</span><span class="p">,</span> <span class="n">use_segments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_keypoints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cls91to80</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lvis</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/data/converter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/converter.py#L229-L344"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">convert_coco</span><span class="p">(</span>
<span></span>    <span class="n">labels_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"../coco/annotations/"</span><span class="p">,</span>
<span></span>    <span class="n">save_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"coco_converted/"</span><span class="p">,</span>
<span></span>    <span class="n">use_segments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">use_keypoints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">cls91to80</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">lvis</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Convert COCO dataset annotations to a YOLO annotation format suitable for training YOLO models.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels_dir (str, optional): Path to directory containing COCO dataset annotation files.</span>
<span></span><span class="sd">        save_dir (str, optional): Path to directory to save results to.</span>
<span></span><span class="sd">        use_segments (bool, optional): Whether to include segmentation masks in the output.</span>
<span></span><span class="sd">        use_keypoints (bool, optional): Whether to include keypoint annotations in the output.</span>
<span></span><span class="sd">        cls91to80 (bool, optional): Whether to map 91 COCO class IDs to the corresponding 80 COCO class IDs.</span>
<span></span><span class="sd">        lvis (bool, optional): Whether to convert data in lvis dataset way.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics.data.converter import convert_coco</span>
<span></span>
<span></span><span class="sd">        Convert COCO annotations to YOLO format</span>
<span></span><span class="sd">        &gt;&gt;&gt; convert_coco("coco/annotations/", use_segments=True, use_keypoints=False, cls91to80=False)</span>
<span></span>
<span></span><span class="sd">        Convert LVIS annotations to YOLO format</span>
<span></span><span class="sd">        &gt;&gt;&gt; convert_coco("lvis/annotations/", use_segments=True, use_keypoints=False, cls91to80=False, lvis=True)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="c1"># Create dataset directory</span>
<span></span>    <span class="n">save_dir</span> <span class="o">=</span> <span class="n">increment_path</span><span class="p">(</span><span class="n">save_dir</span><span class="p">)</span>  <span class="c1"># increment if save directory already exists</span>
<span></span>    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">save_dir</span> <span class="o">/</span> <span class="s2">"labels"</span><span class="p">,</span> <span class="n">save_dir</span> <span class="o">/</span> <span class="s2">"images"</span><span class="p">:</span>
<span></span>        <span class="n">p</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># make dir</span>
<span></span>
<span></span>    <span class="c1"># Convert classes</span>
<span></span>    <span class="n">coco80</span> <span class="o">=</span> <span class="n">coco91_to_coco80_class</span><span class="p">()</span>
<span></span>
<span></span>    <span class="c1"># Import json</span>
<span></span>    <span class="k">for</span> <span class="n">json_file</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">labels_dir</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">"*.json"</span><span class="p">)):</span>
<span></span>        <span class="n">lname</span> <span class="o">=</span> <span class="s2">""</span> <span class="k">if</span> <span class="n">lvis</span> <span class="k">else</span> <span class="n">json_file</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"instances_"</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span>
<span></span>        <span class="n">fn</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">save_dir</span><span class="p">)</span> <span class="o">/</span> <span class="s2">"labels"</span> <span class="o">/</span> <span class="n">lname</span>  <span class="c1"># folder name</span>
<span></span>        <span class="n">fn</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>        <span class="k">if</span> <span class="n">lvis</span><span class="p">:</span>
<span></span>            <span class="c1"># NOTE: create folders for both train and val in advance,</span>
<span></span>            <span class="c1"># since LVIS val set contains images from COCO 2017 train in addition to the COCO 2017 val split.</span>
<span></span>            <span class="p">(</span><span class="n">fn</span> <span class="o">/</span> <span class="s2">"train2017"</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>            <span class="p">(</span><span class="n">fn</span> <span class="o">/</span> <span class="s2">"val2017"</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_file</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span></span>            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span></span>
<span></span>        <span class="c1"># Create image dict</span>
<span></span>        <span class="n">images</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">"</span><span class="p">:</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">"images"</span><span class="p">]}</span>
<span></span>        <span class="c1"># Create image-annotations dict</span>
<span></span>        <span class="n">annotations</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span></span>        <span class="k">for</span> <span class="n">ann</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">"annotations"</span><span class="p">]:</span>
<span></span>            <span class="n">annotations</span><span class="p">[</span><span class="n">ann</span><span class="p">[</span><span class="s2">"image_id"</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ann</span><span class="p">)</span>
<span></span>
<span></span>        <span class="n">image_txt</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>        <span class="c1"># Write labels file</span>
<span></span>        <span class="k">for</span> <span class="n">img_id</span><span class="p">,</span> <span class="n">anns</span> <span class="ow">in</span> <span class="n">TQDM</span><span class="p">(</span><span class="n">annotations</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Annotations </span><span class="si">{</span><span class="n">json_file</span><span class="si">}</span><span class="s2">"</span><span class="p">):</span>
<span></span>            <span class="n">img</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">img_id</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">"</span><span class="p">]</span>
<span></span>            <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="s2">"height"</span><span class="p">],</span> <span class="n">img</span><span class="p">[</span><span class="s2">"width"</span><span class="p">]</span>
<span></span>            <span class="n">f</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="s2">"coco_url"</span><span class="p">])</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="s2">"http://images.cocodataset.org"</span><span class="p">))</span> <span class="k">if</span> <span class="n">lvis</span> <span class="k">else</span> <span class="n">img</span><span class="p">[</span><span class="s2">"file_name"</span><span class="p">]</span>
<span></span>            <span class="k">if</span> <span class="n">lvis</span><span class="p">:</span>
<span></span>                <span class="n">image_txt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">"./images"</span><span class="p">)</span> <span class="o">/</span> <span class="n">f</span><span class="p">))</span>
<span></span>
<span></span>            <span class="n">bboxes</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>            <span class="n">segments</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>            <span class="n">keypoints</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>            <span class="k">for</span> <span class="n">ann</span> <span class="ow">in</span> <span class="n">anns</span><span class="p">:</span>
<span></span>                <span class="k">if</span> <span class="n">ann</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"iscrowd"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
<span></span>                    <span class="k">continue</span>
<span></span>                <span class="c1"># The COCO box format is [top left x, top left y, width, height]</span>
<span></span>                <span class="n">box</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ann</span><span class="p">[</span><span class="s2">"bbox"</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span></span>                <span class="n">box</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">box</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># xy top-left corner to center</span>
<span></span>                <span class="n">box</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span> <span class="o">/=</span> <span class="n">w</span>  <span class="c1"># normalize x</span>
<span></span>                <span class="n">box</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span> <span class="o">/=</span> <span class="n">h</span>  <span class="c1"># normalize y</span>
<span></span>                <span class="k">if</span> <span class="n">box</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">box</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># if w &lt;= 0 and h &lt;= 0</span>
<span></span>                    <span class="k">continue</span>
<span></span>
<span></span>                <span class="bp">cls</span> <span class="o">=</span> <span class="n">coco80</span><span class="p">[</span><span class="n">ann</span><span class="p">[</span><span class="s2">"category_id"</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">cls91to80</span> <span class="k">else</span> <span class="n">ann</span><span class="p">[</span><span class="s2">"category_id"</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># class</span>
<span></span>                <span class="n">box</span> <span class="o">=</span> <span class="p">[</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">box</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>
<span></span>                <span class="k">if</span> <span class="n">box</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bboxes</span><span class="p">:</span>
<span></span>                    <span class="n">bboxes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
<span></span>                    <span class="k">if</span> <span class="n">use_segments</span> <span class="ow">and</span> <span class="n">ann</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"segmentation"</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ann</span><span class="p">[</span><span class="s2">"segmentation"</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>                            <span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
<span></span>                            <span class="k">continue</span>
<span></span>                        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ann</span><span class="p">[</span><span class="s2">"segmentation"</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span></span>                            <span class="n">s</span> <span class="o">=</span> <span class="n">merge_multi_segment</span><span class="p">(</span><span class="n">ann</span><span class="p">[</span><span class="s2">"segmentation"</span><span class="p">])</span>
<span></span>                            <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span></span>                        <span class="k">else</span><span class="p">:</span>
<span></span>                            <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ann</span><span class="p">[</span><span class="s2">"segmentation"</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>  <span class="c1"># all segments concatenated</span>
<span></span>                            <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span></span>                        <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">s</span><span class="p">]</span>
<span></span>                        <span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span></span>                    <span class="k">if</span> <span class="n">use_keypoints</span> <span class="ow">and</span> <span class="n">ann</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"keypoints"</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>                        <span class="n">keypoints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<span></span>                            <span class="n">box</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ann</span><span class="p">[</span><span class="s2">"keypoints"</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span></span>                        <span class="p">)</span>
<span></span>
<span></span>            <span class="c1"># Write</span>
<span></span>            <span class="k">with</span> <span class="nb">open</span><span class="p">((</span><span class="n">fn</span> <span class="o">/</span> <span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">".txt"</span><span class="p">),</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<span></span>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bboxes</span><span class="p">)):</span>
<span></span>                    <span class="k">if</span> <span class="n">use_keypoints</span><span class="p">:</span>
<span></span>                        <span class="n">line</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">keypoints</span><span class="p">[</span><span class="n">i</span><span class="p">]),)</span>  <span class="c1"># cls, box, keypoints</span>
<span></span>                    <span class="k">else</span><span class="p">:</span>
<span></span>                        <span class="n">line</span> <span class="o">=</span> <span class="p">(</span>
<span></span>                            <span class="o">*</span><span class="p">(</span><span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">use_segments</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">bboxes</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
<span></span>                        <span class="p">)</span>  <span class="c1"># cls, box or segments</span>
<span></span>                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="s2">"</span><span class="si">%g</span><span class="s2"> "</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">))</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">%</span> <span class="n">line</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span></span>
<span></span>        <span class="k">if</span> <span class="n">lvis</span><span class="p">:</span>
<span></span>            <span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">save_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">json_file</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"lvis_v1_"</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">".json"</span><span class="p">,</span> <span class="s2">".txt"</span><span class="p">)</span>
<span></span>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span></span>                <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">image_txt</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="s1">'LVIS'</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">lvis</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">'COCO'</span><span class="si">}</span><span class="s2"> data converted successfully.</span><span class="se">\n</span><span class="s2">Results saved to </span><span class="si">{</span><span class="n">save_dir</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.converter.convert_segment_masks_to_yolo_seg"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.converter.convert_segment_masks_to_yolo_seg</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">convert_segment_masks_to_yolo_seg</span><span class="p">(</span><span class="n">masks_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">classes</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</code></pre></div><p>Convert a dataset of segmentation mask images to the YOLO segmentation format.</p><p>This function takes the directory containing the binary format mask images and converts them into YOLO segmentation format. The converted masks are saved in the specified output directory.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>masks_dir</code></td><td><code>str</code></td><td>The path to the directory where all mask images (png, jpg) are stored.</td><td><em>required</em></td></tr><tr><td><code>output_dir</code></td><td><code>str</code></td><td>The path to the directory where the converted YOLO segmentation masks will be stored.</td><td><em>required</em></td></tr><tr><td><code>classes</code></td><td><code>int</code></td><td>Total number of classes in the dataset, e.g., 80 for COCO.</td><td><em>required</em></td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.converter</span><span class="w"> </span><span class="kn">import</span> <span class="n">convert_segment_masks_to_yolo_seg</span>
<span></span>
<span></span><span class="n">The</span> <span class="n">classes</span> <span class="n">here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">total</span> <span class="n">classes</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">dataset</span><span class="p">,</span> <span class="k">for</span> <span class="n">COCO</span> <span class="n">dataset</span> <span class="n">we</span> <span class="n">have</span> <span class="mi">80</span> <span class="n">classes</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">convert_segment_masks_to_yolo_seg</span><span class="p">(</span><span class="s2">"path/to/masks_directory"</span><span class="p">,</span> <span class="s2">"path/to/output/directory"</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</code></pre></div><div class="admonition note"><p class="admonition-title">Notes</p><p>The expected directory structure for the masks is:</p><div class="highlight"><pre><span></span><code>- masks
    â”œâ”€ mask_image_01.png or mask_image_01.jpg
    â”œâ”€ mask_image_02.png or mask_image_02.jpg
    â”œâ”€ mask_image_03.png or mask_image_03.jpg
    â””â”€ mask_image_04.png or mask_image_04.jpg
</code></pre></div><p>After execution, the labels will be organized in the following structure:</p><div class="highlight"><pre><span></span><code>- output_dir
    â”œâ”€ mask_yolo_01.txt
    â”œâ”€ mask_yolo_02.txt
    â”œâ”€ mask_yolo_03.txt
    â””â”€ mask_yolo_04.txt
</code></pre></div></div><details><summary>Source code in <code>ultralytics/data/converter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/converter.py#L347-L419"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">convert_segment_masks_to_yolo_seg</span><span class="p">(</span><span class="n">masks_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">classes</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Convert a dataset of segmentation mask images to the YOLO segmentation format.</span>
<span></span>
<span></span><span class="sd">    This function takes the directory containing the binary format mask images and converts them into YOLO segmentation</span>
<span></span><span class="sd">    format. The converted masks are saved in the specified output directory.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        masks_dir (str): The path to the directory where all mask images (png, jpg) are stored.</span>
<span></span><span class="sd">        output_dir (str): The path to the directory where the converted YOLO segmentation masks will be stored.</span>
<span></span><span class="sd">        classes (int): Total number of classes in the dataset, e.g., 80 for COCO.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics.data.converter import convert_segment_masks_to_yolo_seg</span>
<span></span>
<span></span><span class="sd">        The classes here is the total classes in the dataset, for COCO dataset we have 80 classes</span>
<span></span><span class="sd">        &gt;&gt;&gt; convert_segment_masks_to_yolo_seg("path/to/masks_directory", "path/to/output/directory", classes=80)</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        The expected directory structure for the masks is:</span>
<span></span>
<span></span><span class="sd">            - masks</span>
<span></span><span class="sd">                â”œâ”€ mask_image_01.png or mask_image_01.jpg</span>
<span></span><span class="sd">                â”œâ”€ mask_image_02.png or mask_image_02.jpg</span>
<span></span><span class="sd">                â”œâ”€ mask_image_03.png or mask_image_03.jpg</span>
<span></span><span class="sd">                â””â”€ mask_image_04.png or mask_image_04.jpg</span>
<span></span>
<span></span><span class="sd">        After execution, the labels will be organized in the following structure:</span>
<span></span>
<span></span><span class="sd">            - output_dir</span>
<span></span><span class="sd">                â”œâ”€ mask_yolo_01.txt</span>
<span></span><span class="sd">                â”œâ”€ mask_yolo_02.txt</span>
<span></span><span class="sd">                â”œâ”€ mask_yolo_03.txt</span>
<span></span><span class="sd">                â””â”€ mask_yolo_04.txt</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">pixel_to_class_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">classes</span><span class="p">)}</span>
<span></span>    <span class="k">for</span> <span class="n">mask_path</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">masks_dir</span><span class="p">)</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
<span></span>        <span class="k">if</span> <span class="n">mask_path</span><span class="o">.</span><span class="n">suffix</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">".png"</span><span class="p">,</span> <span class="s2">".jpg"</span><span class="p">}:</span>
<span></span>            <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mask_path</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_GRAYSCALE</span><span class="p">)</span>  <span class="c1"># Read the mask image in grayscale</span>
<span></span>            <span class="n">img_height</span><span class="p">,</span> <span class="n">img_width</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Get image dimensions</span>
<span></span>            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Processing </span><span class="si">{</span><span class="n">mask_path</span><span class="si">}</span><span class="s2"> imgsz = </span><span class="si">{</span><span class="n">img_height</span><span class="si">}</span><span class="s2"> x </span><span class="si">{</span><span class="n">img_width</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>
<span></span>            <span class="n">unique_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>  <span class="c1"># Get unique pixel values representing different classes</span>
<span></span>            <span class="n">yolo_format_data</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>
<span></span>            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unique_values</span><span class="p">:</span>
<span></span>                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>                    <span class="k">continue</span>  <span class="c1"># Skip background</span>
<span></span>                <span class="n">class_index</span> <span class="o">=</span> <span class="n">pixel_to_class_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span></span>                <span class="k">if</span> <span class="n">class_index</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<span></span>                    <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unknown class for pixel value </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> in file </span><span class="si">{</span><span class="n">mask_path</span><span class="si">}</span><span class="s2">, skipping."</span><span class="p">)</span>
<span></span>                    <span class="k">continue</span>
<span></span>
<span></span>                <span class="c1"># Create a binary mask for the current class and find contours</span>
<span></span>                <span class="n">contours</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span>
<span></span>                    <span class="p">(</span><span class="n">mask</span> <span class="o">==</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_EXTERNAL</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_SIMPLE</span>
<span></span>                <span class="p">)</span>  <span class="c1"># Find contours</span>
<span></span>
<span></span>                <span class="k">for</span> <span class="n">contour</span> <span class="ow">in</span> <span class="n">contours</span><span class="p">:</span>
<span></span>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># YOLO requires at least 3 points for a valid segmentation</span>
<span></span>                        <span class="n">contour</span> <span class="o">=</span> <span class="n">contour</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>  <span class="c1"># Remove single-dimensional entries</span>
<span></span>                        <span class="n">yolo_format</span> <span class="o">=</span> <span class="p">[</span><span class="n">class_index</span><span class="p">]</span>
<span></span>                        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">contour</span><span class="p">:</span>
<span></span>                            <span class="c1"># Normalize the coordinates</span>
<span></span>                            <span class="n">yolo_format</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">img_width</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>  <span class="c1"># Rounding to 6 decimal places</span>
<span></span>                            <span class="n">yolo_format</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">img_height</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span></span>                        <span class="n">yolo_format_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yolo_format</span><span class="p">)</span>
<span></span>            <span class="c1"># Save Ultralytics YOLO format data to file</span>
<span></span>            <span class="n">output_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">mask_path</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">.txt"</span>
<span></span>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<span></span>                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">yolo_format_data</span><span class="p">:</span>
<span></span>                    <span class="n">line</span> <span class="o">=</span> <span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">item</span><span class="p">))</span>
<span></span>                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span></span>            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Processed and stored at </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2"> imgsz = </span><span class="si">{</span><span class="n">img_height</span><span class="si">}</span><span class="s2"> x </span><span class="si">{</span><span class="n">img_width</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.converter.convert_dota_to_yolo_obb"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.converter.convert_dota_to_yolo_obb</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">convert_dota_to_yolo_obb</span><span class="p">(</span><span class="n">dota_root_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div><p>Convert DOTA dataset annotations to YOLO OBB (Oriented Bounding Box) format.</p><p>The function processes images in the 'train' and 'val' folders of the DOTA dataset. For each image, it reads the associated label from the original labels directory and writes new labels in YOLO OBB format to a new directory.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>dota_root_path</code></td><td><code>str</code></td><td>The root directory path of the DOTA dataset.</td><td><em>required</em></td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.converter</span><span class="w"> </span><span class="kn">import</span> <span class="n">convert_dota_to_yolo_obb</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">convert_dota_to_yolo_obb</span><span class="p">(</span><span class="s2">"path/to/DOTA"</span><span class="p">)</span>
</code></pre></div><div class="admonition note"><p class="admonition-title">Notes</p><p>The directory structure assumed for the DOTA dataset:</p><div class="highlight"><pre><span></span><code>- DOTA
    â”œâ”€ images
    â”‚   â”œâ”€ train
    â”‚   â””â”€ val
    â””â”€ labels
        â”œâ”€ train_original
        â””â”€ val_original
</code></pre></div><p>After execution, the function will organize the labels into:</p><div class="highlight"><pre><span></span><code>- DOTA
    â””â”€ labels
        â”œâ”€ train
        â””â”€ val
</code></pre></div></div><details><summary>Source code in <code>ultralytics/data/converter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/converter.py#L422-L511"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">convert_dota_to_yolo_obb</span><span class="p">(</span><span class="n">dota_root_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Convert DOTA dataset annotations to YOLO OBB (Oriented Bounding Box) format.</span>
<span></span>
<span></span><span class="sd">    The function processes images in the 'train' and 'val' folders of the DOTA dataset. For each image, it reads the</span>
<span></span><span class="sd">    associated label from the original labels directory and writes new labels in YOLO OBB format to a new directory.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        dota_root_path (str): The root directory path of the DOTA dataset.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics.data.converter import convert_dota_to_yolo_obb</span>
<span></span><span class="sd">        &gt;&gt;&gt; convert_dota_to_yolo_obb("path/to/DOTA")</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        The directory structure assumed for the DOTA dataset:</span>
<span></span>
<span></span><span class="sd">            - DOTA</span>
<span></span><span class="sd">                â”œâ”€ images</span>
<span></span><span class="sd">                â”‚   â”œâ”€ train</span>
<span></span><span class="sd">                â”‚   â””â”€ val</span>
<span></span><span class="sd">                â””â”€ labels</span>
<span></span><span class="sd">                    â”œâ”€ train_original</span>
<span></span><span class="sd">                    â””â”€ val_original</span>
<span></span>
<span></span><span class="sd">        After execution, the function will organize the labels into:</span>
<span></span>
<span></span><span class="sd">            - DOTA</span>
<span></span><span class="sd">                â””â”€ labels</span>
<span></span><span class="sd">                    â”œâ”€ train</span>
<span></span><span class="sd">                    â””â”€ val</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">dota_root_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">dota_root_path</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Class names to indices mapping</span>
<span></span>    <span class="n">class_mapping</span> <span class="o">=</span> <span class="p">{</span>
<span></span>        <span class="s2">"plane"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span></span>        <span class="s2">"ship"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span></span>        <span class="s2">"storage-tank"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span></span>        <span class="s2">"baseball-diamond"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span></span>        <span class="s2">"tennis-court"</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<span></span>        <span class="s2">"basketball-court"</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span></span>        <span class="s2">"ground-track-field"</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
<span></span>        <span class="s2">"harbor"</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
<span></span>        <span class="s2">"bridge"</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
<span></span>        <span class="s2">"large-vehicle"</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
<span></span>        <span class="s2">"small-vehicle"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<span></span>        <span class="s2">"helicopter"</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
<span></span>        <span class="s2">"roundabout"</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
<span></span>        <span class="s2">"soccer-ball-field"</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
<span></span>        <span class="s2">"swimming-pool"</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
<span></span>        <span class="s2">"container-crane"</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
<span></span>        <span class="s2">"airport"</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
<span></span>        <span class="s2">"helipad"</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span>
<span></span>    <span class="p">}</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="nf">convert_label</span><span class="p">(</span><span class="n">image_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">image_width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">image_height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">orig_label_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span></span><span class="w">        </span><span class="sd">"""Convert a single image's DOTA annotation to YOLO OBB format and save it to a specified directory."""</span>
<span></span>        <span class="n">orig_label_path</span> <span class="o">=</span> <span class="n">orig_label_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">image_name</span><span class="si">}</span><span class="s2">.txt"</span>
<span></span>        <span class="n">save_path</span> <span class="o">=</span> <span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">image_name</span><span class="si">}</span><span class="s2">.txt"</span>
<span></span>
<span></span>        <span class="k">with</span> <span class="n">orig_label_path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">,</span> <span class="n">save_path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span>
<span></span>            <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span></span>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
<span></span>                <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span></span>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">:</span>
<span></span>                    <span class="k">continue</span>
<span></span>                <span class="n">class_name</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
<span></span>                <span class="n">class_idx</span> <span class="o">=</span> <span class="n">class_mapping</span><span class="p">[</span><span class="n">class_name</span><span class="p">]</span>
<span></span>                <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">[:</span><span class="mi">8</span><span class="p">]]</span>
<span></span>                <span class="n">normalized_coords</span> <span class="o">=</span> <span class="p">[</span>
<span></span>                    <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">image_width</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">image_height</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span></span>                <span class="p">]</span>
<span></span>                <span class="n">formatted_coords</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">coord</span><span class="si">:</span><span class="s2">.6g</span><span class="si">}</span><span class="s2">"</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">normalized_coords</span><span class="p">]</span>
<span></span>                <span class="n">g</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">class_idx</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">formatted_coords</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">for</span> <span class="n">phase</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"train"</span><span class="p">,</span> <span class="s2">"val"</span><span class="p">}:</span>
<span></span>        <span class="n">image_dir</span> <span class="o">=</span> <span class="n">dota_root_path</span> <span class="o">/</span> <span class="s2">"images"</span> <span class="o">/</span> <span class="n">phase</span>
<span></span>        <span class="n">orig_label_dir</span> <span class="o">=</span> <span class="n">dota_root_path</span> <span class="o">/</span> <span class="s2">"labels"</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">phase</span><span class="si">}</span><span class="s2">_original"</span>
<span></span>        <span class="n">save_dir</span> <span class="o">=</span> <span class="n">dota_root_path</span> <span class="o">/</span> <span class="s2">"labels"</span> <span class="o">/</span> <span class="n">phase</span>
<span></span>
<span></span>        <span class="n">save_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>
<span></span>        <span class="n">image_paths</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">image_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">())</span>
<span></span>        <span class="k">for</span> <span class="n">image_path</span> <span class="ow">in</span> <span class="n">TQDM</span><span class="p">(</span><span class="n">image_paths</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Processing </span><span class="si">{</span><span class="n">phase</span><span class="si">}</span><span class="s2"> images"</span><span class="p">):</span>
<span></span>            <span class="k">if</span> <span class="n">image_path</span><span class="o">.</span><span class="n">suffix</span> <span class="o">!=</span> <span class="s2">".png"</span><span class="p">:</span>
<span></span>                <span class="k">continue</span>
<span></span>            <span class="n">image_name_without_ext</span> <span class="o">=</span> <span class="n">image_path</span><span class="o">.</span><span class="n">stem</span>
<span></span>            <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">image_path</span><span class="p">))</span>
<span></span>            <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span></span>            <span class="n">convert_label</span><span class="p">(</span><span class="n">image_name_without_ext</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">orig_label_dir</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.converter.min_index"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.converter.min_index</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">min_index</span><span class="p">(</span><span class="n">arr1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">arr2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</code></pre></div><p>Find a pair of indexes with the shortest distance between two arrays of 2D points.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>arr1</code></td><td><code>np.ndarray</code></td><td>A NumPy array of shape (N, 2) representing N 2D points.</td><td><em>required</em></td></tr><tr><td><code>arr2</code></td><td><code>np.ndarray</code></td><td>A NumPy array of shape (M, 2) representing M 2D points.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>idx1 (int)</code></td><td>Index of the point in arr1 with the shortest distance.</td></tr><tr><td><code>idx2 (int)</code></td><td>Index of the point in arr2 with the shortest distance.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/converter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/converter.py#L514-L526"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">min_index</span><span class="p">(</span><span class="n">arr1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">arr2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Find a pair of indexes with the shortest distance between two arrays of 2D points.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        arr1 (np.ndarray): A NumPy array of shape (N, 2) representing N 2D points.</span>
<span></span><span class="sd">        arr2 (np.ndarray): A NumPy array of shape (M, 2) representing M 2D points.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        idx1 (int): Index of the point in arr1 with the shortest distance.</span>
<span></span><span class="sd">        idx2 (int): Index of the point in arr2 with the shortest distance.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">dis</span> <span class="o">=</span> <span class="p">((</span><span class="n">arr1</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">arr2</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dis</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span> <span class="n">dis</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.converter.merge_multi_segment"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.converter.merge_multi_segment</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">merge_multi_segment</span><span class="p">(</span><span class="n">segments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">])</span>
</code></pre></div><p>Merge multiple segments into one list by connecting the coordinates with the minimum distance between each</p><p>segment.</p><p>This function connects these coordinates with a thin line to merge all segments into one.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>segments</code></td><td><code>list[list]</code></td><td>Original segmentations in COCO's JSON file. Each element is a list of coordinates, like<br/> [segmentation1, segmentation2,...].</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>s (list[np.ndarray])</code></td><td>A list of connected segments represented as NumPy arrays.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/converter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/converter.py#L529-L577"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">merge_multi_segment</span><span class="p">(</span><span class="n">segments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">]):</span>
<span></span><span class="w">    </span><span class="sd">"""Merge multiple segments into one list by connecting the coordinates with the minimum distance between each</span>
<span></span><span class="sd">    segment.</span>
<span></span>
<span></span><span class="sd">    This function connects these coordinates with a thin line to merge all segments into one.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        segments (list[list]): Original segmentations in COCO's JSON file. Each element is a list of coordinates, like</span>
<span></span><span class="sd">            [segmentation1, segmentation2,...].</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        s (list[np.ndarray]): A list of connected segments represented as NumPy arrays.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>    <span class="n">segments</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">]</span>
<span></span>    <span class="n">idx_list</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">))]</span>
<span></span>
<span></span>    <span class="c1"># Record the indexes with min distance between each segment</span>
<span></span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)):</span>
<span></span>        <span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="n">min_index</span><span class="p">(</span><span class="n">segments</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span></span>        <span class="n">idx_list</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx1</span><span class="p">)</span>
<span></span>        <span class="n">idx_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx2</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Use two round to connect all the segments</span>
<span></span>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
<span></span>        <span class="c1"># Forward connection</span>
<span></span>        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idx_list</span><span class="p">):</span>
<span></span>                <span class="c1"># Middle segments have two indexes, reverse the index of middle segments</span>
<span></span>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<span></span>                    <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span></span>                    <span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
<span></span>
<span></span>                <span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">-</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span></span>                <span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="mi">1</span><span class="p">]])</span>
<span></span>                <span class="c1"># Deal with the first segment and the last one</span>
<span></span>                <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">}:</span>
<span></span>                    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span></span>                <span class="k">else</span><span class="p">:</span>
<span></span>                    <span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span></span>                    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<span></span>
<span></span>        <span class="k">else</span><span class="p">:</span>
<span></span>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span></span>                <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">}:</span>
<span></span>                    <span class="n">idx</span> <span class="o">=</span> <span class="n">idx_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span></span>                    <span class="n">nidx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span></span>                    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">segments</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">nidx</span><span class="p">:])</span>
<span></span>    <span class="k">return</span> <span class="n">s</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.converter.yolo_bbox2segment"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.converter.yolo_bbox2segment</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">yolo_bbox2segment</span><span class="p">(</span><span class="n">im_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sam_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"sam_b.pt"</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div><p>Convert existing object detection dataset (bounding boxes) to segmentation dataset or oriented bounding box (OBB)</p><p>in YOLO format. Generate segmentation data using SAM auto-annotator as needed.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>im_dir</code></td><td><code>str | Path</code></td><td>Path to image directory to convert.</td><td><em>required</em></td></tr><tr><td><code>save_dir</code></td><td><code>str | Path, optional</code></td><td>Path to save the generated labels, labels will be saved into <code>labels-segment</code><br/> in the same directory level of <code>im_dir</code> if save_dir is None.</td><td><code>None</code></td></tr><tr><td><code>sam_model</code></td><td><code>str</code></td><td>Segmentation model to use for intermediate segmentation data.</td><td><code>"sam_b.pt"</code></td></tr><tr><td><code>device</code></td><td><code>int | str, optional</code></td><td>The specific device to run SAM models.</td><td><code>None</code></td></tr></tbody></table><div class="admonition note"><p class="admonition-title">Notes</p><p>The input directory structure assumed for dataset:</p><div class="highlight"><pre><span></span><code>- im_dir
    â”œâ”€ 001.jpg
    â”œâ”€ ...
    â””â”€ NNN.jpg
- labels
    â”œâ”€ 001.txt
    â”œâ”€ ...
    â””â”€ NNN.txt
</code></pre></div></div><details><summary>Source code in <code>ultralytics/data/converter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/converter.py#L580-L640"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">yolo_bbox2segment</span><span class="p">(</span><span class="n">im_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sam_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"sam_b.pt"</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Convert existing object detection dataset (bounding boxes) to segmentation dataset or oriented bounding box (OBB)</span>
<span></span><span class="sd">    in YOLO format. Generate segmentation data using SAM auto-annotator as needed.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        im_dir (str | Path): Path to image directory to convert.</span>
<span></span><span class="sd">        save_dir (str | Path, optional): Path to save the generated labels, labels will be saved into `labels-segment`</span>
<span></span><span class="sd">            in the same directory level of `im_dir` if save_dir is None.</span>
<span></span><span class="sd">        sam_model (str): Segmentation model to use for intermediate segmentation data.</span>
<span></span><span class="sd">        device (int | str, optional): The specific device to run SAM models.</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        The input directory structure assumed for dataset:</span>
<span></span>
<span></span><span class="sd">            - im_dir</span>
<span></span><span class="sd">                â”œâ”€ 001.jpg</span>
<span></span><span class="sd">                â”œâ”€ ...</span>
<span></span><span class="sd">                â””â”€ NNN.jpg</span>
<span></span><span class="sd">            - labels</span>
<span></span><span class="sd">                â”œâ”€ 001.txt</span>
<span></span><span class="sd">                â”œâ”€ ...</span>
<span></span><span class="sd">                â””â”€ NNN.txt</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">SAM</span>
<span></span>    <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">YOLODataset</span>
<span></span>    <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.utils.ops</span><span class="w"> </span><span class="kn">import</span> <span class="n">xywh2xyxy</span>
<span></span>
<span></span>    <span class="c1"># NOTE: add placeholder to pass class index check</span>
<span></span>    <span class="n">dataset</span> <span class="o">=</span> <span class="n">YOLODataset</span><span class="p">(</span><span class="n">im_dir</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)),</span> <span class="n">channels</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span></span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"segments"</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># if it's segment data</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"Segmentation labels detected, no need to generate new ones!"</span><span class="p">)</span>
<span></span>        <span class="k">return</span>
<span></span>
<span></span>    <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"Detection labels detected, generating segment labels by SAM model!"</span><span class="p">)</span>
<span></span>    <span class="n">sam_model</span> <span class="o">=</span> <span class="n">SAM</span><span class="p">(</span><span class="n">sam_model</span><span class="p">)</span>
<span></span>    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">TQDM</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">labels</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">"Generating segment labels"</span><span class="p">):</span>
<span></span>        <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="s2">"shape"</span><span class="p">]</span>
<span></span>        <span class="n">boxes</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]</span>
<span></span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">boxes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># skip empty labels</span>
<span></span>            <span class="k">continue</span>
<span></span>        <span class="n">boxes</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span> <span class="o">*=</span> <span class="n">w</span>
<span></span>        <span class="n">boxes</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span> <span class="o">*=</span> <span class="n">h</span>
<span></span>        <span class="n">im</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="s2">"im_file"</span><span class="p">])</span>
<span></span>        <span class="n">sam_results</span> <span class="o">=</span> <span class="n">sam_model</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">bboxes</span><span class="o">=</span><span class="n">xywh2xyxy</span><span class="p">(</span><span class="n">boxes</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span></span>        <span class="n">label</span><span class="p">[</span><span class="s2">"segments"</span><span class="p">]</span> <span class="o">=</span> <span class="n">sam_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">masks</span><span class="o">.</span><span class="n">xyn</span>
<span></span>
<span></span>    <span class="n">save_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">save_dir</span><span class="p">)</span> <span class="k">if</span> <span class="n">save_dir</span> <span class="k">else</span> <span class="n">Path</span><span class="p">(</span><span class="n">im_dir</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">"labels-segment"</span>
<span></span>    <span class="n">save_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
<span></span>        <span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>        <span class="n">lb_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="s2">"im_file"</span><span class="p">])</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">".txt"</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<span></span>        <span class="n">txt_file</span> <span class="o">=</span> <span class="n">save_dir</span> <span class="o">/</span> <span class="n">lb_name</span>
<span></span>        <span class="bp">cls</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">]</span>
<span></span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="s2">"segments"</span><span class="p">]):</span>
<span></span>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>                <span class="k">continue</span>
<span></span>            <span class="n">line</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">cls</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="o">*</span><span class="n">s</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span></span>            <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s2">"</span><span class="si">%g</span><span class="s2"> "</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">))</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">%</span> <span class="n">line</span><span class="p">)</span>
<span></span>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">txt_file</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span></span>            <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">text</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">)</span>
<span></span>    <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Generated segment labels saved in </span><span class="si">{</span><span class="n">save_dir</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.converter.create_synthetic_coco_dataset"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.converter.create_synthetic_coco_dataset</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">create_synthetic_coco_dataset</span><span class="p">()</span>
</code></pre></div><p>Create a synthetic COCO dataset with random images based on filenames from label lists.</p><p>This function downloads COCO labels, reads image filenames from label list files, creates synthetic images for train2017 and val2017 subsets, and organizes them in the COCO dataset structure. It uses multithreading to generate images efficiently.</p><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.converter</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_synthetic_coco_dataset</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">create_synthetic_coco_dataset</span><span class="p">()</span>
</code></pre></div><div class="admonition note"><p class="admonition-title">Notes</p><ul><li>Requires internet connection to download label files.</li><li>Generates random RGB images of varying sizes (480x480 to 640x640 pixels).</li><li>Existing test2017 directory is removed as it's not needed.</li><li>Reads image filenames from train2017.txt and val2017.txt files.</li></ul></div><details><summary>Source code in <code>ultralytics/data/converter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/converter.py#L643-L695"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">create_synthetic_coco_dataset</span><span class="p">():</span>
<span></span><span class="w">    </span><span class="sd">"""Create a synthetic COCO dataset with random images based on filenames from label lists.</span>
<span></span>
<span></span><span class="sd">    This function downloads COCO labels, reads image filenames from label list files, creates synthetic images for</span>
<span></span><span class="sd">    train2017 and val2017 subsets, and organizes them in the COCO dataset structure. It uses multithreading to generate</span>
<span></span><span class="sd">    images efficiently.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics.data.converter import create_synthetic_coco_dataset</span>
<span></span><span class="sd">        &gt;&gt;&gt; create_synthetic_coco_dataset()</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        - Requires internet connection to download label files.</span>
<span></span><span class="sd">        - Generates random RGB images of varying sizes (480x480 to 640x640 pixels).</span>
<span></span><span class="sd">        - Existing test2017 directory is removed as it's not needed.</span>
<span></span><span class="sd">        - Reads image filenames from train2017.txt and val2017.txt files.</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="nf">create_synthetic_image</span><span class="p">(</span><span class="n">image_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span></span><span class="w">        </span><span class="sd">"""Generate synthetic images with random sizes and colors for dataset augmentation or testing purposes."""</span>
<span></span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">image_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<span></span>            <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">640</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">640</span><span class="p">))</span>
<span></span>            <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
<span></span>                <span class="s2">"RGB"</span><span class="p">,</span>
<span></span>                <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
<span></span>                <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span>
<span></span>            <span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">image_file</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Download labels</span>
<span></span>    <span class="nb">dir</span> <span class="o">=</span> <span class="n">DATASETS_DIR</span> <span class="o">/</span> <span class="s2">"coco"</span>
<span></span>    <span class="n">download</span><span class="p">([</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">ASSETS_URL</span><span class="si">}</span><span class="s2">/coco2017labels-segments.zip"</span><span class="p">],</span> <span class="nb">dir</span><span class="o">=</span><span class="nb">dir</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Create synthetic images</span>
<span></span>    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="nb">dir</span> <span class="o">/</span> <span class="s2">"labels"</span> <span class="o">/</span> <span class="s2">"test2017"</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Remove test2017 directory as not needed</span>
<span></span>    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">NUM_THREADS</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
<span></span>        <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"train2017"</span><span class="p">,</span> <span class="s2">"val2017"</span><span class="p">}:</span>
<span></span>            <span class="n">subset_dir</span> <span class="o">=</span> <span class="nb">dir</span> <span class="o">/</span> <span class="s2">"images"</span> <span class="o">/</span> <span class="n">subset</span>
<span></span>            <span class="n">subset_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>
<span></span>            <span class="c1"># Read image filenames from label list file</span>
<span></span>            <span class="n">label_list_file</span> <span class="o">=</span> <span class="nb">dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">subset</span><span class="si">}</span><span class="s2">.txt"</span>
<span></span>            <span class="k">if</span> <span class="n">label_list_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<span></span>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">label_list_file</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span></span>                    <span class="n">image_files</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dir</span> <span class="o">/</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
<span></span>
<span></span>                <span class="c1"># Submit all tasks</span>
<span></span>                <span class="n">futures</span> <span class="o">=</span> <span class="p">[</span><span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">create_synthetic_image</span><span class="p">,</span> <span class="n">image_file</span><span class="p">)</span> <span class="k">for</span> <span class="n">image_file</span> <span class="ow">in</span> <span class="n">image_files</span><span class="p">]</span>
<span></span>                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">TQDM</span><span class="p">(</span><span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">futures</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Generating images for </span><span class="si">{</span><span class="n">subset</span><span class="si">}</span><span class="s2">"</span><span class="p">):</span>
<span></span>                    <span class="k">pass</span>  <span class="c1"># The actual work is done in the background</span>
<span></span>            <span class="k">else</span><span class="p">:</span>
<span></span>                <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Labels file </span><span class="si">{</span><span class="n">label_list_file</span><span class="si">}</span><span class="s2"> does not exist. Skipping image creation for </span><span class="si">{</span><span class="n">subset</span><span class="si">}</span><span class="s2">."</span><span class="p">)</span>
<span></span>
<span></span>    <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"Synthetic COCO dataset created successfully."</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.converter.convert_to_multispectral"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.converter.convert_to_multispectral</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_multispectral</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">replace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="nb">zip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</code></pre></div><p>Convert RGB images to multispectral images by interpolating across wavelength bands.</p><p>This function takes RGB images and interpolates them to create multispectral images with a specified number of channels. It can process either a single image or a directory of images.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>path</code></td><td><code>str | Path</code></td><td>Path to an image file or directory containing images to convert.</td><td><em>required</em></td></tr><tr><td><code>n_channels</code></td><td><code>int</code></td><td>Number of spectral channels to generate in the output image.</td><td><code>10</code></td></tr><tr><td><code>replace</code></td><td><code>bool</code></td><td>Whether to replace the original image file with the converted one.</td><td><code>False</code></td></tr><tr><td><code>zip</code></td><td><code>bool</code></td><td>Whether to zip the converted images into a zip file.</td><td><code>False</code></td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="n">Convert</span> <span class="n">a</span> <span class="n">single</span> <span class="n">image</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">convert_to_multispectral</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">,</span> <span class="n">n_channels</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span></span>
<span></span><span class="n">Convert</span> <span class="n">a</span> <span class="n">dataset</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">convert_to_multispectral</span><span class="p">(</span><span class="s2">"coco8"</span><span class="p">,</span> <span class="n">n_channels</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/data/converter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/converter.py#L698-L746"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_multispectral</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">replace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="nb">zip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Convert RGB images to multispectral images by interpolating across wavelength bands.</span>
<span></span>
<span></span><span class="sd">    This function takes RGB images and interpolates them to create multispectral images with a specified number of</span>
<span></span><span class="sd">    channels. It can process either a single image or a directory of images.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        path (str | Path): Path to an image file or directory containing images to convert.</span>
<span></span><span class="sd">        n_channels (int): Number of spectral channels to generate in the output image.</span>
<span></span><span class="sd">        replace (bool): Whether to replace the original image file with the converted one.</span>
<span></span><span class="sd">        zip (bool): Whether to zip the converted images into a zip file.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        Convert a single image</span>
<span></span><span class="sd">        &gt;&gt;&gt; convert_to_multispectral("path/to/image.jpg", n_channels=10)</span>
<span></span>
<span></span><span class="sd">        Convert a dataset</span>
<span></span><span class="sd">        &gt;&gt;&gt; convert_to_multispectral("coco8", n_channels=10)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">interp1d</span>
<span></span>
<span></span>    <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.data.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">IMG_FORMATS</span>
<span></span>
<span></span>    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
<span></span>        <span class="c1"># Process directory</span>
<span></span>        <span class="n">im_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">(</span><span class="n">IMG_FORMATS</span> <span class="o">-</span> <span class="p">{</span><span class="s2">"tif"</span><span class="p">,</span> <span class="s2">"tiff"</span><span class="p">})</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="sa">f</span><span class="s2">"*.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">"</span><span class="p">)]</span>
<span></span>        <span class="k">for</span> <span class="n">im_path</span> <span class="ow">in</span> <span class="n">im_files</span><span class="p">:</span>
<span></span>            <span class="k">try</span><span class="p">:</span>
<span></span>                <span class="n">convert_to_multispectral</span><span class="p">(</span><span class="n">im_path</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">)</span>
<span></span>                <span class="k">if</span> <span class="n">replace</span><span class="p">:</span>
<span></span>                    <span class="n">im_path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
<span></span>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span></span>                <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error converting </span><span class="si">{</span><span class="n">im_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>
<span></span>        <span class="k">if</span> <span class="nb">zip</span><span class="p">:</span>
<span></span>            <span class="n">zip_directory</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="c1"># Process a single image</span>
<span></span>        <span class="n">output_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">".tiff"</span><span class="p">)</span>
<span></span>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
<span></span>
<span></span>        <span class="c1"># Interpolate all pixels at once</span>
<span></span>        <span class="n">rgb_wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">650</span><span class="p">,</span> <span class="mi">510</span><span class="p">,</span> <span class="mi">475</span><span class="p">])</span>  <span class="c1"># R, G, B wavelengths (nm)</span>
<span></span>        <span class="n">target_wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">450</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">)</span>
<span></span>        <span class="n">f</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">rgb_wavelengths</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">"linear"</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">"extrapolate"</span><span class="p">)</span>
<span></span>        <span class="n">multispectral</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">target_wavelengths</span><span class="p">)</span>
<span></span>        <span class="n">cv2</span><span class="o">.</span><span class="n">imwritemulti</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_path</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">multispectral</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Converted </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.converter.convert_ndjson_to_yolo"><span class="doc-kind doc-kind-function">function</span> <code>ultralytics.data.converter.convert_ndjson_to_yolo</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">convert_ndjson_to_yolo</span><span class="p">(</span><span class="n">ndjson_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span>
</code></pre></div><p>Convert NDJSON dataset format to Ultralytics YOLO dataset structure.</p><p>This function converts datasets stored in NDJSON (Newline Delimited JSON) format to the standard YOLO format. For
detection/segmentation/pose/obb tasks, it creates separate directories for images and labels. For classification
tasks, it creates the ImageNet-style {split}/{class_name}/ folder structure. It supports parallel processing for
efficient conversion of large datasets and can download images from URLs.</p><p>The NDJSON format consists of:
- First line: Dataset metadata with class names, task type, and configuration
- Subsequent lines: Individual image records with annotations and optional URLs</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>ndjson_path</code></td><td><code>Union[str, Path]</code></td><td>Path to the input NDJSON file containing dataset information.</td><td><em>required</em></td></tr><tr><td><code>output_path</code></td><td><code>Optional[Union[str, Path]], optional</code></td><td>Directory where the converted YOLO dataset will be saved. If<br/> None, uses the parent directory of the NDJSON file. Defaults to None.</td><td><code>None</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Path</code></td><td>Path to the generated data.yaml file (detection) or dataset directory (classification).</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="n">Convert</span> <span class="n">a</span> <span class="n">local</span> <span class="n">NDJSON</span> <span class="n">file</span><span class="p">:</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">yaml_path</span> <span class="o">=</span> <span class="n">convert_ndjson_to_yolo</span><span class="p">(</span><span class="s2">"dataset.ndjson"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Dataset converted to: </span><span class="si">{</span><span class="n">yaml_path</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>
<span></span><span class="n">Convert</span> <span class="k">with</span> <span class="n">custom</span> <span class="n">output</span> <span class="n">directory</span><span class="p">:</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">yaml_path</span> <span class="o">=</span> <span class="n">convert_ndjson_to_yolo</span><span class="p">(</span><span class="s2">"dataset.ndjson"</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="s2">"./converted_datasets"</span><span class="p">)</span>
<span></span>
<span></span><span class="n">Use</span> <span class="k">with</span> <span class="n">YOLO</span> <span class="n">training</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">YOLO</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="s2">"yolo26n.pt"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s2">"https://github.com/ultralytics/assets/releases/download/v0.0.0/coco8-ndjson.ndjson"</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/data/converter.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/converter.py#L749-L886"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">convert_ndjson_to_yolo</span><span class="p">(</span><span class="n">ndjson_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Convert NDJSON dataset format to Ultralytics YOLO dataset structure.</span>
<span></span>
<span></span><span class="sd">    This function converts datasets stored in NDJSON (Newline Delimited JSON) format to the standard YOLO format. For</span>
<span></span><span class="sd">    detection/segmentation/pose/obb tasks, it creates separate directories for images and labels. For classification</span>
<span></span><span class="sd">    tasks, it creates the ImageNet-style {split}/{class_name}/ folder structure. It supports parallel processing for</span>
<span></span><span class="sd">    efficient conversion of large datasets and can download images from URLs.</span>
<span></span>
<span></span><span class="sd">    The NDJSON format consists of:</span>
<span></span><span class="sd">    - First line: Dataset metadata with class names, task type, and configuration</span>
<span></span><span class="sd">    - Subsequent lines: Individual image records with annotations and optional URLs</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        ndjson_path (Union[str, Path]): Path to the input NDJSON file containing dataset information.</span>
<span></span><span class="sd">        output_path (Optional[Union[str, Path]], optional): Directory where the converted YOLO dataset will be saved. If</span>
<span></span><span class="sd">            None, uses the parent directory of the NDJSON file. Defaults to None.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Path): Path to the generated data.yaml file (detection) or dataset directory (classification).</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        Convert a local NDJSON file:</span>
<span></span><span class="sd">        &gt;&gt;&gt; yaml_path = convert_ndjson_to_yolo("dataset.ndjson")</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(f"Dataset converted to: {yaml_path}")</span>
<span></span>
<span></span><span class="sd">        Convert with custom output directory:</span>
<span></span><span class="sd">        &gt;&gt;&gt; yaml_path = convert_ndjson_to_yolo("dataset.ndjson", output_path="./converted_datasets")</span>
<span></span>
<span></span><span class="sd">        Use with YOLO training</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics import YOLO</span>
<span></span><span class="sd">        &gt;&gt;&gt; model = YOLO("yolo26n.pt")</span>
<span></span><span class="sd">        &gt;&gt;&gt; model.train(data="https://github.com/ultralytics/assets/releases/download/v0.0.0/coco8-ndjson.ndjson")</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.utils.checks</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_requirements</span>
<span></span>
<span></span>    <span class="n">check_requirements</span><span class="p">(</span><span class="s2">"aiohttp"</span><span class="p">)</span>
<span></span>    <span class="kn">import</span><span class="w"> </span><span class="nn">aiohttp</span>
<span></span>
<span></span>    <span class="n">ndjson_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">check_file</span><span class="p">(</span><span class="n">ndjson_path</span><span class="p">))</span>
<span></span>    <span class="n">output_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_path</span> <span class="ow">or</span> <span class="n">DATASETS_DIR</span><span class="p">)</span>
<span></span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ndjson_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span></span>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
<span></span>
<span></span>    <span class="n">dataset_record</span><span class="p">,</span> <span class="n">image_records</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span></span>    <span class="n">dataset_dir</span> <span class="o">=</span> <span class="n">output_path</span> <span class="o">/</span> <span class="n">ndjson_path</span><span class="o">.</span><span class="n">stem</span>
<span></span>    <span class="n">splits</span> <span class="o">=</span> <span class="p">{</span><span class="n">record</span><span class="p">[</span><span class="s2">"split"</span><span class="p">]</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">image_records</span><span class="p">}</span>
<span></span>
<span></span>    <span class="c1"># Check if this is a classification dataset</span>
<span></span>    <span class="n">is_classification</span> <span class="o">=</span> <span class="n">dataset_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"task"</span><span class="p">)</span> <span class="o">==</span> <span class="s2">"classify"</span>
<span></span>    <span class="n">class_names</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dataset_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"class_names"</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span></span>
<span></span>    <span class="c1"># Create base directories</span>
<span></span>    <span class="n">dataset_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>    <span class="n">data_yaml</span> <span class="o">=</span> <span class="kc">None</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_classification</span><span class="p">:</span>
<span></span>        <span class="c1"># Detection/segmentation/pose/obb: prepare YAML and create base structure</span>
<span></span>        <span class="n">data_yaml</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dataset_record</span><span class="p">)</span>
<span></span>        <span class="n">data_yaml</span><span class="p">[</span><span class="s2">"names"</span><span class="p">]</span> <span class="o">=</span> <span class="n">class_names</span>
<span></span>        <span class="n">data_yaml</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"class_names"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span></span>        <span class="n">data_yaml</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"type"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Remove NDJSON-specific fields</span>
<span></span>        <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">splits</span><span class="p">):</span>
<span></span>            <span class="p">(</span><span class="n">dataset_dir</span> <span class="o">/</span> <span class="s2">"images"</span> <span class="o">/</span> <span class="n">split</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>            <span class="p">(</span><span class="n">dataset_dir</span> <span class="o">/</span> <span class="s2">"labels"</span> <span class="o">/</span> <span class="n">split</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>            <span class="n">data_yaml</span><span class="p">[</span><span class="n">split</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"images/</span><span class="si">{</span><span class="n">split</span><span class="si">}</span><span class="s2">"</span>
<span></span>
<span></span>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_record</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">semaphore</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
<span></span><span class="w">        </span><span class="sd">"""Process single image record with async session."""</span>
<span></span>        <span class="k">async</span> <span class="k">with</span> <span class="n">semaphore</span><span class="p">:</span>
<span></span>            <span class="n">split</span><span class="p">,</span> <span class="n">original_name</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s2">"split"</span><span class="p">],</span> <span class="n">record</span><span class="p">[</span><span class="s2">"file"</span><span class="p">]</span>
<span></span>            <span class="n">annotations</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"annotations"</span><span class="p">,</span> <span class="p">{})</span>
<span></span>
<span></span>            <span class="k">if</span> <span class="n">is_classification</span><span class="p">:</span>
<span></span>                <span class="c1"># Classification: place image in {split}/{class_name}/ folder</span>
<span></span>                <span class="n">class_ids</span> <span class="o">=</span> <span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"classification"</span><span class="p">,</span> <span class="p">[])</span>
<span></span>                <span class="n">class_id</span> <span class="o">=</span> <span class="n">class_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">class_ids</span> <span class="k">else</span> <span class="mi">0</span>
<span></span>                <span class="n">class_name</span> <span class="o">=</span> <span class="n">class_names</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">class_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">class_id</span><span class="p">))</span>
<span></span>                <span class="n">image_path</span> <span class="o">=</span> <span class="n">dataset_dir</span> <span class="o">/</span> <span class="n">split</span> <span class="o">/</span> <span class="n">class_name</span> <span class="o">/</span> <span class="n">original_name</span>
<span></span>            <span class="k">else</span><span class="p">:</span>
<span></span>                <span class="c1"># Detection: write label file and place image in images/{split}/</span>
<span></span>                <span class="n">image_path</span> <span class="o">=</span> <span class="n">dataset_dir</span> <span class="o">/</span> <span class="s2">"images"</span> <span class="o">/</span> <span class="n">split</span> <span class="o">/</span> <span class="n">original_name</span>
<span></span>                <span class="n">label_path</span> <span class="o">=</span> <span class="n">dataset_dir</span> <span class="o">/</span> <span class="s2">"labels"</span> <span class="o">/</span> <span class="n">split</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="n">original_name</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">.txt"</span>
<span></span>                <span class="n">lines_to_write</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">annotations</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span></span>                    <span class="n">lines_to_write</span> <span class="o">=</span> <span class="p">[</span><span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">item</span><span class="p">))</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>
<span></span>                    <span class="k">break</span>
<span></span>                <span class="n">label_path</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines_to_write</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="k">if</span> <span class="n">lines_to_write</span> <span class="k">else</span> <span class="s2">""</span><span class="p">)</span>
<span></span>
<span></span>            <span class="c1"># Download image if URL provided and file doesn't exist</span>
<span></span>            <span class="k">if</span> <span class="n">http_url</span> <span class="o">:=</span> <span class="n">record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"url"</span><span class="p">):</span>
<span></span>                <span class="k">if</span> <span class="ow">not</span> <span class="n">image_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<span></span>                    <span class="n">image_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>                    <span class="c1"># Retry with exponential backoff (3 attempts: 0s, 2s, 4s delays)</span>
<span></span>                    <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span></span>                        <span class="k">try</span><span class="p">:</span>
<span></span>                            <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">http_url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientTimeout</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span> <span class="k">as</span> <span class="n">response</span><span class="p">:</span>
<span></span>                                <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<span></span>                                <span class="n">image_path</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="k">await</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span></span>                            <span class="k">return</span> <span class="kc">True</span>
<span></span>                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span></span>                            <span class="k">if</span> <span class="n">attempt</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Don't sleep after last attempt</span>
<span></span>                                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">attempt</span><span class="p">)</span>  <span class="c1"># 1s, 2s backoff</span>
<span></span>                            <span class="k">else</span><span class="p">:</span>
<span></span>                                <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Failed to download </span><span class="si">{</span><span class="n">http_url</span><span class="si">}</span><span class="s2"> after 3 attempts: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>                                <span class="k">return</span> <span class="kc">False</span>
<span></span>            <span class="k">return</span> <span class="kc">True</span>
<span></span>
<span></span>    <span class="c1"># Process all images with async downloads (limit connections for small datasets)</span>
<span></span>    <span class="n">semaphore</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Semaphore</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">image_records</span><span class="p">)))</span>
<span></span>    <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
<span></span>        <span class="n">pbar</span> <span class="o">=</span> <span class="n">TQDM</span><span class="p">(</span>
<span></span>            <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">image_records</span><span class="p">),</span>
<span></span>            <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Converting </span><span class="si">{</span><span class="n">ndjson_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> â†’ </span><span class="si">{</span><span class="n">dataset_dir</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">image_records</span><span class="p">)</span><span class="si">}</span><span class="s2"> images)"</span><span class="p">,</span>
<span></span>        <span class="p">)</span>
<span></span>
<span></span>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">tracked_process</span><span class="p">(</span><span class="n">record</span><span class="p">):</span>
<span></span>            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">process_record</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">semaphore</span><span class="p">,</span> <span class="n">record</span><span class="p">)</span>
<span></span>            <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span></span>            <span class="k">return</span> <span class="n">result</span>
<span></span>
<span></span>        <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">tracked_process</span><span class="p">(</span><span class="n">record</span><span class="p">)</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">image_records</span><span class="p">])</span>
<span></span>        <span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span></span>
<span></span>    <span class="c1"># Validate images were downloaded successfully</span>
<span></span>    <span class="n">success_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">success_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Failed to download any images from </span><span class="si">{</span><span class="n">ndjson_path</span><span class="si">}</span><span class="s2">. Check network connection and URLs."</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">success_count</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">image_records</span><span class="p">):</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Downloaded </span><span class="si">{</span><span class="n">success_count</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">image_records</span><span class="p">)</span><span class="si">}</span><span class="s2"> images from </span><span class="si">{</span><span class="n">ndjson_path</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="n">is_classification</span><span class="p">:</span>
<span></span>        <span class="c1"># Classification: return dataset directory (check_cls_dataset expects a directory path)</span>
<span></span>        <span class="k">return</span> <span class="n">dataset_dir</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="c1"># Detection: write data.yaml and return its path</span>
<span></span>        <span class="n">yaml_path</span> <span class="o">=</span> <span class="n">dataset_dir</span> <span class="o">/</span> <span class="s2">"data.yaml"</span>
<span></span>        <span class="n">YAML</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">yaml_path</span><span class="p">,</span> <span class="n">data_yaml</span><span class="p">)</span>
<span></span>        <span class="k">return</span> <span class="n">yaml_path</span>
</code></pre></div></details><p><br/><br/></p><br/><br/><div class="git-info"><div class="dates-container"><span class="date-item" title="This page was first created on November 12, 2023"><span class="hover-item">ğŸ“…</span> Created 2 years ago </span><span class="date-item" title="This page was last updated on November 23, 2025"><span class="hover-item">âœï¸</span> Updated 1 month ago </span></div><div class="authors-container"><a class="author-link" href="https://github.com/glenn-jocher" title="glenn-jocher (10 changes)"><img alt="glenn-jocher" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/26833433?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/UltralyticsAssistant" title="UltralyticsAssistant (1 change)"><img alt="UltralyticsAssistant" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/135830346?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/jk4e" title="jk4e (1 change)"><img alt="jk4e" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/116908874?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/RizwanMunawar" title="RizwanMunawar (1 change)"><img alt="RizwanMunawar" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62513924?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/Burhan-Q" title="Burhan-Q (1 change)"><img alt="Burhan-Q" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62214284?v=4&amp;s=96"/></a></div></div><div class="share-buttons"><button class="share-button hover-item" onclick="window.open('https://twitter.com/intent/tweet?url=https%3A%2F%2Fdocs.ultralytics.com%2Freference%2Fdata%2Fconverter%2F', 'TwitterShare', 'width=550,height=680,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-x-twitter"></i> Tweet </button><button class="share-button hover-item linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fdocs.ultralytics.com%2Freference%2Fdata%2Fconverter%2F', 'LinkedinShare', 'width=550,height=730,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-linkedin-in"></i> Share </button></div><br/></article></div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div><button class="md-top md-icon" data-md-component="top" hidden="" type="button"><svg class="lucide lucide-circle-arrow-up" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10"></circle><path d="m16 12-4-4-4 4M12 16V8"></path></svg> Back to top
</button></main><footer class="md-footer"><nav aria-label="Footer" class="md-footer__inner md-grid"><a aria-label="Previous: build" class="md-footer__link md-footer__link--prev" href="../build/"><div class="md-footer__button md-icon"><svg class="lucide lucide-arrow-left" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12 19-7-7 7-7M19 12H5"></path></svg></div><div class="md-footer__title"><span class="md-footer__direction"> Previous </span><div class="md-ellipsis"> build </div></div></a><a aria-label="Next: dataset" class="md-footer__link md-footer__link--next" href="../dataset/"><div class="md-footer__title"><span class="md-footer__direction"> Next </span><div class="md-ellipsis"> dataset </div></div><div class="md-footer__button md-icon"><svg class="lucide lucide-arrow-right" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 12h14M12 5l7 7-7 7"></path></svg></div></a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-copyright"><div class="md-copyright__highlight"><a href="https://www.ultralytics.com/" target="_blank">Â© 2026 Ultralytics Inc.</a> All rights reserved. </div> Made with <a href="https://zensical.org/" rel="noopener" target="_blank"> Zensical </a></div><div class="md-social"><a class="md-social__link" href="https://github.com/ultralytics" rel="noopener" target="_blank" title="github.com"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://www.linkedin.com/company/ultralytics/" rel="noopener" target="_blank" title="www.linkedin.com"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://x.com/ultralytics" rel="noopener" target="_blank" title="x.com"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://youtube.com/ultralytics?sub_confirmation=1" rel="noopener" target="_blank" title="youtube.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://hub.docker.com/r/ultralytics/ultralytics/" rel="noopener" target="_blank" title="hub.docker.com"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://pypi.org/project/ultralytics/" rel="noopener" target="_blank" title="pypi.org"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://discord.com/invite/ultralytics" rel="noopener" target="_blank" title="discord.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://reddit.com/r/ultralytics" rel="noopener" target="_blank" title="reddit.com"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://weixin.qq.com/r/mp/LxckPDfEgWr_rXNf90I9" rel="noopener" target="_blank" title="weixin.qq.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6" fill="currentColor"></path></svg></a></div></div></div></footer></div><div class="md-dialog" data-md-component="dialog"><div class="md-dialog__inner md-typeset"></div></div><div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"annotate":null,"base":"../../..","features":["content.action.edit","content.code.annotate","content.code.copy","content.tooltips","toc.follow","navigation.top","navigation.tabs","navigation.tabs.sticky","navigation.prune","navigation.footer","navigation.tracking","navigation.instant","navigation.instant.progress","navigation.indexes","navigation.sections","content.tabs.link"],"search":"../../../assets/javascripts/workers/search.e2d2d235.min.js","tags":null,"translations":{"clipboard.copied":"Copied to clipboard","clipboard.copy":"Copy to clipboard","search.result.more.one":"1 more on this page","search.result.more.other":"# more on this page","search.result.none":"No matching documents","search.result.one":"1 matching document","search.result.other":"# matching documents","search.result.placeholder":"Type to start searching","search.result.term.missing":"Missing","select.version":"Select version"},"version":null}</script>
<script src="../../../assets/javascripts/bundle.8ffeb9c9.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/ultralytics/llm@v0.1.8/js/chat.min.js"></script>
<script src="https://unpkg.com/tablesort@5.6.0/dist/tablesort.min.js"></script>
<script src="../../../javascript/extra.js"></script>
<script src="../../../javascript/giscus.js"></script>
<script src="../../../javascript/tablesort.js"></script>
</body></html>