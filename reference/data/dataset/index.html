 <!DOCTYPE html><html class="no-js" lang="en"><head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Explore the YOLODataset and its subclasses for object detection, segmentation, and multi-modal tasks. Find details on dataset loading, caching, and augmentation." name="description"/><meta content="Ultralytics" name="author"/><link href="https://docs.ultralytics.com/reference/data/dataset/" rel="canonical"/><link href="../converter/" rel="prev"/><link href="../loaders/" rel="next"/><link href="/" hreflang="en" rel="alternate"/><link href="/zh/" hreflang="zh" rel="alternate"/><link href="/ko/" hreflang="ko" rel="alternate"/><link href="/ja/" hreflang="ja" rel="alternate"/><link href="/ru/" hreflang="ru" rel="alternate"/><link href="/de/" hreflang="de" rel="alternate"/><link href="/fr/" hreflang="fr" rel="alternate"/><link href="/es/" hreflang="es" rel="alternate"/><link href="/pt/" hreflang="pt" rel="alternate"/><link href="/it/" hreflang="it" rel="alternate"/><link href="/tr/" hreflang="tr" rel="alternate"/><link href="/vi/" hreflang="vi" rel="alternate"/><link href="/ar/" hreflang="ar" rel="alternate"/><link href="https://raw.githubusercontent.com/ultralytics/assets/refs/heads/main/logo/favicon-yolo.png" rel="icon"/><meta content="zensical-0.0.10" name="generator"/><title>Reference for ultralytics/data/dataset.py - Ultralytics YOLO Docs</title><link href="../../../assets/stylesheets/modern/main.eafc6f7f.min.css" rel="stylesheet"/><link href="../../../assets/stylesheets/modern/palette.dfe2e883.min.css" rel="stylesheet"/><style>:root{}</style><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,500,500i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link href="../../../stylesheets/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)),0),__md_get=(e,t=localStorage,a=__md_scope)=>JSON.parse(t.getItem(a.pathname+"."+e)),__md_set=(e,t,a=localStorage,_=__md_scope)=>{try{a.setItem(_.pathname+"."+e,JSON.stringify(t))}catch(e){}},document.documentElement.setAttribute("data-platform",navigator.platform)</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2M5EHKC0BH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2M5EHKC0BH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2M5EHKC0BH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
<style data-doc-kind="true">.doc-kind{display:inline-flex;align-items:center;gap:0.25em;padding:0.21em 0.59em;border-radius:999px;font-weight:700;font-size:0.81em;letter-spacing:0.06em;text-transform:uppercase;line-height:1;color:var(--doc-kind-color,#f8fafc);background:var(--doc-kind-bg,rgba(255,255,255,0.12));}.doc-kind-class{--doc-kind-color:#039dfc;--doc-kind-bg:rgba(3,157,252,0.22);}.doc-kind-function{--doc-kind-color:#fc9803;--doc-kind-bg:rgba(252,152,3,0.22);}.doc-kind-method{--doc-kind-color:#ef5eff;--doc-kind-bg:rgba(239,94,255,0.22);}.doc-kind-property{--doc-kind-color:#02e835;--doc-kind-bg:rgba(2,232,53,0.22);}</style><meta content="Reference for ultralytics/data/dataset.py" name="title"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"/><meta content="website" property="og:type"/><meta content="https://docs.ultralytics.com/reference/data/dataset/" property="og:url"/><meta content="Reference for ultralytics/data/dataset.py" property="og:title"/><meta content="" property="og:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="og:image"/><meta content="summary_large_image" property="twitter:card"/><meta content="https://docs.ultralytics.com/reference/data/dataset/" property="twitter:url"/><meta content="Reference for ultralytics/data/dataset.py" property="twitter:title"/><meta content="" property="twitter:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="twitter:image"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "headline": "Reference for ultralytics/data/dataset.py", "image": ["https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png"], "datePublished": "2023-11-12 02:49:37 +0100", "dateModified": "2025-11-23 19:53:50 +0100", "author": [{"@type": "Organization", "name": "Ultralytics", "url": "https://ultralytics.com/"}], "abstract": ""}</script></head><body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr"><input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/><input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/><label class="md-overlay" for="__drawer"></label><div data-md-component="skip"><a class="md-skip" href="#reference-for-ultralyticsdatadatasetpy"> Skip to content </a></div><div data-md-component="announce"><aside class="md-banner"><div class="md-banner__inner md-grid md-typeset"><a class="banner-wrapper" href="https://www.ultralytics.com/news/ultralytics-raises-30m-series-a" target="_blank"><div class="banner-content-wrapper"><img alt="Ultralytics raises $30M Series A" height="40" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac336b5de2ae8b398bca_writting.svg"/><div class="vc-wrapper"><img alt="Elephant" height="28" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac33c95408144846afc7_image%201.png"/><img alt="SquareOne" height="28" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac3333068d9632cc6df8_image%202.png"/></div></div></a></div></aside></div><header class="md-header md-header--shadow md-header--lifted" data-md-component="header"><nav aria-label="Header" class="md-header__inner md-grid"><a aria-label="Ultralytics YOLO Docs" class="md-header__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs"><img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/></a><label class="md-header__button md-icon" for="__drawer"><svg class="lucide lucide-menu" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 5h16M4 12h16M4 19h16"></path></svg></label><div class="md-header__title" data-md-component="header-title"><div class="md-header__ellipsis"><div class="md-header__topic"><span class="md-ellipsis"> Ultralytics YOLO Docs </span></div><div class="md-header__topic" data-md-component="header-topic"><span class="md-ellipsis"> Reference for ultralytics/data/dataset.py </span></div></div></div><form class="md-header__option" data-md-component="palette"><input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg></label><input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to system preference"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label><input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label></form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<div class="md-header__option"><div class="md-select"><button aria-label="Select language" class="md-header__button md-icon"><svg class="lucide lucide-languages" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m5 8 6 6M4 14l6-6 2-3M2 5h12M7 2h1M22 22l-5-10-5 10M14 18h6"></path></svg></button><div class="md-select__inner"><ul class="md-select__list"><li class="md-select__item"><a class="md-select__link" href="/" hreflang="en"> ğŸ‡¬ğŸ‡§ English </a></li><li class="md-select__item"><a class="md-select__link" href="/zh/" hreflang="zh"> ğŸ‡¨ğŸ‡³ ç®€ä½“ä¸­æ–‡ </a></li><li class="md-select__item"><a class="md-select__link" href="/ko/" hreflang="ko"> ğŸ‡°ğŸ‡· í•œêµ­ì–´ </a></li><li class="md-select__item"><a class="md-select__link" href="/ja/" hreflang="ja"> ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª </a></li><li class="md-select__item"><a class="md-select__link" href="/ru/" hreflang="ru"> ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹ </a></li><li class="md-select__item"><a class="md-select__link" href="/de/" hreflang="de"> ğŸ‡©ğŸ‡ª Deutsch </a></li><li class="md-select__item"><a class="md-select__link" href="/fr/" hreflang="fr"> ğŸ‡«ğŸ‡· FranÃ§ais </a></li><li class="md-select__item"><a class="md-select__link" href="/es/" hreflang="es"> ğŸ‡ªğŸ‡¸ EspaÃ±ol </a></li><li class="md-select__item"><a class="md-select__link" href="/pt/" hreflang="pt"> ğŸ‡µğŸ‡¹ PortuguÃªs </a></li><li class="md-select__item"><a class="md-select__link" href="/it/" hreflang="it"> ğŸ‡®ğŸ‡¹ Italiano </a></li><li class="md-select__item"><a class="md-select__link" href="/tr/" hreflang="tr"> ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e </a></li><li class="md-select__item"><a class="md-select__link" href="/vi/" hreflang="vi"> ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t </a></li><li class="md-select__item"><a class="md-select__link" href="/ar/" hreflang="ar"> ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© </a></li></ul></div></div></div><label class="md-header__button md-icon" for="__search"><svg class="lucide lucide-search" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m21 21-4.34-4.34"></path><circle cx="11" cy="11" r="8"></circle></svg></label><div aria-label="Search" class="md-search" data-md-component="search" role="dialog"><button class="md-search__button" type="button"> Search </button></div><div class="md-header__source"><a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository"><div class="md-source__icon md-icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></div><div class="md-source__repository"> ultralytics/ultralytics </div></a></div></nav><nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"><div class="md-grid"><ul class="md-tabs__list"><li class="md-tabs__item"><a class="md-tabs__link" href="../../.."> Home </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../quickstart/"> Quickstart </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../modes/"> Modes </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../tasks/"> Tasks </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../models/"> Models </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../datasets/"> Datasets </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../solutions/"> Solutions </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../guides/"> Guides </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../integrations/"> Integrations </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../hub/"> HUB </a></li><li class="md-tabs__item md-tabs__item--active"><a class="md-tabs__link" href="../../__init__/"> Reference </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../help/"> Help </a></li></ul></div></nav></header><div class="md-container" data-md-component="container"><main class="md-main" data-md-component="main"><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0"><label class="md-nav__title" for="__drawer"><a aria-label="Ultralytics YOLO Docs" class="md-nav__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs"><img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/></a> Ultralytics YOLO Docs </label><div class="md-nav__source"><a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository"><div class="md-source__icon md-icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></div><div class="md-source__repository"> ultralytics/ultralytics </div></a></div><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../.."><span class="md-ellipsis"> Home </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../quickstart/"><span class="md-ellipsis"> Quickstart </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../modes/"><span class="md-ellipsis"> Modes </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../tasks/"><span class="md-ellipsis"> Tasks </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../models/"><span class="md-ellipsis"> Models </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../datasets/"><span class="md-ellipsis"> Datasets </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../solutions/"><span class="md-ellipsis"> Solutions </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../guides/"><span class="md-ellipsis"> Guides </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../integrations/"><span class="md-ellipsis"> Integrations </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../hub/"><span class="md-ellipsis"> HUB </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input checked="" class="md-nav__toggle md-toggle" id="__nav_11" type="checkbox"/><label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex=""><span class="md-ellipsis"> Reference </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="true" aria-labelledby="__nav_11_label" class="md-nav" data-md-level="1"><label class="md-nav__title" for="__nav_11"><span class="md-nav__icon md-icon"></span> Reference </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_2" type="checkbox"/><label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex=""><span class="md-ellipsis"> cfg </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_2_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_2"><span class="md-nav__icon md-icon"></span> cfg </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../cfg/__init__/"><span class="md-ellipsis"> __init__ </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input checked="" class="md-nav__toggle md-toggle" id="__nav_11_3" type="checkbox"/><label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex=""><span class="md-ellipsis"> data </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="true" aria-labelledby="__nav_11_3_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_3"><span class="md-nav__icon md-icon"></span> data </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../annotator/"><span class="md-ellipsis"> annotator </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../augment/"><span class="md-ellipsis"> augment </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../base/"><span class="md-ellipsis"> base </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../build/"><span class="md-ellipsis"> build </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../converter/"><span class="md-ellipsis"> converter </span></a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/><label class="md-nav__link md-nav__link--active" for="__toc"><span class="md-ellipsis"> dataset </span><span class="md-nav__icon md-icon"></span></label><a class="md-nav__link md-nav__link--active" href="./"><span class="md-ellipsis"> dataset </span></a><nav aria-label="On this page" class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc"><span class="md-nav__icon md-icon"></span> On this page </label><ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLODataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> YOLODataset</span></a><nav aria-label="Class ultralytics.data.dataset.YOLODataset" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLODataset.build_transforms"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> build_transforms</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLODataset.cache_labels"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> cache_labels</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLODataset.close_mosaic"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> close_mosaic</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLODataset.collate_fn"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> collate_fn</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLODataset.get_labels"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> get_labels</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLODataset.update_labels_info"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> update_labels_info</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOMultiModalDataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> YOLOMultiModalDataset</span></a><nav aria-label="Class ultralytics.data.dataset.YOLOMultiModalDataset" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOMultiModalDataset.category_names"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> category_names</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOMultiModalDataset.category_freq"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> category_freq</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOMultiModalDataset._get_neg_texts"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> _get_neg_texts</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOMultiModalDataset.build_transforms"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> build_transforms</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOMultiModalDataset.update_labels_info"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> update_labels_info</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> GroundingDataset</span></a><nav aria-label="Class ultralytics.data.dataset.GroundingDataset" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset.category_names"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> category_names</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset.category_freq"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> category_freq</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset._get_neg_texts"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> _get_neg_texts</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset.build_transforms"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> build_transforms</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset.cache_labels"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> cache_labels</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset.get_img_files"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> get_img_files</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset.get_labels"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> get_labels</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset.verify_labels"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> verify_labels</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOConcatDataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> YOLOConcatDataset</span></a><nav aria-label="Class ultralytics.data.dataset.YOLOConcatDataset" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOConcatDataset.close_mosaic"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> close_mosaic</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOConcatDataset.collate_fn"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> collate_fn</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.SemanticDataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> SemanticDataset</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.ClassificationDataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> ClassificationDataset</span></a><nav aria-label="Class ultralytics.data.dataset.ClassificationDataset" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.ClassificationDataset.__getitem__"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> __getitem__</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.ClassificationDataset.__len__"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> __len__</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.ClassificationDataset.verify_images"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> verify_images</span></a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="../loaders/"><span class="md-ellipsis"> loaders </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../split/"><span class="md-ellipsis"> split </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../split_dota/"><span class="md-ellipsis"> split_dota </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../utils/"><span class="md-ellipsis"> utils </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_4" type="checkbox"/><label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex=""><span class="md-ellipsis"> engine </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_4_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_4"><span class="md-nav__icon md-icon"></span> engine </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../engine/exporter/"><span class="md-ellipsis"> exporter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/model/"><span class="md-ellipsis"> model </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/predictor/"><span class="md-ellipsis"> predictor </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/results/"><span class="md-ellipsis"> results </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/trainer/"><span class="md-ellipsis"> trainer </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/tuner/"><span class="md-ellipsis"> tuner </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../engine/validator/"><span class="md-ellipsis"> validator </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_5" type="checkbox"/><label class="md-nav__link" for="__nav_11_5" id="__nav_11_5_label" tabindex=""><span class="md-ellipsis"> hub </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_5_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_5"><span class="md-nav__icon md-icon"></span> hub </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../hub/__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/auth/"><span class="md-ellipsis"> auth </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../hub/google/__init__/"><span class="md-ellipsis"> google </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/session/"><span class="md-ellipsis"> session </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/utils/"><span class="md-ellipsis"> utils </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_6" type="checkbox"/><label class="md-nav__link" for="__nav_11_6" id="__nav_11_6_label" tabindex=""><span class="md-ellipsis"> models </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_6_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_6"><span class="md-nav__icon md-icon"></span> models </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/fastsam/model/"><span class="md-ellipsis"> fastsam </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/nas/model/"><span class="md-ellipsis"> nas </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/rtdetr/model/"><span class="md-ellipsis"> rtdetr </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/sam/amg/"><span class="md-ellipsis"> sam </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/utils/loss/"><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/yolo/classify/predict/"><span class="md-ellipsis"> yolo </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_7" type="checkbox"/><label class="md-nav__link" for="__nav_11_7" id="__nav_11_7_label" tabindex=""><span class="md-ellipsis"> nn </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_7_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_7"><span class="md-nav__icon md-icon"></span> nn </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../nn/autobackend/"><span class="md-ellipsis"> autobackend </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../nn/modules/activation/"><span class="md-ellipsis"> modules </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../nn/tasks/"><span class="md-ellipsis"> tasks </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../nn/text_model/"><span class="md-ellipsis"> text_model </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_8" type="checkbox"/><label class="md-nav__link" for="__nav_11_8" id="__nav_11_8_label" tabindex=""><span class="md-ellipsis"> solutions </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_8_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_8"><span class="md-nav__icon md-icon"></span> solutions </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/ai_gym/"><span class="md-ellipsis"> ai_gym </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/analytics/"><span class="md-ellipsis"> analytics </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/config/"><span class="md-ellipsis"> config </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/distance_calculation/"><span class="md-ellipsis"> distance_calculation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/heatmap/"><span class="md-ellipsis"> heatmap </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/instance_segmentation/"><span class="md-ellipsis"> instance_segmentation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_blurrer/"><span class="md-ellipsis"> object_blurrer </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_counter/"><span class="md-ellipsis"> object_counter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_cropper/"><span class="md-ellipsis"> object_cropper </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/parking_management/"><span class="md-ellipsis"> parking_management </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/queue_management/"><span class="md-ellipsis"> queue_management </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/region_counter/"><span class="md-ellipsis"> region_counter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/security_alarm/"><span class="md-ellipsis"> security_alarm </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/similarity_search/"><span class="md-ellipsis"> similarity_search </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/solutions/"><span class="md-ellipsis"> solutions </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/speed_estimation/"><span class="md-ellipsis"> speed_estimation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/streamlit_inference/"><span class="md-ellipsis"> streamlit_inference </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/trackzone/"><span class="md-ellipsis"> trackzone </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/vision_eye/"><span class="md-ellipsis"> vision_eye </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_9" type="checkbox"/><label class="md-nav__link" for="__nav_11_9" id="__nav_11_9_label" tabindex=""><span class="md-ellipsis"> trackers </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_9_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_9"><span class="md-nav__icon md-icon"></span> trackers </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/basetrack/"><span class="md-ellipsis"> basetrack </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/bot_sort/"><span class="md-ellipsis"> bot_sort </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/byte_tracker/"><span class="md-ellipsis"> byte_tracker </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/track/"><span class="md-ellipsis"> track </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../trackers/utils/gmc/"><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_10" type="checkbox"/><label class="md-nav__link" for="__nav_11_10" id="__nav_11_10_label" tabindex=""><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_10_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_10"><span class="md-nav__icon md-icon"></span> utils </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../utils/__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/autobatch/"><span class="md-ellipsis"> autobatch </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/autodevice/"><span class="md-ellipsis"> autodevice </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/benchmarks/"><span class="md-ellipsis"> benchmarks </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../utils/callbacks/base/"><span class="md-ellipsis"> callbacks </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/checks/"><span class="md-ellipsis"> checks </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/cpu/"><span class="md-ellipsis"> cpu </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/dist/"><span class="md-ellipsis"> dist </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/downloads/"><span class="md-ellipsis"> downloads </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/errors/"><span class="md-ellipsis"> errors </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/events/"><span class="md-ellipsis"> events </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../utils/export/engine/"><span class="md-ellipsis"> export </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/files/"><span class="md-ellipsis"> files </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/git/"><span class="md-ellipsis"> git </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/instance/"><span class="md-ellipsis"> instance </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/logger/"><span class="md-ellipsis"> logger </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/loss/"><span class="md-ellipsis"> loss </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/metrics/"><span class="md-ellipsis"> metrics </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/nms/"><span class="md-ellipsis"> nms </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/ops/"><span class="md-ellipsis"> ops </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/patches/"><span class="md-ellipsis"> patches </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/plotting/"><span class="md-ellipsis"> plotting </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/tal/"><span class="md-ellipsis"> tal </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/torch_utils/"><span class="md-ellipsis"> torch_utils </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/tqdm/"><span class="md-ellipsis"> tqdm </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/triton/"><span class="md-ellipsis"> triton </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/tuner/"><span class="md-ellipsis"> tuner </span></a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../help/"><span class="md-ellipsis"> Help </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav aria-label="On this page" class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc"><span class="md-nav__icon md-icon"></span> On this page </label><ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLODataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> YOLODataset</span></a><nav aria-label="Class ultralytics.data.dataset.YOLODataset" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLODataset.build_transforms"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> build_transforms</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLODataset.cache_labels"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> cache_labels</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLODataset.close_mosaic"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> close_mosaic</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLODataset.collate_fn"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> collate_fn</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLODataset.get_labels"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> get_labels</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLODataset.update_labels_info"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> update_labels_info</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOMultiModalDataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> YOLOMultiModalDataset</span></a><nav aria-label="Class ultralytics.data.dataset.YOLOMultiModalDataset" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOMultiModalDataset.category_names"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> category_names</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOMultiModalDataset.category_freq"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> category_freq</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOMultiModalDataset._get_neg_texts"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> _get_neg_texts</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOMultiModalDataset.build_transforms"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> build_transforms</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOMultiModalDataset.update_labels_info"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> update_labels_info</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> GroundingDataset</span></a><nav aria-label="Class ultralytics.data.dataset.GroundingDataset" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset.category_names"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> category_names</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset.category_freq"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> category_freq</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset._get_neg_texts"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> _get_neg_texts</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset.build_transforms"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> build_transforms</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset.cache_labels"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> cache_labels</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset.get_img_files"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> get_img_files</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset.get_labels"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> get_labels</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.GroundingDataset.verify_labels"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> verify_labels</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOConcatDataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> YOLOConcatDataset</span></a><nav aria-label="Class ultralytics.data.dataset.YOLOConcatDataset" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOConcatDataset.close_mosaic"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> close_mosaic</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.YOLOConcatDataset.collate_fn"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> collate_fn</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.SemanticDataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> SemanticDataset</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.ClassificationDataset"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> ClassificationDataset</span></a><nav aria-label="Class ultralytics.data.dataset.ClassificationDataset" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.ClassificationDataset.__getitem__"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> __getitem__</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.ClassificationDataset.__len__"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> __len__</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.data.dataset.ClassificationDataset.verify_images"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> verify_images</span></a></li></ul></nav></li></ul></nav></div></div></div><div class="md-content" data-md-component="content"><article class="md-content__inner md-typeset"><a class="md-content__button md-icon" href="https://github.com/ultralytics/ultralytics/tree/main/docs/en/reference/data/dataset.md" rel="edit" title="Edit this page"><svg class="lucide lucide-file-pen" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5"></path><path d="M14 2v4a2 2 0 0 0 2 2h4M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z"></path></svg></a><h1 id="reference-for-ultralyticsdatadatasetpy">Reference for <code>ultralytics/data/dataset.py</code></h1><div class="admonition success"><p class="admonition-title">Improvements</p><p>This page is sourced from <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py">https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py</a>. Have an improvement or example to add? Open a <a href="https://docs.ultralytics.com/help/contributing/">Pull Request</a> â€” thank you! ğŸ™</p></div><p><br/></p><div class="admonition abstract"><p class="admonition-title">Summary</p><div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="classes" name="__tabbed_1" type="radio"/><input id="properties" name="__tabbed_1" type="radio"/><input id="methods" name="__tabbed_1" type="radio"/><div class="tabbed-labels"><label for="classes"><span class="doc-kind doc-kind-class">Classes</span></label><label for="properties"><span class="doc-kind doc-kind-property">Properties</span></label><label for="methods"><span class="doc-kind doc-kind-method">Methods</span></label></div><div class="tabbed-content"><div class="tabbed-block"><ul><li><a href="#ultralytics.data.dataset.YOLODataset"><code>YOLODataset</code></a></li><li><a href="#ultralytics.data.dataset.YOLOMultiModalDataset"><code>YOLOMultiModalDataset</code></a></li><li><a href="#ultralytics.data.dataset.GroundingDataset"><code>GroundingDataset</code></a></li><li><a href="#ultralytics.data.dataset.YOLOConcatDataset"><code>YOLOConcatDataset</code></a></li><li><a href="#ultralytics.data.dataset.SemanticDataset"><code>SemanticDataset</code></a></li><li><a href="#ultralytics.data.dataset.ClassificationDataset"><code>ClassificationDataset</code></a></li></ul></div><div class="tabbed-block"><ul><li><a href="#ultralytics.data.dataset.YOLOMultiModalDataset.category_names"><code>YOLOMultiModalDataset.category_names</code></a></li><li><a href="#ultralytics.data.dataset.YOLOMultiModalDataset.category_freq"><code>YOLOMultiModalDataset.category_freq</code></a></li><li><a href="#ultralytics.data.dataset.GroundingDataset.category_names"><code>GroundingDataset.category_names</code></a></li><li><a href="#ultralytics.data.dataset.GroundingDataset.category_freq"><code>GroundingDataset.category_freq</code></a></li></ul></div><div class="tabbed-block"><ul><li><a href="#ultralytics.data.dataset.YOLODataset.cache_labels"><code>YOLODataset.cache_labels</code></a></li><li><a href="#ultralytics.data.dataset.YOLODataset.get_labels"><code>YOLODataset.get_labels</code></a></li><li><a href="#ultralytics.data.dataset.YOLODataset.build_transforms"><code>YOLODataset.build_transforms</code></a></li><li><a href="#ultralytics.data.dataset.YOLODataset.close_mosaic"><code>YOLODataset.close_mosaic</code></a></li><li><a href="#ultralytics.data.dataset.YOLODataset.update_labels_info"><code>YOLODataset.update_labels_info</code></a></li><li><a href="#ultralytics.data.dataset.YOLODataset.collate_fn"><code>YOLODataset.collate_fn</code></a></li><li><a href="#ultralytics.data.dataset.YOLOMultiModalDataset.update_labels_info"><code>YOLOMultiModalDataset.update_labels_info</code></a></li><li><a href="#ultralytics.data.dataset.YOLOMultiModalDataset.build_transforms"><code>YOLOMultiModalDataset.build_transforms</code></a></li><li><a href="#ultralytics.data.dataset.YOLOMultiModalDataset._get_neg_texts"><code>YOLOMultiModalDataset._get_neg_texts</code></a></li><li><a href="#ultralytics.data.dataset.GroundingDataset.get_img_files"><code>GroundingDataset.get_img_files</code></a></li><li><a href="#ultralytics.data.dataset.GroundingDataset.verify_labels"><code>GroundingDataset.verify_labels</code></a></li><li><a href="#ultralytics.data.dataset.GroundingDataset.cache_labels"><code>GroundingDataset.cache_labels</code></a></li><li><a href="#ultralytics.data.dataset.GroundingDataset.get_labels"><code>GroundingDataset.get_labels</code></a></li><li><a href="#ultralytics.data.dataset.GroundingDataset.build_transforms"><code>GroundingDataset.build_transforms</code></a></li><li><a href="#ultralytics.data.dataset.GroundingDataset._get_neg_texts"><code>GroundingDataset._get_neg_texts</code></a></li><li><a href="#ultralytics.data.dataset.YOLOConcatDataset.collate_fn"><code>YOLOConcatDataset.collate_fn</code></a></li><li><a href="#ultralytics.data.dataset.YOLOConcatDataset.close_mosaic"><code>YOLOConcatDataset.close_mosaic</code></a></li><li><a href="#ultralytics.data.dataset.ClassificationDataset.__getitem__"><code>ClassificationDataset.__getitem__</code></a></li><li><a href="#ultralytics.data.dataset.ClassificationDataset.__len__"><code>ClassificationDataset.__len__</code></a></li><li><a href="#ultralytics.data.dataset.ClassificationDataset.verify_images"><code>ClassificationDataset.verify_images</code></a></li></ul></div></div></div></div><h2 id="ultralytics.data.dataset.YOLODataset"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.data.dataset.YOLODataset</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">YOLODataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"detect"</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div><p><strong>Bases:</strong> <code>BaseDataset</code></p><p>Dataset class for loading object detection and/or segmentation labels in YOLO format.</p><p>This class supports loading data for object detection, segmentation, pose estimation, and oriented bounding box (OBB) tasks using the YOLO format.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>data</code></td><td><code>dict, optional</code></td><td>Dataset configuration dictionary.</td><td><code>None</code></td></tr><tr><td><code>task</code></td><td><code>str</code></td><td>Task type, one of 'detect', 'segment', 'pose', or 'obb'.</td><td><code>"detect"</code></td></tr><tr><td><code>*args</code></td><td><code>Any</code></td><td>Additional positional arguments for the parent class.</td><td><em>required</em></td></tr><tr><td><code>**kwargs</code></td><td><code>Any</code></td><td>Additional keyword arguments for the parent class.</td><td><em>required</em></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>use_segments</code></td><td><code>bool</code></td><td>Indicates if segmentation masks should be used.</td></tr><tr><td><code>use_keypoints</code></td><td><code>bool</code></td><td>Indicates if keypoints should be used for pose estimation.</td></tr><tr><td><code>use_obb</code></td><td><code>bool</code></td><td>Indicates if oriented bounding boxes should be used.</td></tr><tr><td><code>data</code></td><td><code>dict</code></td><td>Dataset configuration dictionary.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.data.dataset.YOLODataset.build_transforms"><code>build_transforms</code></a></td><td>Build and append transforms to the list.</td></tr><tr><td><a href="#ultralytics.data.dataset.YOLODataset.cache_labels"><code>cache_labels</code></a></td><td>Cache dataset labels, check images and read shapes.</td></tr><tr><td><a href="#ultralytics.data.dataset.YOLODataset.close_mosaic"><code>close_mosaic</code></a></td><td>Disable mosaic, copy_paste, mixup and cutmix augmentations by setting their probabilities to 0.0.</td></tr><tr><td><a href="#ultralytics.data.dataset.YOLODataset.collate_fn"><code>collate_fn</code></a></td><td>Collate data samples into batches.</td></tr><tr><td><a href="#ultralytics.data.dataset.YOLODataset.get_labels"><code>get_labels</code></a></td><td>Return dictionary of labels for YOLO training.</td></tr><tr><td><a href="#ultralytics.data.dataset.YOLODataset.update_labels_info"><code>update_labels_info</code></a></td><td>Update label format for different tasks.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">YOLODataset</span><span class="p">(</span><span class="n">img_path</span><span class="o">=</span><span class="s2">"path/to/images"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"names"</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">"person"</span><span class="p">}},</span> <span class="n">task</span><span class="o">=</span><span class="s2">"detect"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L49-L308"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">YOLODataset</span><span class="p">(</span><span class="n">BaseDataset</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Dataset class for loading object detection and/or segmentation labels in YOLO format.</span>
<span></span>
<span></span><span class="sd">    This class supports loading data for object detection, segmentation, pose estimation, and oriented bounding box</span>
<span></span><span class="sd">    (OBB) tasks using the YOLO format.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        use_segments (bool): Indicates if segmentation masks should be used.</span>
<span></span><span class="sd">        use_keypoints (bool): Indicates if keypoints should be used for pose estimation.</span>
<span></span><span class="sd">        use_obb (bool): Indicates if oriented bounding boxes should be used.</span>
<span></span><span class="sd">        data (dict): Dataset configuration dictionary.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        cache_labels: Cache dataset labels, check images and read shapes.</span>
<span></span><span class="sd">        get_labels: Return dictionary of labels for YOLO training.</span>
<span></span><span class="sd">        build_transforms: Build and append transforms to the list.</span>
<span></span><span class="sd">        close_mosaic: Set mosaic, copy_paste and mixup options to 0.0 and build transformations.</span>
<span></span><span class="sd">        update_labels_info: Update label format for different tasks.</span>
<span></span><span class="sd">        collate_fn: Collate data samples into batches.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; dataset = YOLODataset(img_path="path/to/images", data={"names": {0: "person"}}, task="detect")</span>
<span></span><span class="sd">        &gt;&gt;&gt; dataset.get_labels()</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"detect"</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize the YOLODataset.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            data (dict, optional): Dataset configuration dictionary.</span>
<span></span><span class="sd">            task (str): Task type, one of 'detect', 'segment', 'pose', or 'obb'.</span>
<span></span><span class="sd">            *args (Any): Additional positional arguments for the parent class.</span>
<span></span><span class="sd">            **kwargs (Any): Additional keyword arguments for the parent class.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">use_segments</span> <span class="o">=</span> <span class="n">task</span> <span class="o">==</span> <span class="s2">"segment"</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">use_keypoints</span> <span class="o">=</span> <span class="n">task</span> <span class="o">==</span> <span class="s2">"pose"</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">use_obb</span> <span class="o">=</span> <span class="n">task</span> <span class="o">==</span> <span class="s2">"obb"</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
<span></span>        <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_segments</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_keypoints</span><span class="p">),</span> <span class="s2">"Can not use both segments and keypoints."</span>
<span></span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"channels"</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.YOLODataset.build_transforms"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.YOLODataset.build_transforms</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">build_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Compose</span>
</code></pre></div><p>Build and append transforms to the list.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>hyp</code></td><td><code>dict, optional</code></td><td>Hyperparameters for transforms.</td><td><code>None</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Compose</code></td><td>Composed transforms.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L206-L235"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">build_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Compose</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Build and append transforms to the list.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        hyp (dict, optional): Hyperparameters for transforms.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Compose): Composed transforms.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">augment</span><span class="p">:</span>
<span></span>        <span class="n">hyp</span><span class="o">.</span><span class="n">mosaic</span> <span class="o">=</span> <span class="n">hyp</span><span class="o">.</span><span class="n">mosaic</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">augment</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="k">else</span> <span class="mf">0.0</span>
<span></span>        <span class="n">hyp</span><span class="o">.</span><span class="n">mixup</span> <span class="o">=</span> <span class="n">hyp</span><span class="o">.</span><span class="n">mixup</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">augment</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="k">else</span> <span class="mf">0.0</span>
<span></span>        <span class="n">hyp</span><span class="o">.</span><span class="n">cutmix</span> <span class="o">=</span> <span class="n">hyp</span><span class="o">.</span><span class="n">cutmix</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">augment</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="k">else</span> <span class="mf">0.0</span>
<span></span>        <span class="n">transforms</span> <span class="o">=</span> <span class="n">v8_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imgsz</span><span class="p">,</span> <span class="n">hyp</span><span class="p">)</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="n">transforms</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">([</span><span class="n">LetterBox</span><span class="p">(</span><span class="n">new_shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imgsz</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imgsz</span><span class="p">),</span> <span class="n">scaleup</span><span class="o">=</span><span class="kc">False</span><span class="p">)])</span>
<span></span>    <span class="n">transforms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<span></span>        <span class="n">Format</span><span class="p">(</span>
<span></span>            <span class="n">bbox_format</span><span class="o">=</span><span class="s2">"xywh"</span><span class="p">,</span>
<span></span>            <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span></span>            <span class="n">return_mask</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_segments</span><span class="p">,</span>
<span></span>            <span class="n">return_keypoint</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_keypoints</span><span class="p">,</span>
<span></span>            <span class="n">return_obb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_obb</span><span class="p">,</span>
<span></span>            <span class="n">batch_idx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span></span>            <span class="n">mask_ratio</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">mask_ratio</span><span class="p">,</span>
<span></span>            <span class="n">mask_overlap</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">overlap_mask</span><span class="p">,</span>
<span></span>            <span class="n">bgr</span><span class="o">=</span><span class="n">hyp</span><span class="o">.</span><span class="n">bgr</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">augment</span> <span class="k">else</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># only affect training.</span>
<span></span>        <span class="p">)</span>
<span></span>    <span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">transforms</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.YOLODataset.cache_labels"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.YOLODataset.cache_labels</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cache_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"./labels.cache"</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div><p>Cache dataset labels, check images and read shapes.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>path</code></td><td><code>Path</code></td><td>Path where to save the cache file.</td><td><code>Path("./labels.cache")</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>dict</code></td><td>Dictionary containing cached labels and related information.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L90-L155"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cache_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"./labels.cache"</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Cache dataset labels, check images and read shapes.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        path (Path): Path where to save the cache file.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): Dictionary containing cached labels and related information.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">x</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"labels"</span><span class="p">:</span> <span class="p">[]}</span>
<span></span>    <span class="n">nm</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">ne</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">msgs</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[]</span>  <span class="c1"># number missing, found, empty, corrupt, messages</span>
<span></span>    <span class="n">desc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="si">}</span><span class="s2">Scanning </span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">path</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">..."</span>
<span></span>    <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_files</span><span class="p">)</span>
<span></span>    <span class="n">nkpt</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"kpt_shape"</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_keypoints</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nkpt</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ndim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">}):</span>
<span></span>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span></span>            <span class="s2">"'kpt_shape' in data.yaml missing or incorrect. Should be a list with [number of "</span>
<span></span>            <span class="s2">"keypoints, number of dims (2 for x,y or 3 for x,y,visible)], i.e. 'kpt_shape: [17, 3]'"</span>
<span></span>        <span class="p">)</span>
<span></span>    <span class="k">with</span> <span class="n">ThreadPool</span><span class="p">(</span><span class="n">NUM_THREADS</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
<span></span>        <span class="n">results</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">imap</span><span class="p">(</span>
<span></span>            <span class="n">func</span><span class="o">=</span><span class="n">verify_image_label</span><span class="p">,</span>
<span></span>            <span class="n">iterable</span><span class="o">=</span><span class="nb">zip</span><span class="p">(</span>
<span></span>                <span class="bp">self</span><span class="o">.</span><span class="n">im_files</span><span class="p">,</span>
<span></span>                <span class="bp">self</span><span class="o">.</span><span class="n">label_files</span><span class="p">,</span>
<span></span>                <span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="p">),</span>
<span></span>                <span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_keypoints</span><span class="p">),</span>
<span></span>                <span class="n">repeat</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">"names"</span><span class="p">])),</span>
<span></span>                <span class="n">repeat</span><span class="p">(</span><span class="n">nkpt</span><span class="p">),</span>
<span></span>                <span class="n">repeat</span><span class="p">(</span><span class="n">ndim</span><span class="p">),</span>
<span></span>                <span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">single_cls</span><span class="p">),</span>
<span></span>            <span class="p">),</span>
<span></span>        <span class="p">)</span>
<span></span>        <span class="n">pbar</span> <span class="o">=</span> <span class="n">TQDM</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">)</span>
<span></span>        <span class="k">for</span> <span class="n">im_file</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">keypoint</span><span class="p">,</span> <span class="n">nm_f</span><span class="p">,</span> <span class="n">nf_f</span><span class="p">,</span> <span class="n">ne_f</span><span class="p">,</span> <span class="n">nc_f</span><span class="p">,</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
<span></span>            <span class="n">nm</span> <span class="o">+=</span> <span class="n">nm_f</span>
<span></span>            <span class="n">nf</span> <span class="o">+=</span> <span class="n">nf_f</span>
<span></span>            <span class="n">ne</span> <span class="o">+=</span> <span class="n">ne_f</span>
<span></span>            <span class="n">nc</span> <span class="o">+=</span> <span class="n">nc_f</span>
<span></span>            <span class="k">if</span> <span class="n">im_file</span><span class="p">:</span>
<span></span>                <span class="n">x</span><span class="p">[</span><span class="s2">"labels"</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<span></span>                    <span class="p">{</span>
<span></span>                        <span class="s2">"im_file"</span><span class="p">:</span> <span class="n">im_file</span><span class="p">,</span>
<span></span>                        <span class="s2">"shape"</span><span class="p">:</span> <span class="n">shape</span><span class="p">,</span>
<span></span>                        <span class="s2">"cls"</span><span class="p">:</span> <span class="n">lb</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># n, 1</span>
<span></span>                        <span class="s2">"bboxes"</span><span class="p">:</span> <span class="n">lb</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span>  <span class="c1"># n, 4</span>
<span></span>                        <span class="s2">"segments"</span><span class="p">:</span> <span class="n">segments</span><span class="p">,</span>
<span></span>                        <span class="s2">"keypoints"</span><span class="p">:</span> <span class="n">keypoint</span><span class="p">,</span>
<span></span>                        <span class="s2">"normalized"</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span></span>                        <span class="s2">"bbox_format"</span><span class="p">:</span> <span class="s2">"xywh"</span><span class="p">,</span>
<span></span>                    <span class="p">}</span>
<span></span>                <span class="p">)</span>
<span></span>            <span class="k">if</span> <span class="n">msg</span><span class="p">:</span>
<span></span>                <span class="n">msgs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span></span>            <span class="n">pbar</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">desc</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">nf</span><span class="si">}</span><span class="s2"> images, </span><span class="si">{</span><span class="n">nm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ne</span><span class="si">}</span><span class="s2"> backgrounds, </span><span class="si">{</span><span class="n">nc</span><span class="si">}</span><span class="s2"> corrupt"</span>
<span></span>        <span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="n">msgs</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">msgs</span><span class="p">))</span>
<span></span>    <span class="k">if</span> <span class="n">nf</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="si">}</span><span class="s2">No labels found in </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">HELP_URL</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>    <span class="n">x</span><span class="p">[</span><span class="s2">"hash"</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_files</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">im_files</span><span class="p">)</span>
<span></span>    <span class="n">x</span><span class="p">[</span><span class="s2">"results"</span><span class="p">]</span> <span class="o">=</span> <span class="n">nf</span><span class="p">,</span> <span class="n">nm</span><span class="p">,</span> <span class="n">ne</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_files</span><span class="p">)</span>
<span></span>    <span class="n">x</span><span class="p">[</span><span class="s2">"msgs"</span><span class="p">]</span> <span class="o">=</span> <span class="n">msgs</span>  <span class="c1"># warnings</span>
<span></span>    <span class="n">save_dataset_cache_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">DATASET_CACHE_VERSION</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.YOLODataset.close_mosaic"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.YOLODataset.close_mosaic</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">close_mosaic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p>Disable mosaic, copy_paste, mixup and cutmix augmentations by setting their probabilities to 0.0.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>hyp</code></td><td><code>dict</code></td><td>Hyperparameters for transforms.</td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L237-L247"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">close_mosaic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Disable mosaic, copy_paste, mixup and cutmix augmentations by setting their probabilities to 0.0.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        hyp (dict): Hyperparameters for transforms.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">hyp</span><span class="o">.</span><span class="n">mosaic</span> <span class="o">=</span> <span class="mf">0.0</span>
<span></span>    <span class="n">hyp</span><span class="o">.</span><span class="n">copy_paste</span> <span class="o">=</span> <span class="mf">0.0</span>
<span></span>    <span class="n">hyp</span><span class="o">.</span><span class="n">mixup</span> <span class="o">=</span> <span class="mf">0.0</span>
<span></span>    <span class="n">hyp</span><span class="o">.</span><span class="n">cutmix</span> <span class="o">=</span> <span class="mf">0.0</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">transforms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_transforms</span><span class="p">(</span><span class="n">hyp</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.YOLODataset.collate_fn"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.YOLODataset.collate_fn</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">collate_fn</span><span class="p">(</span><span class="n">batch</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div><p>Collate data samples into batches.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>batch</code></td><td><code>list[dict]</code></td><td>List of dictionaries containing sample data.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>dict</code></td><td>Collated batch with stacked tensors.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L282-L308"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@staticmethod</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">collate_fn</span><span class="p">(</span><span class="n">batch</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Collate data samples into batches.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        batch (list[dict]): List of dictionaries containing sample data.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): Collated batch with stacked tensors.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">new_batch</span> <span class="o">=</span> <span class="p">{}</span>
<span></span>    <span class="n">batch</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">]</span>  <span class="c1"># make sure the keys are in the same order</span>
<span></span>    <span class="n">keys</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span></span>    <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">]))</span>
<span></span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
<span></span>        <span class="n">value</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span></span>        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"img"</span><span class="p">,</span> <span class="s2">"text_feats"</span><span class="p">}:</span>
<span></span>            <span class="n">value</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span></span>        <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">"visuals"</span><span class="p">:</span>
<span></span>            <span class="n">value</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">rnn</span><span class="o">.</span><span class="n">pad_sequence</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">batch_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"masks"</span><span class="p">,</span> <span class="s2">"keypoints"</span><span class="p">,</span> <span class="s2">"bboxes"</span><span class="p">,</span> <span class="s2">"cls"</span><span class="p">,</span> <span class="s2">"segments"</span><span class="p">,</span> <span class="s2">"obb"</span><span class="p">}:</span>
<span></span>            <span class="n">value</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span></span>        <span class="n">new_batch</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<span></span>    <span class="n">new_batch</span><span class="p">[</span><span class="s2">"batch_idx"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_batch</span><span class="p">[</span><span class="s2">"batch_idx"</span><span class="p">])</span>
<span></span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_batch</span><span class="p">[</span><span class="s2">"batch_idx"</span><span class="p">])):</span>
<span></span>        <span class="n">new_batch</span><span class="p">[</span><span class="s2">"batch_idx"</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">i</span>  <span class="c1"># add target image index for build_targets()</span>
<span></span>    <span class="n">new_batch</span><span class="p">[</span><span class="s2">"batch_idx"</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">new_batch</span><span class="p">[</span><span class="s2">"batch_idx"</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">new_batch</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.YOLODataset.get_labels"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.YOLODataset.get_labels</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
</code></pre></div><p>Return dictionary of labels for YOLO training.</p><p>This method loads labels from disk or cache, verifies their integrity, and prepares them for training.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list[dict]</code></td><td>List of label dictionaries, each containing information about an image and its annotations.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L157-L204"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return dictionary of labels for YOLO training.</span>
<span></span>
<span></span><span class="sd">    This method loads labels from disk or cache, verifies their integrity, and prepares them for training.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list[dict]): List of label dictionaries, each containing information about an image and its annotations.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">label_files</span> <span class="o">=</span> <span class="n">img2label_paths</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_files</span><span class="p">)</span>
<span></span>    <span class="n">cache_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">".cache"</span><span class="p">)</span>
<span></span>    <span class="k">try</span><span class="p">:</span>
<span></span>        <span class="n">cache</span><span class="p">,</span> <span class="n">exists</span> <span class="o">=</span> <span class="n">load_dataset_cache_file</span><span class="p">(</span><span class="n">cache_path</span><span class="p">),</span> <span class="kc">True</span>  <span class="c1"># attempt to load a *.cache file</span>
<span></span>        <span class="k">assert</span> <span class="n">cache</span><span class="p">[</span><span class="s2">"version"</span><span class="p">]</span> <span class="o">==</span> <span class="n">DATASET_CACHE_VERSION</span>  <span class="c1"># matches current version</span>
<span></span>        <span class="k">assert</span> <span class="n">cache</span><span class="p">[</span><span class="s2">"hash"</span><span class="p">]</span> <span class="o">==</span> <span class="n">get_hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_files</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">im_files</span><span class="p">)</span>  <span class="c1"># identical hash</span>
<span></span>    <span class="k">except</span> <span class="p">(</span><span class="ne">FileNotFoundError</span><span class="p">,</span> <span class="ne">AssertionError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ModuleNotFoundError</span><span class="p">):</span>
<span></span>        <span class="n">cache</span><span class="p">,</span> <span class="n">exists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_labels</span><span class="p">(</span><span class="n">cache_path</span><span class="p">),</span> <span class="kc">False</span>  <span class="c1"># run cache ops</span>
<span></span>
<span></span>    <span class="c1"># Display cache</span>
<span></span>    <span class="n">nf</span><span class="p">,</span> <span class="n">nm</span><span class="p">,</span> <span class="n">ne</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"results"</span><span class="p">)</span>  <span class="c1"># found, missing, empty, corrupt, total</span>
<span></span>    <span class="k">if</span> <span class="n">exists</span> <span class="ow">and</span> <span class="n">LOCAL_RANK</span> <span class="ow">in</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">}:</span>
<span></span>        <span class="n">d</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"Scanning </span><span class="si">{</span><span class="n">cache_path</span><span class="si">}</span><span class="s2">... </span><span class="si">{</span><span class="n">nf</span><span class="si">}</span><span class="s2"> images, </span><span class="si">{</span><span class="n">nm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ne</span><span class="si">}</span><span class="s2"> backgrounds, </span><span class="si">{</span><span class="n">nc</span><span class="si">}</span><span class="s2"> corrupt"</span>
<span></span>        <span class="n">TQDM</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span> <span class="o">+</span> <span class="n">d</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># display results</span>
<span></span>        <span class="k">if</span> <span class="n">cache</span><span class="p">[</span><span class="s2">"msgs"</span><span class="p">]:</span>
<span></span>            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cache</span><span class="p">[</span><span class="s2">"msgs"</span><span class="p">]))</span>  <span class="c1"># display warnings</span>
<span></span>
<span></span>    <span class="c1"># Read cache</span>
<span></span>    <span class="p">[</span><span class="n">cache</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">"hash"</span><span class="p">,</span> <span class="s2">"version"</span><span class="p">,</span> <span class="s2">"msgs"</span><span class="p">)]</span>  <span class="c1"># remove items</span>
<span></span>    <span class="n">labels</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[</span><span class="s2">"labels"</span><span class="p">]</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">labels</span><span class="p">:</span>
<span></span>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<span></span>            <span class="sa">f</span><span class="s2">"No valid images found in </span><span class="si">{</span><span class="n">cache_path</span><span class="si">}</span><span class="s2">. Images with incorrectly formatted labels are ignored. </span><span class="si">{</span><span class="n">HELP_URL</span><span class="si">}</span><span class="s2">"</span>
<span></span>        <span class="p">)</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">im_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">lb</span><span class="p">[</span><span class="s2">"im_file"</span><span class="p">]</span> <span class="k">for</span> <span class="n">lb</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>  <span class="c1"># update im_files</span>
<span></span>
<span></span>    <span class="c1"># Check if the dataset is all boxes or all segments</span>
<span></span>    <span class="n">lengths</span> <span class="o">=</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">lb</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lb</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lb</span><span class="p">[</span><span class="s2">"segments"</span><span class="p">]))</span> <span class="k">for</span> <span class="n">lb</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">)</span>
<span></span>    <span class="n">len_cls</span><span class="p">,</span> <span class="n">len_boxes</span><span class="p">,</span> <span class="n">len_segments</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">lengths</span><span class="p">))</span>
<span></span>    <span class="k">if</span> <span class="n">len_segments</span> <span class="ow">and</span> <span class="n">len_boxes</span> <span class="o">!=</span> <span class="n">len_segments</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<span></span>            <span class="sa">f</span><span class="s2">"Box and segment counts should be equal, but got len(segments) = </span><span class="si">{</span><span class="n">len_segments</span><span class="si">}</span><span class="s2">, "</span>
<span></span>            <span class="sa">f</span><span class="s2">"len(boxes) = </span><span class="si">{</span><span class="n">len_boxes</span><span class="si">}</span><span class="s2">. To resolve this only boxes will be used and all segments will be removed. "</span>
<span></span>            <span class="s2">"To avoid this please supply either a detect or segment dataset, not a detect-segment mixed dataset."</span>
<span></span>        <span class="p">)</span>
<span></span>        <span class="k">for</span> <span class="n">lb</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
<span></span>            <span class="n">lb</span><span class="p">[</span><span class="s2">"segments"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>    <span class="k">if</span> <span class="n">len_cls</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Labels are missing or empty in </span><span class="si">{</span><span class="n">cache_path</span><span class="si">}</span><span class="s2">, training may not work correctly. </span><span class="si">{</span><span class="n">HELP_URL</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">labels</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.YOLODataset.update_labels_info"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.YOLODataset.update_labels_info</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update_labels_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div><p>Update label format for different tasks.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>label</code></td><td><code>dict</code></td><td>Label dictionary containing bboxes, segments, keypoints, etc.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>dict</code></td><td>Updated label dictionary with instances.</td></tr></tbody></table><div class="admonition note"><p class="admonition-title">Notes</p><p>cls is not with bboxes now, classification and semantic segmentation need an independent cls label
Can also support classification and semantic segmentation by adding or removing dict keys there.</p></div><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L249-L279"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update_labels_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Update label format for different tasks.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        label (dict): Label dictionary containing bboxes, segments, keypoints, etc.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): Updated label dictionary with instances.</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        cls is not with bboxes now, classification and semantic segmentation need an independent cls label</span>
<span></span><span class="sd">        Can also support classification and semantic segmentation by adding or removing dict keys there.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">bboxes</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"bboxes"</span><span class="p">)</span>
<span></span>    <span class="n">segments</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"segments"</span><span class="p">,</span> <span class="p">[])</span>
<span></span>    <span class="n">keypoints</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"keypoints"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span></span>    <span class="n">bbox_format</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"bbox_format"</span><span class="p">)</span>
<span></span>    <span class="n">normalized</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"normalized"</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># NOTE: do NOT resample oriented boxes</span>
<span></span>    <span class="n">segment_resamples</span> <span class="o">=</span> <span class="mi">100</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_obb</span> <span class="k">else</span> <span class="mi">1000</span>
<span></span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span></span>        <span class="c1"># make sure segments interpolate correctly if original length is greater than segment_resamples</span>
<span></span>        <span class="n">max_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">)</span>
<span></span>        <span class="n">segment_resamples</span> <span class="o">=</span> <span class="p">(</span><span class="n">max_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">segment_resamples</span> <span class="o">&lt;</span> <span class="n">max_len</span> <span class="k">else</span> <span class="n">segment_resamples</span>
<span></span>        <span class="c1"># list[np.array(segment_resamples, 2)] * num_samples</span>
<span></span>        <span class="n">segments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">resample_segments</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">segment_resamples</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span></span>    <span class="k">else</span><span class="p">:</span>
<span></span>        <span class="n">segments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">segment_resamples</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>    <span class="n">label</span><span class="p">[</span><span class="s2">"instances"</span><span class="p">]</span> <span class="o">=</span> <span class="n">Instances</span><span class="p">(</span><span class="n">bboxes</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">keypoints</span><span class="p">,</span> <span class="n">bbox_format</span><span class="o">=</span><span class="n">bbox_format</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="n">normalized</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">label</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.dataset.YOLOMultiModalDataset"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.data.dataset.YOLOMultiModalDataset</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">YOLOMultiModalDataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"detect"</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div><p><strong>Bases:</strong> <code>YOLODataset</code></p><p>Dataset class for loading object detection and/or segmentation labels in YOLO format with multi-modal support.</p><p>This class extends YOLODataset to add text information for multi-modal model training, enabling models to process both image and text data.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>data</code></td><td><code>dict, optional</code></td><td>Dataset configuration dictionary.</td><td><code>None</code></td></tr><tr><td><code>task</code></td><td><code>str</code></td><td>Task type, one of 'detect', 'segment', 'pose', or 'obb'.</td><td><code>"detect"</code></td></tr><tr><td><code>*args</code></td><td><code>Any</code></td><td>Additional positional arguments for the parent class.</td><td><em>required</em></td></tr><tr><td><code>**kwargs</code></td><td><code>Any</code></td><td>Additional keyword arguments for the parent class.</td><td><em>required</em></td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.data.dataset.YOLOMultiModalDataset.category_names"><code>category_names</code></a></td><td>Return category names for the dataset.</td></tr><tr><td><a href="#ultralytics.data.dataset.YOLOMultiModalDataset.category_freq"><code>category_freq</code></a></td><td>Return frequency of each category in the dataset.</td></tr><tr><td><a href="#ultralytics.data.dataset.YOLOMultiModalDataset._get_neg_texts"><code>_get_neg_texts</code></a></td><td>Get negative text samples based on frequency threshold.</td></tr><tr><td><a href="#ultralytics.data.dataset.YOLOMultiModalDataset.build_transforms"><code>build_transforms</code></a></td><td>Enhance data transformations with optional text augmentation for multi-modal training.</td></tr><tr><td><a href="#ultralytics.data.dataset.YOLOMultiModalDataset.update_labels_info"><code>update_labels_info</code></a></td><td>Add text information for multi-modal model training.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">YOLOMultiModalDataset</span><span class="p">(</span><span class="n">img_path</span><span class="o">=</span><span class="s2">"path/to/images"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"names"</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">"person"</span><span class="p">}},</span> <span class="n">task</span><span class="o">=</span><span class="s2">"detect"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>  <span class="c1"># Should include 'texts'</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L311-L404"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">YOLOMultiModalDataset</span><span class="p">(</span><span class="n">YOLODataset</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Dataset class for loading object detection and/or segmentation labels in YOLO format with multi-modal support.</span>
<span></span>
<span></span><span class="sd">    This class extends YOLODataset to add text information for multi-modal model training, enabling models to process</span>
<span></span><span class="sd">    both image and text data.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        update_labels_info: Add text information for multi-modal model training.</span>
<span></span><span class="sd">        build_transforms: Enhance data transformations with text augmentation.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; dataset = YOLOMultiModalDataset(img_path="path/to/images", data={"names": {0: "person"}}, task="detect")</span>
<span></span><span class="sd">        &gt;&gt;&gt; batch = next(iter(dataset))</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(batch.keys())  # Should include 'texts'</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"detect"</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize a YOLOMultiModalDataset.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            data (dict, optional): Dataset configuration dictionary.</span>
<span></span><span class="sd">            task (str): Task type, one of 'detect', 'segment', 'pose', or 'obb'.</span>
<span></span><span class="sd">            *args (Any): Additional positional arguments for the parent class.</span>
<span></span><span class="sd">            **kwargs (Any): Additional keyword arguments for the parent class.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.YOLOMultiModalDataset.category_names"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.data.dataset.YOLOMultiModalDataset.category_names</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">category_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>Return category names for the dataset.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>set[str]</code></td><td>List of class names.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L378-L385"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">category_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Return category names for the dataset.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (set[str]): List of class names.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">"names"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span></span>    <span class="k">return</span> <span class="p">{</span><span class="n">n</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"/"</span><span class="p">)}</span>  <span class="c1"># category names</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.YOLOMultiModalDataset.category_freq"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.data.dataset.YOLOMultiModalDataset.category_freq</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">category_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>Return frequency of each category in the dataset.</p><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L388-L398"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">category_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Return frequency of each category in the dataset."""</span>
<span></span>    <span class="n">texts</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"/"</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">"names"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
<span></span>    <span class="n">category_freq</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span></span>    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
<span></span>        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">label</span><span class="p">[</span><span class="s2">"cls"</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>  <span class="c1"># to check</span>
<span></span>            <span class="n">text</span> <span class="o">=</span> <span class="n">texts</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)]</span>
<span></span>            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
<span></span>                <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span></span>                <span class="n">category_freq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span></span>    <span class="k">return</span> <span class="n">category_freq</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.YOLOMultiModalDataset._get_neg_texts"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.YOLOMultiModalDataset._get_neg_texts</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_get_neg_texts</span><span class="p">(</span><span class="n">category_freq</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div><p>Get negative text samples based on frequency threshold.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>category_freq</code></td><td><code>dict</code></td><td></td><td><em>required</em></td></tr><tr><td><code>threshold</code></td><td><code>int</code></td><td></td><td><code>100</code></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L401-L404"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@staticmethod</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">_get_neg_texts</span><span class="p">(</span><span class="n">category_freq</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Get negative text samples based on frequency threshold."""</span>
<span></span>    <span class="n">threshold</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">category_freq</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="mi">100</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">category_freq</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.YOLOMultiModalDataset.build_transforms"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.YOLOMultiModalDataset.build_transforms</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">build_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Compose</span>
</code></pre></div><p>Enhance data transformations with optional text augmentation for multi-modal training.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>hyp</code></td><td><code>dict, optional</code></td><td>Hyperparameters for transforms.</td><td><code>None</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Compose</code></td><td>Composed transforms including text augmentation if applicable.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L354-L375"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">build_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Compose</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Enhance data transformations with optional text augmentation for multi-modal training.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        hyp (dict, optional): Hyperparameters for transforms.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Compose): Composed transforms including text augmentation if applicable.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">transforms</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">build_transforms</span><span class="p">(</span><span class="n">hyp</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">augment</span><span class="p">:</span>
<span></span>        <span class="c1"># NOTE: hard-coded the args for now.</span>
<span></span>        <span class="c1"># NOTE: this implementation is different from official yoloe,</span>
<span></span>        <span class="c1"># the strategy of selecting negative is restricted in one dataset,</span>
<span></span>        <span class="c1"># while official pre-saved neg embeddings from all datasets at once.</span>
<span></span>        <span class="n">transform</span> <span class="o">=</span> <span class="n">RandomLoadText</span><span class="p">(</span>
<span></span>            <span class="n">max_samples</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">"nc"</span><span class="p">],</span> <span class="mi">80</span><span class="p">),</span>
<span></span>            <span class="n">padding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span></span>            <span class="n">padding_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_neg_texts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">category_freq</span><span class="p">),</span>
<span></span>        <span class="p">)</span>
<span></span>        <span class="n">transforms</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">transforms</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.YOLOMultiModalDataset.update_labels_info"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.YOLOMultiModalDataset.update_labels_info</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update_labels_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div><p>Add text information for multi-modal model training.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>label</code></td><td><code>dict</code></td><td>Label dictionary containing bboxes, segments, keypoints, etc.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>dict</code></td><td>Updated label dictionary with instances and texts.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L338-L352"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update_labels_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Add text information for multi-modal model training.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        label (dict): Label dictionary containing bboxes, segments, keypoints, etc.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): Updated label dictionary with instances and texts.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">labels</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update_labels_info</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
<span></span>    <span class="c1"># NOTE: some categories are concatenated with its synonyms by `/`.</span>
<span></span>    <span class="c1"># NOTE: and `RandomLoadText` would randomly select one of them if there are multiple words.</span>
<span></span>    <span class="n">labels</span><span class="p">[</span><span class="s2">"texts"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"/"</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">"names"</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="n">labels</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.dataset.GroundingDataset"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.data.dataset.GroundingDataset</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">GroundingDataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"detect"</span><span class="p">,</span> <span class="n">json_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span> <span class="n">max_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div><p><strong>Bases:</strong> <code>YOLODataset</code></p><p>Dataset class for object detection tasks using annotations from a JSON file in grounding format.</p><p>This dataset is designed for grounding tasks where annotations are provided in a JSON file rather than the standard YOLO format text files.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>json_file</code></td><td><code>str</code></td><td>Path to the JSON file containing annotations.</td><td><code>""</code></td></tr><tr><td><code>task</code></td><td><code>str</code></td><td>Must be 'detect' or 'segment' for GroundingDataset.</td><td><code>"detect"</code></td></tr><tr><td><code>max_samples</code></td><td><code>int</code></td><td>Maximum number of samples to load for text augmentation.</td><td><code>80</code></td></tr><tr><td><code>*args</code></td><td><code>Any</code></td><td>Additional positional arguments for the parent class.</td><td><em>required</em></td></tr><tr><td><code>**kwargs</code></td><td><code>Any</code></td><td>Additional keyword arguments for the parent class.</td><td><em>required</em></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>json_file</code></td><td><code>str</code></td><td>Path to the JSON file containing annotations.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.data.dataset.GroundingDataset.category_names"><code>category_names</code></a></td><td>Return unique category names from the dataset.</td></tr><tr><td><a href="#ultralytics.data.dataset.GroundingDataset.category_freq"><code>category_freq</code></a></td><td>Return frequency of each category in the dataset.</td></tr><tr><td><a href="#ultralytics.data.dataset.GroundingDataset._get_neg_texts"><code>_get_neg_texts</code></a></td><td>Get negative text samples based on frequency threshold.</td></tr><tr><td><a href="#ultralytics.data.dataset.GroundingDataset.build_transforms"><code>build_transforms</code></a></td><td>Configure augmentations for training with optional text loading.</td></tr><tr><td><a href="#ultralytics.data.dataset.GroundingDataset.cache_labels"><code>cache_labels</code></a></td><td>Load annotations from a JSON file, filter, and normalize bounding boxes for each image.</td></tr><tr><td><a href="#ultralytics.data.dataset.GroundingDataset.get_img_files"><code>get_img_files</code></a></td><td>The image files would be read in <code>get_labels</code> function, return empty list here.</td></tr><tr><td><a href="#ultralytics.data.dataset.GroundingDataset.get_labels"><code>get_labels</code></a></td><td>Load labels from cache or generate them from JSON file.</td></tr><tr><td><a href="#ultralytics.data.dataset.GroundingDataset.verify_labels"><code>verify_labels</code></a></td><td>Verify the number of instances in the dataset matches expected counts.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">GroundingDataset</span><span class="p">(</span><span class="n">img_path</span><span class="o">=</span><span class="s2">"path/to/images"</span><span class="p">,</span> <span class="n">json_file</span><span class="o">=</span><span class="s2">"annotations.json"</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">"detect"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>  <span class="c1"># Number of valid images with annotations</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L407-L639"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">GroundingDataset</span><span class="p">(</span><span class="n">YOLODataset</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Dataset class for object detection tasks using annotations from a JSON file in grounding format.</span>
<span></span>
<span></span><span class="sd">    This dataset is designed for grounding tasks where annotations are provided in a JSON file rather than the standard</span>
<span></span><span class="sd">    YOLO format text files.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        json_file (str): Path to the JSON file containing annotations.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        get_img_files: Return empty list as image files are read in get_labels.</span>
<span></span><span class="sd">        get_labels: Load annotations from a JSON file and prepare them for training.</span>
<span></span><span class="sd">        build_transforms: Configure augmentations for training with optional text loading.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; dataset = GroundingDataset(img_path="path/to/images", json_file="annotations.json", task="detect")</span>
<span></span><span class="sd">        &gt;&gt;&gt; len(dataset)  # Number of valid images with annotations</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"detect"</span><span class="p">,</span> <span class="n">json_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span> <span class="n">max_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize a GroundingDataset for object detection.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            json_file (str): Path to the JSON file containing annotations.</span>
<span></span><span class="sd">            task (str): Must be 'detect' or 'segment' for GroundingDataset.</span>
<span></span><span class="sd">            max_samples (int): Maximum number of samples to load for text augmentation.</span>
<span></span><span class="sd">            *args (Any): Additional positional arguments for the parent class.</span>
<span></span><span class="sd">            **kwargs (Any): Additional keyword arguments for the parent class.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="k">assert</span> <span class="n">task</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"detect"</span><span class="p">,</span> <span class="s2">"segment"</span><span class="p">},</span> <span class="s2">"GroundingDataset currently only supports `detect` and `segment` tasks"</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">json_file</span> <span class="o">=</span> <span class="n">json_file</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">max_samples</span> <span class="o">=</span> <span class="n">max_samples</span>
<span></span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"channels"</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.GroundingDataset.category_names"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.data.dataset.GroundingDataset.category_names</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">category_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>Return unique category names from the dataset.</p><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L620-L622"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">category_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Return unique category names from the dataset."""</span>
<span></span>    <span class="k">return</span> <span class="p">{</span><span class="n">t</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">label</span><span class="p">[</span><span class="s2">"texts"</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">text</span><span class="p">}</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.GroundingDataset.category_freq"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.data.dataset.GroundingDataset.category_freq</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">category_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>Return frequency of each category in the dataset.</p><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L625-L633"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">category_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Return frequency of each category in the dataset."""</span>
<span></span>    <span class="n">category_freq</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span></span>    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
<span></span>        <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">label</span><span class="p">[</span><span class="s2">"texts"</span><span class="p">]:</span>
<span></span>            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
<span></span>                <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span></span>                <span class="n">category_freq</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span></span>    <span class="k">return</span> <span class="n">category_freq</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.GroundingDataset._get_neg_texts"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.GroundingDataset._get_neg_texts</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_get_neg_texts</span><span class="p">(</span><span class="n">category_freq</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div><p>Get negative text samples based on frequency threshold.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>category_freq</code></td><td><code>dict</code></td><td></td><td><em>required</em></td></tr><tr><td><code>threshold</code></td><td><code>int</code></td><td></td><td><code>100</code></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L636-L639"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@staticmethod</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">_get_neg_texts</span><span class="p">(</span><span class="n">category_freq</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Get negative text samples based on frequency threshold."""</span>
<span></span>    <span class="n">threshold</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">category_freq</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="mi">100</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">category_freq</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.GroundingDataset.build_transforms"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.GroundingDataset.build_transforms</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">build_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Compose</span>
</code></pre></div><p>Configure augmentations for training with optional text loading.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>hyp</code></td><td><code>dict, optional</code></td><td>Hyperparameters for transforms.</td><td><code>None</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Compose</code></td><td>Composed transforms including text augmentation if applicable.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L596-L617"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">build_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Compose</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Configure augmentations for training with optional text loading.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        hyp (dict, optional): Hyperparameters for transforms.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Compose): Composed transforms including text augmentation if applicable.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">transforms</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">build_transforms</span><span class="p">(</span><span class="n">hyp</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">augment</span><span class="p">:</span>
<span></span>        <span class="c1"># NOTE: hard-coded the args for now.</span>
<span></span>        <span class="c1"># NOTE: this implementation is different from official yoloe,</span>
<span></span>        <span class="c1"># the strategy of selecting negative is restricted in one dataset,</span>
<span></span>        <span class="c1"># while official pre-saved neg embeddings from all datasets at once.</span>
<span></span>        <span class="n">transform</span> <span class="o">=</span> <span class="n">RandomLoadText</span><span class="p">(</span>
<span></span>            <span class="n">max_samples</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_samples</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
<span></span>            <span class="n">padding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span></span>            <span class="n">padding_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_neg_texts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">category_freq</span><span class="p">),</span>
<span></span>        <span class="p">)</span>
<span></span>        <span class="n">transforms</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">transforms</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.GroundingDataset.cache_labels"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.GroundingDataset.cache_labels</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cache_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"./labels.cache"</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div><p>Load annotations from a JSON file, filter, and normalize bounding boxes for each image.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>path</code></td><td><code>Path</code></td><td>Path where to save the cache file.</td><td><code>Path("./labels.cache")</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>dict[str, Any]</code></td><td>Dictionary containing cached labels and related information.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L485-L573"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cache_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"./labels.cache"</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Load annotations from a JSON file, filter, and normalize bounding boxes for each image.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        path (Path): Path where to save the cache file.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict[str, Any]): Dictionary containing cached labels and related information.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">x</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"labels"</span><span class="p">:</span> <span class="p">[]}</span>
<span></span>    <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"Loading annotation file..."</span><span class="p">)</span>
<span></span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span></span>        <span class="n">annotations</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span></span>    <span class="n">images</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">"</span><span class="p">:</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">[</span><span class="s2">"images"</span><span class="p">]}</span>
<span></span>    <span class="n">img_to_anns</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span></span>    <span class="k">for</span> <span class="n">ann</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">[</span><span class="s2">"annotations"</span><span class="p">]:</span>
<span></span>        <span class="n">img_to_anns</span><span class="p">[</span><span class="n">ann</span><span class="p">[</span><span class="s2">"image_id"</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ann</span><span class="p">)</span>
<span></span>    <span class="k">for</span> <span class="n">img_id</span><span class="p">,</span> <span class="n">anns</span> <span class="ow">in</span> <span class="n">TQDM</span><span class="p">(</span><span class="n">img_to_anns</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Reading annotations </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">json_file</span><span class="si">}</span><span class="s2">"</span><span class="p">):</span>
<span></span>        <span class="n">img</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">img_id</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">"</span><span class="p">]</span>
<span></span>        <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="s2">"height"</span><span class="p">],</span> <span class="n">img</span><span class="p">[</span><span class="s2">"width"</span><span class="p">],</span> <span class="n">img</span><span class="p">[</span><span class="s2">"file_name"</span><span class="p">]</span>
<span></span>        <span class="n">im_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">img_path</span><span class="p">)</span> <span class="o">/</span> <span class="n">f</span>
<span></span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">im_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<span></span>            <span class="k">continue</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">im_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">im_file</span><span class="p">))</span>
<span></span>        <span class="n">bboxes</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>        <span class="n">segments</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>        <span class="n">cat2id</span> <span class="o">=</span> <span class="p">{}</span>
<span></span>        <span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>        <span class="k">for</span> <span class="n">ann</span> <span class="ow">in</span> <span class="n">anns</span><span class="p">:</span>
<span></span>            <span class="k">if</span> <span class="n">ann</span><span class="p">[</span><span class="s2">"iscrowd"</span><span class="p">]:</span>
<span></span>                <span class="k">continue</span>
<span></span>            <span class="n">box</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ann</span><span class="p">[</span><span class="s2">"bbox"</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>            <span class="n">box</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">box</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">/</span> <span class="mi">2</span>
<span></span>            <span class="n">box</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span> <span class="o">/=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span></span>            <span class="n">box</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span> <span class="o">/=</span> <span class="nb">float</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span></span>            <span class="k">if</span> <span class="n">box</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">box</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<span></span>                <span class="k">continue</span>
<span></span>
<span></span>            <span class="n">caption</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="s2">"caption"</span><span class="p">]</span>
<span></span>            <span class="n">cat_name</span> <span class="o">=</span> <span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">caption</span><span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ann</span><span class="p">[</span><span class="s2">"tokens_positive"</span><span class="p">]])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span></span>            <span class="k">if</span> <span class="ow">not</span> <span class="n">cat_name</span><span class="p">:</span>
<span></span>                <span class="k">continue</span>
<span></span>
<span></span>            <span class="k">if</span> <span class="n">cat_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cat2id</span><span class="p">:</span>
<span></span>                <span class="n">cat2id</span><span class="p">[</span><span class="n">cat_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cat2id</span><span class="p">)</span>
<span></span>                <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">cat_name</span><span class="p">])</span>
<span></span>            <span class="bp">cls</span> <span class="o">=</span> <span class="n">cat2id</span><span class="p">[</span><span class="n">cat_name</span><span class="p">]</span>  <span class="c1"># class</span>
<span></span>            <span class="n">box</span> <span class="o">=</span> <span class="p">[</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">box</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>
<span></span>            <span class="k">if</span> <span class="n">box</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bboxes</span><span class="p">:</span>
<span></span>                <span class="n">bboxes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
<span></span>                <span class="k">if</span> <span class="n">ann</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"segmentation"</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ann</span><span class="p">[</span><span class="s2">"segmentation"</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>                        <span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
<span></span>                        <span class="k">continue</span>
<span></span>                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ann</span><span class="p">[</span><span class="s2">"segmentation"</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span></span>                        <span class="n">s</span> <span class="o">=</span> <span class="n">merge_multi_segment</span><span class="p">(</span><span class="n">ann</span><span class="p">[</span><span class="s2">"segmentation"</span><span class="p">])</span>
<span></span>                        <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span></span>                    <span class="k">else</span><span class="p">:</span>
<span></span>                        <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ann</span><span class="p">[</span><span class="s2">"segmentation"</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>  <span class="c1"># all segments concatenated</span>
<span></span>                        <span class="n">s</span> <span class="o">=</span> <span class="p">(</span>
<span></span>                            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span></span>                            <span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span></span>                            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span></span>                        <span class="p">)</span>
<span></span>                    <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">s</span><span class="p">]</span>
<span></span>                    <span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span></span>        <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bboxes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bboxes</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>
<span></span>        <span class="k">if</span> <span class="n">segments</span><span class="p">:</span>
<span></span>            <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>            <span class="n">segments</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">]</span>  <span class="c1"># (cls, xy1...)</span>
<span></span>            <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">classes</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">segments2boxes</span><span class="p">(</span><span class="n">segments</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># (cls, xywh)</span>
<span></span>        <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span></span>
<span></span>        <span class="n">x</span><span class="p">[</span><span class="s2">"labels"</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<span></span>            <span class="p">{</span>
<span></span>                <span class="s2">"im_file"</span><span class="p">:</span> <span class="n">im_file</span><span class="p">,</span>
<span></span>                <span class="s2">"shape"</span><span class="p">:</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">),</span>
<span></span>                <span class="s2">"cls"</span><span class="p">:</span> <span class="n">lb</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># n, 1</span>
<span></span>                <span class="s2">"bboxes"</span><span class="p">:</span> <span class="n">lb</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span>  <span class="c1"># n, 4</span>
<span></span>                <span class="s2">"segments"</span><span class="p">:</span> <span class="n">segments</span><span class="p">,</span>
<span></span>                <span class="s2">"normalized"</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span></span>                <span class="s2">"bbox_format"</span><span class="p">:</span> <span class="s2">"xywh"</span><span class="p">,</span>
<span></span>                <span class="s2">"texts"</span><span class="p">:</span> <span class="n">texts</span><span class="p">,</span>
<span></span>            <span class="p">}</span>
<span></span>        <span class="p">)</span>
<span></span>    <span class="n">x</span><span class="p">[</span><span class="s2">"hash"</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_file</span><span class="p">)</span>
<span></span>    <span class="n">save_dataset_cache_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">DATASET_CACHE_VERSION</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.GroundingDataset.get_img_files"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.GroundingDataset.get_img_files</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_img_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span>
</code></pre></div><p>The image files would be read in <code>get_labels</code> function, return empty list here.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>img_path</code></td><td><code>str</code></td><td>Path to the directory containing images.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list</code></td><td>Empty list as image files are read in get_labels.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L441-L450"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_img_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""The image files would be read in `get_labels` function, return empty list here.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        img_path (str): Path to the directory containing images.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list): Empty list as image files are read in get_labels.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.GroundingDataset.get_labels"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.GroundingDataset.get_labels</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
</code></pre></div><p>Load labels from cache or generate them from JSON file.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list[dict]</code></td><td>List of label dictionaries, each containing information about an image and its annotations.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L575-L594"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Load labels from cache or generate them from JSON file.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list[dict]): List of label dictionaries, each containing information about an image and its annotations.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">cache_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">".cache"</span><span class="p">)</span>
<span></span>    <span class="k">try</span><span class="p">:</span>
<span></span>        <span class="n">cache</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_dataset_cache_file</span><span class="p">(</span><span class="n">cache_path</span><span class="p">),</span> <span class="kc">True</span>  <span class="c1"># attempt to load a *.cache file</span>
<span></span>        <span class="k">assert</span> <span class="n">cache</span><span class="p">[</span><span class="s2">"version"</span><span class="p">]</span> <span class="o">==</span> <span class="n">DATASET_CACHE_VERSION</span>  <span class="c1"># matches current version</span>
<span></span>        <span class="k">assert</span> <span class="n">cache</span><span class="p">[</span><span class="s2">"hash"</span><span class="p">]</span> <span class="o">==</span> <span class="n">get_hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_file</span><span class="p">)</span>  <span class="c1"># identical hash</span>
<span></span>    <span class="k">except</span> <span class="p">(</span><span class="ne">FileNotFoundError</span><span class="p">,</span> <span class="ne">AssertionError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ModuleNotFoundError</span><span class="p">):</span>
<span></span>        <span class="n">cache</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_labels</span><span class="p">(</span><span class="n">cache_path</span><span class="p">),</span> <span class="kc">False</span>  <span class="c1"># run cache ops</span>
<span></span>    <span class="p">[</span><span class="n">cache</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">"hash"</span><span class="p">,</span> <span class="s2">"version"</span><span class="p">)]</span>  <span class="c1"># remove items</span>
<span></span>    <span class="n">labels</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[</span><span class="s2">"labels"</span><span class="p">]</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">verify_labels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">im_files</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="s2">"im_file"</span><span class="p">])</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
<span></span>    <span class="k">if</span> <span class="n">LOCAL_RANK</span> <span class="ow">in</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">}:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Load </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">json_file</span><span class="si">}</span><span class="s2"> from cache file </span><span class="si">{</span><span class="n">cache_path</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">labels</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.GroundingDataset.verify_labels"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.GroundingDataset.verify_labels</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">verify_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p>Verify the number of instances in the dataset matches expected counts.</p><p>This method checks if the total number of bounding box instances in the provided labels matches the expected count for known datasets. It performs validation against a predefined set of datasets with known instance counts.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>labels</code></td><td><code>list[dict[str, Any]]</code></td><td>List of label dictionaries, where each dictionary contains dataset annotations. Each label dict must have a 'bboxes' key with a numpy array or tensor containing bounding box coordinates.</td><td><em>required</em></td></tr></tbody></table><div class="admonition note"><p class="admonition-title">Notes</p><p>For unrecognized datasets (those not in the predefined expected_counts),
a warning is logged and verification is skipped.</p></div><p><strong>Raises</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>AssertionError</code></td><td>If the actual instance count doesn't match the expected count for a recognized dataset.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L452-L483"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">verify_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Verify the number of instances in the dataset matches expected counts.</span>
<span></span>
<span></span><span class="sd">    This method checks if the total number of bounding box instances in the provided labels matches the expected</span>
<span></span><span class="sd">    count for known datasets. It performs validation against a predefined set of datasets with known instance</span>
<span></span><span class="sd">    counts.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        labels (list[dict[str, Any]]): List of label dictionaries, where each dictionary contains dataset</span>
<span></span><span class="sd">            annotations. Each label dict must have a 'bboxes' key with a numpy array or tensor containing bounding</span>
<span></span><span class="sd">            box coordinates.</span>
<span></span>
<span></span><span class="sd">    Raises:</span>
<span></span><span class="sd">        AssertionError: If the actual instance count doesn't match the expected count for a recognized dataset.</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        For unrecognized datasets (those not in the predefined expected_counts),</span>
<span></span><span class="sd">        a warning is logged and verification is skipped.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">expected_counts</span> <span class="o">=</span> <span class="p">{</span>
<span></span>        <span class="s2">"final_mixed_train_no_coco_segm"</span><span class="p">:</span> <span class="mi">3662412</span><span class="p">,</span>
<span></span>        <span class="s2">"final_mixed_train_no_coco"</span><span class="p">:</span> <span class="mi">3681235</span><span class="p">,</span>
<span></span>        <span class="s2">"final_flickr_separateGT_train_segm"</span><span class="p">:</span> <span class="mi">638214</span><span class="p">,</span>
<span></span>        <span class="s2">"final_flickr_separateGT_train"</span><span class="p">:</span> <span class="mi">640704</span><span class="p">,</span>
<span></span>    <span class="p">}</span>
<span></span>
<span></span>    <span class="n">instance_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="s2">"bboxes"</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">)</span>
<span></span>    <span class="k">for</span> <span class="n">data_name</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">expected_counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span></span>        <span class="k">if</span> <span class="n">data_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_file</span><span class="p">:</span>
<span></span>            <span class="k">assert</span> <span class="n">instance_count</span> <span class="o">==</span> <span class="n">count</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">json_file</span><span class="si">}</span><span class="s2">' has </span><span class="si">{</span><span class="n">instance_count</span><span class="si">}</span><span class="s2"> instances, expected </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">."</span>
<span></span>            <span class="k">return</span>
<span></span>    <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Skipping instance count verification for unrecognized dataset '</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">json_file</span><span class="si">}</span><span class="s2">'"</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.dataset.YOLOConcatDataset"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.data.dataset.YOLOConcatDataset</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">YOLOConcatDataset</span><span class="p">()</span>
</code></pre></div><p><strong>Bases:</strong> <code>ConcatDataset</code></p><p>Dataset as a concatenation of multiple datasets.</p><p>This class is useful to assemble different existing datasets for YOLO training, ensuring they use the same collation function.</p><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.data.dataset.YOLOConcatDataset.close_mosaic"><code>close_mosaic</code></a></td><td>Set mosaic, copy_paste and mixup options to 0.0 and build transformations.</td></tr><tr><td><a href="#ultralytics.data.dataset.YOLOConcatDataset.collate_fn"><code>collate_fn</code></a></td><td>Collate data samples into batches.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">dataset1</span> <span class="o">=</span> <span class="n">YOLODataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">dataset2</span> <span class="o">=</span> <span class="n">YOLODataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">combined_dataset</span> <span class="o">=</span> <span class="n">YOLOConcatDataset</span><span class="p">([</span><span class="n">dataset1</span><span class="p">,</span> <span class="n">dataset2</span><span class="p">])</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L642-L678"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">YOLOConcatDataset</span><span class="p">(</span><span class="n">ConcatDataset</span><span class="p">):</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.YOLOConcatDataset.close_mosaic"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.YOLOConcatDataset.close_mosaic</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">close_mosaic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p>Set mosaic, copy_paste and mixup options to 0.0 and build transformations.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>hyp</code></td><td><code>dict</code></td><td>Hyperparameters for transforms.</td><td><em>required</em></td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L669-L678"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">close_mosaic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Set mosaic, copy_paste and mixup options to 0.0 and build transformations.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        hyp (dict): Hyperparameters for transforms.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">:</span>
<span></span>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="s2">"close_mosaic"</span><span class="p">):</span>
<span></span>            <span class="k">continue</span>
<span></span>        <span class="n">dataset</span><span class="o">.</span><span class="n">close_mosaic</span><span class="p">(</span><span class="n">hyp</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.YOLOConcatDataset.collate_fn"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.YOLOConcatDataset.collate_fn</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">collate_fn</span><span class="p">(</span><span class="n">batch</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div><p>Collate data samples into batches.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>batch</code></td><td><code>list[dict]</code></td><td>List of dictionaries containing sample data.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>dict</code></td><td>Collated batch with stacked tensors.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L658-L667"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@staticmethod</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">collate_fn</span><span class="p">(</span><span class="n">batch</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Collate data samples into batches.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        batch (list[dict]): List of dictionaries containing sample data.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): Collated batch with stacked tensors.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="n">YOLODataset</span><span class="o">.</span><span class="n">collate_fn</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.dataset.SemanticDataset"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.data.dataset.SemanticDataset</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">SemanticDataset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p><strong>Bases:</strong> <code>BaseDataset</code></p><p>Semantic Segmentation Dataset.</p><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L682-L687"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SemanticDataset</span><span class="p">(</span><span class="n">BaseDataset</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Semantic Segmentation Dataset."""</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize a SemanticDataset object."""</span>
<span></span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.data.dataset.ClassificationDataset"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.data.dataset.ClassificationDataset</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">ClassificationDataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">augment</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">""</span><span class="p">)</span>
</code></pre></div><p>Dataset class for image classification tasks extending torchvision ImageFolder functionality.</p><p>This class offers functionalities like image augmentation, caching, and verification. It's designed to efficiently handle large datasets for training deep learning models, with optional image transformations and caching mechanisms to speed up training.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>root</code></td><td><code>str</code></td><td>Path to the dataset directory where images are stored in a class-specific folder structure.</td><td><em>required</em></td></tr><tr><td><code>args</code></td><td><code>Namespace</code></td><td>Configuration containing dataset-related settings such as image size, augmentation parameters, and cache settings.</td><td><em>required</em></td></tr><tr><td><code>augment</code></td><td><code>bool, optional</code></td><td>Whether to apply augmentations to the dataset.</td><td><code>False</code></td></tr><tr><td><code>prefix</code></td><td><code>str, optional</code></td><td>Prefix for logging and cache filenames, aiding in dataset identification.</td><td><code>""</code></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>cache_ram</code></td><td><code>bool</code></td><td>Indicates if caching in RAM is enabled.</td></tr><tr><td><code>cache_disk</code></td><td><code>bool</code></td><td>Indicates if caching on disk is enabled.</td></tr><tr><td><code>samples</code></td><td><code>list</code></td><td>A list of tuples, each containing the path to an image, its class index, path to its .npy cache file (if caching on disk), and optionally the loaded image array (if caching in RAM).</td></tr><tr><td><code>torch_transforms</code></td><td><code>callable</code></td><td>PyTorch transforms to be applied to the images.</td></tr><tr><td><code>root</code></td><td><code>str</code></td><td>Root directory of the dataset.</td></tr><tr><td><code>prefix</code></td><td><code>str</code></td><td>Prefix for logging and cache filenames.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.data.dataset.ClassificationDataset.__getitem__"><code>__getitem__</code></a></td><td>Return subset of data and targets corresponding to given indices.</td></tr><tr><td><a href="#ultralytics.data.dataset.ClassificationDataset.__len__"><code>__len__</code></a></td><td>Return the total number of samples in the dataset.</td></tr><tr><td><a href="#ultralytics.data.dataset.ClassificationDataset.verify_images"><code>verify_images</code></a></td><td>Verify all images in dataset.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L690-L834"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ClassificationDataset</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Dataset class for image classification tasks extending torchvision ImageFolder functionality.</span>
<span></span>
<span></span><span class="sd">    This class offers functionalities like image augmentation, caching, and verification. It's designed to efficiently</span>
<span></span><span class="sd">    handle large datasets for training deep learning models, with optional image transformations and caching mechanisms</span>
<span></span><span class="sd">    to speed up training.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        cache_ram (bool): Indicates if caching in RAM is enabled.</span>
<span></span><span class="sd">        cache_disk (bool): Indicates if caching on disk is enabled.</span>
<span></span><span class="sd">        samples (list): A list of tuples, each containing the path to an image, its class index, path to its .npy cache</span>
<span></span><span class="sd">            file (if caching on disk), and optionally the loaded image array (if caching in RAM).</span>
<span></span><span class="sd">        torch_transforms (callable): PyTorch transforms to be applied to the images.</span>
<span></span><span class="sd">        root (str): Root directory of the dataset.</span>
<span></span><span class="sd">        prefix (str): Prefix for logging and cache filenames.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        __getitem__: Return subset of data and targets corresponding to given indices.</span>
<span></span><span class="sd">        __len__: Return the total number of samples in the dataset.</span>
<span></span><span class="sd">        verify_images: Verify all images in dataset.</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">augment</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">""</span><span class="p">):</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize YOLO classification dataset with root directory, arguments, augmentations, and cache settings.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            root (str): Path to the dataset directory where images are stored in a class-specific folder structure.</span>
<span></span><span class="sd">            args (Namespace): Configuration containing dataset-related settings such as image size, augmentation</span>
<span></span><span class="sd">                parameters, and cache settings.</span>
<span></span><span class="sd">            augment (bool, optional): Whether to apply augmentations to the dataset.</span>
<span></span><span class="sd">            prefix (str, optional): Prefix for logging and cache filenames, aiding in dataset identification.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="kn">import</span><span class="w"> </span><span class="nn">torchvision</span>  <span class="c1"># scope for faster 'import ultralytics'</span>
<span></span>
<span></span>        <span class="c1"># Base class assigned as attribute rather than used as base class to allow for scoping slow torchvision import</span>
<span></span>        <span class="k">if</span> <span class="n">TORCHVISION_0_18</span><span class="p">:</span>  <span class="c1"># 'allow_empty' argument first introduced in torchvision 0.18</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">ImageFolder</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">allow_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>        <span class="k">else</span><span class="p">:</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">ImageFolder</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">)</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">samples</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">root</span>
<span></span>
<span></span>        <span class="c1"># Initialize attributes</span>
<span></span>        <span class="k">if</span> <span class="n">augment</span> <span class="ow">and</span> <span class="n">args</span><span class="o">.</span><span class="n">fraction</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>  <span class="c1"># reduce training fraction</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">[:</span> <span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span> <span class="o">*</span> <span class="n">args</span><span class="o">.</span><span class="n">fraction</span><span class="p">)]</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="n">colorstr</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">: "</span><span class="p">)</span> <span class="k">if</span> <span class="n">prefix</span> <span class="k">else</span> <span class="s2">""</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">cache_ram</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">cache</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"ram"</span>  <span class="c1"># cache images into RAM</span>
<span></span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_ram</span><span class="p">:</span>
<span></span>            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<span></span>                <span class="s2">"Classification `cache_ram` training has known memory leak in "</span>
<span></span>                <span class="s2">"https://github.com/ultralytics/ultralytics/issues/9824, setting `cache_ram=False`."</span>
<span></span>            <span class="p">)</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">cache_ram</span> <span class="o">=</span> <span class="kc">False</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">cache_disk</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"disk"</span>  <span class="c1"># cache images on hard drive as uncompressed *.npy files</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verify_images</span><span class="p">()</span>  <span class="c1"># filter out bad images</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="o">=</span> <span class="p">[[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">".npy"</span><span class="p">),</span> <span class="kc">None</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">]</span>  <span class="c1"># file, index, npy, im</span>
<span></span>        <span class="n">scale</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">args</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>  <span class="c1"># (0.08, 1.0)</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">torch_transforms</span> <span class="o">=</span> <span class="p">(</span>
<span></span>            <span class="n">classify_augmentations</span><span class="p">(</span>
<span></span>                <span class="n">size</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">imgsz</span><span class="p">,</span>
<span></span>                <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
<span></span>                <span class="n">hflip</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">fliplr</span><span class="p">,</span>
<span></span>                <span class="n">vflip</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">flipud</span><span class="p">,</span>
<span></span>                <span class="n">erasing</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">erasing</span><span class="p">,</span>
<span></span>                <span class="n">auto_augment</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">auto_augment</span><span class="p">,</span>
<span></span>                <span class="n">hsv_h</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">hsv_h</span><span class="p">,</span>
<span></span>                <span class="n">hsv_s</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">hsv_s</span><span class="p">,</span>
<span></span>                <span class="n">hsv_v</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">hsv_v</span><span class="p">,</span>
<span></span>            <span class="p">)</span>
<span></span>            <span class="k">if</span> <span class="n">augment</span>
<span></span>            <span class="k">else</span> <span class="n">classify_transforms</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">imgsz</span><span class="p">)</span>
<span></span>        <span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.ClassificationDataset.__getitem__"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.ClassificationDataset.__getitem__</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>
</code></pre></div><p>Return subset of data and targets corresponding to given indices.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>i</code></td><td><code>int</code></td><td>Index of the sample to retrieve.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>dict</code></td><td>Dictionary containing the image and its class index.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L763-L785"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return subset of data and targets corresponding to given indices.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        i (int): Index of the sample to retrieve.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (dict): Dictionary containing the image and its class index.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">f</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># filename, index, filename.with_suffix('.npy'), image</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_ram</span><span class="p">:</span>
<span></span>        <span class="k">if</span> <span class="n">im</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Warning: two separate if statements required here, do not combine this with previous line</span>
<span></span>            <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span></span>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_disk</span><span class="p">:</span>
<span></span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">fn</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>  <span class="c1"># load npy</span>
<span></span>            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span></span>        <span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span></span>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># read image</span>
<span></span>        <span class="n">im</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># BGR</span>
<span></span>    <span class="c1"># Convert NumPy array to PIL image</span>
<span></span>    <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span></span>    <span class="n">sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">torch_transforms</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="p">{</span><span class="s2">"img"</span><span class="p">:</span> <span class="n">sample</span><span class="p">,</span> <span class="s2">"cls"</span><span class="p">:</span> <span class="n">j</span><span class="p">}</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.ClassificationDataset.__len__"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.ClassificationDataset.__len__</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div><p>Return the total number of samples in the dataset.</p><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L787-L789"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the total number of samples in the dataset."""</span>
<span></span>    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.data.dataset.ClassificationDataset.verify_images"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.data.dataset.ClassificationDataset.verify_images</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">verify_images</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span>
</code></pre></div><p>Verify all images in dataset.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list</code></td><td>List of valid samples after verification.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/data/dataset.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/data/dataset.py#L791-L834"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">verify_images</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Verify all images in dataset.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list): List of valid samples after verification.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">desc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="si">}</span><span class="s2">Scanning </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="s2">..."</span>
<span></span>    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">".cache"</span><span class="p">)</span>  <span class="c1"># *.cache file path</span>
<span></span>
<span></span>    <span class="k">try</span><span class="p">:</span>
<span></span>        <span class="n">check_file_speeds</span><span class="p">([</span><span class="n">file</span> <span class="k">for</span> <span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">[:</span><span class="mi">5</span><span class="p">]],</span> <span class="n">prefix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>  <span class="c1"># check image read speeds</span>
<span></span>        <span class="n">cache</span> <span class="o">=</span> <span class="n">load_dataset_cache_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>  <span class="c1"># attempt to load a *.cache file</span>
<span></span>        <span class="k">assert</span> <span class="n">cache</span><span class="p">[</span><span class="s2">"version"</span><span class="p">]</span> <span class="o">==</span> <span class="n">DATASET_CACHE_VERSION</span>  <span class="c1"># matches current version</span>
<span></span>        <span class="k">assert</span> <span class="n">cache</span><span class="p">[</span><span class="s2">"hash"</span><span class="p">]</span> <span class="o">==</span> <span class="n">get_hash</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">])</span>  <span class="c1"># identical hash</span>
<span></span>        <span class="n">nf</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">samples</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"results"</span><span class="p">)</span>  <span class="c1"># found, missing, empty, corrupt, total</span>
<span></span>        <span class="k">if</span> <span class="n">LOCAL_RANK</span> <span class="ow">in</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">}:</span>
<span></span>            <span class="n">d</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">desc</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">nf</span><span class="si">}</span><span class="s2"> images, </span><span class="si">{</span><span class="n">nc</span><span class="si">}</span><span class="s2"> corrupt"</span>
<span></span>            <span class="n">TQDM</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span></span>            <span class="k">if</span> <span class="n">cache</span><span class="p">[</span><span class="s2">"msgs"</span><span class="p">]:</span>
<span></span>                <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cache</span><span class="p">[</span><span class="s2">"msgs"</span><span class="p">]))</span>  <span class="c1"># display warnings</span>
<span></span>        <span class="k">return</span> <span class="n">samples</span>
<span></span>
<span></span>    <span class="k">except</span> <span class="p">(</span><span class="ne">FileNotFoundError</span><span class="p">,</span> <span class="ne">AssertionError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
<span></span>        <span class="c1"># Run scan if *.cache retrieval failed</span>
<span></span>        <span class="n">nf</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">msgs</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">{}</span>
<span></span>        <span class="k">with</span> <span class="n">ThreadPool</span><span class="p">(</span><span class="n">NUM_THREADS</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
<span></span>            <span class="n">results</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">imap</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">verify_image</span><span class="p">,</span> <span class="n">iterable</span><span class="o">=</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">,</span> <span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="p">)))</span>
<span></span>            <span class="n">pbar</span> <span class="o">=</span> <span class="n">TQDM</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">))</span>
<span></span>            <span class="k">for</span> <span class="n">sample</span><span class="p">,</span> <span class="n">nf_f</span><span class="p">,</span> <span class="n">nc_f</span><span class="p">,</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
<span></span>                <span class="k">if</span> <span class="n">nf_f</span><span class="p">:</span>
<span></span>                    <span class="n">samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span></span>                <span class="k">if</span> <span class="n">msg</span><span class="p">:</span>
<span></span>                    <span class="n">msgs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span></span>                <span class="n">nf</span> <span class="o">+=</span> <span class="n">nf_f</span>
<span></span>                <span class="n">nc</span> <span class="o">+=</span> <span class="n">nc_f</span>
<span></span>                <span class="n">pbar</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">desc</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">nf</span><span class="si">}</span><span class="s2"> images, </span><span class="si">{</span><span class="n">nc</span><span class="si">}</span><span class="s2"> corrupt"</span>
<span></span>            <span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span></span>        <span class="k">if</span> <span class="n">msgs</span><span class="p">:</span>
<span></span>            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">msgs</span><span class="p">))</span>
<span></span>        <span class="n">x</span><span class="p">[</span><span class="s2">"hash"</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_hash</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">])</span>
<span></span>        <span class="n">x</span><span class="p">[</span><span class="s2">"results"</span><span class="p">]</span> <span class="o">=</span> <span class="n">nf</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">),</span> <span class="n">samples</span>
<span></span>        <span class="n">x</span><span class="p">[</span><span class="s2">"msgs"</span><span class="p">]</span> <span class="o">=</span> <span class="n">msgs</span>  <span class="c1"># warnings</span>
<span></span>        <span class="n">save_dataset_cache_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">DATASET_CACHE_VERSION</span><span class="p">)</span>
<span></span>        <span class="k">return</span> <span class="n">samples</span>
</code></pre></div></details><p><br/><br/></p><br/><br/><div class="git-info"><div class="dates-container"><span class="date-item" title="This page was first created on November 12, 2023"><span class="hover-item">ğŸ“…</span> Created 2 years ago </span><span class="date-item" title="This page was last updated on November 23, 2025"><span class="hover-item">âœï¸</span> Updated 3 days ago </span></div><div class="authors-container"><a class="author-link" href="https://github.com/glenn-jocher" title="glenn-jocher (8 changes)"><img alt="glenn-jocher" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/26833433?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/jk4e" title="jk4e (1 change)"><img alt="jk4e" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/116908874?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/Burhan-Q" title="Burhan-Q (1 change)"><img alt="Burhan-Q" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62214284?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/Laughing-q" title="Laughing-q (1 change)"><img alt="Laughing-q" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/61612323?v=4&amp;s=96"/></a></div></div><div class="share-buttons"><button class="share-button hover-item" onclick="window.open('https://twitter.com/intent/tweet?url=https%3A%2F%2Fdocs.ultralytics.com%2Freference%2Fdata%2Fdataset%2F', 'TwitterShare', 'width=550,height=680,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-x-twitter"></i> Tweet </button><button class="share-button hover-item linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fdocs.ultralytics.com%2Freference%2Fdata%2Fdataset%2F', 'LinkedinShare', 'width=550,height=730,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-linkedin-in"></i> Share </button></div><br/></article></div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div><button class="md-top md-icon" data-md-component="top" hidden="" type="button"><svg class="lucide lucide-circle-arrow-up" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10"></circle><path d="m16 12-4-4-4 4M12 16V8"></path></svg> Back to top
</button></main><footer class="md-footer"><nav aria-label="Footer" class="md-footer__inner md-grid"><a aria-label="Previous: converter" class="md-footer__link md-footer__link--prev" href="../converter/"><div class="md-footer__button md-icon"><svg class="lucide lucide-arrow-left" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12 19-7-7 7-7M19 12H5"></path></svg></div><div class="md-footer__title"><span class="md-footer__direction"> Previous </span><div class="md-ellipsis"> converter </div></div></a><a aria-label="Next: loaders" class="md-footer__link md-footer__link--next" href="../loaders/"><div class="md-footer__title"><span class="md-footer__direction"> Next </span><div class="md-ellipsis"> loaders </div></div><div class="md-footer__button md-icon"><svg class="lucide lucide-arrow-right" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 12h14M12 5l7 7-7 7"></path></svg></div></a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-copyright"><div class="md-copyright__highlight"><a href="https://www.ultralytics.com/" target="_blank">Â© 2025 Ultralytics Inc.</a> All rights reserved. </div> Made with <a href="https://zensical.org/" rel="noopener" target="_blank"> Zensical </a></div><div class="md-social"><a class="md-social__link" href="https://github.com/ultralytics" rel="noopener" target="_blank" title="github.com"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://www.linkedin.com/company/ultralytics/" rel="noopener" target="_blank" title="www.linkedin.com"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://x.com/ultralytics" rel="noopener" target="_blank" title="x.com"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://youtube.com/ultralytics?sub_confirmation=1" rel="noopener" target="_blank" title="youtube.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://hub.docker.com/r/ultralytics/ultralytics/" rel="noopener" target="_blank" title="hub.docker.com"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://pypi.org/project/ultralytics/" rel="noopener" target="_blank" title="pypi.org"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://discord.com/invite/ultralytics" rel="noopener" target="_blank" title="discord.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://reddit.com/r/ultralytics" rel="noopener" target="_blank" title="reddit.com"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://weixin.qq.com/r/mp/LxckPDfEgWr_rXNf90I9" rel="noopener" target="_blank" title="weixin.qq.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6" fill="currentColor"></path></svg></a></div></div></div></footer></div><div class="md-dialog" data-md-component="dialog"><div class="md-dialog__inner md-typeset"></div></div><div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"annotate":null,"base":"../../..","features":["content.action.edit","content.code.annotate","content.code.copy","content.tooltips","toc.follow","navigation.top","navigation.tabs","navigation.tabs.sticky","navigation.prune","navigation.footer","navigation.tracking","navigation.instant","navigation.instant.progress","navigation.indexes","navigation.sections","content.tabs.link"],"search":"../../../assets/javascripts/workers/search.5df7522c.min.js","tags":null,"translations":{"clipboard.copied":"Copied to clipboard","clipboard.copy":"Copy to clipboard","search.result.more.one":"1 more on this page","search.result.more.other":"# more on this page","search.result.none":"No matching documents","search.result.one":"1 matching document","search.result.other":"# matching documents","search.result.placeholder":"Type to start searching","search.result.term.missing":"Missing","select.version":"Select version"},"version":null}</script>
<script src="../../../assets/javascripts/bundle.21aa498e.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/ultralytics/llm@v0.0.8/js/chat.min.js"></script>
<script src="https://unpkg.com/tablesort@5.6.0/dist/tablesort.min.js"></script>
<script src="../../../javascript/extra.js"></script>
<script src="../../../javascript/giscus.js"></script>
<script src="../../../javascript/tablesort.js"></script>
</body></html>