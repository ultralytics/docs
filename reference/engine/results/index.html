 <!DOCTYPE html><html class="no-js" lang="en"><head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Explore the details of Ultralytics engine results including classes like BaseTensor, Results, Boxes, Masks, Keypoints, Probs, and OBB to handle inference results efficiently." name="description"/><meta content="Ultralytics" name="author"/><link href="https://docs.ultralytics.com/reference/engine/results/" rel="canonical"/><link href="../predictor/" rel="prev"/><link href="../trainer/" rel="next"/><link href="/" hreflang="en" rel="alternate"/><link href="/zh/" hreflang="zh" rel="alternate"/><link href="/ko/" hreflang="ko" rel="alternate"/><link href="/ja/" hreflang="ja" rel="alternate"/><link href="/ru/" hreflang="ru" rel="alternate"/><link href="/de/" hreflang="de" rel="alternate"/><link href="/fr/" hreflang="fr" rel="alternate"/><link href="/es/" hreflang="es" rel="alternate"/><link href="/pt/" hreflang="pt" rel="alternate"/><link href="/it/" hreflang="it" rel="alternate"/><link href="/tr/" hreflang="tr" rel="alternate"/><link href="/vi/" hreflang="vi" rel="alternate"/><link href="/ar/" hreflang="ar" rel="alternate"/><link href="https://raw.githubusercontent.com/ultralytics/assets/refs/heads/main/logo/favicon-yolo.png" rel="icon"/><meta content="zensical-0.0.10" name="generator"/><title>Reference for ultralytics/engine/results.py - Ultralytics YOLO Docs</title><link href="../../../assets/stylesheets/modern/main.eafc6f7f.min.css" rel="stylesheet"/><link href="../../../assets/stylesheets/modern/palette.dfe2e883.min.css" rel="stylesheet"/><style>:root{}</style><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,500,500i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link href="../../../stylesheets/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)),0),__md_get=(e,t=localStorage,a=__md_scope)=>JSON.parse(t.getItem(a.pathname+"."+e)),__md_set=(e,t,a=localStorage,_=__md_scope)=>{try{a.setItem(_.pathname+"."+e,JSON.stringify(t))}catch(e){}},document.documentElement.setAttribute("data-platform",navigator.platform)</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2M5EHKC0BH"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2M5EHKC0BH",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2M5EHKC0BH",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
<style data-doc-kind="true">.doc-kind{display:inline-flex;align-items:center;gap:0.25em;padding:0.21em 0.59em;border-radius:999px;font-weight:700;font-size:0.81em;letter-spacing:0.06em;text-transform:uppercase;line-height:1;color:var(--doc-kind-color,#f8fafc);background:var(--doc-kind-bg,rgba(255,255,255,0.12));}.doc-kind-class{--doc-kind-color:#039dfc;--doc-kind-bg:rgba(3,157,252,0.22);}.doc-kind-function{--doc-kind-color:#fc9803;--doc-kind-bg:rgba(252,152,3,0.22);}.doc-kind-method{--doc-kind-color:#ef5eff;--doc-kind-bg:rgba(239,94,255,0.22);}.doc-kind-property{--doc-kind-color:#02e835;--doc-kind-bg:rgba(2,232,53,0.22);}</style><meta content="Reference for ultralytics/engine/results.py" name="title"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"/><meta content="website" property="og:type"/><meta content="https://docs.ultralytics.com/reference/engine/results/" property="og:url"/><meta content="Reference for ultralytics/engine/results.py" property="og:title"/><meta content="" property="og:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="og:image"/><meta content="summary_large_image" property="twitter:card"/><meta content="https://docs.ultralytics.com/reference/engine/results/" property="twitter:url"/><meta content="Reference for ultralytics/engine/results.py" property="twitter:title"/><meta content="" property="twitter:description"/><meta content="https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png" property="twitter:image"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "headline": "Reference for ultralytics/engine/results.py", "image": ["https://raw.githubusercontent.com/ultralytics/assets/main/yolov8/banner-yolov8.png"], "datePublished": "2023-11-12 02:49:37 +0100", "dateModified": "2025-11-23 19:53:50 +0100", "author": [{"@type": "Organization", "name": "Ultralytics", "url": "https://ultralytics.com/"}], "abstract": ""}</script></head><body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr"><input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/><input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/><label class="md-overlay" for="__drawer"></label><div data-md-component="skip"><a class="md-skip" href="#reference-for-ultralyticsengineresultspy"> Skip to content </a></div><div data-md-component="announce"><aside class="md-banner"><div class="md-banner__inner md-grid md-typeset"><a class="banner-wrapper" href="https://www.ultralytics.com/news/ultralytics-raises-30m-series-a" target="_blank"><div class="banner-content-wrapper"><img alt="Ultralytics raises $30M Series A" height="40" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac336b5de2ae8b398bca_writting.svg"/><div class="vc-wrapper"><img alt="Elephant" height="28" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac33c95408144846afc7_image%201.png"/><img alt="SquareOne" height="28" src="https://cdn.prod.website-files.com/680a070c3b99253410dd3dcf/691dac3333068d9632cc6df8_image%202.png"/></div></div></a></div></aside></div><header class="md-header md-header--shadow md-header--lifted" data-md-component="header"><nav aria-label="Header" class="md-header__inner md-grid"><a aria-label="Ultralytics YOLO Docs" class="md-header__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs"><img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/></a><label class="md-header__button md-icon" for="__drawer"><svg class="lucide lucide-menu" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 5h16M4 12h16M4 19h16"></path></svg></label><div class="md-header__title" data-md-component="header-title"><div class="md-header__ellipsis"><div class="md-header__topic"><span class="md-ellipsis"> Ultralytics YOLO Docs </span></div><div class="md-header__topic" data-md-component="header-topic"><span class="md-ellipsis"> Reference for ultralytics/engine/results.py </span></div></div></div><form class="md-header__option" data-md-component="palette"><input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg></label><input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to system preference"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label><input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/><label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg></label></form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<div class="md-header__option"><div class="md-select"><button aria-label="Select language" class="md-header__button md-icon"><svg class="lucide lucide-languages" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m5 8 6 6M4 14l6-6 2-3M2 5h12M7 2h1M22 22l-5-10-5 10M14 18h6"></path></svg></button><div class="md-select__inner"><ul class="md-select__list"><li class="md-select__item"><a class="md-select__link" href="/" hreflang="en"> ğŸ‡¬ğŸ‡§ English </a></li><li class="md-select__item"><a class="md-select__link" href="/zh/" hreflang="zh"> ğŸ‡¨ğŸ‡³ ç®€ä½“ä¸­æ–‡ </a></li><li class="md-select__item"><a class="md-select__link" href="/ko/" hreflang="ko"> ğŸ‡°ğŸ‡· í•œêµ­ì–´ </a></li><li class="md-select__item"><a class="md-select__link" href="/ja/" hreflang="ja"> ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª </a></li><li class="md-select__item"><a class="md-select__link" href="/ru/" hreflang="ru"> ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹ </a></li><li class="md-select__item"><a class="md-select__link" href="/de/" hreflang="de"> ğŸ‡©ğŸ‡ª Deutsch </a></li><li class="md-select__item"><a class="md-select__link" href="/fr/" hreflang="fr"> ğŸ‡«ğŸ‡· FranÃ§ais </a></li><li class="md-select__item"><a class="md-select__link" href="/es/" hreflang="es"> ğŸ‡ªğŸ‡¸ EspaÃ±ol </a></li><li class="md-select__item"><a class="md-select__link" href="/pt/" hreflang="pt"> ğŸ‡µğŸ‡¹ PortuguÃªs </a></li><li class="md-select__item"><a class="md-select__link" href="/it/" hreflang="it"> ğŸ‡®ğŸ‡¹ Italiano </a></li><li class="md-select__item"><a class="md-select__link" href="/tr/" hreflang="tr"> ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e </a></li><li class="md-select__item"><a class="md-select__link" href="/vi/" hreflang="vi"> ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t </a></li><li class="md-select__item"><a class="md-select__link" href="/ar/" hreflang="ar"> ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© </a></li></ul></div></div></div><label class="md-header__button md-icon" for="__search"><svg class="lucide lucide-search" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m21 21-4.34-4.34"></path><circle cx="11" cy="11" r="8"></circle></svg></label><div aria-label="Search" class="md-search" data-md-component="search" role="dialog"><button class="md-search__button" type="button"> Search </button></div><div class="md-header__source"><a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository"><div class="md-source__icon md-icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></div><div class="md-source__repository"> ultralytics/ultralytics </div></a></div></nav><nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"><div class="md-grid"><ul class="md-tabs__list"><li class="md-tabs__item"><a class="md-tabs__link" href="../../.."> Home </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../quickstart/"> Quickstart </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../modes/"> Modes </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../tasks/"> Tasks </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../models/"> Models </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../datasets/"> Datasets </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../solutions/"> Solutions </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../guides/"> Guides </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../integrations/"> Integrations </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../hub/"> HUB </a></li><li class="md-tabs__item md-tabs__item--active"><a class="md-tabs__link" href="../../__init__/"> Reference </a></li><li class="md-tabs__item"><a class="md-tabs__link" href="../../../help/"> Help </a></li></ul></div></nav></header><div class="md-container" data-md-component="container"><main class="md-main" data-md-component="main"><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0"><label class="md-nav__title" for="__drawer"><a aria-label="Ultralytics YOLO Docs" class="md-nav__button md-logo" data-md-component="logo" href="https://www.ultralytics.com/" title="Ultralytics YOLO Docs"><img alt="logo" src="https://raw.githubusercontent.com/ultralytics/assets/main/logo/Ultralytics_Logotype_Reverse.svg"/></a> Ultralytics YOLO Docs </label><div class="md-nav__source"><a class="md-source" data-md-component="source" href="https://github.com/ultralytics/ultralytics" title="Go to repository"><div class="md-source__icon md-icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></div><div class="md-source__repository"> ultralytics/ultralytics </div></a></div><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../.."><span class="md-ellipsis"> Home </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../quickstart/"><span class="md-ellipsis"> Quickstart </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../modes/"><span class="md-ellipsis"> Modes </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../tasks/"><span class="md-ellipsis"> Tasks </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../models/"><span class="md-ellipsis"> Models </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../datasets/"><span class="md-ellipsis"> Datasets </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../solutions/"><span class="md-ellipsis"> Solutions </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../guides/"><span class="md-ellipsis"> Guides </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../integrations/"><span class="md-ellipsis"> Integrations </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../hub/"><span class="md-ellipsis"> HUB </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input checked="" class="md-nav__toggle md-toggle" id="__nav_11" type="checkbox"/><label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex=""><span class="md-ellipsis"> Reference </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="true" aria-labelledby="__nav_11_label" class="md-nav" data-md-level="1"><label class="md-nav__title" for="__nav_11"><span class="md-nav__icon md-icon"></span> Reference </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_2" type="checkbox"/><label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex=""><span class="md-ellipsis"> cfg </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_2_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_2"><span class="md-nav__icon md-icon"></span> cfg </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../cfg/__init__/"><span class="md-ellipsis"> __init__ </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_3" type="checkbox"/><label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex=""><span class="md-ellipsis"> data </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_3_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_3"><span class="md-nav__icon md-icon"></span> data </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../data/annotator/"><span class="md-ellipsis"> annotator </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/augment/"><span class="md-ellipsis"> augment </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/base/"><span class="md-ellipsis"> base </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/build/"><span class="md-ellipsis"> build </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/converter/"><span class="md-ellipsis"> converter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/dataset/"><span class="md-ellipsis"> dataset </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/loaders/"><span class="md-ellipsis"> loaders </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/split/"><span class="md-ellipsis"> split </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/split_dota/"><span class="md-ellipsis"> split_dota </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../data/utils/"><span class="md-ellipsis"> utils </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input checked="" class="md-nav__toggle md-toggle" id="__nav_11_4" type="checkbox"/><label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex=""><span class="md-ellipsis"> engine </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="true" aria-labelledby="__nav_11_4_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_4"><span class="md-nav__icon md-icon"></span> engine </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../exporter/"><span class="md-ellipsis"> exporter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../model/"><span class="md-ellipsis"> model </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../predictor/"><span class="md-ellipsis"> predictor </span></a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/><label class="md-nav__link md-nav__link--active" for="__toc"><span class="md-ellipsis"> results </span><span class="md-nav__icon md-icon"></span></label><a class="md-nav__link md-nav__link--active" href="./"><span class="md-ellipsis"> results </span></a><nav aria-label="On this page" class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc"><span class="md-nav__icon md-icon"></span> On this page </label><ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> BaseTensor</span></a><nav aria-label="Class ultralytics.engine.results.BaseTensor" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor.shape"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> shape</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor.__getitem__"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> __getitem__</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor.__len__"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> __len__</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor.cpu"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> cpu</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor.cuda"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> cuda</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor.numpy"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> numpy</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor.to"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> to</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> Results</span></a><nav aria-label="Class ultralytics.engine.results.Results" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.__getitem__"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> __getitem__</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.__len__"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> __len__</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results._apply"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> _apply</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.cpu"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> cpu</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.cuda"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> cuda</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.new"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> new</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.numpy"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> numpy</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.plot"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> plot</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.save"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> save</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.save_crop"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> save_crop</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.save_txt"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> save_txt</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.show"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> show</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.summary"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> summary</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.to"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> to</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.update"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> update</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.verbose"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> verbose</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> Boxes</span></a><nav aria-label="Class ultralytics.engine.results.Boxes" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes.xyxy"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xyxy</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes.conf"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> conf</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes.cls"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> cls</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes.id"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> id</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes.xywh"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xywh</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes.xyxyn"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xyxyn</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes.xywhn"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xywhn</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Masks"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> Masks</span></a><nav aria-label="Class ultralytics.engine.results.Masks" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Masks.xyn"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xyn</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Masks.xy"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xy</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Keypoints"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> Keypoints</span></a><nav aria-label="Class ultralytics.engine.results.Keypoints" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Keypoints.xy"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xy</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Keypoints.xyn"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xyn</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Keypoints.conf"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> conf</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Probs"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> Probs</span></a><nav aria-label="Class ultralytics.engine.results.Probs" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Probs.top1"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> top1</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Probs.top5"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> top5</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Probs.top1conf"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> top1conf</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Probs.top5conf"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> top5conf</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> OBB</span></a><nav aria-label="Class ultralytics.engine.results.OBB" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB.xywhr"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xywhr</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB.conf"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> conf</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB.cls"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> cls</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB.id"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> id</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB.xyxyxyxy"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xyxyxyxy</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB.xyxyxyxyn"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xyxyxyxyn</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB.xyxy"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xyxy</span></a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="../trainer/"><span class="md-ellipsis"> trainer </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../tuner/"><span class="md-ellipsis"> tuner </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../validator/"><span class="md-ellipsis"> validator </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_5" type="checkbox"/><label class="md-nav__link" for="__nav_11_5" id="__nav_11_5_label" tabindex=""><span class="md-ellipsis"> hub </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_5_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_5"><span class="md-nav__icon md-icon"></span> hub </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../hub/__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/auth/"><span class="md-ellipsis"> auth </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../hub/google/__init__/"><span class="md-ellipsis"> google </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/session/"><span class="md-ellipsis"> session </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../hub/utils/"><span class="md-ellipsis"> utils </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_6" type="checkbox"/><label class="md-nav__link" for="__nav_11_6" id="__nav_11_6_label" tabindex=""><span class="md-ellipsis"> models </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_6_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_6"><span class="md-nav__icon md-icon"></span> models </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/fastsam/model/"><span class="md-ellipsis"> fastsam </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/nas/model/"><span class="md-ellipsis"> nas </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/rtdetr/model/"><span class="md-ellipsis"> rtdetr </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/sam/amg/"><span class="md-ellipsis"> sam </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/utils/loss/"><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../models/yolo/classify/predict/"><span class="md-ellipsis"> yolo </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_7" type="checkbox"/><label class="md-nav__link" for="__nav_11_7" id="__nav_11_7_label" tabindex=""><span class="md-ellipsis"> nn </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_7_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_7"><span class="md-nav__icon md-icon"></span> nn </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../nn/autobackend/"><span class="md-ellipsis"> autobackend </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../nn/modules/activation/"><span class="md-ellipsis"> modules </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../nn/tasks/"><span class="md-ellipsis"> tasks </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../nn/text_model/"><span class="md-ellipsis"> text_model </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_8" type="checkbox"/><label class="md-nav__link" for="__nav_11_8" id="__nav_11_8_label" tabindex=""><span class="md-ellipsis"> solutions </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_8_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_8"><span class="md-nav__icon md-icon"></span> solutions </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/ai_gym/"><span class="md-ellipsis"> ai_gym </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/analytics/"><span class="md-ellipsis"> analytics </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/config/"><span class="md-ellipsis"> config </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/distance_calculation/"><span class="md-ellipsis"> distance_calculation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/heatmap/"><span class="md-ellipsis"> heatmap </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/instance_segmentation/"><span class="md-ellipsis"> instance_segmentation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_blurrer/"><span class="md-ellipsis"> object_blurrer </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_counter/"><span class="md-ellipsis"> object_counter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/object_cropper/"><span class="md-ellipsis"> object_cropper </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/parking_management/"><span class="md-ellipsis"> parking_management </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/queue_management/"><span class="md-ellipsis"> queue_management </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/region_counter/"><span class="md-ellipsis"> region_counter </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/security_alarm/"><span class="md-ellipsis"> security_alarm </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/similarity_search/"><span class="md-ellipsis"> similarity_search </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/solutions/"><span class="md-ellipsis"> solutions </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/speed_estimation/"><span class="md-ellipsis"> speed_estimation </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/streamlit_inference/"><span class="md-ellipsis"> streamlit_inference </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/trackzone/"><span class="md-ellipsis"> trackzone </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../solutions/vision_eye/"><span class="md-ellipsis"> vision_eye </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_9" type="checkbox"/><label class="md-nav__link" for="__nav_11_9" id="__nav_11_9_label" tabindex=""><span class="md-ellipsis"> trackers </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_9_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_9"><span class="md-nav__icon md-icon"></span> trackers </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/basetrack/"><span class="md-ellipsis"> basetrack </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/bot_sort/"><span class="md-ellipsis"> bot_sort </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/byte_tracker/"><span class="md-ellipsis"> byte_tracker </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../trackers/track/"><span class="md-ellipsis"> track </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../trackers/utils/gmc/"><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" id="__nav_11_10" type="checkbox"/><label class="md-nav__link" for="__nav_11_10" id="__nav_11_10_label" tabindex=""><span class="md-ellipsis"> utils </span><span class="md-nav__icon md-icon"></span></label><nav aria-expanded="false" aria-labelledby="__nav_11_10_label" class="md-nav" data-md-level="2"><label class="md-nav__title" for="__nav_11_10"><span class="md-nav__icon md-icon"></span> utils </label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="../../utils/__init__/"><span class="md-ellipsis"> __init__ </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/autobatch/"><span class="md-ellipsis"> autobatch </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/autodevice/"><span class="md-ellipsis"> autodevice </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/benchmarks/"><span class="md-ellipsis"> benchmarks </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../utils/callbacks/base/"><span class="md-ellipsis"> callbacks </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/checks/"><span class="md-ellipsis"> checks </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/cpu/"><span class="md-ellipsis"> cpu </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/dist/"><span class="md-ellipsis"> dist </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/downloads/"><span class="md-ellipsis"> downloads </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/errors/"><span class="md-ellipsis"> errors </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/events/"><span class="md-ellipsis"> events </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../utils/export/engine/"><span class="md-ellipsis"> export </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/files/"><span class="md-ellipsis"> files </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/git/"><span class="md-ellipsis"> git </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/instance/"><span class="md-ellipsis"> instance </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/logger/"><span class="md-ellipsis"> logger </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/loss/"><span class="md-ellipsis"> loss </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/metrics/"><span class="md-ellipsis"> metrics </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/nms/"><span class="md-ellipsis"> nms </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/ops/"><span class="md-ellipsis"> ops </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/patches/"><span class="md-ellipsis"> patches </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/plotting/"><span class="md-ellipsis"> plotting </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/tal/"><span class="md-ellipsis"> tal </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/torch_utils/"><span class="md-ellipsis"> torch_utils </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/tqdm/"><span class="md-ellipsis"> tqdm </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/triton/"><span class="md-ellipsis"> triton </span></a></li><li class="md-nav__item"><a class="md-nav__link" href="../../utils/tuner/"><span class="md-ellipsis"> tuner </span></a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class="md-nav__link" href="../../../help/"><span class="md-ellipsis"> Help </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav aria-label="On this page" class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc"><span class="md-nav__icon md-icon"></span> On this page </label><ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> BaseTensor</span></a><nav aria-label="Class ultralytics.engine.results.BaseTensor" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor.shape"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> shape</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor.__getitem__"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> __getitem__</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor.__len__"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> __len__</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor.cpu"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> cpu</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor.cuda"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> cuda</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor.numpy"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> numpy</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.BaseTensor.to"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> to</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> Results</span></a><nav aria-label="Class ultralytics.engine.results.Results" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.__getitem__"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> __getitem__</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.__len__"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> __len__</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results._apply"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> _apply</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.cpu"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> cpu</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.cuda"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> cuda</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.new"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> new</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.numpy"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> numpy</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.plot"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> plot</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.save"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> save</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.save_crop"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> save_crop</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.save_txt"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> save_txt</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.show"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> show</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.summary"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> summary</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.to"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> to</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.update"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> update</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Results.verbose"><span class="md-ellipsis"><span class="doc-kind doc-kind-method">method</span> verbose</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> Boxes</span></a><nav aria-label="Class ultralytics.engine.results.Boxes" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes.xyxy"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xyxy</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes.conf"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> conf</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes.cls"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> cls</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes.id"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> id</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes.xywh"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xywh</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes.xyxyn"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xyxyn</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Boxes.xywhn"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xywhn</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Masks"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> Masks</span></a><nav aria-label="Class ultralytics.engine.results.Masks" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Masks.xyn"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xyn</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Masks.xy"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xy</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Keypoints"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> Keypoints</span></a><nav aria-label="Class ultralytics.engine.results.Keypoints" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Keypoints.xy"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xy</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Keypoints.xyn"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xyn</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Keypoints.conf"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> conf</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Probs"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> Probs</span></a><nav aria-label="Class ultralytics.engine.results.Probs" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Probs.top1"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> top1</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Probs.top5"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> top5</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Probs.top1conf"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> top1conf</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.Probs.top5conf"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> top5conf</span></a></li></ul></nav></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB"><span class="md-ellipsis"><span class="doc-kind doc-kind-class">class</span> OBB</span></a><nav aria-label="Class ultralytics.engine.results.OBB" class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB.xywhr"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xywhr</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB.conf"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> conf</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB.cls"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> cls</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB.id"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> id</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB.xyxyxyxy"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xyxyxyxy</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB.xyxyxyxyn"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xyxyxyxyn</span></a></li><li class="md-nav__item"><a class="md-nav__link" href="#ultralytics.engine.results.OBB.xyxy"><span class="md-ellipsis"><span class="doc-kind doc-kind-property">property</span> xyxy</span></a></li></ul></nav></li></ul></nav></div></div></div><div class="md-content" data-md-component="content"><article class="md-content__inner md-typeset"><a class="md-content__button md-icon" href="https://github.com/ultralytics/ultralytics/tree/main/docs/en/reference/engine/results.md" rel="edit" title="Edit this page"><svg class="lucide lucide-file-pen" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5"></path><path d="M14 2v4a2 2 0 0 0 2 2h4M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z"></path></svg></a><h1 id="reference-for-ultralyticsengineresultspy">Reference for <code>ultralytics/engine/results.py</code></h1><div class="admonition success"><p class="admonition-title">Improvements</p><p>This page is sourced from <a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py">https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py</a>. Have an improvement or example to add? Open a <a href="https://docs.ultralytics.com/help/contributing/">Pull Request</a> â€” thank you! ğŸ™</p></div><p><br/></p><div class="admonition abstract"><p class="admonition-title">Summary</p><div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="classes" name="__tabbed_1" type="radio"/><input id="properties" name="__tabbed_1" type="radio"/><input id="methods" name="__tabbed_1" type="radio"/><div class="tabbed-labels"><label for="classes"><span class="doc-kind doc-kind-class">Classes</span></label><label for="properties"><span class="doc-kind doc-kind-property">Properties</span></label><label for="methods"><span class="doc-kind doc-kind-method">Methods</span></label></div><div class="tabbed-content"><div class="tabbed-block"><ul><li><a href="#ultralytics.engine.results.BaseTensor"><code>BaseTensor</code></a></li><li><a href="#ultralytics.engine.results.Results"><code>Results</code></a></li><li><a href="#ultralytics.engine.results.Boxes"><code>Boxes</code></a></li><li><a href="#ultralytics.engine.results.Masks"><code>Masks</code></a></li><li><a href="#ultralytics.engine.results.Keypoints"><code>Keypoints</code></a></li><li><a href="#ultralytics.engine.results.Probs"><code>Probs</code></a></li><li><a href="#ultralytics.engine.results.OBB"><code>OBB</code></a></li></ul></div><div class="tabbed-block"><ul><li><a href="#ultralytics.engine.results.BaseTensor.shape"><code>BaseTensor.shape</code></a></li><li><a href="#ultralytics.engine.results.Boxes.xyxy"><code>Boxes.xyxy</code></a></li><li><a href="#ultralytics.engine.results.Boxes.conf"><code>Boxes.conf</code></a></li><li><a href="#ultralytics.engine.results.Boxes.cls"><code>Boxes.cls</code></a></li><li><a href="#ultralytics.engine.results.Boxes.id"><code>Boxes.id</code></a></li><li><a href="#ultralytics.engine.results.Boxes.xywh"><code>Boxes.xywh</code></a></li><li><a href="#ultralytics.engine.results.Boxes.xyxyn"><code>Boxes.xyxyn</code></a></li><li><a href="#ultralytics.engine.results.Boxes.xywhn"><code>Boxes.xywhn</code></a></li><li><a href="#ultralytics.engine.results.Masks.xyn"><code>Masks.xyn</code></a></li><li><a href="#ultralytics.engine.results.Masks.xy"><code>Masks.xy</code></a></li><li><a href="#ultralytics.engine.results.Keypoints.xy"><code>Keypoints.xy</code></a></li><li><a href="#ultralytics.engine.results.Keypoints.xyn"><code>Keypoints.xyn</code></a></li><li><a href="#ultralytics.engine.results.Keypoints.conf"><code>Keypoints.conf</code></a></li><li><a href="#ultralytics.engine.results.Probs.top1"><code>Probs.top1</code></a></li><li><a href="#ultralytics.engine.results.Probs.top5"><code>Probs.top5</code></a></li><li><a href="#ultralytics.engine.results.Probs.top1conf"><code>Probs.top1conf</code></a></li><li><a href="#ultralytics.engine.results.Probs.top5conf"><code>Probs.top5conf</code></a></li><li><a href="#ultralytics.engine.results.OBB.xywhr"><code>OBB.xywhr</code></a></li><li><a href="#ultralytics.engine.results.OBB.conf"><code>OBB.conf</code></a></li><li><a href="#ultralytics.engine.results.OBB.cls"><code>OBB.cls</code></a></li><li><a href="#ultralytics.engine.results.OBB.id"><code>OBB.id</code></a></li><li><a href="#ultralytics.engine.results.OBB.xyxyxyxy"><code>OBB.xyxyxyxy</code></a></li><li><a href="#ultralytics.engine.results.OBB.xyxyxyxyn"><code>OBB.xyxyxyxyn</code></a></li><li><a href="#ultralytics.engine.results.OBB.xyxy"><code>OBB.xyxy</code></a></li></ul></div><div class="tabbed-block"><ul><li><a href="#ultralytics.engine.results.BaseTensor.cpu"><code>BaseTensor.cpu</code></a></li><li><a href="#ultralytics.engine.results.BaseTensor.numpy"><code>BaseTensor.numpy</code></a></li><li><a href="#ultralytics.engine.results.BaseTensor.cuda"><code>BaseTensor.cuda</code></a></li><li><a href="#ultralytics.engine.results.BaseTensor.to"><code>BaseTensor.to</code></a></li><li><a href="#ultralytics.engine.results.BaseTensor.__len__"><code>BaseTensor.__len__</code></a></li><li><a href="#ultralytics.engine.results.BaseTensor.__getitem__"><code>BaseTensor.__getitem__</code></a></li><li><a href="#ultralytics.engine.results.Results.__getitem__"><code>Results.__getitem__</code></a></li><li><a href="#ultralytics.engine.results.Results.__len__"><code>Results.__len__</code></a></li><li><a href="#ultralytics.engine.results.Results.update"><code>Results.update</code></a></li><li><a href="#ultralytics.engine.results.Results._apply"><code>Results._apply</code></a></li><li><a href="#ultralytics.engine.results.Results.cpu"><code>Results.cpu</code></a></li><li><a href="#ultralytics.engine.results.Results.numpy"><code>Results.numpy</code></a></li><li><a href="#ultralytics.engine.results.Results.cuda"><code>Results.cuda</code></a></li><li><a href="#ultralytics.engine.results.Results.to"><code>Results.to</code></a></li><li><a href="#ultralytics.engine.results.Results.new"><code>Results.new</code></a></li><li><a href="#ultralytics.engine.results.Results.plot"><code>Results.plot</code></a></li><li><a href="#ultralytics.engine.results.Results.show"><code>Results.show</code></a></li><li><a href="#ultralytics.engine.results.Results.save"><code>Results.save</code></a></li><li><a href="#ultralytics.engine.results.Results.verbose"><code>Results.verbose</code></a></li><li><a href="#ultralytics.engine.results.Results.save_txt"><code>Results.save_txt</code></a></li><li><a href="#ultralytics.engine.results.Results.save_crop"><code>Results.save_crop</code></a></li><li><a href="#ultralytics.engine.results.Results.summary"><code>Results.summary</code></a></li></ul></div></div></div></div><h2 id="ultralytics.engine.results.BaseTensor"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.engine.results.BaseTensor</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">BaseTensor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p><strong>Bases:</strong> <code>SimpleClass</code></p><p>Base tensor class with additional methods for easy manipulation and device handling.</p><p>This class provides a foundation for tensor-like objects with device management capabilities, supporting both PyTorch tensors and NumPy arrays. It includes methods for moving data between devices and converting between tensor types.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>data</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Prediction data such as bounding boxes, masks, or keypoints.</td><td><em>required</em></td></tr><tr><td><code>orig_shape</code></td><td><code>tuple[int, int]</code></td><td>Original shape of the image in (height, width) format.</td><td><em>required</em></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>data</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Prediction data such as bounding boxes, masks, or keypoints.</td></tr><tr><td><code>orig_shape</code></td><td><code>tuple[int, int]</code></td><td>Original shape of the image, typically in the format (height, width).</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.engine.results.BaseTensor.shape"><code>shape</code></a></td><td>Return the shape of the underlying data tensor.</td></tr><tr><td><a href="#ultralytics.engine.results.BaseTensor.__getitem__"><code>__getitem__</code></a></td><td>Return a new BaseTensor instance containing the specified indexed elements of the data tensor.</td></tr><tr><td><a href="#ultralytics.engine.results.BaseTensor.__len__"><code>__len__</code></a></td><td>Return the length of the underlying data tensor.</td></tr><tr><td><a href="#ultralytics.engine.results.BaseTensor.cpu"><code>cpu</code></a></td><td>Return a copy of the tensor stored in CPU memory.</td></tr><tr><td><a href="#ultralytics.engine.results.BaseTensor.cuda"><code>cuda</code></a></td><td>Move the tensor to GPU memory.</td></tr><tr><td><a href="#ultralytics.engine.results.BaseTensor.numpy"><code>numpy</code></a></td><td>Return a copy of the tensor as a numpy array.</td></tr><tr><td><a href="#ultralytics.engine.results.BaseTensor.to"><code>to</code></a></td><td>Return a copy of the tensor with the specified device and dtype.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">orig_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">720</span><span class="p">,</span> <span class="mi">1280</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">base_tensor</span> <span class="o">=</span> <span class="n">BaseTensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">cpu_tensor</span> <span class="o">=</span> <span class="n">base_tensor</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">numpy_array</span> <span class="o">=</span> <span class="n">base_tensor</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">gpu_tensor</span> <span class="o">=</span> <span class="n">base_tensor</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L23-L174"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BaseTensor</span><span class="p">(</span><span class="n">SimpleClass</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Base tensor class with additional methods for easy manipulation and device handling.</span>
<span></span>
<span></span><span class="sd">    This class provides a foundation for tensor-like objects with device management capabilities, supporting both</span>
<span></span><span class="sd">    PyTorch tensors and NumPy arrays. It includes methods for moving data between devices and converting between tensor</span>
<span></span><span class="sd">    types.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        data (torch.Tensor | np.ndarray): Prediction data such as bounding boxes, masks, or keypoints.</span>
<span></span><span class="sd">        orig_shape (tuple[int, int]): Original shape of the image, typically in the format (height, width).</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        cpu: Return a copy of the tensor stored in CPU memory.</span>
<span></span><span class="sd">        numpy: Return a copy of the tensor as a numpy array.</span>
<span></span><span class="sd">        cuda: Move the tensor to GPU memory, returning a new instance if necessary.</span>
<span></span><span class="sd">        to: Return a copy of the tensor with the specified device and dtype.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; import torch</span>
<span></span><span class="sd">        &gt;&gt;&gt; data = torch.tensor([[1, 2, 3], [4, 5, 6]])</span>
<span></span><span class="sd">        &gt;&gt;&gt; orig_shape = (720, 1280)</span>
<span></span><span class="sd">        &gt;&gt;&gt; base_tensor = BaseTensor(data, orig_shape)</span>
<span></span><span class="sd">        &gt;&gt;&gt; cpu_tensor = base_tensor.cpu()</span>
<span></span><span class="sd">        &gt;&gt;&gt; numpy_array = base_tensor.numpy()</span>
<span></span><span class="sd">        &gt;&gt;&gt; gpu_tensor = base_tensor.cuda()</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize BaseTensor with prediction data and the original shape of the image.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            data (torch.Tensor | np.ndarray): Prediction data such as bounding boxes, masks, or keypoints.</span>
<span></span><span class="sd">            orig_shape (tuple[int, int]): Original shape of the image in (height, width) format.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)),</span> <span class="s2">"data must be torch.Tensor or np.ndarray"</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span> <span class="o">=</span> <span class="n">orig_shape</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.BaseTensor.shape"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.BaseTensor.shape</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</code></pre></div><p>Return the shape of the underlying data tensor.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>tuple[int, ...]</code></td><td>The shape of the data tensor.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">base_tensor</span> <span class="o">=</span> <span class="n">BaseTensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">720</span><span class="p">,</span> <span class="mi">1280</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">base_tensor</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span></span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L62-L74"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the shape of the underlying data tensor.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (tuple[int, ...]): The shape of the data tensor.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; data = torch.rand(100, 4)</span>
<span></span><span class="sd">        &gt;&gt;&gt; base_tensor = BaseTensor(data, orig_shape=(720, 1280))</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(base_tensor.shape)</span>
<span></span><span class="sd">        (100, 4)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.BaseTensor.__getitem__"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.BaseTensor.__getitem__</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
</code></pre></div><p>Return a new BaseTensor instance containing the specified indexed elements of the data tensor.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>idx</code></td><td><code>int | list[int] | torch.Tensor</code></td><td>Index or indices to select from the data tensor.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>BaseTensor</code></td><td>A new BaseTensor instance containing the indexed data.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">base_tensor</span> <span class="o">=</span> <span class="n">BaseTensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">720</span><span class="p">,</span> <span class="mi">1280</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">base_tensor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Select the first row</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span></span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L158-L174"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Return a new BaseTensor instance containing the specified indexed elements of the data tensor.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        idx (int | list[int] | torch.Tensor): Index or indices to select from the data tensor.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (BaseTensor): A new BaseTensor instance containing the indexed data.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; data = torch.tensor([[1, 2, 3], [4, 5, 6]])</span>
<span></span><span class="sd">        &gt;&gt;&gt; base_tensor = BaseTensor(data, orig_shape=(720, 1280))</span>
<span></span><span class="sd">        &gt;&gt;&gt; result = base_tensor[0]  # Select the first row</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(result.data)</span>
<span></span><span class="sd">        tensor([1, 2, 3])</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.BaseTensor.__len__"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.BaseTensor.__len__</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div><p>Return the length of the underlying data tensor.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>int</code></td><td>The number of elements in the first dimension of the data tensor.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">base_tensor</span> <span class="o">=</span> <span class="n">BaseTensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">720</span><span class="p">,</span> <span class="mi">1280</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_tensor</span><span class="p">)</span>
<span></span><span class="mi">2</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L144-L156"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the length of the underlying data tensor.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (int): The number of elements in the first dimension of the data tensor.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; data = torch.tensor([[1, 2, 3], [4, 5, 6]])</span>
<span></span><span class="sd">        &gt;&gt;&gt; base_tensor = BaseTensor(data, orig_shape=(720, 1280))</span>
<span></span><span class="sd">        &gt;&gt;&gt; len(base_tensor)</span>
<span></span><span class="sd">        2</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.BaseTensor.cpu"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.BaseTensor.cpu</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cpu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>Return a copy of the tensor stored in CPU memory.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>BaseTensor</code></td><td>A new BaseTensor object with the data tensor moved to CPU memory.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">base_tensor</span> <span class="o">=</span> <span class="n">BaseTensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">720</span><span class="p">,</span> <span class="mi">1280</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">cpu_tensor</span> <span class="o">=</span> <span class="n">base_tensor</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cpu_tensor</span><span class="p">,</span> <span class="n">BaseTensor</span><span class="p">)</span>
<span></span><span class="kc">True</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">cpu_tensor</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">device</span>
<span></span><span class="n">device</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">'cpu'</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L76-L91"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cpu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Return a copy of the tensor stored in CPU memory.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (BaseTensor): A new BaseTensor object with the data tensor moved to CPU memory.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; data = torch.tensor([[1, 2, 3], [4, 5, 6]]).cuda()</span>
<span></span><span class="sd">        &gt;&gt;&gt; base_tensor = BaseTensor(data, orig_shape=(720, 1280))</span>
<span></span><span class="sd">        &gt;&gt;&gt; cpu_tensor = base_tensor.cpu()</span>
<span></span><span class="sd">        &gt;&gt;&gt; isinstance(cpu_tensor, BaseTensor)</span>
<span></span><span class="sd">        True</span>
<span></span><span class="sd">        &gt;&gt;&gt; cpu_tensor.data.device</span>
<span></span><span class="sd">        device(type='cpu')</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cpu</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.BaseTensor.cuda"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.BaseTensor.cuda</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cuda</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>Move the tensor to GPU memory.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>BaseTensor</code></td><td>A new BaseTensor instance with the data moved to GPU memory if it's not already a numpy array,</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.engine.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseTensor</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">base_tensor</span> <span class="o">=</span> <span class="n">BaseTensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">720</span><span class="p">,</span> <span class="mi">1280</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">gpu_tensor</span> <span class="o">=</span> <span class="n">base_tensor</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">gpu_tensor</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<span></span><span class="n">cuda</span><span class="p">:</span><span class="mi">0</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L109-L125"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cuda</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Move the tensor to GPU memory.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (BaseTensor): A new BaseTensor instance with the data moved to GPU memory if it's not already a numpy array,</span>
<span></span><span class="sd">            otherwise returns self.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; import torch</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics.engine.results import BaseTensor</span>
<span></span><span class="sd">        &gt;&gt;&gt; data = torch.tensor([[1, 2, 3], [4, 5, 6]])</span>
<span></span><span class="sd">        &gt;&gt;&gt; base_tensor = BaseTensor(data, orig_shape=(720, 1280))</span>
<span></span><span class="sd">        &gt;&gt;&gt; gpu_tensor = base_tensor.cuda()</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(gpu_tensor.data.device)</span>
<span></span><span class="sd">        cuda:0</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.BaseTensor.numpy"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.BaseTensor.numpy</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>Return a copy of the tensor as a numpy array.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>np.ndarray</code></td><td>A numpy array containing the same data as the original tensor.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">orig_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">720</span><span class="p">,</span> <span class="mi">1280</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">base_tensor</span> <span class="o">=</span> <span class="n">BaseTensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">numpy_array</span> <span class="o">=</span> <span class="n">base_tensor</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">))</span>
<span></span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">'</span><span class="nc">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="s1">'&gt;</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L93-L107"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Return a copy of the tensor as a numpy array.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (np.ndarray): A numpy array containing the same data as the original tensor.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; data = torch.tensor([[1, 2, 3], [4, 5, 6]])</span>
<span></span><span class="sd">        &gt;&gt;&gt; orig_shape = (720, 1280)</span>
<span></span><span class="sd">        &gt;&gt;&gt; base_tensor = BaseTensor(data, orig_shape)</span>
<span></span><span class="sd">        &gt;&gt;&gt; numpy_array = base_tensor.numpy()</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(type(numpy_array))</span>
<span></span><span class="sd">        &lt;class 'numpy.ndarray'&gt;</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.BaseTensor.to"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.BaseTensor.to</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div><p>Return a copy of the tensor with the specified device and dtype.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>*args</code></td><td><code>Any</code></td><td>Variable length argument list to be passed to torch.Tensor.to().</td><td><em>required</em></td></tr><tr><td><code>**kwargs</code></td><td><code>Any</code></td><td>Arbitrary keyword arguments to be passed to torch.Tensor.to().</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>BaseTensor</code></td><td>A new BaseTensor instance with the data moved to the specified device and/or dtype.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">base_tensor</span> <span class="o">=</span> <span class="n">BaseTensor</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">640</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">cuda_tensor</span> <span class="o">=</span> <span class="n">base_tensor</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">"cuda"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">float16_tensor</span> <span class="o">=</span> <span class="n">base_tensor</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L127-L142"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Return a copy of the tensor with the specified device and dtype.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        *args (Any): Variable length argument list to be passed to torch.Tensor.to().</span>
<span></span><span class="sd">        **kwargs (Any): Arbitrary keyword arguments to be passed to torch.Tensor.to().</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (BaseTensor): A new BaseTensor instance with the data moved to the specified device and/or dtype.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; base_tensor = BaseTensor(torch.randn(3, 4), orig_shape=(480, 640))</span>
<span></span><span class="sd">        &gt;&gt;&gt; cuda_tensor = base_tensor.to("cuda")</span>
<span></span><span class="sd">        &gt;&gt;&gt; float16_tensor = base_tensor.to(dtype=torch.float16)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.engine.results.Results"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.engine.results.Results</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<span></span>    <span class="bp">self</span><span class="p">,</span>
<span></span>    <span class="n">orig_img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span></span>    <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
<span></span>    <span class="n">boxes</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">masks</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">probs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">keypoints</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">obb</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">speed</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p><strong>Bases:</strong> <code>SimpleClass</code>, <code>DataExportMixin</code></p><p>A class for storing and manipulating inference results.</p><p>This class provides comprehensive functionality for handling inference results from various Ultralytics models, including detection, segmentation, classification, and pose estimation. It supports visualization, data export, and various coordinate transformations.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>orig_img</code></td><td><code>np.ndarray</code></td><td>The original image as a numpy array.</td><td><em>required</em></td></tr><tr><td><code>path</code></td><td><code>str</code></td><td>The path to the image file.</td><td><em>required</em></td></tr><tr><td><code>names</code></td><td><code>dict</code></td><td>A dictionary of class names.</td><td><em>required</em></td></tr><tr><td><code>boxes</code></td><td><code>torch.Tensor | None</code></td><td>A 2D tensor of bounding box coordinates for each detection.</td><td><code>None</code></td></tr><tr><td><code>masks</code></td><td><code>torch.Tensor | None</code></td><td>A 3D tensor of detection masks, where each mask is a binary image.</td><td><code>None</code></td></tr><tr><td><code>probs</code></td><td><code>torch.Tensor | None</code></td><td>A 1D tensor of probabilities of each class for classification task.</td><td><code>None</code></td></tr><tr><td><code>keypoints</code></td><td><code>torch.Tensor | None</code></td><td>A 2D tensor of keypoint coordinates for each detection.</td><td><code>None</code></td></tr><tr><td><code>obb</code></td><td><code>torch.Tensor | None</code></td><td>A 2D tensor of oriented bounding box coordinates for each detection.</td><td><code>None</code></td></tr><tr><td><code>speed</code></td><td><code>dict | None</code></td><td>A dictionary containing preprocess, inference, and postprocess speeds (ms/image).</td><td><code>None</code></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>orig_img</code></td><td><code>np.ndarray</code></td><td>The original image as a numpy array.</td></tr><tr><td><code>orig_shape</code></td><td><code>tuple[int, int]</code></td><td>Original image shape in (height, width) format.</td></tr><tr><td><code>boxes</code></td><td><code>Boxes | None</code></td><td>Detected bounding boxes.</td></tr><tr><td><code>masks</code></td><td><code>Masks | None</code></td><td>Segmentation masks.</td></tr><tr><td><code>probs</code></td><td><code>Probs | None</code></td><td>Classification probabilities.</td></tr><tr><td><code>keypoints</code></td><td><code>Keypoints | None</code></td><td>Detected keypoints.</td></tr><tr><td><code>obb</code></td><td><code>OBB | None</code></td><td>Oriented bounding boxes.</td></tr><tr><td><code>speed</code></td><td><code>dict</code></td><td>Dictionary containing inference speed information.</td></tr><tr><td><code>names</code></td><td><code>dict</code></td><td>Dictionary mapping class indices to class names.</td></tr><tr><td><code>path</code></td><td><code>str</code></td><td>Path to the input image file.</td></tr><tr><td><code>save_dir</code></td><td><code>str | None</code></td><td>Directory to save results.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.engine.results.Results.__getitem__"><code>__getitem__</code></a></td><td>Return a Results object for a specific index of inference results.</td></tr><tr><td><a href="#ultralytics.engine.results.Results.__len__"><code>__len__</code></a></td><td>Return the number of detections in the Results object.</td></tr><tr><td><a href="#ultralytics.engine.results.Results._apply"><code>_apply</code></a></td><td>Apply a function to all non-empty attributes and return a new Results object with modified attributes.</td></tr><tr><td><a href="#ultralytics.engine.results.Results.cpu"><code>cpu</code></a></td><td>Return a copy of the Results object with all its tensors moved to CPU memory.</td></tr><tr><td><a href="#ultralytics.engine.results.Results.cuda"><code>cuda</code></a></td><td>Move all tensors in the Results object to GPU memory.</td></tr><tr><td><a href="#ultralytics.engine.results.Results.new"><code>new</code></a></td><td>Create a new Results object with the same image, path, names, and speed attributes.</td></tr><tr><td><a href="#ultralytics.engine.results.Results.numpy"><code>numpy</code></a></td><td>Convert all tensors in the Results object to numpy arrays.</td></tr><tr><td><a href="#ultralytics.engine.results.Results.plot"><code>plot</code></a></td><td>Plot detection results on an input RGB image.</td></tr><tr><td><a href="#ultralytics.engine.results.Results.save"><code>save</code></a></td><td>Save annotated inference results image to file.</td></tr><tr><td><a href="#ultralytics.engine.results.Results.save_crop"><code>save_crop</code></a></td><td>Save cropped detection images to specified directory.</td></tr><tr><td><a href="#ultralytics.engine.results.Results.save_txt"><code>save_txt</code></a></td><td>Save detection results to a text file.</td></tr><tr><td><a href="#ultralytics.engine.results.Results.show"><code>show</code></a></td><td>Display the image with annotated inference results.</td></tr><tr><td><a href="#ultralytics.engine.results.Results.summary"><code>summary</code></a></td><td>Convert inference results to a summarized dictionary with optional normalization for box coordinates.</td></tr><tr><td><a href="#ultralytics.engine.results.Results.to"><code>to</code></a></td><td>Move all tensors in the Results object to the specified device and dtype.</td></tr><tr><td><a href="#ultralytics.engine.results.Results.update"><code>update</code></a></td><td>Update the Results object with new detection data.</td></tr><tr><td><a href="#ultralytics.engine.results.Results.verbose"><code>verbose</code></a></td><td>Return a log string for each task in the results, detailing detection and classification outcomes.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Get the first result</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">boxes</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">boxes</span>  <span class="c1"># Get the boxes for the first result</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">masks</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">masks</span>  <span class="c1"># Get the masks for the first result</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span></span><span class="o">&gt;&gt;&gt;</span>     <span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>  <span class="c1"># Plot detection results</span>
</code></pre></div><div class="admonition note"><p class="admonition-title">Notes</p><p>For the default pose model, keypoint indices for human body pose estimation are:
0: Nose, 1: Left Eye, 2: Right Eye, 3: Left Ear, 4: Right Ear
5: Left Shoulder, 6: Right Shoulder, 7: Left Elbow, 8: Right Elbow
9: Left Wrist, 10: Right Wrist, 11: Left Hip, 12: Right Hip
13: Left Knee, 14: Right Knee, 15: Left Ankle, 16: Right Ankle</p></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L177-L813"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Results</span><span class="p">(</span><span class="n">SimpleClass</span><span class="p">,</span> <span class="n">DataExportMixin</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""A class for storing and manipulating inference results.</span>
<span></span>
<span></span><span class="sd">    This class provides comprehensive functionality for handling inference results from various Ultralytics models,</span>
<span></span><span class="sd">    including detection, segmentation, classification, and pose estimation. It supports visualization, data export, and</span>
<span></span><span class="sd">    various coordinate transformations.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        orig_img (np.ndarray): The original image as a numpy array.</span>
<span></span><span class="sd">        orig_shape (tuple[int, int]): Original image shape in (height, width) format.</span>
<span></span><span class="sd">        boxes (Boxes | None): Detected bounding boxes.</span>
<span></span><span class="sd">        masks (Masks | None): Segmentation masks.</span>
<span></span><span class="sd">        probs (Probs | None): Classification probabilities.</span>
<span></span><span class="sd">        keypoints (Keypoints | None): Detected keypoints.</span>
<span></span><span class="sd">        obb (OBB | None): Oriented bounding boxes.</span>
<span></span><span class="sd">        speed (dict): Dictionary containing inference speed information.</span>
<span></span><span class="sd">        names (dict): Dictionary mapping class indices to class names.</span>
<span></span><span class="sd">        path (str): Path to the input image file.</span>
<span></span><span class="sd">        save_dir (str | None): Directory to save results.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        update: Update the Results object with new detection data.</span>
<span></span><span class="sd">        cpu: Return a copy of the Results object with all tensors moved to CPU memory.</span>
<span></span><span class="sd">        numpy: Convert all tensors in the Results object to numpy arrays.</span>
<span></span><span class="sd">        cuda: Move all tensors in the Results object to GPU memory.</span>
<span></span><span class="sd">        to: Move all tensors to the specified device and dtype.</span>
<span></span><span class="sd">        new: Create a new Results object with the same image, path, names, and speed attributes.</span>
<span></span><span class="sd">        plot: Plot detection results on an input RGB image.</span>
<span></span><span class="sd">        show: Display the image with annotated inference results.</span>
<span></span><span class="sd">        save: Save annotated inference results image to file.</span>
<span></span><span class="sd">        verbose: Return a log string for each task in the results.</span>
<span></span><span class="sd">        save_txt: Save detection results to a text file.</span>
<span></span><span class="sd">        save_crop: Save cropped detection images to specified directory.</span>
<span></span><span class="sd">        summary: Convert inference results to a summarized dictionary.</span>
<span></span><span class="sd">        to_df: Convert detection results to a Polars Dataframe.</span>
<span></span><span class="sd">        to_json: Convert detection results to JSON format.</span>
<span></span><span class="sd">        to_csv: Convert detection results to a CSV format.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("path/to/image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; result = results[0]  # Get the first result</span>
<span></span><span class="sd">        &gt;&gt;&gt; boxes = result.boxes  # Get the boxes for the first result</span>
<span></span><span class="sd">        &gt;&gt;&gt; masks = result.masks  # Get the masks for the first result</span>
<span></span><span class="sd">        &gt;&gt;&gt; for result in results:</span>
<span></span><span class="sd">        &gt;&gt;&gt;     result.plot()  # Plot detection results</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<span></span>        <span class="bp">self</span><span class="p">,</span>
<span></span>        <span class="n">orig_img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span></span>        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span></span>        <span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
<span></span>        <span class="n">boxes</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="n">masks</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="n">probs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="n">keypoints</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="n">obb</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>        <span class="n">speed</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize the Results class for storing and manipulating inference results.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            orig_img (np.ndarray): The original image as a numpy array.</span>
<span></span><span class="sd">            path (str): The path to the image file.</span>
<span></span><span class="sd">            names (dict): A dictionary of class names.</span>
<span></span><span class="sd">            boxes (torch.Tensor | None): A 2D tensor of bounding box coordinates for each detection.</span>
<span></span><span class="sd">            masks (torch.Tensor | None): A 3D tensor of detection masks, where each mask is a binary image.</span>
<span></span><span class="sd">            probs (torch.Tensor | None): A 1D tensor of probabilities of each class for classification task.</span>
<span></span><span class="sd">            keypoints (torch.Tensor | None): A 2D tensor of keypoint coordinates for each detection.</span>
<span></span><span class="sd">            obb (torch.Tensor | None): A 2D tensor of oriented bounding box coordinates for each detection.</span>
<span></span><span class="sd">            speed (dict | None): A dictionary containing preprocess, inference, and postprocess speeds (ms/image).</span>
<span></span>
<span></span><span class="sd">        Notes:</span>
<span></span><span class="sd">            For the default pose model, keypoint indices for human body pose estimation are:</span>
<span></span><span class="sd">            0: Nose, 1: Left Eye, 2: Right Eye, 3: Left Ear, 4: Right Ear</span>
<span></span><span class="sd">            5: Left Shoulder, 6: Right Shoulder, 7: Left Elbow, 8: Right Elbow</span>
<span></span><span class="sd">            9: Left Wrist, 10: Right Wrist, 11: Left Hip, 12: Right Hip</span>
<span></span><span class="sd">            13: Left Knee, 14: Right Knee, 15: Left Ankle, 16: Right Ankle</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">orig_img</span> <span class="o">=</span> <span class="n">orig_img</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span> <span class="o">=</span> <span class="n">orig_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span> <span class="o">=</span> <span class="n">Boxes</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">)</span> <span class="k">if</span> <span class="n">boxes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># native size boxes</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">masks</span> <span class="o">=</span> <span class="n">Masks</span><span class="p">(</span><span class="n">masks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">)</span> <span class="k">if</span> <span class="n">masks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># native size or imgsz masks</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">probs</span> <span class="o">=</span> <span class="n">Probs</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span> <span class="k">if</span> <span class="n">probs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">keypoints</span> <span class="o">=</span> <span class="n">Keypoints</span><span class="p">(</span><span class="n">keypoints</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">)</span> <span class="k">if</span> <span class="n">keypoints</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">obb</span> <span class="o">=</span> <span class="n">OBB</span><span class="p">(</span><span class="n">obb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">)</span> <span class="k">if</span> <span class="n">obb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="n">speed</span> <span class="k">if</span> <span class="n">speed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{</span><span class="s2">"preprocess"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">"inference"</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">"postprocess"</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">names</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">save_dir</span> <span class="o">=</span> <span class="kc">None</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">_keys</span> <span class="o">=</span> <span class="s2">"boxes"</span><span class="p">,</span> <span class="s2">"masks"</span><span class="p">,</span> <span class="s2">"probs"</span><span class="p">,</span> <span class="s2">"keypoints"</span><span class="p">,</span> <span class="s2">"obb"</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.__getitem__"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.__getitem__</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
</code></pre></div><p>Return a Results object for a specific index of inference results.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>idx</code></td><td><code>int | slice</code></td><td>Index or slice to retrieve from the Results object.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Results</code></td><td>A new Results object containing the specified subset of inference results.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>  <span class="c1"># Perform inference</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">single_result</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Get the first result</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">subset_results</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>  <span class="c1"># Get a slice of results</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L269-L283"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Return a Results object for a specific index of inference results.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        idx (int | slice): Index or slice to retrieve from the Results object.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Results): A new Results object containing the specified subset of inference results.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("path/to/image.jpg")  # Perform inference</span>
<span></span><span class="sd">        &gt;&gt;&gt; single_result = results[0]  # Get the first result</span>
<span></span><span class="sd">        &gt;&gt;&gt; subset_results = results[1:4]  # Get a slice of results</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply</span><span class="p">(</span><span class="s2">"__getitem__"</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.__len__"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.__len__</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div><p>Return the number of detections in the Results object.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>int</code></td><td>The number of detections, determined by the length of the first non-empty attribute in (masks, probs,</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">Results</span><span class="p">(</span><span class="n">orig_img</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">boxes</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span></span><span class="mi">5</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L285-L300"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the number of detections in the Results object.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (int): The number of detections, determined by the length of the first non-empty attribute in (masks, probs,</span>
<span></span><span class="sd">            keypoints, or obb).</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = Results(orig_img, path, names, boxes=torch.rand(5, 4))</span>
<span></span><span class="sd">        &gt;&gt;&gt; len(results)</span>
<span></span><span class="sd">        5</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keys</span><span class="p">:</span>
<span></span>        <span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span></span>        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results._apply"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results._apply</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div><p>Apply a function to all non-empty attributes and return a new Results object with modified attributes.</p><p>This method is internally called by methods like .to(), .cuda(), .cpu(), etc.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>fn</code></td><td><code>str</code></td><td>The name of the function to apply.</td><td><em>required</em></td></tr><tr><td><code>*args</code></td><td><code>Any</code></td><td>Variable length argument list to pass to the function.</td><td><em>required</em></td></tr><tr><td><code>**kwargs</code></td><td><code>Any</code></td><td>Arbitrary keyword arguments to pass to the function.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Results</code></td><td>A new Results object with attributes modified by the applied function.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span></span><span class="o">...</span>     <span class="n">result_cuda</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span></span><span class="o">...</span>     <span class="n">result_cpu</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L339-L363"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Apply a function to all non-empty attributes and return a new Results object with modified attributes.</span>
<span></span>
<span></span><span class="sd">    This method is internally called by methods like .to(), .cuda(), .cpu(), etc.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        fn (str): The name of the function to apply.</span>
<span></span><span class="sd">        *args (Any): Variable length argument list to pass to the function.</span>
<span></span><span class="sd">        **kwargs (Any): Arbitrary keyword arguments to pass to the function.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Results): A new Results object with attributes modified by the applied function.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("path/to/image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; for result in results:</span>
<span></span><span class="sd">        ...     result_cuda = result.cuda()</span>
<span></span><span class="sd">        ...     result_cpu = result.cpu()</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<span></span>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keys</span><span class="p">:</span>
<span></span>        <span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span></span>        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>            <span class="nb">setattr</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">fn</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
<span></span>    <span class="k">return</span> <span class="n">r</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.cpu"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.cpu</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cpu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>Return a copy of the Results object with all its tensors moved to CPU memory.</p><p>This method creates a new Results object with all tensor attributes (boxes, masks, probs, keypoints, obb) transferred to CPU memory. It's useful for moving data from GPU to CPU for further processing or saving.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Results</code></td><td>A new Results object with all tensor attributes on CPU memory.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>  <span class="c1"># Perform inference</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">cpu_result</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>  <span class="c1"># Move the first result to CPU</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">cpu_result</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># Output: cpu</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L365-L379"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cpu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Return a copy of the Results object with all its tensors moved to CPU memory.</span>
<span></span>
<span></span><span class="sd">    This method creates a new Results object with all tensor attributes (boxes, masks, probs, keypoints, obb)</span>
<span></span><span class="sd">    transferred to CPU memory. It's useful for moving data from GPU to CPU for further processing or saving.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Results): A new Results object with all tensor attributes on CPU memory.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("path/to/image.jpg")  # Perform inference</span>
<span></span><span class="sd">        &gt;&gt;&gt; cpu_result = results[0].cpu()  # Move the first result to CPU</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(cpu_result.boxes.device)  # Output: cpu</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply</span><span class="p">(</span><span class="s2">"cpu"</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.cuda"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.cuda</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cuda</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>Move all tensors in the Results object to GPU memory.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Results</code></td><td>A new Results object with all tensors moved to CUDA device.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">cuda_results</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>  <span class="c1"># Move first result to GPU</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span></span><span class="o">...</span>     <span class="n">result_cuda</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>  <span class="c1"># Move each result to GPU</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L399-L411"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cuda</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Move all tensors in the Results object to GPU memory.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Results): A new Results object with all tensors moved to CUDA device.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("path/to/image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; cuda_results = results[0].cuda()  # Move first result to GPU</span>
<span></span><span class="sd">        &gt;&gt;&gt; for result in results:</span>
<span></span><span class="sd">        ...     result_cuda = result.cuda()  # Move each result to GPU</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply</span><span class="p">(</span><span class="s2">"cuda"</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.new"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.new</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">new</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>Create a new Results object with the same image, path, names, and speed attributes.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Results</code></td><td>A new Results object with copied attributes from the original instance.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">new_result</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L431-L441"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">new</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Create a new Results object with the same image, path, names, and speed attributes.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Results): A new Results object with copied attributes from the original instance.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("path/to/image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; new_result = results[0].new()</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="n">Results</span><span class="p">(</span><span class="n">orig_img</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orig_img</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.numpy"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.numpy</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div><p>Convert all tensors in the Results object to numpy arrays.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Results</code></td><td>A new Results object with all tensors converted to numpy arrays.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">numpy_result</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">numpy_result</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span></span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">'</span><span class="nc">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="s1">'&gt;</span>
</code></pre></div><div class="admonition note"><p class="admonition-title">Notes</p><p>This method creates a new Results object, leaving the original unchanged. It's useful for
interoperability with numpy-based libraries or when CPU-based operations are required.</p></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L381-L397"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Convert all tensors in the Results object to numpy arrays.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Results): A new Results object with all tensors converted to numpy arrays.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("path/to/image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; numpy_result = results[0].numpy()</span>
<span></span><span class="sd">        &gt;&gt;&gt; type(numpy_result.boxes.data)</span>
<span></span><span class="sd">        &lt;class 'numpy.ndarray'&gt;</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        This method creates a new Results object, leaving the original unchanged. It's useful for</span>
<span></span><span class="sd">        interoperability with numpy-based libraries or when CPU-based operations are required.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply</span><span class="p">(</span><span class="s2">"numpy"</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.plot"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.plot</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
<span></span>    <span class="bp">self</span><span class="p">,</span>
<span></span>    <span class="n">conf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">line_width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">font_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">font</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"Arial.ttf"</span><span class="p">,</span>
<span></span>    <span class="n">pil</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">im_gpu</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">kpt_radius</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<span></span>    <span class="n">kpt_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">boxes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">masks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">probs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">save</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">color_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"class"</span><span class="p">,</span>
<span></span>    <span class="n">txt_color</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Plot detection results on an input RGB image.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>conf</code></td><td><code>bool</code></td><td>Whether to plot detection confidence scores.</td><td><code>True</code></td></tr><tr><td><code>line_width</code></td><td><code>float | None</code></td><td>Line width of bounding boxes. If None, scaled to image size.</td><td><code>None</code></td></tr><tr><td><code>font_size</code></td><td><code>float | None</code></td><td>Font size for text. If None, scaled to image size.</td><td><code>None</code></td></tr><tr><td><code>font</code></td><td><code>str</code></td><td>Font to use for text.</td><td><code>"Arial.ttf"</code></td></tr><tr><td><code>pil</code></td><td><code>bool</code></td><td>Whether to return the image as a PIL Image.</td><td><code>False</code></td></tr><tr><td><code>img</code></td><td><code>np.ndarray | None</code></td><td>Image to plot on. If None, uses original image.</td><td><code>None</code></td></tr><tr><td><code>im_gpu</code></td><td><code>torch.Tensor | None</code></td><td>Normalized image on GPU for faster mask plotting.</td><td><code>None</code></td></tr><tr><td><code>kpt_radius</code></td><td><code>int</code></td><td>Radius of drawn keypoints.</td><td><code>5</code></td></tr><tr><td><code>kpt_line</code></td><td><code>bool</code></td><td>Whether to draw lines connecting keypoints.</td><td><code>True</code></td></tr><tr><td><code>labels</code></td><td><code>bool</code></td><td>Whether to plot labels of bounding boxes.</td><td><code>True</code></td></tr><tr><td><code>boxes</code></td><td><code>bool</code></td><td>Whether to plot bounding boxes.</td><td><code>True</code></td></tr><tr><td><code>masks</code></td><td><code>bool</code></td><td>Whether to plot masks.</td><td><code>True</code></td></tr><tr><td><code>probs</code></td><td><code>bool</code></td><td>Whether to plot classification probabilities.</td><td><code>True</code></td></tr><tr><td><code>show</code></td><td><code>bool</code></td><td>Whether to display the annotated image.</td><td><code>False</code></td></tr><tr><td><code>save</code></td><td><code>bool</code></td><td>Whether to save the annotated image.</td><td><code>False</code></td></tr><tr><td><code>filename</code></td><td><code>str | None</code></td><td>Filename to save image if save is True.</td><td><code>None</code></td></tr><tr><td><code>color_mode</code></td><td><code>str</code></td><td>Specify the color mode, e.g., 'instance' or 'class'.</td><td><code>"class"</code></td></tr><tr><td><code>txt_color</code></td><td><code>tuple[int, int, int]</code></td><td>Specify the RGB text color for classification task.</td><td><code>(255, 255, 255)</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>np.ndarray</code></td><td>Annotated image as a numpy array.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span></span><span class="o">&gt;&gt;&gt;</span>     <span class="n">im</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span>     <span class="n">im</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L443-L580"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
<span></span>    <span class="bp">self</span><span class="p">,</span>
<span></span>    <span class="n">conf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">line_width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">font_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">font</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"Arial.ttf"</span><span class="p">,</span>
<span></span>    <span class="n">pil</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">im_gpu</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">kpt_radius</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<span></span>    <span class="n">kpt_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">boxes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">masks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">probs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span></span>    <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">save</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span></span>    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">color_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"class"</span><span class="p">,</span>
<span></span>    <span class="n">txt_color</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
<span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Plot detection results on an input RGB image.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        conf (bool): Whether to plot detection confidence scores.</span>
<span></span><span class="sd">        line_width (float | None): Line width of bounding boxes. If None, scaled to image size.</span>
<span></span><span class="sd">        font_size (float | None): Font size for text. If None, scaled to image size.</span>
<span></span><span class="sd">        font (str): Font to use for text.</span>
<span></span><span class="sd">        pil (bool): Whether to return the image as a PIL Image.</span>
<span></span><span class="sd">        img (np.ndarray | None): Image to plot on. If None, uses original image.</span>
<span></span><span class="sd">        im_gpu (torch.Tensor | None): Normalized image on GPU for faster mask plotting.</span>
<span></span><span class="sd">        kpt_radius (int): Radius of drawn keypoints.</span>
<span></span><span class="sd">        kpt_line (bool): Whether to draw lines connecting keypoints.</span>
<span></span><span class="sd">        labels (bool): Whether to plot labels of bounding boxes.</span>
<span></span><span class="sd">        boxes (bool): Whether to plot bounding boxes.</span>
<span></span><span class="sd">        masks (bool): Whether to plot masks.</span>
<span></span><span class="sd">        probs (bool): Whether to plot classification probabilities.</span>
<span></span><span class="sd">        show (bool): Whether to display the annotated image.</span>
<span></span><span class="sd">        save (bool): Whether to save the annotated image.</span>
<span></span><span class="sd">        filename (str | None): Filename to save image if save is True.</span>
<span></span><span class="sd">        color_mode (str): Specify the color mode, e.g., 'instance' or 'class'.</span>
<span></span><span class="sd">        txt_color (tuple[int, int, int]): Specify the RGB text color for classification task.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (np.ndarray): Annotated image as a numpy array.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; for result in results:</span>
<span></span><span class="sd">        &gt;&gt;&gt;     im = result.plot()</span>
<span></span><span class="sd">        &gt;&gt;&gt;     im.show()</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">assert</span> <span class="n">color_mode</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">"instance"</span><span class="p">,</span> <span class="s2">"class"</span><span class="p">},</span> <span class="sa">f</span><span class="s2">"Expected color_mode='instance' or 'class', not </span><span class="si">{</span><span class="n">color_mode</span><span class="si">}</span><span class="s2">."</span>
<span></span>    <span class="k">if</span> <span class="n">img</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">orig_img</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<span></span>        <span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">orig_img</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">contiguous</span><span class="p">()</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">byte</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span></span>
<span></span>    <span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
<span></span>    <span class="n">is_obb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span></span>    <span class="n">pred_boxes</span><span class="p">,</span> <span class="n">show_boxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obb</span> <span class="k">if</span> <span class="n">is_obb</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="p">,</span> <span class="n">boxes</span>
<span></span>    <span class="n">pred_masks</span><span class="p">,</span> <span class="n">show_masks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">masks</span><span class="p">,</span> <span class="n">masks</span>
<span></span>    <span class="n">pred_probs</span><span class="p">,</span> <span class="n">show_probs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">probs</span><span class="p">,</span> <span class="n">probs</span>
<span></span>    <span class="n">annotator</span> <span class="o">=</span> <span class="n">Annotator</span><span class="p">(</span>
<span></span>        <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">orig_img</span> <span class="k">if</span> <span class="n">img</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">img</span><span class="p">),</span>
<span></span>        <span class="n">line_width</span><span class="p">,</span>
<span></span>        <span class="n">font_size</span><span class="p">,</span>
<span></span>        <span class="n">font</span><span class="p">,</span>
<span></span>        <span class="n">pil</span> <span class="ow">or</span> <span class="p">(</span><span class="n">pred_probs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">show_probs</span><span class="p">),</span>  <span class="c1"># Classify tasks default to pil=True</span>
<span></span>        <span class="n">example</span><span class="o">=</span><span class="n">names</span><span class="p">,</span>
<span></span>    <span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Plot Segment results</span>
<span></span>    <span class="k">if</span> <span class="n">pred_masks</span> <span class="ow">and</span> <span class="n">show_masks</span><span class="p">:</span>
<span></span>        <span class="k">if</span> <span class="n">im_gpu</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span></span>            <span class="n">img</span> <span class="o">=</span> <span class="n">LetterBox</span><span class="p">(</span><span class="n">pred_masks</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])(</span><span class="n">image</span><span class="o">=</span><span class="n">annotator</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>
<span></span>            <span class="n">im_gpu</span> <span class="o">=</span> <span class="p">(</span>
<span></span>                <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float16</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">pred_masks</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<span></span>                <span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span></span>                <span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span></span>                <span class="o">.</span><span class="n">contiguous</span><span class="p">()</span>
<span></span>                <span class="o">/</span> <span class="mi">255</span>
<span></span>            <span class="p">)</span>
<span></span>        <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span>
<span></span>            <span class="n">pred_boxes</span><span class="o">.</span><span class="n">id</span>
<span></span>            <span class="k">if</span> <span class="n">pred_boxes</span><span class="o">.</span><span class="n">is_track</span> <span class="ow">and</span> <span class="n">color_mode</span> <span class="o">==</span> <span class="s2">"instance"</span>
<span></span>            <span class="k">else</span> <span class="n">pred_boxes</span><span class="o">.</span><span class="n">cls</span>
<span></span>            <span class="k">if</span> <span class="n">pred_boxes</span> <span class="ow">and</span> <span class="n">color_mode</span> <span class="o">==</span> <span class="s2">"class"</span>
<span></span>            <span class="k">else</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_masks</span><span class="p">)))</span>
<span></span>        <span class="p">)</span>
<span></span>        <span class="n">annotator</span><span class="o">.</span><span class="n">masks</span><span class="p">(</span><span class="n">pred_masks</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">],</span> <span class="n">im_gpu</span><span class="o">=</span><span class="n">im_gpu</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Plot Detect results</span>
<span></span>    <span class="k">if</span> <span class="n">pred_boxes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">show_boxes</span><span class="p">:</span>
<span></span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">pred_boxes</span><span class="p">)):</span>
<span></span>            <span class="n">c</span><span class="p">,</span> <span class="n">d_conf</span><span class="p">,</span> <span class="nb">id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">cls</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">conf</span><span class="p">)</span> <span class="k">if</span> <span class="n">conf</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">item</span><span class="p">())</span> <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">is_track</span> <span class="k">else</span> <span class="kc">None</span>
<span></span>            <span class="n">name</span> <span class="o">=</span> <span class="p">(</span><span class="s2">""</span> <span class="k">if</span> <span class="nb">id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">"id:</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2"> "</span><span class="p">)</span> <span class="o">+</span> <span class="n">names</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
<span></span>            <span class="n">label</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">d_conf</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span> <span class="k">if</span> <span class="n">conf</span> <span class="k">else</span> <span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">labels</span> <span class="k">else</span> <span class="kc">None</span>
<span></span>            <span class="n">box</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">xyxyxyxy</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span> <span class="k">if</span> <span class="n">is_obb</span> <span class="k">else</span> <span class="n">d</span><span class="o">.</span><span class="n">xyxy</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span></span>            <span class="n">annotator</span><span class="o">.</span><span class="n">box_label</span><span class="p">(</span>
<span></span>                <span class="n">box</span><span class="p">,</span>
<span></span>                <span class="n">label</span><span class="p">,</span>
<span></span>                <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span>
<span></span>                    <span class="n">c</span>
<span></span>                    <span class="k">if</span> <span class="n">color_mode</span> <span class="o">==</span> <span class="s2">"class"</span>
<span></span>                    <span class="k">else</span> <span class="nb">id</span>
<span></span>                    <span class="k">if</span> <span class="nb">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span></span>                    <span class="k">else</span> <span class="n">i</span>
<span></span>                    <span class="k">if</span> <span class="n">color_mode</span> <span class="o">==</span> <span class="s2">"instance"</span>
<span></span>                    <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<span></span>                    <span class="kc">True</span><span class="p">,</span>
<span></span>                <span class="p">),</span>
<span></span>            <span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Plot Classify results</span>
<span></span>    <span class="k">if</span> <span class="n">pred_probs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">show_probs</span><span class="p">:</span>
<span></span>        <span class="n">text</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">names</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">j</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">pred_probs</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">pred_probs</span><span class="o">.</span><span class="n">top5</span><span class="p">)</span>
<span></span>        <span class="n">x</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.03</span><span class="p">)</span>
<span></span>        <span class="n">annotator</span><span class="o">.</span><span class="n">text</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="n">text</span><span class="p">,</span> <span class="n">txt_color</span><span class="o">=</span><span class="n">txt_color</span><span class="p">,</span> <span class="n">box_color</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>  <span class="c1"># RGBA box</span>
<span></span>
<span></span>    <span class="c1"># Plot Pose results</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keypoints</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keypoints</span><span class="o">.</span><span class="n">data</span><span class="p">)):</span>
<span></span>            <span class="n">annotator</span><span class="o">.</span><span class="n">kpts</span><span class="p">(</span>
<span></span>                <span class="n">k</span><span class="p">,</span>
<span></span>                <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">,</span>
<span></span>                <span class="n">radius</span><span class="o">=</span><span class="n">kpt_radius</span><span class="p">,</span>
<span></span>                <span class="n">kpt_line</span><span class="o">=</span><span class="n">kpt_line</span><span class="p">,</span>
<span></span>                <span class="n">kpt_color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">color_mode</span> <span class="o">==</span> <span class="s2">"instance"</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<span></span>            <span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Show results</span>
<span></span>    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
<span></span>        <span class="n">annotator</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span></span>
<span></span>    <span class="c1"># Save results</span>
<span></span>    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
<span></span>        <span class="n">annotator</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">"results_</span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="n">annotator</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">pil</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.save"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.save</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div><p>Save annotated inference results image to file.</p><p>This method plots the detection results on the original image and saves the annotated image to a file. It utilizes the <code>plot</code> method to generate the annotated image and then saves it to the specified filename.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>filename</code></td><td><code>str | Path | None</code></td><td>The filename to save the annotated image. If None, a default filename is generated based on the original image path.</td><td><code>None</code></td></tr><tr><td><code>*args</code></td><td><code>Any</code></td><td>Variable length argument list to be passed to the <code>plot</code> method.</td><td><em>required</em></td></tr><tr><td><code>**kwargs</code></td><td><code>Any</code></td><td>Arbitrary keyword arguments to be passed to the <code>plot</code> method.</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>str</code></td><td>The filename where the image was saved.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span></span><span class="o">&gt;&gt;&gt;</span>     <span class="n">result</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">"annotated_image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Or with custom plot arguments</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span></span><span class="o">&gt;&gt;&gt;</span>     <span class="n">result</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">"annotated_image.jpg"</span><span class="p">,</span> <span class="n">conf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L600-L626"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Save annotated inference results image to file.</span>
<span></span>
<span></span><span class="sd">    This method plots the detection results on the original image and saves the annotated image to a file. It</span>
<span></span><span class="sd">    utilizes the `plot` method to generate the annotated image and then saves it to the specified filename.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        filename (str | Path | None): The filename to save the annotated image. If None, a default filename is</span>
<span></span><span class="sd">            generated based on the original image path.</span>
<span></span><span class="sd">        *args (Any): Variable length argument list to be passed to the `plot` method.</span>
<span></span><span class="sd">        **kwargs (Any): Arbitrary keyword arguments to be passed to the `plot` method.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (str): The filename where the image was saved.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("path/to/image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; for result in results:</span>
<span></span><span class="sd">        &gt;&gt;&gt;     result.save("annotated_image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; # Or with custom plot arguments</span>
<span></span><span class="sd">        &gt;&gt;&gt; for result in results:</span>
<span></span><span class="sd">        &gt;&gt;&gt;     result.save("annotated_image.jpg", conf=False, line_width=2)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
<span></span>        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"results_</span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">"</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span></span>    <span class="k">return</span> <span class="n">filename</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.save_crop"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.save_crop</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">save_crop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"im.jpg"</span><span class="p">))</span>
</code></pre></div><p>Save cropped detection images to specified directory.</p><p>This method saves cropped images of detected objects to a specified directory. Each crop is saved in a subdirectory named after the object's class, with the filename based on the input file_name.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>save_dir</code></td><td><code>str | Path</code></td><td>Directory path where cropped images will be saved.</td><td><em>required</em></td></tr><tr><td><code>file_name</code></td><td><code>str | Path</code></td><td>Base filename for the saved cropped images.</td><td><code>Path("im.jpg")</code></td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span></span><span class="o">&gt;&gt;&gt;</span>     <span class="n">result</span><span class="o">.</span><span class="n">save_crop</span><span class="p">(</span><span class="n">save_dir</span><span class="o">=</span><span class="s2">"path/to/crops"</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"detection"</span><span class="p">)</span>
</code></pre></div><div class="admonition note"><p class="admonition-title">Notes</p><ul><li>This method does not support Classify or Oriented Bounding Box (OBB) tasks.</li><li>Crops are saved as 'save_dir/class_name/file_name.jpg'.</li><li>The method will create necessary subdirectories if they don't exist.</li><li>Original image is copied before cropping to avoid modifying the original.</li></ul></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L715-L748"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">save_crop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"im.jpg"</span><span class="p">)):</span>
<span></span><span class="w">    </span><span class="sd">"""Save cropped detection images to specified directory.</span>
<span></span>
<span></span><span class="sd">    This method saves cropped images of detected objects to a specified directory. Each crop is saved in a</span>
<span></span><span class="sd">    subdirectory named after the object's class, with the filename based on the input file_name.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        save_dir (str | Path): Directory path where cropped images will be saved.</span>
<span></span><span class="sd">        file_name (str | Path): Base filename for the saved cropped images.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("path/to/image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; for result in results:</span>
<span></span><span class="sd">        &gt;&gt;&gt;     result.save_crop(save_dir="path/to/crops", file_name="detection")</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        - This method does not support Classify or Oriented Bounding Box (OBB) tasks.</span>
<span></span><span class="sd">        - Crops are saved as 'save_dir/class_name/file_name.jpg'.</span>
<span></span><span class="sd">        - The method will create necessary subdirectories if they don't exist.</span>
<span></span><span class="sd">        - Original image is copied before cropping to avoid modifying the original.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">probs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">"Classify task do not support `save_crop`."</span><span class="p">)</span>
<span></span>        <span class="k">return</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">obb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">"OBB task do not support `save_crop`."</span><span class="p">)</span>
<span></span>        <span class="k">return</span>
<span></span>    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="p">:</span>
<span></span>        <span class="n">save_one_box</span><span class="p">(</span>
<span></span>            <span class="n">d</span><span class="o">.</span><span class="n">xyxy</span><span class="p">,</span>
<span></span>            <span class="bp">self</span><span class="o">.</span><span class="n">orig_img</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
<span></span>            <span class="n">file</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">save_dir</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">cls</span><span class="p">)]</span> <span class="o">/</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">".jpg"</span><span class="p">),</span>
<span></span>            <span class="n">BGR</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span></span>        <span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.save_txt"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.save_txt</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">save_txt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">txt_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="n">save_conf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div><p>Save detection results to a text file.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>txt_file</code></td><td><code>str | Path</code></td><td>Path to the output text file.</td><td><em>required</em></td></tr><tr><td><code>save_conf</code></td><td><code>bool</code></td><td>Whether to include confidence scores in the output.</td><td><code>False</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>str</code></td><td>Path to the saved text file.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">YOLO</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="s2">"yolo11n.pt"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span></span><span class="o">&gt;&gt;&gt;</span>     <span class="n">result</span><span class="o">.</span><span class="n">save_txt</span><span class="p">(</span><span class="s2">"output.txt"</span><span class="p">)</span>
</code></pre></div><div class="admonition note"><p class="admonition-title">Notes</p><ul><li>The file will contain one line per detection or classification with the following structure:</li><li>For detections: <code>class confidence x_center y_center width height</code></li><li>For classifications: <code>confidence class_name</code></li><li>For masks and keypoints, the specific formats will vary accordingly.</li><li>The function will create the output directory if it does not exist.</li><li>If save_conf is False, the confidence scores will be excluded from the output.</li><li>Existing contents of the file will not be overwritten; new results will be appended.</li></ul></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L659-L713"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">save_txt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">txt_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span> <span class="n">save_conf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Save detection results to a text file.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        txt_file (str | Path): Path to the output text file.</span>
<span></span><span class="sd">        save_conf (bool): Whether to include confidence scores in the output.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (str): Path to the saved text file.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics import YOLO</span>
<span></span><span class="sd">        &gt;&gt;&gt; model = YOLO("yolo11n.pt")</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("path/to/image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; for result in results:</span>
<span></span><span class="sd">        &gt;&gt;&gt;     result.save_txt("output.txt")</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        - The file will contain one line per detection or classification with the following structure:</span>
<span></span><span class="sd">          - For detections: `class confidence x_center y_center width height`</span>
<span></span><span class="sd">          - For classifications: `confidence class_name`</span>
<span></span><span class="sd">          - For masks and keypoints, the specific formats will vary accordingly.</span>
<span></span><span class="sd">        - The function will create the output directory if it does not exist.</span>
<span></span><span class="sd">        - If save_conf is False, the confidence scores will be excluded from the output.</span>
<span></span><span class="sd">        - Existing contents of the file will not be overwritten; new results will be appended.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">is_obb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span></span>    <span class="n">boxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obb</span> <span class="k">if</span> <span class="n">is_obb</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span>
<span></span>    <span class="n">masks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">masks</span>
<span></span>    <span class="n">probs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">probs</span>
<span></span>    <span class="n">kpts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keypoints</span>
<span></span>    <span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>    <span class="k">if</span> <span class="n">probs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="c1"># Classify</span>
<span></span>        <span class="p">[</span><span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">probs</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">probs</span><span class="o">.</span><span class="n">top5</span><span class="p">]</span>
<span></span>    <span class="k">elif</span> <span class="n">boxes</span><span class="p">:</span>
<span></span>        <span class="c1"># Detect/segment/pose</span>
<span></span>        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">boxes</span><span class="p">):</span>
<span></span>            <span class="n">c</span><span class="p">,</span> <span class="n">conf</span><span class="p">,</span> <span class="nb">id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">cls</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">conf</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">item</span><span class="p">())</span> <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">is_track</span> <span class="k">else</span> <span class="kc">None</span>
<span></span>            <span class="n">line</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">xyxyxyxyn</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_obb</span> <span class="k">else</span> <span class="n">d</span><span class="o">.</span><span class="n">xywhn</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<span></span>            <span class="k">if</span> <span class="n">masks</span><span class="p">:</span>
<span></span>                <span class="n">seg</span> <span class="o">=</span> <span class="n">masks</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">xyn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># reversed mask.xyn, (n,2) to (n*2)</span>
<span></span>                <span class="n">line</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="o">*</span><span class="n">seg</span><span class="p">)</span>
<span></span>            <span class="k">if</span> <span class="n">kpts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>                <span class="n">kpt</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">kpts</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">xyn</span><span class="p">,</span> <span class="n">kpts</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">conf</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]),</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">kpts</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">has_visible</span> <span class="k">else</span> <span class="n">kpts</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">xyn</span>
<span></span>                <span class="n">line</span> <span class="o">+=</span> <span class="p">(</span><span class="o">*</span><span class="n">kpt</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),)</span>
<span></span>            <span class="n">line</span> <span class="o">+=</span> <span class="p">(</span><span class="n">conf</span><span class="p">,)</span> <span class="o">*</span> <span class="n">save_conf</span> <span class="o">+</span> <span class="p">(()</span> <span class="k">if</span> <span class="nb">id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="nb">id</span><span class="p">,))</span>
<span></span>            <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s2">"</span><span class="si">%g</span><span class="s2"> "</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">))</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">%</span> <span class="n">line</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">if</span> <span class="n">texts</span><span class="p">:</span>
<span></span>        <span class="n">Path</span><span class="p">(</span><span class="n">txt_file</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># make directory</span>
<span></span>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">txt_file</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span></span>            <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">text</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">txt_file</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.show"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.show</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div><p>Display the image with annotated inference results.</p><p>This method plots the detection results on the original image and displays it. It's a convenient way to visualize the model's predictions directly.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>*args</code></td><td><code>Any</code></td><td>Variable length argument list to be passed to the <code>plot()</code> method.</td><td><em>required</em></td></tr><tr><td><code>**kwargs</code></td><td><code>Any</code></td><td>Arbitrary keyword arguments to be passed to the <code>plot()</code> method.</td><td><em>required</em></td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Display the first result</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span></span><span class="o">&gt;&gt;&gt;</span>     <span class="n">result</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Display all results</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L582-L598"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Display the image with annotated inference results.</span>
<span></span>
<span></span><span class="sd">    This method plots the detection results on the original image and displays it. It's a convenient way to</span>
<span></span><span class="sd">    visualize the model's predictions directly.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        *args (Any): Variable length argument list to be passed to the `plot()` method.</span>
<span></span><span class="sd">        **kwargs (Any): Arbitrary keyword arguments to be passed to the `plot()` method.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("path/to/image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; results[0].show()  # Display the first result</span>
<span></span><span class="sd">        &gt;&gt;&gt; for result in results:</span>
<span></span><span class="sd">        &gt;&gt;&gt;     result.show()  # Display all results</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.summary"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.summary</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">decimals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
</code></pre></div><p>Convert inference results to a summarized dictionary with optional normalization for box coordinates.</p><p>This method creates a list of detection dictionaries, each containing information about a single detection or classification result. For classification tasks, it returns the top class and its confidence. For detection tasks, it includes class information, bounding box coordinates, and optionally mask segments and keypoints.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>normalize</code></td><td><code>bool</code></td><td>Whether to normalize bounding box coordinates by image dimensions.</td><td><code>False</code></td></tr><tr><td><code>decimals</code></td><td><code>int</code></td><td>Number of decimal places to round the output values to.</td><td><code>5</code></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list[dict[str, Any]]</code></td><td>A list of dictionaries, each containing summarized information for a single</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span></span><span class="o">&gt;&gt;&gt;</span>     <span class="n">summary</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span></span><span class="o">&gt;&gt;&gt;</span>     <span class="nb">print</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L750-L813"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">decimals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span></span><span class="w">    </span><span class="sd">"""Convert inference results to a summarized dictionary with optional normalization for box coordinates.</span>
<span></span>
<span></span><span class="sd">    This method creates a list of detection dictionaries, each containing information about a single detection or</span>
<span></span><span class="sd">    classification result. For classification tasks, it returns the top class and its</span>
<span></span><span class="sd">    confidence. For detection tasks, it includes class information, bounding box coordinates, and</span>
<span></span><span class="sd">    optionally mask segments and keypoints.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        normalize (bool): Whether to normalize bounding box coordinates by image dimensions.</span>
<span></span><span class="sd">        decimals (int): Number of decimal places to round the output values to.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list[dict[str, Any]]): A list of dictionaries, each containing summarized information for a single</span>
<span></span><span class="sd">            detection or classification result. The structure of each dictionary varies based on the task type</span>
<span></span><span class="sd">            (classification or detection) and available information (boxes, masks, keypoints).</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; for result in results:</span>
<span></span><span class="sd">        &gt;&gt;&gt;     summary = result.summary()</span>
<span></span><span class="sd">        &gt;&gt;&gt;     print(summary)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="c1"># Create list of detection dictionaries</span>
<span></span>    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">probs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="n">class_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">probs</span><span class="o">.</span><span class="n">top1</span>
<span></span>        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<span></span>            <span class="p">{</span>
<span></span>                <span class="s2">"name"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">class_id</span><span class="p">],</span>
<span></span>                <span class="s2">"class"</span><span class="p">:</span> <span class="n">class_id</span><span class="p">,</span>
<span></span>                <span class="s2">"confidence"</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">probs</span><span class="o">.</span><span class="n">top1conf</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">decimals</span><span class="p">),</span>
<span></span>            <span class="p">}</span>
<span></span>        <span class="p">)</span>
<span></span>        <span class="k">return</span> <span class="n">results</span>
<span></span>
<span></span>    <span class="n">is_obb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span></span>    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obb</span> <span class="k">if</span> <span class="n">is_obb</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span>
<span></span>    <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span> <span class="k">if</span> <span class="n">normalize</span> <span class="k">else</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>  <span class="c1"># xyxy, track_id if tracking, conf, class_id</span>
<span></span>        <span class="n">class_id</span><span class="p">,</span> <span class="n">conf</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">cls</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">decimals</span><span class="p">)</span>
<span></span>        <span class="n">box</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">xyxyxyxy</span> <span class="k">if</span> <span class="n">is_obb</span> <span class="k">else</span> <span class="n">row</span><span class="o">.</span><span class="n">xyxy</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span></span>        <span class="n">xy</span> <span class="o">=</span> <span class="p">{}</span>
<span></span>        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">box</span><span class="p">):</span>
<span></span>            <span class="n">xy</span><span class="p">[</span><span class="sa">f</span><span class="s2">"x</span><span class="si">{</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">w</span><span class="p">,</span> <span class="n">decimals</span><span class="p">)</span>
<span></span>            <span class="n">xy</span><span class="p">[</span><span class="sa">f</span><span class="s2">"y</span><span class="si">{</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">h</span><span class="p">,</span> <span class="n">decimals</span><span class="p">)</span>
<span></span>        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">class_id</span><span class="p">],</span> <span class="s2">"class"</span><span class="p">:</span> <span class="n">class_id</span><span class="p">,</span> <span class="s2">"confidence"</span><span class="p">:</span> <span class="n">conf</span><span class="p">,</span> <span class="s2">"box"</span><span class="p">:</span> <span class="n">xy</span><span class="p">}</span>
<span></span>        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">is_track</span><span class="p">:</span>
<span></span>            <span class="n">result</span><span class="p">[</span><span class="s2">"track_id"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>  <span class="c1"># track ID</span>
<span></span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">masks</span><span class="p">:</span>
<span></span>            <span class="n">result</span><span class="p">[</span><span class="s2">"segments"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span></span>                <span class="s2">"x"</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masks</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
<span></span>                <span class="s2">"y"</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masks</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
<span></span>            <span class="p">}</span>
<span></span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keypoints</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">visible</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keypoints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># torch Tensor</span>
<span></span>            <span class="n">result</span><span class="p">[</span><span class="s2">"keypoints"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span></span>                <span class="s2">"x"</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>  <span class="c1"># decimals named argument required</span>
<span></span>                <span class="s2">"y"</span><span class="p">:</span> <span class="p">(</span><span class="n">y</span> <span class="o">/</span> <span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
<span></span>                <span class="s2">"visible"</span><span class="p">:</span> <span class="n">visible</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
<span></span>            <span class="p">}</span>
<span></span>        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span></span>
<span></span>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.to"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.to</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div><p>Move all tensors in the Results object to the specified device and dtype.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>*args</code></td><td><code>Any</code></td><td>Variable length argument list to be passed to torch.Tensor.to().</td><td><em>required</em></td></tr><tr><td><code>**kwargs</code></td><td><code>Any</code></td><td>Arbitrary keyword arguments to be passed to torch.Tensor.to().</td><td><em>required</em></td></tr></tbody></table><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Results</code></td><td>A new Results object with all tensors moved to the specified device and dtype.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">result_cuda</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">"cuda"</span><span class="p">)</span>  <span class="c1"># Move first result to GPU</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">result_cpu</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">"cpu"</span><span class="p">)</span>  <span class="c1"># Move first result to CPU</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">result_half</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>  <span class="c1"># Convert first result to half precision</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L413-L429"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Move all tensors in the Results object to the specified device and dtype.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        *args (Any): Variable length argument list to be passed to torch.Tensor.to().</span>
<span></span><span class="sd">        **kwargs (Any): Arbitrary keyword arguments to be passed to torch.Tensor.to().</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (Results): A new Results object with all tensors moved to the specified device and dtype.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("path/to/image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; result_cuda = results[0].to("cuda")  # Move first result to GPU</span>
<span></span><span class="sd">        &gt;&gt;&gt; result_cpu = results[0].to("cpu")  # Move first result to CPU</span>
<span></span><span class="sd">        &gt;&gt;&gt; result_half = results[0].to(dtype=torch.float16)  # Convert first result to half precision</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply</span><span class="p">(</span><span class="s2">"to"</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.update"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.update</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span>
<span></span>    <span class="bp">self</span><span class="p">,</span>
<span></span>    <span class="n">boxes</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">masks</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">probs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">obb</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">keypoints</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span><span class="p">)</span>
</code></pre></div><p>Update the Results object with new detection data.</p><p>This method allows updating the boxes, masks, probabilities, and oriented bounding boxes (OBB) of the Results object. It ensures that boxes are clipped to the original image shape.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>boxes</code></td><td><code>torch.Tensor | None</code></td><td>A tensor of shape (N, 6) containing bounding box coordinates and confidence scores. The format is (x1, y1, x2, y2, conf, class).</td><td><code>None</code></td></tr><tr><td><code>masks</code></td><td><code>torch.Tensor | None</code></td><td>A tensor of shape (N, H, W) containing segmentation masks.</td><td><code>None</code></td></tr><tr><td><code>probs</code></td><td><code>torch.Tensor | None</code></td><td>A tensor of shape (num_classes,) containing class probabilities.</td><td><code>None</code></td></tr><tr><td><code>obb</code></td><td><code>torch.Tensor | None</code></td><td>A tensor of shape (N, 5) containing oriented bounding box coordinates.</td><td><code>None</code></td></tr><tr><td><code>keypoints</code></td><td><code>torch.Tensor | None</code></td><td>A tensor of shape (N, 17, 3) containing keypoints.</td><td><code>None</code></td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">new_boxes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">boxes</span><span class="o">=</span><span class="n">new_boxes</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L302-L337"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span>
<span></span>    <span class="bp">self</span><span class="p">,</span>
<span></span>    <span class="n">boxes</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">masks</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">probs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">obb</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span>    <span class="n">keypoints</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span></span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""Update the Results object with new detection data.</span>
<span></span>
<span></span><span class="sd">    This method allows updating the boxes, masks, probabilities, and oriented bounding boxes (OBB) of the Results</span>
<span></span><span class="sd">    object. It ensures that boxes are clipped to the original image shape.</span>
<span></span>
<span></span><span class="sd">    Args:</span>
<span></span><span class="sd">        boxes (torch.Tensor | None): A tensor of shape (N, 6) containing bounding box coordinates and confidence</span>
<span></span><span class="sd">            scores. The format is (x1, y1, x2, y2, conf, class).</span>
<span></span><span class="sd">        masks (torch.Tensor | None): A tensor of shape (N, H, W) containing segmentation masks.</span>
<span></span><span class="sd">        probs (torch.Tensor | None): A tensor of shape (num_classes,) containing class probabilities.</span>
<span></span><span class="sd">        obb (torch.Tensor | None): A tensor of shape (N, 5) containing oriented bounding box coordinates.</span>
<span></span><span class="sd">        keypoints (torch.Tensor | None): A tensor of shape (N, 17, 3) containing keypoints.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; new_boxes = torch.tensor([[100, 100, 200, 200, 0.9, 0]])</span>
<span></span><span class="sd">        &gt;&gt;&gt; results[0].update(boxes=new_boxes)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">if</span> <span class="n">boxes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span> <span class="o">=</span> <span class="n">Boxes</span><span class="p">(</span><span class="n">ops</span><span class="o">.</span><span class="n">clip_boxes</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">masks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">masks</span> <span class="o">=</span> <span class="n">Masks</span><span class="p">(</span><span class="n">masks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">probs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">probs</span> <span class="o">=</span> <span class="n">probs</span>
<span></span>    <span class="k">if</span> <span class="n">obb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">obb</span> <span class="o">=</span> <span class="n">OBB</span><span class="p">(</span><span class="n">obb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">)</span>
<span></span>    <span class="k">if</span> <span class="n">keypoints</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">keypoints</span> <span class="o">=</span> <span class="n">Keypoints</span><span class="p">(</span><span class="n">keypoints</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Results.verbose"><span class="doc-kind doc-kind-method">method</span> <code>ultralytics.engine.results.Results.verbose</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">verbose</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div><p>Return a log string for each task in the results, detailing detection and classification outcomes.</p><p>This method generates a human-readable string summarizing the detection and classification results. It includes the number of detections for each class and the top probabilities for classification tasks.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>str</code></td><td>A formatted string containing a summary of the results. For detection tasks, it includes the number</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span></span><span class="o">&gt;&gt;&gt;</span>     <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">verbose</span><span class="p">())</span>
<span></span><span class="mi">2</span> <span class="n">persons</span><span class="p">,</span> <span class="mi">1</span> <span class="n">car</span><span class="p">,</span> <span class="mi">3</span> <span class="n">traffic</span> <span class="n">lights</span><span class="p">,</span>
<span></span><span class="n">dog</span> <span class="mf">0.92</span><span class="p">,</span> <span class="n">cat</span> <span class="mf">0.78</span><span class="p">,</span> <span class="n">horse</span> <span class="mf">0.64</span><span class="p">,</span>
</code></pre></div><div class="admonition note"><p class="admonition-title">Notes</p><ul><li>If there are no detections, the method returns "(no detections), " for detection tasks.</li><li>For classification tasks, it returns the top 5 class probabilities and their corresponding class names.</li><li>The returned string is comma-separated and ends with a comma and a space.</li></ul></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L628-L657"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">verbose</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return a log string for each task in the results, detailing detection and classification outcomes.</span>
<span></span>
<span></span><span class="sd">    This method generates a human-readable string summarizing the detection and classification results. It includes</span>
<span></span><span class="sd">    the number of detections for each class and the top probabilities for classification tasks.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (str): A formatted string containing a summary of the results. For detection tasks, it includes the number</span>
<span></span><span class="sd">            of detections per class. For classification tasks, it includes the top 5 class probabilities.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("path/to/image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; for result in results:</span>
<span></span><span class="sd">        &gt;&gt;&gt;     print(result.verbose())</span>
<span></span><span class="sd">        2 persons, 1 car, 3 traffic lights,</span>
<span></span><span class="sd">        dog 0.92, cat 0.78, horse 0.64,</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        - If there are no detections, the method returns "(no detections), " for detection tasks.</span>
<span></span><span class="sd">        - For classification tasks, it returns the top 5 class probabilities and their corresponding class names.</span>
<span></span><span class="sd">        - The returned string is comma-separated and ends with a comma and a space.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">boxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obb</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">obb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span>
<span></span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span></span>        <span class="k">return</span> <span class="s2">""</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">probs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">"(no detections), "</span>
<span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">probs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span>        <span class="k">return</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">probs</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">'</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">probs</span><span class="o">.</span><span class="n">top5</span><span class="p">)</span><span class="si">}</span><span class="s2">, "</span>
<span></span>    <span class="k">if</span> <span class="n">boxes</span><span class="p">:</span>
<span></span>        <span class="n">counts</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">cls</span><span class="o">.</span><span class="n">int</span><span class="p">()</span><span class="o">.</span><span class="n">bincount</span><span class="p">()</span>
<span></span>        <span class="k">return</span> <span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}{</span><span class="s1">'s'</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">, "</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.engine.results.Boxes"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.engine.results.Boxes</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">Boxes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p><strong>Bases:</strong> <code>BaseTensor</code></p><p>A class for managing and manipulating detection boxes.</p><p>This class provides comprehensive functionality for handling detection boxes, including their coordinates, confidence scores, class labels, and optional tracking IDs. It supports various box formats and offers methods for easy manipulation and conversion between different coordinate systems.</p><p>This class manages detection boxes, providing easy access and manipulation of box coordinates, confidence scores, class identifiers, and optional tracking IDs. It supports multiple formats for box coordinates, including both absolute and normalized forms.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>boxes</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>A tensor or numpy array with detection boxes of shape (num_boxes, 6) or (num_boxes, 7). Columns should contain [x1, y1, x2, y2, (optional) track_id, confidence, class].</td><td><em>required</em></td></tr><tr><td><code>orig_shape</code></td><td><code>tuple[int, int]</code></td><td>The original image shape as (height, width). Used for normalization.</td><td><em>required</em></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>data</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>The raw tensor containing detection boxes and associated data.</td></tr><tr><td><code>orig_shape</code></td><td><code>tuple[int, int]</code></td><td>The original image dimensions (height, width).</td></tr><tr><td><code>is_track</code></td><td><code>bool</code></td><td>Indicates whether tracking IDs are included in the box data.</td></tr><tr><td><code>xyxy</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Boxes in [x1, y1, x2, y2] format.</td></tr><tr><td><code>conf</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Confidence scores for each box.</td></tr><tr><td><code>cls</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Class labels for each box.</td></tr><tr><td><code>id</code></td><td><code>torch.Tensor | None</code></td><td>Tracking IDs for each box (if available).</td></tr><tr><td><code>xywh</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Boxes in [x, y, width, height] format.</td></tr><tr><td><code>xyxyn</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Normalized [x1, y1, x2, y2] boxes relative to orig_shape.</td></tr><tr><td><code>xywhn</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Normalized [x, y, width, height] boxes relative to orig_shape.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.engine.results.Boxes.xyxy"><code>xyxy</code></a></td><td>Return bounding boxes in [x1, y1, x2, y2] format.</td></tr><tr><td><a href="#ultralytics.engine.results.Boxes.conf"><code>conf</code></a></td><td>Return the confidence scores for each detection box.</td></tr><tr><td><a href="#ultralytics.engine.results.Boxes.cls"><code>cls</code></a></td><td>Return the class ID tensor representing category predictions for each bounding box.</td></tr><tr><td><a href="#ultralytics.engine.results.Boxes.id"><code>id</code></a></td><td>Return the tracking IDs for each detection box if available.</td></tr><tr><td><a href="#ultralytics.engine.results.Boxes.xywh"><code>xywh</code></a></td><td>Convert bounding boxes from [x1, y1, x2, y2] format to [x, y, width, height] format.</td></tr><tr><td><a href="#ultralytics.engine.results.Boxes.xyxyn"><code>xyxyn</code></a></td><td>Return normalized bounding box coordinates relative to the original image size.</td></tr><tr><td><a href="#ultralytics.engine.results.Boxes.xywhn"><code>xywhn</code></a></td><td>Return normalized bounding boxes in [x, y, width, height] format.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">boxes_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">orig_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">640</span><span class="p">)</span>  <span class="c1"># height, width</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">boxes</span> <span class="o">=</span> <span class="n">Boxes</span><span class="p">(</span><span class="n">boxes_data</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">boxes</span><span class="o">.</span><span class="n">xyxy</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">boxes</span><span class="o">.</span><span class="n">conf</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">boxes</span><span class="o">.</span><span class="n">cls</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">boxes</span><span class="o">.</span><span class="n">xywhn</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L816-L1008"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Boxes</span><span class="p">(</span><span class="n">BaseTensor</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""A class for managing and manipulating detection boxes.</span>
<span></span>
<span></span><span class="sd">    This class provides comprehensive functionality for handling detection boxes, including their coordinates,</span>
<span></span><span class="sd">    confidence scores, class labels, and optional tracking IDs. It supports various box formats and offers methods for</span>
<span></span><span class="sd">    easy manipulation and conversion between different coordinate systems.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        data (torch.Tensor | np.ndarray): The raw tensor containing detection boxes and associated data.</span>
<span></span><span class="sd">        orig_shape (tuple[int, int]): The original image dimensions (height, width).</span>
<span></span><span class="sd">        is_track (bool): Indicates whether tracking IDs are included in the box data.</span>
<span></span><span class="sd">        xyxy (torch.Tensor | np.ndarray): Boxes in [x1, y1, x2, y2] format.</span>
<span></span><span class="sd">        conf (torch.Tensor | np.ndarray): Confidence scores for each box.</span>
<span></span><span class="sd">        cls (torch.Tensor | np.ndarray): Class labels for each box.</span>
<span></span><span class="sd">        id (torch.Tensor | None): Tracking IDs for each box (if available).</span>
<span></span><span class="sd">        xywh (torch.Tensor | np.ndarray): Boxes in [x, y, width, height] format.</span>
<span></span><span class="sd">        xyxyn (torch.Tensor | np.ndarray): Normalized [x1, y1, x2, y2] boxes relative to orig_shape.</span>
<span></span><span class="sd">        xywhn (torch.Tensor | np.ndarray): Normalized [x, y, width, height] boxes relative to orig_shape.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        cpu: Return a copy of the object with all tensors on CPU memory.</span>
<span></span><span class="sd">        numpy: Return a copy of the object with all tensors as numpy arrays.</span>
<span></span><span class="sd">        cuda: Return a copy of the object with all tensors on GPU memory.</span>
<span></span><span class="sd">        to: Return a copy of the object with tensors on specified device and dtype.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; import torch</span>
<span></span><span class="sd">        &gt;&gt;&gt; boxes_data = torch.tensor([[100, 50, 150, 100, 0.9, 0], [200, 150, 300, 250, 0.8, 1]])</span>
<span></span><span class="sd">        &gt;&gt;&gt; orig_shape = (480, 640)  # height, width</span>
<span></span><span class="sd">        &gt;&gt;&gt; boxes = Boxes(boxes_data, orig_shape)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(boxes.xyxy)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(boxes.conf)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(boxes.cls)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(boxes.xywhn)</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize the Boxes class with detection box data and the original image shape.</span>
<span></span>
<span></span><span class="sd">        This class manages detection boxes, providing easy access and manipulation of box coordinates, confidence</span>
<span></span><span class="sd">        scores, class identifiers, and optional tracking IDs. It supports multiple formats for box coordinates,</span>
<span></span><span class="sd">        including both absolute and normalized forms.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            boxes (torch.Tensor | np.ndarray): A tensor or numpy array with detection boxes of shape (num_boxes, 6) or</span>
<span></span><span class="sd">                (num_boxes, 7). Columns should contain [x1, y1, x2, y2, (optional) track_id, confidence, class].</span>
<span></span><span class="sd">            orig_shape (tuple[int, int]): The original image shape as (height, width). Used for normalization.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="k">if</span> <span class="n">boxes</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span></span>            <span class="n">boxes</span> <span class="o">=</span> <span class="n">boxes</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
<span></span>        <span class="n">n</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span></span>        <span class="k">assert</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">},</span> <span class="sa">f</span><span class="s2">"expected 6 or 7 values but got </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">"</span>  <span class="c1"># xyxy, track_id, conf, cls</span>
<span></span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">)</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">is_track</span> <span class="o">=</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">7</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span> <span class="o">=</span> <span class="n">orig_shape</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Boxes.xyxy"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Boxes.xyxy</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">xyxy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return bounding boxes in [x1, y1, x2, y2] format.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>A tensor or numpy array of shape (n, 4) containing bounding box coordinates in</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">boxes</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">boxes</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">xyxy</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">xyxy</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">xyxy</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L873-L886"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">xyxy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return bounding boxes in [x1, y1, x2, y2] format.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): A tensor or numpy array of shape (n, 4) containing bounding box coordinates in</span>
<span></span><span class="sd">            [x1, y1, x2, y2] format, where n is the number of boxes.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; boxes = results[0].boxes</span>
<span></span><span class="sd">        &gt;&gt;&gt; xyxy = boxes.xyxy</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(xyxy)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Boxes.conf"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Boxes.conf</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">conf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return the confidence scores for each detection box.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>A 1D tensor or array containing confidence scores for each detection, with</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">boxes</span> <span class="o">=</span> <span class="n">Boxes</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">conf_scores</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">conf</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">conf_scores</span><span class="p">)</span>
<span></span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.9000</span><span class="p">])</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L889-L902"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">conf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the confidence scores for each detection box.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): A 1D tensor or array containing confidence scores for each detection, with</span>
<span></span><span class="sd">            shape (N,) where N is the number of detections.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; boxes = Boxes(torch.tensor([[10, 20, 30, 40, 0.9, 0]]), orig_shape=(100, 100))</span>
<span></span><span class="sd">        &gt;&gt;&gt; conf_scores = boxes.conf</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(conf_scores)</span>
<span></span><span class="sd">        tensor([0.9000])</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Boxes.cls"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Boxes.cls</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return the class ID tensor representing category predictions for each bounding box.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>A tensor or numpy array containing the class IDs for each detection box. The</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">boxes</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">boxes</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">class_ids</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">cls</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">class_ids</span><span class="p">)</span>  <span class="c1"># tensor([0., 2., 1.])</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L905-L918"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">cls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the class ID tensor representing category predictions for each bounding box.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): A tensor or numpy array containing the class IDs for each detection box. The</span>
<span></span><span class="sd">            shape is (N,), where N is the number of boxes.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; boxes = results[0].boxes</span>
<span></span><span class="sd">        &gt;&gt;&gt; class_ids = boxes.cls</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(class_ids)  # tensor([0., 2., 1.])</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Boxes.id"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Boxes.id</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div><p>Return the tracking IDs for each detection box if available.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | None</code></td><td>A tensor containing tracking IDs for each box if tracking is enabled, otherwise None.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">track</span><span class="p">(</span><span class="s2">"path/to/video.mp4"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span></span><span class="o">...</span>     <span class="n">boxes</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">boxes</span>
<span></span><span class="o">...</span>     <span class="k">if</span> <span class="n">boxes</span><span class="o">.</span><span class="n">is_track</span><span class="p">:</span>
<span></span><span class="o">...</span>         <span class="n">track_ids</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">id</span>
<span></span><span class="o">...</span>         <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Tracking IDs: </span><span class="si">{</span><span class="n">track_ids</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span></span><span class="o">...</span>     <span class="k">else</span><span class="p">:</span>
<span></span><span class="o">...</span>         <span class="nb">print</span><span class="p">(</span><span class="s2">"Tracking is not enabled for these boxes."</span><span class="p">)</span>
</code></pre></div><div class="admonition note"><p class="admonition-title">Notes</p><ul><li>This property is only available when tracking is enabled (i.e., when <code>is_track</code> is True).</li><li>The tracking IDs are typically used to associate detections across multiple frames in video analysis.</li></ul></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L921-L942"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the tracking IDs for each detection box if available.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | None): A tensor containing tracking IDs for each box if tracking is enabled, otherwise None.</span>
<span></span><span class="sd">            Shape is (N,) where N is the number of boxes.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model.track("path/to/video.mp4")</span>
<span></span><span class="sd">        &gt;&gt;&gt; for result in results:</span>
<span></span><span class="sd">        ...     boxes = result.boxes</span>
<span></span><span class="sd">        ...     if boxes.is_track:</span>
<span></span><span class="sd">        ...         track_ids = boxes.id</span>
<span></span><span class="sd">        ...         print(f"Tracking IDs: {track_ids}")</span>
<span></span><span class="sd">        ...     else:</span>
<span></span><span class="sd">        ...         print("Tracking is not enabled for these boxes.")</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        - This property is only available when tracking is enabled (i.e., when `is_track` is True).</span>
<span></span><span class="sd">        - The tracking IDs are typically used to associate detections across multiple frames in video analysis.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_track</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Boxes.xywh"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Boxes.xywh</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">xywh</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Convert bounding boxes from [x1, y1, x2, y2] format to [x, y, width, height] format.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>Boxes in [x_center, y_center, width, height] format, where x_center, y_center</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">boxes</span> <span class="o">=</span> <span class="n">Boxes</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">250</span><span class="p">]]),</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">640</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">xywh</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">xywh</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">xywh</span><span class="p">)</span>
<span></span><span class="n">tensor</span><span class="p">([[</span><span class="mf">100.0000</span><span class="p">,</span>  <span class="mf">50.0000</span><span class="p">,</span>  <span class="mf">50.0000</span><span class="p">,</span>  <span class="mf">50.0000</span><span class="p">],</span>
<span></span>        <span class="p">[</span><span class="mf">200.0000</span><span class="p">,</span> <span class="mf">150.0000</span><span class="p">,</span> <span class="mf">100.0000</span><span class="p">,</span> <span class="mf">100.0000</span><span class="p">]])</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L946-L961"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">xywh</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Convert bounding boxes from [x1, y1, x2, y2] format to [x, y, width, height] format.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): Boxes in [x_center, y_center, width, height] format, where x_center, y_center</span>
<span></span><span class="sd">            are the coordinates of the center point of the bounding box, width, height are the dimensions of the</span>
<span></span><span class="sd">            bounding box and the shape of the returned tensor is (N, 4), where N is the number of boxes.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; boxes = Boxes(torch.tensor([[100, 50, 150, 100], [200, 150, 300, 250]]), orig_shape=(480, 640))</span>
<span></span><span class="sd">        &gt;&gt;&gt; xywh = boxes.xywh</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(xywh)</span>
<span></span><span class="sd">        tensor([[100.0000,  50.0000,  50.0000,  50.0000],</span>
<span></span><span class="sd">                [200.0000, 150.0000, 100.0000, 100.0000]])</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">xyxy2xywh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyxy</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Boxes.xyxyn"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Boxes.xyxyn</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">xyxyn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return normalized bounding box coordinates relative to the original image size.</p><p>This property calculates and returns the bounding box coordinates in [x1, y1, x2, y2] format, normalized to the range [0, 1] based on the original image dimensions.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>Normalized bounding box coordinates with shape (N, 4), where N is the number of</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">boxes</span> <span class="o">=</span> <span class="n">Boxes</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">640</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">normalized</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">xyxyn</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">normalized</span><span class="p">)</span>
<span></span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.1562</span><span class="p">,</span> <span class="mf">0.1042</span><span class="p">,</span> <span class="mf">0.4688</span><span class="p">,</span> <span class="mf">0.8333</span><span class="p">]])</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L965-L984"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">xyxyn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return normalized bounding box coordinates relative to the original image size.</span>
<span></span>
<span></span><span class="sd">    This property calculates and returns the bounding box coordinates in [x1, y1, x2, y2] format, normalized to the</span>
<span></span><span class="sd">    range [0, 1] based on the original image dimensions.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): Normalized bounding box coordinates with shape (N, 4), where N is the number of</span>
<span></span><span class="sd">            boxes. Each row contains [x1, y1, x2, y2] values normalized to [0, 1].</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; boxes = Boxes(torch.tensor([[100, 50, 300, 400, 0.9, 0]]), orig_shape=(480, 640))</span>
<span></span><span class="sd">        &gt;&gt;&gt; normalized = boxes.xyxyn</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(normalized)</span>
<span></span><span class="sd">        tensor([[0.1562, 0.1042, 0.4688, 0.8333]])</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">xyxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyxy</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyxy</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyxy</span><span class="p">)</span>
<span></span>    <span class="n">xyxy</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span></span>    <span class="n">xyxy</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span></span>    <span class="k">return</span> <span class="n">xyxy</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Boxes.xywhn"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Boxes.xywhn</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">xywhn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return normalized bounding boxes in [x, y, width, height] format.</p><p>This property calculates and returns the normalized bounding box coordinates in the format [x_center, y_center, width, height], where all values are relative to the original image dimensions.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>Normalized bounding boxes with shape (N, 4), where N is the number of boxes.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">boxes</span> <span class="o">=</span> <span class="n">Boxes</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">640</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">normalized</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">xywhn</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">normalized</span><span class="p">)</span>
<span></span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.1953</span><span class="p">,</span> <span class="mf">0.1562</span><span class="p">,</span> <span class="mf">0.0781</span><span class="p">,</span> <span class="mf">0.1042</span><span class="p">]])</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L988-L1008"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">xywhn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return normalized bounding boxes in [x, y, width, height] format.</span>
<span></span>
<span></span><span class="sd">    This property calculates and returns the normalized bounding box coordinates in the format [x_center, y_center,</span>
<span></span><span class="sd">    width, height], where all values are relative to the original image dimensions.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): Normalized bounding boxes with shape (N, 4), where N is the number of boxes.</span>
<span></span><span class="sd">            Each row contains [x_center, y_center, width, height] values normalized to [0, 1] based on the original</span>
<span></span><span class="sd">            image dimensions.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; boxes = Boxes(torch.tensor([[100, 50, 150, 100, 0.9, 0]]), orig_shape=(480, 640))</span>
<span></span><span class="sd">        &gt;&gt;&gt; normalized = boxes.xywhn</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(normalized)</span>
<span></span><span class="sd">        tensor([[0.1953, 0.1562, 0.0781, 0.1042]])</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">xywh</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">xyxy2xywh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyxy</span><span class="p">)</span>
<span></span>    <span class="n">xywh</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span></span>    <span class="n">xywh</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span></span>    <span class="k">return</span> <span class="n">xywh</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.engine.results.Masks"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.engine.results.Masks</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">Masks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">masks</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p><strong>Bases:</strong> <code>BaseTensor</code></p><p>A class for storing and manipulating detection masks.</p><p>This class extends BaseTensor and provides functionality for handling segmentation masks, including methods for converting between pixel and normalized coordinates.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>masks</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Detection masks with shape (num_masks, height, width).</td><td><em>required</em></td></tr><tr><td><code>orig_shape</code></td><td><code>tuple</code></td><td>The original image shape as (height, width). Used for normalization.</td><td><em>required</em></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>data</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>The raw tensor or array containing mask data.</td></tr><tr><td><code>orig_shape</code></td><td><code>tuple</code></td><td>Original image shape in (height, width) format.</td></tr><tr><td><code>xy</code></td><td><code>list[np.ndarray]</code></td><td>A list of segments in pixel coordinates.</td></tr><tr><td><code>xyn</code></td><td><code>list[np.ndarray]</code></td><td>A list of normalized segments.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.engine.results.Masks.xyn"><code>xyn</code></a></td><td>Return normalized xy-coordinates of the segmentation masks.</td></tr><tr><td><a href="#ultralytics.engine.results.Masks.xy"><code>xy</code></a></td><td>Return the [x, y] pixel coordinates for each segment in the mask tensor.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">masks_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">160</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">orig_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">720</span><span class="p">,</span> <span class="mi">1280</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">masks</span> <span class="o">=</span> <span class="n">Masks</span><span class="p">(</span><span class="n">masks_data</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">pixel_coords</span> <span class="o">=</span> <span class="n">masks</span><span class="o">.</span><span class="n">xy</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">normalized_coords</span> <span class="o">=</span> <span class="n">masks</span><span class="o">.</span><span class="n">xyn</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1011-L1094"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Masks</span><span class="p">(</span><span class="n">BaseTensor</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""A class for storing and manipulating detection masks.</span>
<span></span>
<span></span><span class="sd">    This class extends BaseTensor and provides functionality for handling segmentation masks, including methods for</span>
<span></span><span class="sd">    converting between pixel and normalized coordinates.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        data (torch.Tensor | np.ndarray): The raw tensor or array containing mask data.</span>
<span></span><span class="sd">        orig_shape (tuple): Original image shape in (height, width) format.</span>
<span></span><span class="sd">        xy (list[np.ndarray]): A list of segments in pixel coordinates.</span>
<span></span><span class="sd">        xyn (list[np.ndarray]): A list of normalized segments.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        cpu: Return a copy of the Masks object with the mask tensor on CPU memory.</span>
<span></span><span class="sd">        numpy: Return a copy of the Masks object with the mask tensor as a numpy array.</span>
<span></span><span class="sd">        cuda: Return a copy of the Masks object with the mask tensor on GPU memory.</span>
<span></span><span class="sd">        to: Return a copy of the Masks object with the mask tensor on specified device and dtype.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; masks_data = torch.rand(1, 160, 160)</span>
<span></span><span class="sd">        &gt;&gt;&gt; orig_shape = (720, 1280)</span>
<span></span><span class="sd">        &gt;&gt;&gt; masks = Masks(masks_data, orig_shape)</span>
<span></span><span class="sd">        &gt;&gt;&gt; pixel_coords = masks.xy</span>
<span></span><span class="sd">        &gt;&gt;&gt; normalized_coords = masks.xyn</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">masks</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize the Masks class with detection mask data and the original image shape.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            masks (torch.Tensor | np.ndarray): Detection masks with shape (num_masks, height, width).</span>
<span></span><span class="sd">            orig_shape (tuple): The original image shape as (height, width). Used for normalization.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="k">if</span> <span class="n">masks</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span></span>            <span class="n">masks</span> <span class="o">=</span> <span class="n">masks</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
<span></span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">masks</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Masks.xyn"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Masks.xyn</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">xyn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div><p>Return normalized xy-coordinates of the segmentation masks.</p><p>This property calculates and caches the normalized xy-coordinates of the segmentation masks. The coordinates are normalized relative to the original image shape.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list[np.ndarray]</code></td><td>A list of numpy arrays, where each array contains the normalized xy-coordinates of a</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">masks</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">masks</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">normalized_coords</span> <span class="o">=</span> <span class="n">masks</span><span class="o">.</span><span class="n">xyn</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">normalized_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># Normalized coordinates of the first mask</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1050-L1070"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">xyn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return normalized xy-coordinates of the segmentation masks.</span>
<span></span>
<span></span><span class="sd">    This property calculates and caches the normalized xy-coordinates of the segmentation masks. The coordinates are</span>
<span></span><span class="sd">    normalized relative to the original image shape.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list[np.ndarray]): A list of numpy arrays, where each array contains the normalized xy-coordinates of a</span>
<span></span><span class="sd">            single segmentation mask. Each array has shape (N, 2), where N is the number of points in the</span>
<span></span><span class="sd">            mask contour.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; masks = results[0].masks</span>
<span></span><span class="sd">        &gt;&gt;&gt; normalized_coords = masks.xyn</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(normalized_coords[0])  # Normalized coordinates of the first mask</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="p">[</span>
<span></span>        <span class="n">ops</span><span class="o">.</span><span class="n">scale_coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ops</span><span class="o">.</span><span class="n">masks2segments</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span></span>    <span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Masks.xy"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Masks.xy</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">xy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div><p>Return the [x, y] pixel coordinates for each segment in the mask tensor.</p><p>This property calculates and returns a list of pixel coordinates for each segmentation mask in the Masks object. The coordinates are scaled to match the original image dimensions.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list[np.ndarray]</code></td><td>A list of numpy arrays, where each array contains the [x, y] pixel coordinates for a</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">masks</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">masks</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">xy_coords</span> <span class="o">=</span> <span class="n">masks</span><span class="o">.</span><span class="n">xy</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">))</span>  <span class="c1"># Number of masks</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Shape of first mask's coordinates</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1074-L1094"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">xy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the [x, y] pixel coordinates for each segment in the mask tensor.</span>
<span></span>
<span></span><span class="sd">    This property calculates and returns a list of pixel coordinates for each segmentation mask in the Masks object.</span>
<span></span><span class="sd">    The coordinates are scaled to match the original image dimensions.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list[np.ndarray]): A list of numpy arrays, where each array contains the [x, y] pixel coordinates for a</span>
<span></span><span class="sd">            single segmentation mask. Each array has shape (N, 2), where N is the number of points in the segment.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; masks = results[0].masks</span>
<span></span><span class="sd">        &gt;&gt;&gt; xy_coords = masks.xy</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(len(xy_coords))  # Number of masks</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(xy_coords[0].shape)  # Shape of first mask's coordinates</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="p">[</span>
<span></span>        <span class="n">ops</span><span class="o">.</span><span class="n">scale_coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span></span>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ops</span><span class="o">.</span><span class="n">masks2segments</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span></span>    <span class="p">]</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.engine.results.Keypoints"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.engine.results.Keypoints</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">Keypoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keypoints</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p><strong>Bases:</strong> <code>BaseTensor</code></p><p>A class for storing and manipulating detection keypoints.</p><p>This class encapsulates functionality for handling keypoint data, including coordinate manipulation, normalization, and confidence values. It supports keypoint detection results with optional visibility information.</p><p>This method processes the input keypoints tensor, handling both 2D and 3D formats. For 3D tensors (x, y, confidence), it masks out low-confidence keypoints by setting their coordinates to zero.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>keypoints</code></td><td><code>torch.Tensor</code></td><td>A tensor containing keypoint data. Shape can be either: - (num_objects, num_keypoints, 2) for x, y coordinates only - (num_objects, num_keypoints, 3) for x, y coordinates and confidence scores</td><td><em>required</em></td></tr><tr><td><code>orig_shape</code></td><td><code>tuple[int, int]</code></td><td>The original image dimensions (height, width).</td><td><em>required</em></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>data</code></td><td><code>torch.Tensor</code></td><td>The raw tensor containing keypoint data.</td></tr><tr><td><code>orig_shape</code></td><td><code>tuple[int, int]</code></td><td>The original image dimensions (height, width).</td></tr><tr><td><code>has_visible</code></td><td><code>bool</code></td><td>Indicates whether visibility information is available for keypoints.</td></tr><tr><td><code>xy</code></td><td><code>torch.Tensor</code></td><td>Keypoint coordinates in [x, y] format.</td></tr><tr><td><code>xyn</code></td><td><code>torch.Tensor</code></td><td>Normalized keypoint coordinates in [x, y] format, relative to orig_shape.</td></tr><tr><td><code>conf</code></td><td><code>torch.Tensor</code></td><td>Confidence values for each keypoint, if available.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.engine.results.Keypoints.xy"><code>xy</code></a></td><td>Return x, y coordinates of keypoints.</td></tr><tr><td><a href="#ultralytics.engine.results.Keypoints.xyn"><code>xyn</code></a></td><td>Return normalized coordinates (x, y) of keypoints relative to the original image size.</td></tr><tr><td><a href="#ultralytics.engine.results.Keypoints.conf"><code>conf</code></a></td><td>Return confidence values for each keypoint.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics.engine.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">Keypoints</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">keypoints_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 1 detection, 17 keypoints, (x, y, conf)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">orig_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">640</span><span class="p">)</span>  <span class="c1"># Original image shape (height, width)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">keypoints</span> <span class="o">=</span> <span class="n">Keypoints</span><span class="p">(</span><span class="n">keypoints_data</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">keypoints</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Access xy coordinates</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">keypoints</span><span class="o">.</span><span class="n">conf</span><span class="p">)</span>  <span class="c1"># Access confidence values</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">keypoints_cpu</span> <span class="o">=</span> <span class="n">keypoints</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>  <span class="c1"># Move keypoints to CPU</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1097-L1203"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Keypoints</span><span class="p">(</span><span class="n">BaseTensor</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""A class for storing and manipulating detection keypoints.</span>
<span></span>
<span></span><span class="sd">    This class encapsulates functionality for handling keypoint data, including coordinate manipulation, normalization,</span>
<span></span><span class="sd">    and confidence values. It supports keypoint detection results with optional visibility information.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        data (torch.Tensor): The raw tensor containing keypoint data.</span>
<span></span><span class="sd">        orig_shape (tuple[int, int]): The original image dimensions (height, width).</span>
<span></span><span class="sd">        has_visible (bool): Indicates whether visibility information is available for keypoints.</span>
<span></span><span class="sd">        xy (torch.Tensor): Keypoint coordinates in [x, y] format.</span>
<span></span><span class="sd">        xyn (torch.Tensor): Normalized keypoint coordinates in [x, y] format, relative to orig_shape.</span>
<span></span><span class="sd">        conf (torch.Tensor): Confidence values for each keypoint, if available.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        cpu: Return a copy of the keypoints tensor on CPU memory.</span>
<span></span><span class="sd">        numpy: Return a copy of the keypoints tensor as a numpy array.</span>
<span></span><span class="sd">        cuda: Return a copy of the keypoints tensor on GPU memory.</span>
<span></span><span class="sd">        to: Return a copy of the keypoints tensor with specified device and dtype.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; import torch</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics.engine.results import Keypoints</span>
<span></span><span class="sd">        &gt;&gt;&gt; keypoints_data = torch.rand(1, 17, 3)  # 1 detection, 17 keypoints, (x, y, conf)</span>
<span></span><span class="sd">        &gt;&gt;&gt; orig_shape = (480, 640)  # Original image shape (height, width)</span>
<span></span><span class="sd">        &gt;&gt;&gt; keypoints = Keypoints(keypoints_data, orig_shape)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(keypoints.xy.shape)  # Access xy coordinates</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(keypoints.conf)  # Access confidence values</span>
<span></span><span class="sd">        &gt;&gt;&gt; keypoints_cpu = keypoints.cpu()  # Move keypoints to CPU</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keypoints</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize the Keypoints object with detection keypoints and original image dimensions.</span>
<span></span>
<span></span><span class="sd">        This method processes the input keypoints tensor, handling both 2D and 3D formats. For 3D tensors (x, y,</span>
<span></span><span class="sd">        confidence), it masks out low-confidence keypoints by setting their coordinates to zero.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            keypoints (torch.Tensor): A tensor containing keypoint data. Shape can be either:</span>
<span></span><span class="sd">                - (num_objects, num_keypoints, 2) for x, y coordinates only</span>
<span></span><span class="sd">                - (num_objects, num_keypoints, 3) for x, y coordinates and confidence scores</span>
<span></span><span class="sd">            orig_shape (tuple[int, int]): The original image dimensions (height, width).</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="k">if</span> <span class="n">keypoints</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span></span>            <span class="n">keypoints</span> <span class="o">=</span> <span class="n">keypoints</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
<span></span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">keypoints</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">)</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">has_visible</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Keypoints.xy"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Keypoints.xy</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">xy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return x, y coordinates of keypoints.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor</code></td><td>A tensor containing the x, y coordinates of keypoints with shape (N, K, 2), where N is the</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">keypoints</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keypoints</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">xy</span> <span class="o">=</span> <span class="n">keypoints</span><span class="o">.</span><span class="n">xy</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">xy</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (N, K, 2)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># x, y coordinates of keypoints for first detection</span>
</code></pre></div><div class="admonition note"><p class="admonition-title">Notes</p><ul><li>The returned coordinates are in pixel units relative to the original image dimensions.</li><li>If keypoints were initialized with confidence values, only keypoints with confidence &gt;= 0.5 are returned.</li><li>This property uses LRU caching to improve performance on repeated access.</li></ul></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1147-L1166"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">xy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return x, y coordinates of keypoints.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor): A tensor containing the x, y coordinates of keypoints with shape (N, K, 2), where N is the</span>
<span></span><span class="sd">            number of detections and K is the number of keypoints per detection.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; keypoints = results[0].keypoints</span>
<span></span><span class="sd">        &gt;&gt;&gt; xy = keypoints.xy</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(xy.shape)  # (N, K, 2)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(xy[0])  # x, y coordinates of keypoints for first detection</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        - The returned coordinates are in pixel units relative to the original image dimensions.</span>
<span></span><span class="sd">        - If keypoints were initialized with confidence values, only keypoints with confidence &gt;= 0.5 are returned.</span>
<span></span><span class="sd">        - This property uses LRU caching to improve performance on repeated access.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Keypoints.xyn"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Keypoints.xyn</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">xyn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return normalized coordinates (x, y) of keypoints relative to the original image size.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>A tensor or array of shape (N, K, 2) containing normalized keypoint</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">keypoints</span> <span class="o">=</span> <span class="n">Keypoints</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">640</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">normalized_kpts</span> <span class="o">=</span> <span class="n">keypoints</span><span class="o">.</span><span class="n">xyn</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">normalized_kpts</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span></span><span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1170-L1187"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">xyn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return normalized coordinates (x, y) of keypoints relative to the original image size.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): A tensor or array of shape (N, K, 2) containing normalized keypoint</span>
<span></span><span class="sd">            coordinates, where N is the number of instances, K is the number of keypoints, and the last dimension</span>
<span></span><span class="sd">            contains [x, y] values in the range [0, 1].</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; keypoints = Keypoints(torch.rand(1, 17, 2), orig_shape=(480, 640))</span>
<span></span><span class="sd">        &gt;&gt;&gt; normalized_kpts = keypoints.xyn</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(normalized_kpts.shape)</span>
<span></span><span class="sd">        torch.Size([1, 17, 2])</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">xy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="p">)</span>
<span></span>    <span class="n">xy</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span></span>    <span class="n">xy</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span></span>    <span class="k">return</span> <span class="n">xy</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Keypoints.conf"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Keypoints.conf</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">conf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div><p>Return confidence values for each keypoint.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | None</code></td><td>A tensor containing confidence scores for each keypoint if available, otherwise None.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">keypoints</span> <span class="o">=</span> <span class="n">Keypoints</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">))</span>  <span class="c1"># 1 detection, 17 keypoints</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">conf</span> <span class="o">=</span> <span class="n">keypoints</span><span class="o">.</span><span class="n">conf</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># torch.Size([1, 17])</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1191-L1203"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">conf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return confidence values for each keypoint.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | None): A tensor containing confidence scores for each keypoint if available, otherwise None.</span>
<span></span><span class="sd">            Shape is (num_detections, num_keypoints) for batched data or (num_keypoints,) for single detection.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; keypoints = Keypoints(torch.rand(1, 17, 3), orig_shape=(640, 640))  # 1 detection, 17 keypoints</span>
<span></span><span class="sd">        &gt;&gt;&gt; conf = keypoints.conf</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(conf.shape)  # torch.Size([1, 17])</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_visible</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.engine.results.Probs"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.engine.results.Probs</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">Probs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p><strong>Bases:</strong> <code>BaseTensor</code></p><p>A class for storing and manipulating classification probabilities.</p><p>This class extends BaseTensor and provides methods for accessing and manipulating classification probabilities, including top-1 and top-5 predictions.</p><p>This class stores and manages classification probabilities, providing easy access to top predictions and their confidences.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>probs</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>A 1D tensor or array of classification probabilities.</td><td><em>required</em></td></tr><tr><td><code>orig_shape</code></td><td><code>tuple | None</code></td><td>The original image shape as (height, width). Not used in this class but kept for consistency with other result classes.</td><td><code>None</code></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>data</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>The raw tensor or array containing classification probabilities.</td></tr><tr><td><code>orig_shape</code></td><td><code>tuple | None</code></td><td>The original image shape as (height, width). Not used in this class.</td></tr><tr><td><code>top1</code></td><td><code>int</code></td><td>Index of the class with the highest probability.</td></tr><tr><td><code>top5</code></td><td><code>list[int]</code></td><td>Indices of the top 5 classes by probability.</td></tr><tr><td><code>top1conf</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Confidence score of the top 1 class.</td></tr><tr><td><code>top5conf</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Confidence scores of the top 5 classes.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.engine.results.Probs.top1"><code>top1</code></a></td><td>Return the index of the class with the highest probability.</td></tr><tr><td><a href="#ultralytics.engine.results.Probs.top5"><code>top5</code></a></td><td>Return the indices of the top 5 class probabilities.</td></tr><tr><td><a href="#ultralytics.engine.results.Probs.top1conf"><code>top1conf</code></a></td><td>Return the confidence score of the highest probability class.</td></tr><tr><td><a href="#ultralytics.engine.results.Probs.top5conf"><code>top5conf</code></a></td><td>Return confidence scores for the top 5 classification predictions.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">probs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">])</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Probs</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">top1</span><span class="p">)</span>
<span></span><span class="mi">2</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">top5</span><span class="p">)</span>
<span></span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">top1conf</span><span class="p">)</span>
<span></span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.6000</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">top5conf</span><span class="p">)</span>
<span></span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.6000</span><span class="p">,</span> <span class="mf">0.3000</span><span class="p">,</span> <span class="mf">0.1000</span><span class="p">])</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1206-L1320"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Probs</span><span class="p">(</span><span class="n">BaseTensor</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""A class for storing and manipulating classification probabilities.</span>
<span></span>
<span></span><span class="sd">    This class extends BaseTensor and provides methods for accessing and manipulating classification probabilities,</span>
<span></span><span class="sd">    including top-1 and top-5 predictions.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        data (torch.Tensor | np.ndarray): The raw tensor or array containing classification probabilities.</span>
<span></span><span class="sd">        orig_shape (tuple | None): The original image shape as (height, width). Not used in this class.</span>
<span></span><span class="sd">        top1 (int): Index of the class with the highest probability.</span>
<span></span><span class="sd">        top5 (list[int]): Indices of the top 5 classes by probability.</span>
<span></span><span class="sd">        top1conf (torch.Tensor | np.ndarray): Confidence score of the top 1 class.</span>
<span></span><span class="sd">        top5conf (torch.Tensor | np.ndarray): Confidence scores of the top 5 classes.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        cpu: Return a copy of the probabilities tensor on CPU memory.</span>
<span></span><span class="sd">        numpy: Return a copy of the probabilities tensor as a numpy array.</span>
<span></span><span class="sd">        cuda: Return a copy of the probabilities tensor on GPU memory.</span>
<span></span><span class="sd">        to: Return a copy of the probabilities tensor with specified device and dtype.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; probs = torch.tensor([0.1, 0.3, 0.6])</span>
<span></span><span class="sd">        &gt;&gt;&gt; p = Probs(probs)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(p.top1)</span>
<span></span><span class="sd">        2</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(p.top5)</span>
<span></span><span class="sd">        [2, 1, 0]</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(p.top1conf)</span>
<span></span><span class="sd">        tensor(0.6000)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(p.top5conf)</span>
<span></span><span class="sd">        tensor([0.6000, 0.3000, 0.1000])</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize the Probs class with classification probabilities.</span>
<span></span>
<span></span><span class="sd">        This class stores and manages classification probabilities, providing easy access to top predictions and their</span>
<span></span><span class="sd">        confidences.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            probs (torch.Tensor | np.ndarray): A 1D tensor or array of classification probabilities.</span>
<span></span><span class="sd">            orig_shape (tuple | None): The original image shape as (height, width). Not used in this class but kept for</span>
<span></span><span class="sd">                consistency with other result classes.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">probs</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Probs.top1"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Probs.top1</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">top1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div><p>Return the index of the class with the highest probability.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>int</code></td><td>Index of the class with the highest probability.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">probs</span> <span class="o">=</span> <span class="n">Probs</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">probs</span><span class="o">.</span><span class="n">top1</span>
<span></span><span class="mi">2</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1254-L1265"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">top1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the index of the class with the highest probability.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (int): Index of the class with the highest probability.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; probs = Probs(torch.tensor([0.1, 0.3, 0.6]))</span>
<span></span><span class="sd">        &gt;&gt;&gt; probs.top1</span>
<span></span><span class="sd">        2</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">argmax</span><span class="p">())</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Probs.top5"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Probs.top5</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">top5</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</code></pre></div><p>Return the indices of the top 5 class probabilities.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>list[int]</code></td><td>A list containing the indices of the top 5 class probabilities, sorted in descending order.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">probs</span> <span class="o">=</span> <span class="n">Probs</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">probs</span><span class="o">.</span><span class="n">top5</span><span class="p">)</span>
<span></span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1269-L1280"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">top5</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the indices of the top 5 class probabilities.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (list[int]): A list containing the indices of the top 5 class probabilities, sorted in descending order.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; probs = Probs(torch.tensor([0.1, 0.2, 0.3, 0.4, 0.5]))</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(probs.top5)</span>
<span></span><span class="sd">        [4, 3, 2, 1, 0]</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="mi">0</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># this way works with both torch and numpy.</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Probs.top1conf"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Probs.top1conf</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">top1conf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return the confidence score of the highest probability class.</p><p>This property retrieves the confidence score (probability) of the class with the highest predicted probability from the classification results.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>A tensor containing the confidence score of the top 1 class.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">)</span>  <span class="c1"># classify an image</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">probs</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">probs</span>  <span class="c1"># get classification probabilities</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">top1_confidence</span> <span class="o">=</span> <span class="n">probs</span><span class="o">.</span><span class="n">top1conf</span>  <span class="c1"># get confidence of top 1 class</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Top 1 class confidence: </span><span class="si">{</span><span class="n">top1_confidence</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1284-L1299"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">top1conf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the confidence score of the highest probability class.</span>
<span></span>
<span></span><span class="sd">    This property retrieves the confidence score (probability) of the class with the highest predicted probability</span>
<span></span><span class="sd">    from the classification results.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): A tensor containing the confidence score of the top 1 class.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("image.jpg")  # classify an image</span>
<span></span><span class="sd">        &gt;&gt;&gt; probs = results[0].probs  # get classification probabilities</span>
<span></span><span class="sd">        &gt;&gt;&gt; top1_confidence = probs.top1conf  # get confidence of top 1 class</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(f"Top 1 class confidence: {top1_confidence.item():.4f}")</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">top1</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.Probs.top5conf"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.Probs.top5conf</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">top5conf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return confidence scores for the top 5 classification predictions.</p><p>This property retrieves the confidence scores corresponding to the top 5 class probabilities predicted by the model. It provides a quick way to access the most likely class predictions along with their associated confidence levels.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>A tensor or array containing the confidence scores for the top 5 predicted</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">probs</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">probs</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">top5_conf</span> <span class="o">=</span> <span class="n">probs</span><span class="o">.</span><span class="n">top5conf</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">top5_conf</span><span class="p">)</span>  <span class="c1"># Prints confidence scores for top 5 classes</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1303-L1320"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">top5conf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return confidence scores for the top 5 classification predictions.</span>
<span></span>
<span></span><span class="sd">    This property retrieves the confidence scores corresponding to the top 5 class probabilities predicted by the</span>
<span></span><span class="sd">    model. It provides a quick way to access the most likely class predictions along with their associated</span>
<span></span><span class="sd">    confidence levels.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): A tensor or array containing the confidence scores for the top 5 predicted</span>
<span></span><span class="sd">            classes, sorted in descending order of probability.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; probs = results[0].probs</span>
<span></span><span class="sd">        &gt;&gt;&gt; top5_conf = probs.top5conf</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(top5_conf)  # Prints confidence scores for top 5 classes</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">top5</span><span class="p">]</span>
</code></pre></div></details><p><br/><br/><hr/><br/></p><h2 id="ultralytics.engine.results.OBB"><span class="doc-kind doc-kind-class">class</span> <code>ultralytics.engine.results.OBB</code></h2><div class="highlight"><pre><span></span><code><span></span><span class="n">OBB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><p><strong>Bases:</strong> <code>BaseTensor</code></p><p>A class for storing and manipulating Oriented Bounding Boxes (OBB).</p><p>This class provides functionality to handle oriented bounding boxes, including conversion between different formats, normalization, and access to various properties of the boxes. It supports both tracking and non-tracking scenarios.</p><p>This class stores and manipulates Oriented Bounding Boxes (OBB) for object detection tasks. It provides various properties and methods to access and transform the OBB data.</p><p><strong>Args</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>boxes</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>A tensor or numpy array containing the detection boxes, with shape (num_boxes, 7) or (num_boxes, 8). The last two columns contain confidence and class values. If present, the third last column contains track IDs, and the fifth column contains rotation.</td><td><em>required</em></td></tr><tr><td><code>orig_shape</code></td><td><code>tuple[int, int]</code></td><td>Original image size, in the format (height, width).</td><td><em>required</em></td></tr></tbody></table><p><strong>Attributes</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>data</code></td><td><code>torch.Tensor</code></td><td>The raw OBB tensor containing box coordinates and associated data.</td></tr><tr><td><code>orig_shape</code></td><td><code>tuple</code></td><td>Original image size as (height, width).</td></tr><tr><td><code>is_track</code></td><td><code>bool</code></td><td>Indicates whether tracking IDs are included in the box data.</td></tr><tr><td><code>xywhr</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Boxes in [x_center, y_center, width, height, rotation] format.</td></tr><tr><td><code>conf</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Confidence scores for each box.</td></tr><tr><td><code>cls</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Class labels for each box.</td></tr><tr><td><code>id</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Tracking IDs for each box, if available.</td></tr><tr><td><code>xyxyxyxy</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Boxes in 8-point [x1, y1, x2, y2, x3, y3, x4, y4] format.</td></tr><tr><td><code>xyxyxyxyn</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Normalized 8-point coordinates relative to orig_shape.</td></tr><tr><td><code>xyxy</code></td><td><code>torch.Tensor | np.ndarray</code></td><td>Axis-aligned bounding boxes in [x1, y1, x2, y2] format.</td></tr></tbody></table><p><strong>Methods</strong></p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#ultralytics.engine.results.OBB.xywhr"><code>xywhr</code></a></td><td>Return boxes in [x_center, y_center, width, height, rotation] format.</td></tr><tr><td><a href="#ultralytics.engine.results.OBB.conf"><code>conf</code></a></td><td>Return the confidence scores for Oriented Bounding Boxes (OBBs).</td></tr><tr><td><a href="#ultralytics.engine.results.OBB.cls"><code>cls</code></a></td><td>Return the class values of the oriented bounding boxes.</td></tr><tr><td><a href="#ultralytics.engine.results.OBB.id"><code>id</code></a></td><td>Return the tracking IDs of the oriented bounding boxes (if available).</td></tr><tr><td><a href="#ultralytics.engine.results.OBB.xyxyxyxy"><code>xyxyxyxy</code></a></td><td>Convert OBB format to 8-point (xyxyxyxy) coordinate format for rotated bounding boxes.</td></tr><tr><td><a href="#ultralytics.engine.results.OBB.xyxyxyxyn"><code>xyxyxyxyn</code></a></td><td>Convert rotated bounding boxes to normalized xyxyxyxy format.</td></tr><tr><td><a href="#ultralytics.engine.results.OBB.xyxy"><code>xyxy</code></a></td><td>Convert oriented bounding boxes (OBB) to axis-aligned bounding boxes in xyxy format.</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">boxes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>  <span class="c1"># xywhr, conf, cls</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">obb</span> <span class="o">=</span> <span class="n">OBB</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">640</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">obb</span><span class="o">.</span><span class="n">xyxyxyxy</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">obb</span><span class="o">.</span><span class="n">conf</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">obb</span><span class="o">.</span><span class="n">cls</span><span class="p">)</span>
</code></pre></div><p><strong>Raises</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>AssertionError</code></td><td>If the number of values per box is not 7 or 8.</td></tr></tbody></table><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1323-L1523"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="k">class</span><span class="w"> </span><span class="nc">OBB</span><span class="p">(</span><span class="n">BaseTensor</span><span class="p">):</span>
<span></span><span class="w">    </span><span class="sd">"""A class for storing and manipulating Oriented Bounding Boxes (OBB).</span>
<span></span>
<span></span><span class="sd">    This class provides functionality to handle oriented bounding boxes, including conversion between different formats,</span>
<span></span><span class="sd">    normalization, and access to various properties of the boxes. It supports both tracking and non-tracking scenarios.</span>
<span></span>
<span></span><span class="sd">    Attributes:</span>
<span></span><span class="sd">        data (torch.Tensor): The raw OBB tensor containing box coordinates and associated data.</span>
<span></span><span class="sd">        orig_shape (tuple): Original image size as (height, width).</span>
<span></span><span class="sd">        is_track (bool): Indicates whether tracking IDs are included in the box data.</span>
<span></span><span class="sd">        xywhr (torch.Tensor | np.ndarray): Boxes in [x_center, y_center, width, height, rotation] format.</span>
<span></span><span class="sd">        conf (torch.Tensor | np.ndarray): Confidence scores for each box.</span>
<span></span><span class="sd">        cls (torch.Tensor | np.ndarray): Class labels for each box.</span>
<span></span><span class="sd">        id (torch.Tensor | np.ndarray): Tracking IDs for each box, if available.</span>
<span></span><span class="sd">        xyxyxyxy (torch.Tensor | np.ndarray): Boxes in 8-point [x1, y1, x2, y2, x3, y3, x4, y4] format.</span>
<span></span><span class="sd">        xyxyxyxyn (torch.Tensor | np.ndarray): Normalized 8-point coordinates relative to orig_shape.</span>
<span></span><span class="sd">        xyxy (torch.Tensor | np.ndarray): Axis-aligned bounding boxes in [x1, y1, x2, y2] format.</span>
<span></span>
<span></span><span class="sd">    Methods:</span>
<span></span><span class="sd">        cpu: Return a copy of the OBB object with all tensors on CPU memory.</span>
<span></span><span class="sd">        numpy: Return a copy of the OBB object with all tensors as numpy arrays.</span>
<span></span><span class="sd">        cuda: Return a copy of the OBB object with all tensors on GPU memory.</span>
<span></span><span class="sd">        to: Return a copy of the OBB object with tensors on specified device and dtype.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; boxes = torch.tensor([[100, 50, 150, 100, 30, 0.9, 0]])  # xywhr, conf, cls</span>
<span></span><span class="sd">        &gt;&gt;&gt; obb = OBB(boxes, orig_shape=(480, 640))</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(obb.xyxyxyxy)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(obb.conf)</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(obb.cls)</span>
<span></span><span class="sd">    """</span>
<span></span>
<span></span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">        </span><span class="sd">"""Initialize an OBB (Oriented Bounding Box) instance with oriented bounding box data and original image shape.</span>
<span></span>
<span></span><span class="sd">        This class stores and manipulates Oriented Bounding Boxes (OBB) for object detection tasks. It provides various</span>
<span></span><span class="sd">        properties and methods to access and transform the OBB data.</span>
<span></span>
<span></span><span class="sd">        Args:</span>
<span></span><span class="sd">            boxes (torch.Tensor | np.ndarray): A tensor or numpy array containing the detection boxes, with shape</span>
<span></span><span class="sd">                (num_boxes, 7) or (num_boxes, 8). The last two columns contain confidence and class values. If present,</span>
<span></span><span class="sd">                the third last column contains track IDs, and the fifth column contains rotation.</span>
<span></span><span class="sd">            orig_shape (tuple[int, int]): Original image size, in the format (height, width).</span>
<span></span>
<span></span><span class="sd">        Raises:</span>
<span></span><span class="sd">            AssertionError: If the number of values per box is not 7 or 8.</span>
<span></span><span class="sd">        """</span>
<span></span>        <span class="k">if</span> <span class="n">boxes</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span></span>            <span class="n">boxes</span> <span class="o">=</span> <span class="n">boxes</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
<span></span>        <span class="n">n</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span></span>        <span class="k">assert</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">},</span> <span class="sa">f</span><span class="s2">"expected 7 or 8 values but got </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">"</span>  <span class="c1"># xywh, rotation, track_id, conf, cls</span>
<span></span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">orig_shape</span><span class="p">)</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">is_track</span> <span class="o">=</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">8</span>
<span></span>        <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span> <span class="o">=</span> <span class="n">orig_shape</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.OBB.xywhr"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.OBB.xywhr</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">xywhr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return boxes in [x_center, y_center, width, height, rotation] format.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>A tensor or numpy array containing the oriented bounding boxes with format</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">obb</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">obb</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">xywhr</span> <span class="o">=</span> <span class="n">obb</span><span class="o">.</span><span class="n">xywhr</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">xywhr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span></span><span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1379-L1393"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">xywhr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return boxes in [x_center, y_center, width, height, rotation] format.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): A tensor or numpy array containing the oriented bounding boxes with format</span>
<span></span><span class="sd">            [x_center, y_center, width, height, rotation]. The shape is (N, 5) where N is the number of boxes.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; obb = results[0].obb</span>
<span></span><span class="sd">        &gt;&gt;&gt; xywhr = obb.xywhr</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(xywhr.shape)</span>
<span></span><span class="sd">        torch.Size([3, 5])</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.OBB.conf"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.OBB.conf</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">conf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return the confidence scores for Oriented Bounding Boxes (OBBs).</p><p>This property retrieves the confidence values associated with each OBB detection. The confidence score represents the model's certainty in the detection.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>A tensor or numpy array of shape (N,) containing confidence scores for N</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">obb_result</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">obb</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">confidence_scores</span> <span class="o">=</span> <span class="n">obb_result</span><span class="o">.</span><span class="n">conf</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">confidence_scores</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1396-L1412"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">conf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the confidence scores for Oriented Bounding Boxes (OBBs).</span>
<span></span>
<span></span><span class="sd">    This property retrieves the confidence values associated with each OBB detection. The confidence score</span>
<span></span><span class="sd">    represents the model's certainty in the detection.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): A tensor or numpy array of shape (N,) containing confidence scores for N</span>
<span></span><span class="sd">            detections, where each score is in the range [0, 1].</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; obb_result = results[0].obb</span>
<span></span><span class="sd">        &gt;&gt;&gt; confidence_scores = obb_result.conf</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(confidence_scores)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.OBB.cls"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.OBB.cls</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Return the class values of the oriented bounding boxes.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>A tensor or numpy array containing the class values for each oriented bounding</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">obb</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">obb</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">class_values</span> <span class="o">=</span> <span class="n">obb</span><span class="o">.</span><span class="n">cls</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">class_values</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1415-L1429"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">cls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the class values of the oriented bounding boxes.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): A tensor or numpy array containing the class values for each oriented bounding</span>
<span></span><span class="sd">            box. The shape is (N,), where N is the number of boxes.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; result = results[0]</span>
<span></span><span class="sd">        &gt;&gt;&gt; obb = result.obb</span>
<span></span><span class="sd">        &gt;&gt;&gt; class_values = obb.cls</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(class_values)</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.OBB.id"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.OBB.id</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div><p>Return the tracking IDs of the oriented bounding boxes (if available).</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray | None</code></td><td>A tensor or numpy array containing the tracking IDs for each oriented</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">,</span> <span class="n">tracker</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Run inference with tracking</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span></span><span class="o">...</span>     <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">obb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="o">...</span>         <span class="n">track_ids</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">obb</span><span class="o">.</span><span class="n">id</span>
<span></span><span class="o">...</span>         <span class="k">if</span> <span class="n">track_ids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="o">...</span>             <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Tracking IDs: </span><span class="si">{</span><span class="n">track_ids</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1432-L1447"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Return the tracking IDs of the oriented bounding boxes (if available).</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray | None): A tensor or numpy array containing the tracking IDs for each oriented</span>
<span></span><span class="sd">            bounding box. Returns None if tracking IDs are not available.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("image.jpg", tracker=True)  # Run inference with tracking</span>
<span></span><span class="sd">        &gt;&gt;&gt; for result in results:</span>
<span></span><span class="sd">        ...     if result.obb is not None:</span>
<span></span><span class="sd">        ...         track_ids = result.obb.id</span>
<span></span><span class="sd">        ...         if track_ids is not None:</span>
<span></span><span class="sd">        ...             print(f"Tracking IDs: {track_ids}")</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_track</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.OBB.xyxyxyxy"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.OBB.xyxyxyxy</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">xyxyxyxy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Convert OBB format to 8-point (xyxyxyxy) coordinate format for rotated bounding boxes.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>Rotated bounding boxes in xyxyxyxy format with shape (N, 4, 2), where N is the</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">obb</span> <span class="o">=</span> <span class="n">OBB</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">640</span><span class="p">))</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">xyxyxyxy</span> <span class="o">=</span> <span class="n">obb</span><span class="o">.</span><span class="n">xyxyxyxy</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">xyxyxyxy</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span></span><span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1451-L1465"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">xyxyxyxy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Convert OBB format to 8-point (xyxyxyxy) coordinate format for rotated bounding boxes.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): Rotated bounding boxes in xyxyxyxy format with shape (N, 4, 2), where N is the</span>
<span></span><span class="sd">            number of boxes. Each box is represented by 4 points (x, y), starting from the top-left corner and</span>
<span></span><span class="sd">            moving clockwise.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; obb = OBB(torch.tensor([[100, 100, 50, 30, 0.5, 0.9, 0]]), orig_shape=(640, 640))</span>
<span></span><span class="sd">        &gt;&gt;&gt; xyxyxyxy = obb.xyxyxyxy</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(xyxyxyxy.shape)</span>
<span></span><span class="sd">        torch.Size([1, 4, 2])</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">xywhr2xyxyxyxy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xywhr</span><span class="p">)</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.OBB.xyxyxyxyn"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.OBB.xyxyxyxyn</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">xyxyxyxyn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Convert rotated bounding boxes to normalized xyxyxyxy format.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>Normalized rotated bounding boxes in xyxyxyxy format with shape (N, 4, 2),</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">obb</span> <span class="o">=</span> <span class="n">OBB</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">orig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">))</span>  <span class="c1"># 10 random OBBs</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">normalized_boxes</span> <span class="o">=</span> <span class="n">obb</span><span class="o">.</span><span class="n">xyxyxyxyn</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">normalized_boxes</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span></span><span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</code></pre></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1469-L1486"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">xyxyxyxyn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Convert rotated bounding boxes to normalized xyxyxyxy format.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): Normalized rotated bounding boxes in xyxyxyxy format with shape (N, 4, 2),</span>
<span></span><span class="sd">            where N is the number of boxes. Each box is represented by 4 points (x, y), normalized relative to the</span>
<span></span><span class="sd">            original image dimensions.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; obb = OBB(torch.rand(10, 7), orig_shape=(640, 480))  # 10 random OBBs</span>
<span></span><span class="sd">        &gt;&gt;&gt; normalized_boxes = obb.xyxyxyxyn</span>
<span></span><span class="sd">        &gt;&gt;&gt; print(normalized_boxes.shape)</span>
<span></span><span class="sd">        torch.Size([10, 4, 2])</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">xyxyxyxyn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyxyxyxy</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyxyxyxy</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyxyxyxy</span><span class="p">)</span>
<span></span>    <span class="n">xyxyxyxyn</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span></span>    <span class="n">xyxyxyxyn</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span></span>    <span class="k">return</span> <span class="n">xyxyxyxyn</span>
</code></pre></div></details><p><br/></p><h3 id="ultralytics.engine.results.OBB.xyxy"><span class="doc-kind doc-kind-property">property</span> <code>ultralytics.engine.results.OBB.xyxy</code></h3><div class="highlight"><pre><span></span><code><span></span><span class="k">def</span><span class="w"> </span><span class="nf">xyxy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</code></pre></div><p>Convert oriented bounding boxes (OBB) to axis-aligned bounding boxes in xyxy format.</p><p>This property calculates the minimal enclosing rectangle for each oriented bounding box and returns it in xyxy format (x1, y1, x2, y2). This is useful for operations that require axis-aligned bounding boxes, such as IoU calculation with non-rotated boxes.</p><p><strong>Returns</strong></p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>torch.Tensor | np.ndarray</code></td><td>Axis-aligned bounding boxes in xyxy format with shape (N, 4), where N is the</td></tr></tbody></table><p><strong>Examples</strong></p><div class="highlight"><pre><span></span><code><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ultralytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">YOLO</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">YOLO</span><span class="p">(</span><span class="s2">"yolo11n-obb.pt"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="s2">"path/to/image.jpg"</span><span class="p">)</span>
<span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span></span><span class="o">...</span>     <span class="n">obb</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">obb</span>
<span></span><span class="o">...</span>     <span class="k">if</span> <span class="n">obb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span></span><span class="o">...</span>         <span class="n">xyxy_boxes</span> <span class="o">=</span> <span class="n">obb</span><span class="o">.</span><span class="n">xyxy</span>
<span></span><span class="o">...</span>         <span class="nb">print</span><span class="p">(</span><span class="n">xyxy_boxes</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (N, 4)</span>
</code></pre></div><div class="admonition note"><p class="admonition-title">Notes</p><ul><li>This method approximates the OBB by its minimal enclosing rectangle.</li><li>The returned format is compatible with standard object detection metrics and visualization tools.</li><li>The property uses caching to improve performance for repeated access.</li></ul></div><details><summary>Source code in <code>ultralytics/engine/results.py</code></summary><a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/engine/results.py#L1490-L1523"><i aria-hidden="true" class="fa-brands fa-github" style="margin-right:6px;"></i>View on GitHub</a><div class="highlight"><pre><span></span><code><span></span><span class="nd">@property</span>
<span></span><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">xyxy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span></span><span class="w">    </span><span class="sd">"""Convert oriented bounding boxes (OBB) to axis-aligned bounding boxes in xyxy format.</span>
<span></span>
<span></span><span class="sd">    This property calculates the minimal enclosing rectangle for each oriented bounding box and returns it in xyxy</span>
<span></span><span class="sd">    format (x1, y1, x2, y2). This is useful for operations that require axis-aligned bounding boxes, such as IoU</span>
<span></span><span class="sd">    calculation with non-rotated boxes.</span>
<span></span>
<span></span><span class="sd">    Returns:</span>
<span></span><span class="sd">        (torch.Tensor | np.ndarray): Axis-aligned bounding boxes in xyxy format with shape (N, 4), where N is the</span>
<span></span><span class="sd">            number of boxes. Each row contains [x1, y1, x2, y2] coordinates.</span>
<span></span>
<span></span><span class="sd">    Examples:</span>
<span></span><span class="sd">        &gt;&gt;&gt; import torch</span>
<span></span><span class="sd">        &gt;&gt;&gt; from ultralytics import YOLO</span>
<span></span><span class="sd">        &gt;&gt;&gt; model = YOLO("yolo11n-obb.pt")</span>
<span></span><span class="sd">        &gt;&gt;&gt; results = model("path/to/image.jpg")</span>
<span></span><span class="sd">        &gt;&gt;&gt; for result in results:</span>
<span></span><span class="sd">        ...     obb = result.obb</span>
<span></span><span class="sd">        ...     if obb is not None:</span>
<span></span><span class="sd">        ...         xyxy_boxes = obb.xyxy</span>
<span></span><span class="sd">        ...         print(xyxy_boxes.shape)  # (N, 4)</span>
<span></span>
<span></span><span class="sd">    Notes:</span>
<span></span><span class="sd">        - This method approximates the OBB by its minimal enclosing rectangle.</span>
<span></span><span class="sd">        - The returned format is compatible with standard object detection metrics and visualization tools.</span>
<span></span><span class="sd">        - The property uses caching to improve performance for repeated access.</span>
<span></span><span class="sd">    """</span>
<span></span>    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyxyxyxy</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span></span>    <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyxyxyxy</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span></span>    <span class="k">return</span> <span class="p">(</span>
<span></span>        <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span></span>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span>
<span></span>        <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span></span>    <span class="p">)</span>
</code></pre></div></details><p><br/><br/></p><br/><br/><div class="git-info"><div class="dates-container"><span class="date-item" title="This page was first created on November 12, 2023"><span class="hover-item">ğŸ“…</span> Created 2 years ago </span><span class="date-item" title="This page was last updated on November 23, 2025"><span class="hover-item">âœï¸</span> Updated 2 days ago </span></div><div class="authors-container"><a class="author-link" href="https://github.com/glenn-jocher" title="glenn-jocher (8 changes)"><img alt="glenn-jocher" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/26833433?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/jk4e" title="jk4e (1 change)"><img alt="jk4e" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/116908874?v=4&amp;s=96"/></a><a class="author-link" href="https://github.com/Burhan-Q" title="Burhan-Q (1 change)"><img alt="Burhan-Q" class="hover-item" loading="lazy" src="https://avatars.githubusercontent.com/u/62214284?v=4&amp;s=96"/></a></div></div><div class="share-buttons"><button class="share-button hover-item" onclick="window.open('https://twitter.com/intent/tweet?url=https%3A%2F%2Fdocs.ultralytics.com%2Freference%2Fengine%2Fresults%2F', 'TwitterShare', 'width=550,height=680,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-x-twitter"></i> Tweet </button><button class="share-button hover-item linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fdocs.ultralytics.com%2Freference%2Fengine%2Fresults%2F', 'LinkedinShare', 'width=550,height=730,menubar=no,toolbar=no'); return false;"><i class="fa-brands fa-linkedin-in"></i> Share </button></div><br/></article></div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div><button class="md-top md-icon" data-md-component="top" hidden="" type="button"><svg class="lucide lucide-circle-arrow-up" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10"></circle><path d="m16 12-4-4-4 4M12 16V8"></path></svg> Back to top
</button></main><footer class="md-footer"><nav aria-label="Footer" class="md-footer__inner md-grid"><a aria-label="Previous: predictor" class="md-footer__link md-footer__link--prev" href="../predictor/"><div class="md-footer__button md-icon"><svg class="lucide lucide-arrow-left" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12 19-7-7 7-7M19 12H5"></path></svg></div><div class="md-footer__title"><span class="md-footer__direction"> Previous </span><div class="md-ellipsis"> predictor </div></div></a><a aria-label="Next: trainer" class="md-footer__link md-footer__link--next" href="../trainer/"><div class="md-footer__title"><span class="md-footer__direction"> Next </span><div class="md-ellipsis"> trainer </div></div><div class="md-footer__button md-icon"><svg class="lucide lucide-arrow-right" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 12h14M12 5l7 7-7 7"></path></svg></div></a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-copyright"><div class="md-copyright__highlight"><a href="https://www.ultralytics.com/" target="_blank">Â© 2025 Ultralytics Inc.</a> All rights reserved. </div> Made with <a href="https://zensical.org/" rel="noopener" target="_blank"> Zensical </a></div><div class="md-social"><a class="md-social__link" href="https://github.com/ultralytics" rel="noopener" target="_blank" title="github.com"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://www.linkedin.com/company/ultralytics/" rel="noopener" target="_blank" title="www.linkedin.com"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://x.com/ultralytics" rel="noopener" target="_blank" title="x.com"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://youtube.com/ultralytics?sub_confirmation=1" rel="noopener" target="_blank" title="youtube.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://hub.docker.com/r/ultralytics/ultralytics/" rel="noopener" target="_blank" title="hub.docker.com"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://pypi.org/project/ultralytics/" rel="noopener" target="_blank" title="pypi.org"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://discord.com/invite/ultralytics" rel="noopener" target="_blank" title="discord.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://reddit.com/r/ultralytics" rel="noopener" target="_blank" title="reddit.com"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5" fill="currentColor"></path></svg></a><a class="md-social__link" href="https://weixin.qq.com/r/mp/LxckPDfEgWr_rXNf90I9" rel="noopener" target="_blank" title="weixin.qq.com"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6" fill="currentColor"></path></svg></a></div></div></div></footer></div><div class="md-dialog" data-md-component="dialog"><div class="md-dialog__inner md-typeset"></div></div><div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"annotate":null,"base":"../../..","features":["content.action.edit","content.code.annotate","content.code.copy","content.tooltips","toc.follow","navigation.top","navigation.tabs","navigation.tabs.sticky","navigation.prune","navigation.footer","navigation.tracking","navigation.instant","navigation.instant.progress","navigation.indexes","navigation.sections","content.tabs.link"],"search":"../../../assets/javascripts/workers/search.5df7522c.min.js","tags":null,"translations":{"clipboard.copied":"Copied to clipboard","clipboard.copy":"Copy to clipboard","search.result.more.one":"1 more on this page","search.result.more.other":"# more on this page","search.result.none":"No matching documents","search.result.one":"1 matching document","search.result.other":"# matching documents","search.result.placeholder":"Type to start searching","search.result.term.missing":"Missing","select.version":"Select version"},"version":null}</script>
<script src="../../../assets/javascripts/bundle.21aa498e.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/ultralytics/llm@v0.0.8/js/chat.min.js"></script>
<script src="https://unpkg.com/tablesort@5.6.0/dist/tablesort.min.js"></script>
<script src="../../../javascript/extra.js"></script>
<script src="../../../javascript/giscus.js"></script>
<script src="../../../javascript/tablesort.js"></script>
</body></html>